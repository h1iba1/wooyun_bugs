{"id": 74625, "wybug_id": "wooyun-2016-0174799", "wybug_title": "酷我音乐会员0.01元购买成功存在支付逻辑漏洞", "wybug_corp": "酷我音乐", "wybug_author": "我山之石-无", "wybug_date": "2016-02-17 12:57", "wybug_open_date": "2016-02-17 17:55", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-17：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 使用酷我网页版购买酷我会员，通过修改购买金额为0.01元购买成功原价10元/月的会员 详细说明：  1、找到酷我会员购买界面，使用微信支付方式\n\n2、正常情况下需要通过扫描微信的支付验证码，支付10元购买一个月会员\n\n3、0元购买时通过修改数据包的付费金额为0.01元，然后扫描微信支付成功后就可以成功成为会员了\n\n修改为0.01元\n\n继续操作\n\n支付请求变为0.01元了\n\n\n\n扫一下支付成功后重新登录查看\n\n   漏洞证明：  1、0.01元购买了酷我会员2、银行扣款0.01元   修复方案：  1、对支付的金额做保护，仅做url编码是不可以的   版权声明：转载请注明来源 我山之石-无@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-02-17 14:14 厂商回复： 感谢对酷我的支持 最新状态： 2016-02-17：处理完成  ", "replys": "漏洞评价：\n评价\n     2016-02-18 21:46 |    \t\t暖暖 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:5        | 高三猫)\t\t \n  请问这个数据包是在哪里的    \n     2016-02-19 00:41 |    \t\t小铭同学 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 找工作找工作找工作T_T。。。  有没有上海...)\t\t \n  @暖暖 我认为是这么修改的 burp suite里Proxy里面有Option 里面有个Match and Replace ，ADD里加一条Response body条件 10替换成0.01 ，本地以为这个价格是0.01就生成了一个0.01元的单号的二维码我猜是因为ajax的生成会员的价格是在本地处理的形成的 然后微信支付返回信息的API里可能又没包括金额的多少 只返回了此笔交易的单号支付完成形成的，可能出于服务器成本的一种考虑的优化bug不知道对不对0 0.     \n     2016-02-19 09:49 |    \t\t某科学的围观蛋 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:1        | 专注围观不学无术)\t\t \n  亲,,,你对你的用户名打码不全...    \n     2016-02-19 18:18 |    \t\t暖暖 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:5        | 高三猫)\t\t \n  @小铭同学 多谢，学习了，谢谢哈    \n     2016-02-26 09:05 |    \t\t酷帥王子 \t\t\t( 普通白帽子  |\t\t\t        Rank:244 漏洞数:67        | 天之屌，人之神！天人合一，乃屌神也！)\t\t \n  这样的漏洞很不错，收了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}