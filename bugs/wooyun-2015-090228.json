{"id": 46574, "wybug_id": "wooyun-2015-090228", "wybug_title": "TurboMail邮件系统存储型xss打包", "wybug_corp": "国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-01-06 11:52", "wybug_open_date": "2015-02-20 11:54", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-20：\t细节向公众公开  简要描述：     TurboMail邮件系统，过滤不严导致跨站漏洞存在，打包提交。   详细说明：      官网：http://www.turbomail.org/    百度搜索：Powered by TurboMail 可以发现用户量还是很大的。    测试帐号获取渠道参考 WooYun: TurboMail邮件系统任意账号登录漏洞（附众多案例） 里面的内容，发现链接 http://mail.ieds.com.cn/nicknamelogin.jsp 与链接 http://mail.cttsx.com/nicknamelogin.jsp尚未被修复，依然处于直接登录状态，暗喜开始xss测试。    使用qq邮箱给这两个邮箱帐号发信，liuguoxia@ieds.com.cn   dttf_js@cttsx.com   收到信后效果即现，截图如下xss第一大处：\n\n\n\n说明信头部分么有做过滤处理(这里只测试了发件人昵称部分，其他信头部分应该也存在)    打开信件后如图：xss第二大处：\n\n\n\n    xss测试语句<body/onload=alert(25)> <iframe/onload=alert(document.domain)>    说明信件正文富文本处也没有做过滤处理，从而导致xss漏洞满屏跑。    至于其它猥琐地方，如附件名称，附件内容处等等相信也存在类似问题，你们自己开发人员可以做下自检。   漏洞证明：  官网：http://www.turbomail.org/    百度搜索：Powered by TurboMail 可以发现用户量还是很大的。    测试帐号获取渠道参考 WooYun: TurboMail邮件系统任意账号登录漏洞（附众多案例） 里面的内容，发现链接 http://mail.ieds.com.cn/nicknamelogin.jsp 与链接 http://mail.cttsx.com/nicknamelogin.jsp尚未被修复，依然处于直接登录状态，暗喜开始xss测试。    使用qq邮箱给这两个邮箱帐号发信，liuguoxia@ieds.com.cn   dttf_js@cttsx.com   收到信后效果即现，截图如下xss第一大处：\n\n\n\n说明信头部分么有做过滤处理(这里只测试了发件人昵称部分，其他信头部分应该也存在)    打开信件后如图：xss第二大处：\n\n\n\n    xss测试语句<body/onload=alert(25)> <iframe/onload=alert(document.domain)>    说明信件正文富文本处也没有做过滤处理，从而导致xss漏洞满屏跑。    至于其它猥琐地方，如附件名称，附件内容处等等相信也存在类似问题，你们自己开发人员可以做下自检。   修复方案：     在邮件信头，正文富文本区，附件区等地方加强过滤处理。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-01-11 10:31 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}