{"id": 51309, "wybug_id": "wooyun-2014-075019", "wybug_title": "中国网络电视台存储型xss可蠕虫", "wybug_corp": "中国网络电视台", "wybug_author": "卡卡", "wybug_date": "2014-09-04 15:28", "wybug_open_date": "2014-09-09 15:30", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 唐僧师徒四人一行来到酒家投宿，悟空见老板娘颇有几分姿色，轻浮道：\"娘们儿，给几位爷唱一曲助助兴？\"唐僧怒不可遏，低声喝道：\"猴头，看你活腻了呀！\"悟空愣住，半晌后对老板娘说道：\"听见没？俺师父点歌了，还是英文歌，《Hotel California》\" 详细说明：  问题出现在央视微博这里 \nhttp://t.cntv.cn/\n 其实本来我只是发现了一个反射型的xss在分享哪里，后来我想到这个功能，在微博操作哪里不是也有，如果同样都存在，那就是一个存储型的了，于是我就测了测，果然有收获！ 先注册一个账号，我先试了试发表了一个普通的弹窗代码，然后查看了下源码，发现过滤了尖括号 \n\n \n\n 直接输出这块看来是不可能了，但是其他呢？ 关键部分来了 我在测转发的时候，竟然发现弹窗了 所以我猜测直接输出的话会过滤尖括号，查看源码果然发现没有进行二次过滤，造成xss 漏洞利用： 发表xss代码，点击转发就会触发，不管是弹窗还是cookie代码，全部可以 \n\n 在发表一个cookie的，同样也可以获取到cookie \n\n 而且未作httponly，拿到cookie便可登陆 另外在微博个人设置那里，也同样存在存储型xss，完全可以实现xss蠕虫效果 不过利用不在讨论中，检测也只是点到为止，赶快修复吧   漏洞证明：  \n\n \n\n   修复方案：  你们懂的~   版权声明：转载请注明来源 卡卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-09-09 15:30 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-08 21:36 |    \t\t卡卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:52        | <script>alert('安全团队长期招人')</scrip...)\t\t \n  @@中国网络电视台 放假吃月饼去了？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}