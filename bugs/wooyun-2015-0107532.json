{"id": 36558, "wybug_id": "wooyun-2015-0107532", "wybug_title": "看我是如何控制数万台路由器WiFi及广告的", "wybug_corp": "深圳市百米生活电子商务有限公司", "wybug_author": "Ch丶0nly", "wybug_date": "2015-04-13 09:17", "wybug_open_date": "2015-05-28 09:18", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传内容未检查", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 百米生活，通过免费商业Wi-Fi的铺设，在全国各城市打造一个基于本地化社区的电子商务服务平台，为商家提供产品推广、品牌宣传、商家管理及成本控制等服务；为消费者带来社区附近衣食住行、吃喝玩乐的信息服务，同时借助免费Wi-Fi技术支持，开启移动互联网的全新生活方式。 详细说明：      百米生活，通过免费商业Wi-Fi的铺设，在全国各城市打造一个基于本地化社区的电子商务服务平台，为商家提供产品推广、品牌宣传、商家管理及成本控制等服务；为消费者带来社区附近衣食住行、吃喝玩乐的信息服务，同时借助免费Wi-Fi技术支持，开启移动互联网的全新生活方式。据资料显示  该公司的百米生活路由器已经遍布全国多个省市了，用户多达数十万！不可否认这是全国最NB的一个（广告路由器） 说实话他这个路由器穿透力确实够NB  赞一个   就是广告太多了一切起因皆因贵公司的广告    特么的深深的打动了我  才有了今天的故事废话就不多说了  直接上漏洞证明   漏洞证明：  官网www.100msh.com  漏洞出现在http://open.100msh.com  开发者平台存在任意文件上传首先我们先注册用户http://open.100msh.com/user/register_dev.html此处填写信息   写完之后来到我们的个人资料-上传我们的php一句话\n\n点击提交  会提交请上传jpg文件  这个不管他  返回页面的时候我们的一句话已经上传了 http://img.100msh.net//developer/credential_file/12e31512040936467884.php\n\n我们的php一句话已经执行   \n\n让人激动不已  里面有主站以及多个分站  开发站点等 重要信息及站点附部分数据库信息：\n//管理后台数据库链接\t\t    'ADM' => array(        'DB_HOST' => 'db.100msh.com', //数据库主机        'DB_USER' => '100msh_admin', //数据库用户名        'DB_PWD' => '638m2rh5Hd9cUc2xDjW3Ig==', //数据库密码        'DB_NAME' => '100msh_admin', //数据库名$db_cfg=array(\t//商家管理数据库链接\t'PARTNER'=>array(\t\t\t'DB_HOST'=>'db.100msh.com',      \t//数据库主机\t\t\t'DB_USER'=>'100msh_partner',   //数据库用户名\t\t\t'DB_PWD'=>'g7COkNYlex98kGf4d8peoA==',      \t    //数据库密码\t\t\t'DB_NAME'=>'100msh_partner',    //数据库名\t\t),\t//前台商城数据库链接\t'ADM'=>array(\t\t\t'DB_HOST'=>'db.100msh.com',      \t//数据库主机\t\t\t'DB_USER'=>'100msh_admin',      \t//数据库用户名\t\t\t'DB_PWD'=>'638m2rh5Hd9cUc2xDjW3Ig==',      \t    //数据库密码\t\t\t'DB_NAME'=>'100msh_admin',      \t//数据库名\t\t),\t//商品数据库链接\t'ITEM'=>array(\t\t\t'DB_HOST'=>'db.100msh.com',      \t//数据库主机\t\t\t'DB_USER'=>'100msh_items',      \t//数据库用户名\t\t\t'DB_PWD'=>'VL9vDsx3ob/+9m4QhkUu5w==',      \t    //数据库密码\t\t\t'DB_NAME'=>'100msh_items',      \t//数据库名\t\t),\t'MACADMIN'=>array(\t\t\t'DB_HOST'=>'db.100msh.com',      \t//数据库主机\t\t\t'DB_USER'=>'100msh_macadmin',   //数据库用户名\t\t\t'DB_PWD'=>'FGCy3cDZ4W0wUH2gEtkgcA==',      \t    //数据库密码\t\t\t'DB_NAME'=>'100msh_macadmin',    //数据库名\t\t),\t\t'DEVE'=>array(\t\t\t\t'DB_HOST'=>'db.100msh.com',      \t//数据库主机\t\t\t\t'DB_USER'=>'100msh_developer',   //数据库用户名\t\t\t\t'DB_PWD'=>'pjROJdD6R31dN27KK0DtSg==',      \t    //数据库密码\t\t\t\t'DB_NAME'=>'100msh_developer',    //数据库名\t\t),\t\t);\n找到多个数据库配置信息   其中就有我们的路由器管理后台，里面有数万名百米生活路由器用户的配置信息以及联系方式http://wifiadmintest.100msh.com/z_testadmintest14万商户信息及联系方式\n\n路由器信息及WIFI密码\n\n此处可修改、清除WiFi上网密码\n\n\n\n此处还可以修改、删除路由器广告\n\n简单证明  就不做测试了     修复方案：     版权声明：转载请注明来源 Ch丶0nly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-04-13 19:55 |    \t\t孤影 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 一万年太久，只争朝夕。)\t\t \n  作为使用一名消费者我表示，抢位，沙发。    \n     2015-05-28 09:28 |    \t\thaitaowuyun \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 人至贱,则无敌)\t\t \n  出售瓜子,花生,爆米花    \n     2015-05-28 09:53 |    \t\t绽放的菊花 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 绽放中的菊花)\t\t \n  拍这里拍这里~    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}