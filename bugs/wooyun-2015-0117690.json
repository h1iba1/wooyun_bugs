{"id": 30028, "wybug_id": "wooyun-2015-0117690", "wybug_title": "圣才学习网低权限用户越权访问管理员页面(从而泄漏17万订单信息\\14万注册会员信息以及90万电子书密码信息)", "wybug_corp": "100eshu.com", "wybug_author": "harbour_bin", "wybug_date": "2015-06-02 14:18", "wybug_open_date": "2015-07-17 15:42", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "越权操作", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-17：\t细节向公众公开  简要描述： 圣才学习网低权限用户越权访问管理员页面, 从而泄漏17万订单信息、14万注册会员信息以及90万电子书密码信息PS：还是比较严重的,开始是以为是简单的弱密码,好几次灵感来了,就到了这一步. wooyun rank值能不能稍微多给点:-)  详细说明：  1、后台URL:http://www.100eshu.com/ScEbook_Admin/login.aspx用户名：huwenjie 密码：111111进入后,得到下图：\n\n本来想就是一个简单的弱密码,想着算了吧,然后这两天想有没有可能存在权限的问题,因此尝试了一下2、越权访问超级管理员页面URL：/ScEbook_Admin/Member/order.aspx 会员订单管理,得到17万订单信息\n\n\n\nURL：/ScEbook_Admin/Member/ 注册会员列表,得到14万订单信息\n\n\n\nURL：/ScEbook_Admin/Ebook.aspx E书密码,得到90万电子书密码信息\n\n\n\n3、后台其他的页面信息,已经测试,可以访问的,厂商自己注意一下吧\n+-----+----------+----------------------------------------------------------+------+---------------+-------------+--------+----------------------------+------------+| 1   | 0        | /ScEbook_Admin/                                          | 9000 | E书管理          | 0-1         | 1      | 10 16 2012 \\\\?a05:11PM     | 1       || 10  | 0        | /ScEbook_Admin/                                          | 910  | 信息管理          | 0-10        | 1      | 10 16 2012 \\\\?a05:25PM     | 1        || 100 | 99       | /ScEbook_Admin/EbookPwd/default.aspx                     | 990  | 批量密码生成        | 0-1-99-100  | 1      | 12 \\\\?a03 2012 10:41AM     | 1          || 101 | 99       | /ScEbook_Admin/EbookPwd/generatehand.aspx                | 1000 | 随书密码生成        | 0-1-99-101  | 1      | 12 \\\\?a03 2012 10:42AM     | 1          || 102 | 99       | /ScEbook_Admin/EbookPwd/protect.aspx                     | 980  | e书密码查询        | 0-1-99-102  | 1      | 12 \\\\?a03 2012 10:43AM     | 1         || 104 | 14       | /ScEbook_Admin/Finance/invoice.aspx                      | 500  | 发票受理          | 0-14-104    | 1      | 12 \\\\?a07 2012 \\\\?a05:07PM | 1        || 105 | 4        | /ScEbook_Admin/EbookEvaluate/error.aspx                  | 400  | 错误反馈          | 0-1-4-105   | 1      | 12 19 2012 \\\\?a02:11PM     | 1        || 107 | 7        | /ScEbook_Admin/Data/checkSetting.aspx                    | 390  | 素材审核设置        | 0-103-7-107 | 1      | 01 \\\\?a03 2013 11:09AM     | 1          || 108 | 9        | /ScEbook_Admin/Question/checkSetting.aspx                | 590  | 咨询审核设置        | 0-9-108     | 1      | 01 \\\\?a03 2013 \\\\?a05:29PM | 1          || 109 | 7        | /ScEbook_Admin/Data/report.aspx                          | 0   | 素材举报受理        | 0-103-7-109 | 1      | 02 17 2013 \\\\?a03:16PM     | 1          || 11  | 0        | /ScEbook_Admin/                                          | 900  | 广告管理          | 0-11        | 1      | 10 16 2012 \\\\?a05:25PM     | 1        || 110 | 16       | /ScEbook_Admin/Help/edithelp.aspx                        | 40   | 编辑指南          | 0-16-110    | 1      | 04 16 2013 \\\\?a01:59PM     | 1        || 112 | 17       | /ScEbook_Admin/Admin/AdminUserOnline.aspx                | 960  | 在线管理员查询       | 0-17-112    | 1      | 05 22 2013 10:06PM         |1          || 114 | 1        | /ScEbook_Admin/ScNetDisk/                                | 9000 | 圣才网盘          | 0-1-114     | 0      | 08 \\\\?a01 2013 \\\\?a02:33PM | 1        || 115 | 11       | /ScEbook_Admin/MobileInstructImage/                      | 800  | 移动引导图片        | 0-11-115    | 1      | 08 19 2013 \\\\?a09:00AM     | 1          || 116 | 11       | /ScEbook_Admin/MobileAdvisement/                         | 700  | 移动广告管理        | 0-11-116    | 1      | 08 19 2013 \\\\?a09:00AM     | 1          || 117 | 17       | /ScEbook_Admin/PayConfiguration/                         | 1   | 第三方支付接口       | 0-17        | 1      | 09 12 2013 \\\\?a08:33AM     |1          || 12  | 0        | /ScEbook_Admin/                                          | 890  | 会员管理          | 0-12        | 1      | 10 16 2012 \\\\?a05:26PM     | 1        || 120 | 17       | /ScEbook_Admin/PayLimitConfiguration/                    | 2   | 移动端支付限制管理     | 0-17        | 1      | 09 23 2013 \\\\?a02:02PM| 1          || 122 | 17       | /ScEbook_Admin/SEO/                                      | 3   | 搜索优化          | 0-17-122    | 1      | 11 24 2013 \\\\?a02:15PM     | 1        || 124 | 1        | \\\\ScEbook_Admin\\\\Agent\\\\AgentMessage.aspx                | 0   | 代理商功能         | 0-1-124     | 0      | 01 26 2014 \\\\?a02:04PM     | 1         || 125 | 124      | /ScEbook_Admin/Agent/AppleMessage.aspx                   | 0   | 苹果供货          | 0-1-124-125 | 0      | 03 12 2014 \\\\?a05:19PM     | 1        || 126 | 124      | /ScEbook_Admin/Agent/AgentMessage.aspx                   | 0   | 当当供货          | 0-1-124-126 | 0      | 03 12 2014 \\\\?a05:20PM     | 1        || 127 | 124      | /ScEbook_Admin/Agent/RenDa.aspx                          | 2   | 人大经济论坛推送      | 0-1-124-127 | 0      | 04 \\\\?a04 2014 \\\\?a06:46PM | 1          || 128 | 2        | /ScEbook_Admin/EbookActMember/                           | 480  | E书操作          | 0-1-128     | 1      | 07 23 2014 \\\\?a03:40PM     | 1       || 129 | 1        | /ScEbook_Admin/Ebook/epub.aspx                           | 0   | e书网生成全部epub格式 | 0-1-129     | 0      | 03 30 2015 \\\\?a05:54PM     | 1          || 130 | 15       | /ScEbook_Admin/Statistics/BookDownEdit.aspx              | 715  | e书（题库）下载量修改   | 0-15-130    | 1      | 04 15 2015 \\\\?a03:59PM | 1          || 131 | 12       | \\\\ScEbook_Admin\\\\ServiceDept\\\\UserGroupMakeInfoList.aspx | 0   | e书定制信息列表      | 0-12-131    | 0      | 04 25 2015 10:17AM         |1          || 14  | 0        | /ScEbook_Admin/                                          | 870  | 财务管理          | 0-14        | 1      | 10 16 2012 \\\\?a05:26PM     | 1        || 15  | 0        | /ScEbook_Admin/                                          | 860  | 统计管理          | 0-15        | 1      | 10 16 2012 \\\\?a05:26PM     | 1        || 16  | 0        | /ScEbook_Admin/                                          | 850  | 帮助管理          | 0-16        | 1      | 10 16 2012 \\\\?a05:27PM     | 1        || 17  | 0        | /ScEbook_Admin/                                          | 840  | 系统管理          | 0-17        | 1      | 10 16 2012 \\\\?a05:28PM     | 1        || 18  | 17       | /ScEbook_Admin/Config/                                   | 1000 | 系统基本参数        | 0-17-18     | 1      | 10 16 2012 \\\\?a05:28PM     | 1          || 19  | 17       | /ScEbook_Admin/Menu/                                     | 990  | 系统菜单          | 0-17-19     | 1      | 10 16 2012 \\\\?a05:29PM     | 1        || 2   | 1        | /ScEbook_Admin/                                          | 990  | E书分类          | 0-1-2       | 1      | 10 16 2012 \\\\?a05:12PM     | 1       || 20  | 17       | /ScEbook_Admin/Admin/AdminRole.aspx                      | 980  | 管理员角色配置       | 0-17-20     | 1      | 10 16 2012 \\\\?a05:46PM     |1          || 21  | 17       | /ScEbook_Admin/Admin/AdminUser.aspx                      | 970  | 管理员配置         | 0-17-21     | 1      | 10 16 2012 \\\\?a05:47PM     | 1         || 22  | 2        | /ScEbook_Admin/EbookCategory/                            | 500  | E书分类          | 0-1-2-22    | 1      | 10 17 2012 \\\\?a04:12PM     | 1       || 23  | 17       | /ScEbook_Admin/Log/                                      | 300  | 系统日志          | 0-17-23     | 1      | 10 18 2012 \\\\?a03:04PM     | 1        || 24  | 17       | /ScEbook_Admin/Email/                                    | 400  | 系统邮件模板        | 0-17-24     | 1      | 10 19 2012 11:36AM         | 1          || 25  | 16       | /ScEbook_Admin/Help/webhelp.aspx                         | 100  | 前台帮助          | 0-16-25     | 1      | 10 19 2012 \\\\?a02:16PM     | 1        || 26  | 16       | /ScEbook_Admin/Help/systemhelp.aspx                      | 50   | 后台帮助          | 0-16-26     | 1      | 10 19 2012 \\\\?a02:16PM     | 1        || 27  | 2        | /ScEbook_Admin/Ebook/                                    | 490  | 所有E书列表        | 0-1-2-27    | 1      | 10 19 2012 \\\\?a02:17PM     | 1         || 34  | 3        | /ScEbook_Admin/EbookRecommend/                           | 500  | 推荐设置          | 0-1-3-34    | 1      | 10 19 2012 \\\\?a02:25PM     | 1        || 35  | 3        | /ScEbook_Admin/EbookRecommend/edit.aspx                  | 450  | 推荐查询与修改       | 0-1-3-35    | 1      | 10 19 2012 \\\\?a02:25PM     |1          || 37  | 4        | /ScEbook_Admin/EbookEvaluate/comment.aspx                | 420  | 评论管理          | 0-1-4-37    | 1      | 10 19 2012 \\\\?a02:26PM     | 1        || 38  | 5        | /ScEbook_Admin/EbookSort/make.aspx                       | 500  | 制作排行          | 0-1-5-38    | 1      | 10 19 2012 \\\\?a02:27PM     | 1        || 39  | 5        | /ScEbook_Admin/EbookSort/read.aspx                       | 490  | 阅读排行          | 0-1-5-39    | 1      | 10 19 2012 \\\\?a02:28PM     | 1        || 4   | 1        | /ScEbook_Admin/EbookEvaluate/                            | 970  | E书评价          | 0-1-4       | 1      | 10 16 2012 \\\\?a05:13PM     | 1       || 40  | 5        | /ScEbook_Admin/EbookSort/favorite.aspx                   | 480  | 收藏排行          | 0-1-5-40    | 1      | 10 19 2012 \\\\?a02:28PM     | 1        || 41  | 5        | /ScEbook_Admin/EbookSort/download.aspx                   | 460  | 下载排行          | 0-1-5-41    | 1      | 10 19 2012 \\\\?a02:29PM     | 1        || 43  | 6        | /ScEbook_Admin/EbookMake/basicsetting.aspx               | 480  | E书基本设置        | 0-1-6-43    | 1      | 10 19 2012 \\\\?a02:30PM     | 1         || 44  | 6        | /ScEbook_Admin/EbookMake/encryption.aspx                 | 470  | E书加密设置        | 0-1-6-44    | 1      | 10 19 2012 \\\\?a02:31PM     | 1         || 46  | 7        | /ScEbook_Admin/DataCategory/                             | 500  | 素材分类管理        | 0-103-7-46  | 1      | 10 19 2012 \\\\?a02:43PM     | 1          || 47  | 7        | /ScEbook_Admin/Data/                                     | 490  | 所有素材列表        | 0-103-7-47  | 1      | 10 19 2012 \\\\?a02:43PM     | 1          || 48  | 7        | /ScEbook_Admin/Data/toCheck.aspx                         | 480  | 待审核的素材        | 0-103-7-48  | 1      | 10 19 2012 \\\\?a02:43PM     | 1          || 49  | 7        | /ScEbook_Admin/Data/bechecked.aspx                       | 450  | 审核已通过的素材      | 0-103-7-49  | 1      | 10 19 2012 \\\\?a02:45PM     | 1          || 5   | 1        | /ScEbook_Admin/EbookSort/make.aspx                       | 960  | E书排行          | 0-1-5       | 1      | 10 16 2012 \\\\?a05:15PM     | 1       || 50  | 7        | /ScEbook_Admin/Data/checknopass.aspx                     | 440  | 审核未通过的素材      | 0-103-7-50  | 1      | 10 19 2012 \\\\?a02:45PM     | 1          || 51  | 7        | /ScEbook_Admin/Data/rejectReason.aspx                    | 430  | 审核回复设置        | 0-103-7-51  | 1      | 10 19 2012 \\\\?a02:45PM     | 1          || 52  | 7        | /ScEbook_Admin/Data/mydata.aspx                          | 410  | 我发布的素材        | 0-103-7-52  | 1      | 10 19 2012 \\\\?a02:46PM     | 1          || 53  | 7        | /ScEbook_Admin/Data/garbage.aspx                         | 400  | 素材回收站         | 0-103-7-53  | 1      | 10 19 2012 \\\\?a02:47PM     | 1         || 54  | 8        | /ScEbook_Admin/DataSort/upload.aspx                      | 500  | 上传排行          | 0-103-8-54  | 1      | 10 19 2012 \\\\?a02:47PM     | 1        || 55  | 8        | /ScEbook_Admin/DataSort/create.aspx                      | 490  | 创意排行          | 0-103-8-55  | 1      | 10 19 2012 \\\\?a02:47PM     | 1        || 56  | 8        | /ScEbook_Admin/DataSort/favorite.aspx                    | 480  | 收藏排行          | 0-103-8-56  | 1      | 10 19 2012 \\\\?a02:48PM     | 1        || 57  | 8        | /ScEbook_Admin/DataSort/download.aspx                    | 470  | 下载排行          | 0-103-8-57  | 1      | 10 19 2012 \\\\?a02:48PM     | 1        || 58  | 9        | /ScEbook_Admin/Question/all.aspx                         | 1000 | 所有咨询列表        | 0-9-58      | 1      | 10 19 2012 \\\\?a02:51PM     | 1          || 59  | 9        | /ScEbook_Admin/Question/memberAnswer.aspx                | 900  | 会员回应的咨询       | 0-9-59      | 1      | 10 19 2012 \\\\?a02:52PM     |1          || 6   | 1        | /ScEbook_Admin/                                          | 950  | E书制作          | 0-1-6       | 1      | 10 16 2012 \\\\?a05:19PM     | 0       || 60  | 9        | /ScEbook_Admin/Question/scAnswer.aspx                    | 800  | 圣才回应的咨询       | 0-9-60      | 1      | 10 19 2012 \\\\?a02:53PM     |1          || 61  | 9        | /ScEbook_Admin/Question/experience.aspx                  | 600  | 经验分享          | 0-9-61      | 1      | 10 19 2012 \\\\?a02:53PM     | 1        || 62  | 9        | /ScEbook_Admin/Question/noAnswer.aspx                    | 600  | 未回应的咨询        | 0-9-62      | 1      | 10 19 2012 \\\\?a02:55PM     | 1          || 63  | 10       | /ScEbook_Admin/News/                                     | 1000 | 圣才快讯          | 0-10-63     | 1      | 10 19 2012 \\\\?a03:16PM     | 1        || 66  | 10       | /ScEbook_Admin/News/making.aspx                          | 850  | 正在制作          | 0-10-66     | 1      | 10 19 2012 \\\\?a03:17PM     | 1        || 67  | 11       | /ScEbook_Admin/Advertisement/                            | 1000 | 网站广告          | 0-11-67     | 1      | 10 19 2012 \\\\?a03:18PM     | 1        || 68  | 11       | /ScEbook_Admin/EbookAdvertisement/                       | 900  | E书广告          | 0-11-68     | 1      | 10 19 2012 \\\\?a03:18PM     | 1       || 69  | 12       | /ScEbook_Admin/Member/                                   | 1000 | 注册会员列表        | 0-12-69     | 1      | 10 19 2012 \\\\?a03:19PM     | 1          || 7   | 103      | /ScEbook_Admin/                                          | 940  | 素材审核          | 0-103-7     | 1      | 10 16 2012 \\\\?a05:24PM     | 1        || 73  | 12       | /ScEbook_Admin/Member/order.aspx                         | 950  | 会员订单管理        | 0-12-73     | 1      | 10 19 2012 \\\\?a03:20PM     | 1          || 76  | 13       | /ScEbook_Admin/Score/                                    | 1000 | 积分规则设置        | 0-13-76     | 1      | 10 19 2012 \\\\?a03:22PM     | 1          || 77  | 13       | /ScEbook_Admin/ScoreSearch/                              | 900  | 会员积分查询        | 0-13-77     | 1      | 10 19 2012 \\\\?a03:22PM     | 1          || 78  | 13       | /ScEbook_Admin/ScoreExchange/                            | 800  | 会员积分兑换        | 0-13-78     | 1      | 10 19 2012 \\\\?a03:23PM     | 1          || 79  | 14       | /ScEbook_Admin/Finance/income.aspx                       | 1000 | 收入查询          | 0-14-79     | 1      | 10 19 2012 \\\\?a04:27PM     | 1        || 8   | 103      | /ScEbook_Admin/                                          | 930  | 素材排行          | 0-103-8     | 1      | 10 16 2012 \\\\?a05:24PM     | 1        || 83  | 15       | /ScEbook_Admin/Statistics/ebook.aspx                     | 1000 | E书统计          | 0-15-83     | 1      | 10 19 2012 \\\\?a04:29PM     | 1       || 85  | 15       | /ScEbook_Admin/Statistics/evaluate.aspx                  | 800  | 评价统计          | 0-15-85     | 1      | 10 19 2012 \\\\?a04:30PM     | 1        || 88  | 15       | /ScEbook_Admin/Statistics/member.aspx                    | 770  | 会员统计          | 0-15-88     | 1      | 10 19 2012 \\\\?a04:31PM     | 1        || 89  | 15       | /ScEbook_Admin/Statistics/recharge.aspx                  | 760  | 收入统计          | 0-15-89     | 1      | 10 19 2012 \\\\?a04:32PM     | 1        || 90  | 15       | /ScEbook_Admin/Statistics/consume.aspx                   | 750  | 消费统计          | 0-15-90     | 1      | 10 19 2012 \\\\?a04:32PM     | 1        || 91  | 15       | /ScEbook_Admin/Statistics/withdraw.aspx                  | 720  | 分成统计          | 0-15-91     | 1      | 10 19 2012 \\\\?a04:32PM     | 1        || 92  | 17       | /ScEbook_Admin/Tree/                                     | 10   | 前台菜单          | 0-17-92     | 1      | 10 30 2012 10:07AM         | 1        || 95  | 17       | /ScEbook_Admin/Word/                                     | 550  | 敏感词管理         | 0-17-95     | 1      | 11 25 2012 \\\\?a01:53PM     | 1         || 98  | 97       | /ScEbook_Admin/EbookDownLoad/                            | 1000 | E书下载设置        | 0-1-97-98   | 1      | 12 \\\\?a03 2012 10:01AM     | 1         || 99  | 1        | /ScEbook_Admin/Ebook.aspx                                | 920  | E书密码          | 0-1-99      | 1      | 12 \\\\?a03 2012 10:41AM     | 1       |+-----+----------+----------------------------------------------------------+------+---------------+-------------+--------+----------------------------+------------+\n   漏洞证明：  已证明！   修复方案：  弱密码修改;权限认证！   版权声明：转载请注明来源 harbour_bin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-06-02 15:40 厂商回复： 给你最高的rank值 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-02 14:25 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  万一火了呢，小学生前来凑热闹    \n     2015-06-02 14:57 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:47        | 向TOP200进军！)\t\t \n  本来想交7个弱密码和上传相关的漏洞的,厂商已经修改了,就算了.有意识了,挺好的！是不是我早上访问的次数太多了,怕影响你们家数据,就没删后台浏览记录:-)     \n     2015-06-02 15:15 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  @harbour_bin 不错 你很有遣徒    \n     2015-06-02 15:22 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:47        | 向TOP200进军！)\t\t \n  @牛 小 帅 都不容易,不至于    \n     2015-06-02 15:24 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  @harbour_bin 怎么我还是路人    \n     2015-06-02 16:36 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:47        | 向TOP200进军！)\t\t \n  虽然wooyun最后给我的只有4rank, 感觉厂商好可爱    \n     2015-06-02 16:44 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  5分之1    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}