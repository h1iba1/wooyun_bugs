{"id": 38198, "wybug_id": "wooyun-2015-0106300", "wybug_title": "海尔某站两处配置不当已入内网", "wybug_corp": "海尔集团", "wybug_author": "fuckadmin", "wybug_date": "2015-04-07 06:40", "wybug_open_date": "2015-05-22 13:18", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-22：\t细节向公众公开  简要描述： 有人说过海尔产品链太长，自然问题就多了。 详细说明：  1.第一处\n\n接口存在咯，就getshell~~\n\n2.第二处http://jiaju.haier.net/haier/sys/Login_dologin.action没啥说的，之前有人提过，但还是没修复~~\n\n3.漫游内网数据库配置\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><!-- ===================================================================== --><!--                                                                       --><!--  JBoss Server Configuration                                           --><!--                                                                       --><!-- ===================================================================== --><!-- $Id: mssql-ds.xml 63175 2007-05-21 16:26:06Z rrajesh $ -->  <!-- ======================================================================-->  <!-- New ConnectionManager setup for Microsoft SQL Server 2005  driver     -->  <!-- Further information about the Microsoft JDBC Driver version 1.1      -->  <!-- can be found here:                                                   -->  <!-- http://msdn2.microsoft.com/en-us/library/aa496082.aspx               -->    <!-- ===================================================================== --><datasources>  <local-tx-datasource>    <jndi-name>MSSQLDS</jndi-name>    <connection-url>jdbc:sqlserver://10.135.106.147;databaseName=EBHaier</connection-url>    <driver-class>com.microsoft.sqlserver.jdbc.SQLServerDriver</driver-class>      <user-name>sa</user-name>    <password>Haier123#</password>    <min-pool-size>50</min-pool-size>    <max-pool-size>500</max-pool-size>      <blocking-imeout-millis>30000</blocking-imeout-millis>      <idel-timeout-minutes>1</idel-timeout-minutes>      <exception-sorter-class-name>org.jboss.resource.adapter.jdbc.vendor.SQLExceptionSorter</exception-sorter-class-name>      <metadate>         <type-mapping>MS SQLSERVER2008</type-mapping>      </metadate>  </local-tx-datasource>  <local-tx-datasource>    <jndi-name>MSSQLDS_Test</jndi-name>    <connection-url>jdbc:sqlserver://10.135.106.147;databaseName=20141117EBHaier</connection-url>    <driver-class>com.microsoft.sqlserver.jdbc.SQLServerDriver</driver-class>      <user-name>sa</user-name>    <password>Haier123#</password>    <min-pool-size>50</min-pool-size>    <max-pool-size>500</max-pool-size>      <blocking-imeout-millis>30000</blocking-imeout-millis>      <idel-timeout-minutes>1</idel-timeout-minutes>      <exception-sorter-class-name>org.jboss.resource.adapter.jdbc.vendor.SQLExceptionSorter</exception-sorter-class-name>      <metadate>         <type-mapping>MS SQLSERVER2008</type-mapping>      </metadate>  </local-tx-datasource></datasources>\n\n\n   漏洞证明：  1.第一处\n\n接口存在咯，就getshell~~\n\n2.第二处http://jiaju.haier.net/haier/sys/Login_dologin.action没啥说的，之前有人提过，但还是没修复~~\n\n3.漫游内网数据库配置\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><!-- ===================================================================== --><!--                                                                       --><!--  JBoss Server Configuration                                           --><!--                                                                       --><!-- ===================================================================== --><!-- $Id: mssql-ds.xml 63175 2007-05-21 16:26:06Z rrajesh $ -->  <!-- ======================================================================-->  <!-- New ConnectionManager setup for Microsoft SQL Server 2005  driver     -->  <!-- Further information about the Microsoft JDBC Driver version 1.1      -->  <!-- can be found here:                                                   -->  <!-- http://msdn2.microsoft.com/en-us/library/aa496082.aspx               -->    <!-- ===================================================================== --><datasources>  <local-tx-datasource>    <jndi-name>MSSQLDS</jndi-name>    <connection-url>jdbc:sqlserver://10.135.106.147;databaseName=EBHaier</connection-url>    <driver-class>com.microsoft.sqlserver.jdbc.SQLServerDriver</driver-class>      <user-name>sa</user-name>    <password>Haier123#</password>    <min-pool-size>50</min-pool-size>    <max-pool-size>500</max-pool-size>      <blocking-imeout-millis>30000</blocking-imeout-millis>      <idel-timeout-minutes>1</idel-timeout-minutes>      <exception-sorter-class-name>org.jboss.resource.adapter.jdbc.vendor.SQLExceptionSorter</exception-sorter-class-name>      <metadate>         <type-mapping>MS SQLSERVER2008</type-mapping>      </metadate>  </local-tx-datasource>  <local-tx-datasource>    <jndi-name>MSSQLDS_Test</jndi-name>    <connection-url>jdbc:sqlserver://10.135.106.147;databaseName=20141117EBHaier</connection-url>    <driver-class>com.microsoft.sqlserver.jdbc.SQLServerDriver</driver-class>      <user-name>sa</user-name>    <password>Haier123#</password>    <min-pool-size>50</min-pool-size>    <max-pool-size>500</max-pool-size>      <blocking-imeout-millis>30000</blocking-imeout-millis>      <idel-timeout-minutes>1</idel-timeout-minutes>      <exception-sorter-class-name>org.jboss.resource.adapter.jdbc.vendor.SQLExceptionSorter</exception-sorter-class-name>      <metadate>         <type-mapping>MS SQLSERVER2008</type-mapping>      </metadate>  </local-tx-datasource></datasources>\n\n\n   修复方案：  1.删除接口2.修复漏洞   版权声明：转载请注明来源 fuckadmin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-04-07 13:16 厂商回复： 谢乌云平台白帽子的测试与提醒，我方已安排人员进行处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-07 17:19 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  为什么我提交的就不确认    \n     2015-05-22 14:27 |    \t\t糖剩七颗 \t\t\t( 普通白帽子  |\t\t\t        Rank:430 漏洞数:61        | 天涯何处无屌丝)\t\t \n  洞主工具地址能发一下吗    \n     2015-05-22 16:48 |    \t\tSophone \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 屌丝一枚 共同学习)\t\t \n  求JBOSS工具    \n     2015-05-22 17:05 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  小厂商，14=2  ?    \n     2015-05-22 21:39 |    \t\tfuckadmin \t\t\t( 普通白帽子  |\t\t\t        Rank:476 漏洞数:72        | 千里之堤溃于蚁穴)\t\t \n  @刺刺 多谢乌云，幸好走的是大厂商。    \n     2015-05-22 21:40 |    \t\tfuckadmin \t\t\t( 普通白帽子  |\t\t\t        Rank:476 漏洞数:72        | 千里之堤溃于蚁穴)\t\t \n  @Sophone，@糖剩七颗 在drops找下园长的文章，你会有所发现的。    \n     2015-05-22 22:44 |    \t\t糖剩七颗 \t\t\t( 普通白帽子  |\t\t\t        Rank:430 漏洞数:61        | 天涯何处无屌丝)\t\t \n  @fuckadmin 已经找到了谢谢洞主    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}