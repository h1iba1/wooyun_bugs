{"id": 65947, "wybug_id": "wooyun-2015-0137386", "wybug_title": "中国联通某站基于SQL时间盲注+上万用户宽带帐号泄漏（DBA权限+18库）", "wybug_corp": "中国联通", "wybug_author": "0x 80", "wybug_date": "2015-08-29 15:37", "wybug_open_date": "2015-10-15 17:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向公众公开  简要描述： 中国联通某站基于SQL时间盲注+上万用户宽带帐号泄漏（DBA权限+18库） 详细说明：  http://iposs.sdinfo.net/ldims/szxAssess/szxAssessAction!queryPon.action?city_id=08000104&successFlag=0&statsDate=2015-04-01&endDate=2015-04-30\n\n可以看到endDate参数，是从2015-04-01到2015-04-30查询在，那么我们可以在源代码中看到\n<thead>\t<tr>\t\t<td class=\"title_1\" colspan=\"13\">\t\t\t<div align=\"right\">\t\t\t\t<a href=\"${request.contextPath}/szxAssess/szxAssessAction!exportPonSuc.action?city_id=08000104&successFlag=0&statsDate=2015-04-01&endDate=2015-04-30\">\t\t\t\t<b>导出工单为excel</b></a>\t\t\t</div>\t\t</td>\t</tr>\n我们来对ID进行修改和对endDate参数修改日期提前4个月http://iposs.sdinfo.net/ldims/szxAssess/szxAssessAction!queryPon.action?city_id=08000106&successFlag=0&statsDate=2015-01-01&endDate=2015-05-05\n\n\n宁阳局 \t08091150101010105 \t15-1-1 15:40:21.000 \t053800374022 \t10.212.9.46 \t1 \t0 \t4 \t1 \t\tTA00053493 \t\t处理工单j1420098021411430171911978(08091150101010105)时[EPON注册ONU(HGU)]=device operation failed ErrorCode: 2689018273;宁阳局 \t08091150101011182 \t15-1-1 16:35:16.000 \t053800751178 \t10.212.9.4 \t1 \t0 \t7 \t2 \t10.127.1.176 \tTA00053643 \t\t处理工单j14201013163586612061930315(08091150101011182)时[注册ONU]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150103005104 \t15-1-3 12:36:44.000 \tny091028 \t10.212.9.5 \t1 \t0 \t6 \t6 \t10.127.130.147 \tTA00055866 \t\t处理工单j14202598047686841234153920(08091150103005104)时[注册ONU]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150103005485 \t15-1-3 13:19:58.000 \t053800780701 \t10.212.9.32 \t1 \t0 \t3 \t3 \t\t\tTA00055889 \t处理工单j14202623993320971135142614(08091150103005485)时[GPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150108015893 \t15-1-9 9:13:32.000 \t053800786296 \t10.212.9.7 \t1 \t0 \t4 \t0 \t\tTA00066933 \t\t处理工单j14207660129905471284920127(08091150108015893)时[EPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150109000533 \t15-1-9 9:16:56.000 \tta15029097 \t10.212.9.15 \t1 \t0 \t18 \t3 \t10.127.41.186 \t\tTA00067187 \t处理工单j1420766216422762449027549(08091150109000533)时[GPON注册ONU]=device operation failed ErrorCode: 2689018273;宁阳局 \t08091150109007180 \t15-1-9 11:42:22.000 \tta00011646 \t10.212.9.5 \t1 \t0 \t3 \t2 \t10.127.128.220 \tTA00068236 \t\t处理工单j14207749425835761556473041(08091150109007180)时[注册ONU]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150109009002 \t15-1-9 13:38:58.000 \t053800607846 \t10.212.9.32 \t1 \t0 \t3 \t7 \t10.128.0.5 \t\tTA00068401 \t处理工单j1420781938190439410435405(08091150109009002)时[GPON注册ONU]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150110013956 \t15-1-10 15:53:44.000 \t053800568918 \t10.212.9.15 \t1 \t0 \t18 \t1 \t10.127.36.234 \t\tTA00069861 \t处理工单j1420946988716361845468786(08091150110013956)时[GPON注册ONU]=resource is already exist ErrorCode: 1613561879;宁阳局 \t08091150111002596 \t15-1-11 11:34:21.000 \t053800615127 \t10.212.9.36 \t1 \t0 \t4 \t6 \t\t\tTA00070421 \t处理工单j14209472612593761166090011(08091150111002596)时[GPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150111007094 \t15-1-11 13:33:05.000 \t053800743045 \t10.212.9.36 \t1 \t0 \t4 \t6 \t\t\tTA00070867 \t处理工单j1420954385029862986789156(08091150111007094)时[GPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150111007248 \t15-1-11 13:37:50.000 \tta15034168 \t10.212.9.36 \t1 \t0 \t4 \t7 \t\t\tTA00070877 \t处理工单j1420954670511013676861807(08091150111007248)时[GPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150111010617 \t15-1-11 15:18:46.000 \t13082778902@e \t10.212.9.36 \t1 \t0 \t4 \t7 \t\t\tTA00071184 \t处理工单j14209607266395652078506099(08091150111010617)时[GPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150111016707 \t15-1-12 10:45:02.000 \t053800780537 \t10.212.9.32 \t1 \t0 \t4 \t0 \t\t\tTA00071809 \t处理工单j14210307021999071930091560(08091150111016707)时[GPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150112016448 \t15-1-12 16:05:59.000 \t053800593406 \t10.212.9.33 \t1 \t0 \t1 \t4 \t\tTA00072886 \t\t处理工单j14210499594985612035854299(08091150112016448)时[EPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150113015959 \t15-1-13 16:04:24.000 \t053800625179 \t10.212.9.15 \t1 \t0 \t18 \t5 \t10.127.42.240 \t\tTA00073960 \t处理工单j14211550030544762133428768(08091150113015959)时[GPON注册ONU]=resource is already exist ErrorCode: 1613561879;宁阳局 \t08091150114008900 \t15-1-14 13:57:23.000 \t053800457376 \t10.212.9.8 \t1 \t0 \t6 \t6 \t\t\tTA00075665 \t处理工单j14212174611031632000530746(08091150114008900)时[GPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150114011158 \t15-1-14 15:04:32.000 \t053800483318 \t10.212.9.15 \t1 \t0 \t18 \t5 \t10.127.43.50 \t\tTA00076002 \t处理工单j1421223245508079449198458(08091150114011158)时[GPON注册ONU]=device operation failed ErrorCode: 2689018273;宁阳局 \t08091150114014231 \t15-1-14 16:31:33.000 \t053800787037 \t10.212.9.23 \t1 \t0 \t2 \t5 \t\t\tTA00076514 \t处理工单j1421224293366977633202947(08091150114014231)时[GPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150114015300 \t15-1-14 17:04:13.000 \tta000012757 \t10.212.9.9 \t1 \t0 \t3 \t0 \t10.215.46.153 \tTA00076666 \t\t处理工单j1421226253408777147533449(08091150114015300)时[注册ONU]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150115001518 \t15-1-15 8:54:17.000 \t053800617685 \t10.212.9.15 \t1 \t0 \t18 \t5 \t10.127.34.194 \t\tTA00076981 \t处理工单j14213124134106991917305981(08091150115001518)时[GPON注册ONU]=resource conflict(ONUID) ErrorCode: 2688880284;宁阳局 \t08091150116011310 \t15-1-16 14:50:44.000 \tta10082928 \t10.212.9.15 \t1 \t0 \t18 \t7 \t10.127.43.237 \t\tTA00079216 \t处理工单j1421396443502977570240349(08091150116011310)时[GPON注册ONU]=resource is already exist ErrorCode: 1613561879;宁阳局 \t08091150118005695 \t15-1-18 11:31:38.000 \t053800780701 \t10.212.9.32 \t1 \t0 \t3 \t7 \t\t\tTA00081788 \t处理工单j14215518983093952139984211(08091150118005695)时[GPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150119003112 \t15-1-19 9:46:59.000 \tta10018818 \t10.212.9.38 \t1 \t0 \t5 \t3 \t\tTA00082712 \t\t处理工单j14216320193528541119108354(08091150119003112)时[EPON注册ONU(HGU)]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150120001405 \t15-1-20 9:03:46.000 \tta11086998 \t10.212.9.8 \t1 \t0 \t14 \t5 \t\t\tTA00084811 \t处理工单j1421716623971305702407452(08091150120001405)时[GPON注册ONU(HGU)]=resource is already exist ErrorCode: 1613561879;宁阳局 \t08091150121001116 \t15-1-21 8:50:53.000 \t053800788667 \t10.212.9.12 \t1 \t0 \t2 \t3 \t10.128.192.53 \tTA00086006 \t\t处理工单j14218014536928561756996798(08091150121001116)时[注册ONU]=resource conflict(ONUNO) ErrorCode: 2688880284;宁阳局 \t08091150121006719 \t15-1-21 12:44:41.000 \t053800791411 \t10.212.9.7 \t1 \t0 \t14 \t0 \t\tTA00086326 \t\t处理工单j142181548196623069929843(08091150121006719)时[EPON注册ONU(HGU)]=device operation failed ErrorCode: 2689018273;宁阳局 \t08091150122010408 \t15-1-22 14:14:39.000 \t053800790147 \t10.212.9.61 \t1 \t0 \t2 \t4 \t10.151.224.22 \tTA00088721 \t\t处理工单j14219076222286771588122949(08091150122010408)时[注册ONU]=resource does not exist ErrorCode: 2686058552;宁阳局 \t08091150122010575 \t15-1-22 14:20:55.000 \t053800790132 \t10.212.9.61 \t1 \t0 \t2 \t3 \t\tTA00088752 \t\t处理工单j1421907655832382495820703(08091150122010575)时[EPON注册ONU(HGU)]=resource does not exist ErrorCode: 2686058552;宁阳局 \t08091150122011985 \t15-1-22 15:11:40.000 \t053800771701 \t10.212.9.15 \t1 \t0 \t11 \t2 \t10.127.45.93 \t\tTA00088934 \t处理工单j1421975573246999663370845(08091150122011985)时接收数据超时。\n\n\nhttp://iposs.sdinfo.net/ldims/szxAssess/szxAssessAction!queryLanAdsl.action?city_id=10&jr_type=3&successFlag=0&statsDate=2013-04-01&endDate=2015-04-06\n\n注入SQL：基于时间盲注http://iposs.sdinfo.net/ldims/szxAssess/szxAssessAction!queryLanAdsl.action?city_id=08&jr_type=4&successFlag=0&statsDate=2012-11-01&endDate=2012-11-23endDate参数与city_id参数分别存在注入\n\nDBA权限\n\n\n\n\n\n   漏洞证明：  \nhttp://iposs.sdinfo.net/ldims/szxAssess/szxAssessAction!queryLanAdsl.action?city_id=08&jr_type=4&successFlag=0&statsDate=2012-11-01&endDate=2012-11-23\n\n\n   修复方案：     版权声明：转载请注明来源 0x 80@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-08-31 17:57 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT向中国联通集团公司通报，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-27 15:51 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:407 漏洞数:94        | 什么狗屁爱，生活已乱套！人的一生中，...)\t\t \n  时间盲注 学习    \n     2015-08-28 08:47 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:567 漏洞数:108        | 低调求发展)\t\t \n  高产！    \n     2015-08-31 18:16 |    \t\t-路人甲- \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:4        | 你的是我的,是我的还是我的，拿走也没用。)\t\t \n  还好不是联通宽带。吓死我了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}