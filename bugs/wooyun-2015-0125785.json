{"id": 70238, "wybug_id": "wooyun-2015-0125785", "wybug_title": "Libsys图书馆管理系统某处敏感信息泄露", "wybug_corp": "libsys.com.cn", "wybug_author": "i3esn0w", "wybug_date": "2015-07-10 11:41", "wybug_open_date": "2015-10-08 14:14", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["应用敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向公众公开  简要描述： RT 详细说明：  我觉得这里应该是故意留下的，或许算是个后门吧漏洞文件位于：/include/config.properties这个文件会记录数据库的链接信息\nhost=127.0.0.1port=1521sid=orcluser=bGlic3lzpassword=bGlic3lzindexDir=c:/hwopac/index/interval=12\n这是一个默认的，由于这个页面apache会当作是txt来解析，所以内容全部泄露来看看这个文件到底是干嘛的这个文件是在admin/cfg_database.php产生的\nfunction write_for_gsearch( $host, $sid, $port, $user, $pwd, $fulltextPath ){    $fhandle = fopen( \"../include/config.properties\", \"wb\" );    if ( $fhandle )    {        $done = fwrite( $fhandle, \"host=\".$host.\"\\r\\n\" );        $done = fwrite( $fhandle, \"port=\".$port.\"\\r\\n\" );        $done = fwrite( $fhandle, \"sid=\".$sid.\"\\r\\n\" );        $done = fwrite( $fhandle, \"user=\".base64_encode( $user ).\"\\r\\n\" );        $done = fwrite( $fhandle, \"password=\".base64_encode( $pwd ).\"\\r\\n\" );        $done = fwrite( $fhandle, \"indexDir={$fulltextPath}\\r\\n\" );        $done = fwrite( $fhandle, \"interval=12\" );        if ( $done )        {            fclose( $fhandle );        }    }}\n这里就是写入的函数\n$user = $_REQUEST['user'];    $password = encrypt( $_REQUEST['password'], $key );    $host = encrypt( $_REQUEST['host'], $key );    $sid = encrypt( $_REQUEST['sid'], $key );    $port = encrypt( $_REQUEST['port'], $key );    $fulltextPath = $_REQUEST['fulltext_path'];    write_for_gsearch( $_REQUEST['host'], $_REQUEST['sid'], $_REQUEST['port'], $user, $_REQUEST['password'], $fulltextPath );\n然后这里是调用，文件最后还有一个解密，我觉得这里写入的应该是加密的数据，但是由于程序猿疏忽（故意）写错了，然后导致直接数据写入进去，虽然在函数内部有一个base64加密，但是那个加解密方法都是已知的，等同于没有测试案例+>vul:http://www.njjnlib.cn:8080/include/config.properties+>vul:http://libsys.jaaslib.ac.cn:8080/include/config.properties+>vul:http://202.201.163.2:8080/include/config.properties+>vul:http://opac.lh2lib.cn/include/config.properties+>vul:http://opac.pklib.cn/include/config.properties   漏洞证明：  插入不了图片啊+>vul:http://www.njjnlib.cn:8080/include/config.properties+>vul:http://libsys.jaaslib.ac.cn:8080/include/config.properties+>vul:http://202.201.163.2:8080/include/config.properties+>vul:http://opac.lh2lib.cn/include/config.properties+>vul:http://opac.pklib.cn/include/config.properties   修复方案：  随便修修   版权声明：转载请注明来源 i3esn0w@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-07-10 14:13 厂商回复： 多谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}