{"id": 7028, "wybug_id": "wooyun-2013-039011", "wybug_title": "小米锁屏设计缺陷，可利用后绕过手机安全锁，任意操作用户手机", "wybug_corp": "小米科技", "wybug_author": "px1624", "wybug_date": "2013-10-07 13:07", "wybug_open_date": "2014-01-02 13:07", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "小米"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-08：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-12-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-02：\t细节向公众公开  简要描述： 这个基本可以在任意情况下，去绕过手机安全锁玩别人的手机了。其实我的很多小米手机的漏洞，都是自己在使用过程中，不经意发现的。有么有小米3手机？米3F码也可以啊！ 详细说明：  今天在设置了密码锁的时候，发现在锁屏页面，不要去上下左右滑动，而是连续按两下屏幕锁屏的中心点。重复2-3次，就会发现莫名其妙的启动了手机里面的音乐程序（这个是miui自带音乐播放器的界面），然后在按两下锁屏键，就会发现一个似曾相识的界面，没错，就是第三方音乐播放器的锁屏页面，好奇葩的一个设计。（这里需要注意的是，在启动之前是没有任何后台程序在运行的！）然后，后面的事情我就不用在多说了，就可以任意操作用户手机了，方法详见  WooYun: 小米MIUI安全锁形同虚设（可以绕过后任意操作手机）   漏洞证明：  漏洞证明视频，包括数字密码锁和图案密码锁状态下的演示。（这里视频只是证明可以在锁屏状态启动第三方音乐播放器，至于后续的利用第三方音乐播放器绕过手机安全锁的视频，请看这个帖子 WooYun: 小米MIUI安全锁形同虚设（可以绕过后任意操作手机） ）：\n密码：wooyun优酷视频地址：http://v.youku.com/v_show/id_XNjE4MDY4MjMy.html\n危害：比起之前的那个漏洞 WooYun: 小米MIUI安全锁形同虚设（可以绕过后任意操作手机） 更加严重！因为之前的漏洞是需要用户后台有在运行第三方音乐播放器或者第三方锁屏程序的的。而这个漏洞由于小米的这个比较奇葩的设计，会直接启动第三方音乐播放器导致的，从而可以配合之前的那个漏洞，直接在任意情况下操作用户的手机，我去，好牛逼额！通杀密码安全锁和图案安全锁！   修复方案：  修补：还是做一下权限的判定设计问题吧，将第三方软件的高权限请求拒之门外吧！最后再喊一次，有么有小米3手机？米3F码也可以啊！   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-01-02 13:07 厂商回复： 和之前漏洞相同。感谢关注。：） 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-07 13:10 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-10-07 13:32 |    \t\t0x2b \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:12        )\t\t \n  忽略的节奏    \n     2013-10-07 13:34 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  目测危害低+5rank，回复是“内部已经提交漏洞给相关人员。”    \n     2013-10-07 13:47 |    \t\t0x2b \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:12        )\t\t \n  夜观天象： 我们已经通过其他渠道了解到此漏洞，感谢您对小米科技的支持。故忽略    \n     2013-10-07 14:18 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @VIP @0x2b 擦。。    \n     2013-10-07 16:45 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  我们内部测试已经发现到此漏洞，感谢您对小米科技的支持。故忽略     \n     2013-10-07 20:19 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n  @Black Angel  你什么时候又是小米的了！！！    \n     2013-10-07 20:50 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  因为你玩着玩着玩出了太多的漏洞，为了使米3不发生这种情况，你认为我们还会给你f码吗    \n     2013-10-07 21:31 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @廷廷 哪里有黑客哪里就有我    \n     2013-10-07 22:41 |    \t\t乱人心xsser \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 渗透师|结界师|跨站师|安全工程师|系统工程...)\t\t \n  有小米手机的玩不出来，没有小米手机的反而玩出来了，坑爹啊    \n     2013-10-07 23:20 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @乱人心xsser 洞主也是小米用户 表示他是小米1S青春版    \n     2013-10-07 23:52 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @寂寞的瘦子 必须给啊，这样才能有利于检测出小米3的漏洞！    \n     2013-10-07 23:53 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @乱人心xsser 我就是小米手机啊，小米1s 青春版，一天没事干就瞎折腾，然后就发现漏洞了。还别说，我提交这漏洞，你要是去专门去挖，还真不一定能挖出来。。。    \n     2013-10-08 16:27 |    \t\t心伤的黑子 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | \"><img>bbb)\t\t \n  @小米科技 你确认和之前的一样。。。我去，你自己看下帖子啊！@xsser @疯狗 @肉肉 @Finger 你们说一样吗？    \n     2013-10-08 16:55 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @心伤的黑子 你能看到我发的帖子内容？你是新来的管理员吗？    \n     2013-10-08 17:11 |    \t\t杨过 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 飞雪连天射白鹿,笑书神侠倚碧鸳)\t\t \n  小米V5    \n     2013-10-08 22:05 |    \t\t蓝盾科技 \t\t\t( 实习白帽子  |\t\t\t        Rank:90 漏洞数:16        | 蓝盾科技致力于网络安全，信息安全，通信安...)\t\t \n  无影响厂商忽略    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}