{"id": 12798, "wybug_id": "wooyun-2013-020670", "wybug_title": "杭州游趣某漏洞导致全站沦陷，涉及约100W用户以及充值卡业务（已有入侵痕迹！）", "wybug_corp": "杭州游趣网络有限公司", "wybug_author": "3King", "wybug_date": "2013-03-31 10:54", "wybug_open_date": "2013-05-15 10:55", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "数据库密码泄漏", "用户敏感信息泄露", "渗透测试思路", "用户认证信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-15：\t细节向公众公开  简要描述： 前一段时间的某天晚上看了一下A站的一些建站情况，然后就知道了杭州游趣，然后就进站看了看，然后就想测试一下，然后就手一抖，然后。。。。。 = =ACFUN母公司杭州游趣某站漏洞导致全站沦陷，涉及苍生、Z-Online等约100W用户，以及祺趣一卡通等业务。（已有入侵痕迹！） 详细说明：  一般来说主站没有机会渗透，就只能找旁站。然后从度娘那里找到了苍生的游戏站（同服务器）通过baiduhack(= =)找到了一处上传点。地址位于：http://cs.7fun.com/bizhi/要登录后才能上传。。 注册登录后，先上传一个标准PHPShell试试。。提示只能上传图片类型的文件\n\n然后换成标准图片改为PHP格式上传。。竟然上传成功！然后换成PHP图片Shell上传，也上传成功！获取图片地址后，成功连接至菜刀。进去一看，My god! 已经有入侵痕迹！\n\n\n\n然后看了一下，此站与游戏官网、主站在同一服务器！\n\n在主站文件内发现大量敏感数据，包括游戏数据库，帐号库，点卡库等！\n\n帐号库数据量在100万左右！\n\n\n\n点卡库数据量在10万以上！\n\n\n\n   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  ·迅速删除本次报告中提到了所有PHP木马，并进行全服务器PHP木马检查。·在查看过程中，还发现了SVN等其它漏洞，请一并修复。·本次渗透本人绝未脱库，谢绝跨省 - -..·由于已发现入侵痕迹，不排除其他黑客已经脱库，或获取点卡库信息，风险可能较大，请做好后续公关准备。·杭州游趣进乌云来貌似从没发过礼物... 求AC娘给力礼物~~   版权声明：转载请注明来源 3King@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-04-01 23:52 厂商回复： 非常严重，正在和杭州游趣沟通 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-26 08:22 |    \t\t肥羊宅 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:2        | 只是来学习安全知识的……估计抓不出多少漏...)\t\t \n  看到了不得了的东西……A站记得自称是变态级安全措施……望向A站那些页游=。=保持关注    \n     2013-03-30 08:29 |    \t\t核攻击 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:7        | 统治全球，奴役全人类！毁灭任何胆敢阻拦的...)\t\t \n  @肥羊宅 A站的“变态级安全措施”就一笑话。    \n     2013-03-31 00:47 |    \t\tweb天空 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 你猜镇，不告诉你村。)\t\t \n  无影响厂商忽略？我是不是看错了。。。    \n     2013-03-31 01:15 |    \t\t雅柏菲卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:1213 漏洞数:232        | 雙魚座聖鬥士雅柏菲卡)\t\t \n  揉揉眼睛  无影响？？？？?  啊呀 眼睛被揉的好疼    \n     2013-03-31 02:17 |    \t\t银冥币 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:19        | \"/upload/avatar/avatar_251_b.jpg\" />)\t\t \n  新人正在练习如何上传shell。。。(求解怎么找到上传的shell的文件名)    \n     2013-04-01 23:19 |    \t\t杭州游趣网络有限公司(乌云厂商)\t\t \n  ACFUN正在联系杭州游趣技术，一有消息我们会尽快做出处理    \n     2013-04-01 23:27 |    \t\t杭州游趣网络有限公司(乌云厂商)\t\t \n  ACFUN杭已经和杭州游趣技术取得联系，鉴于此漏洞重要性，我们会及时跟进(话说我也上去看了下，都啥年代了还用AS4    \n     2013-04-02 08:44 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @杭州游趣网络有限公司 靠 你们不是一个公司？    \n     2013-04-02 09:37 |    \t\t杭州游趣网络有限公司(乌云厂商)\t\t \n  @肥羊宅 没有自称过变态级安全措施，只要是系统一定会有漏洞，只是在于漏洞发现和修补得及时与否。    \n     2013-04-05 23:57 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  @杭州游趣网络有限公司 我擦，这个你们两家真不是一起的吗    \n     2013-05-14 12:06 |    \t\tbombless \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 熟悉x86汇编、C语言及系统编程。实战经验较...)\t\t \n  噗……漏洞证明上面的歌词是only my railgun么。    \n     2013-05-14 14:44 |    \t\t3King \t\t\t( 普通白帽子  |\t\t\t        Rank:1129 漏洞数:81        | 【study at HNUST】非常感谢大家的关注~ 大...)\t\t \n  @bombless  ~~    \n     2013-05-15 10:59 |    \t\t无我 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:5        | 我是无我)\t\t \n  @3King 我不相信你不脱库！    \n     2013-05-15 12:42 |    \t\tAofa \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | check it out yo)\t\t \n  @无我 脱完了才提交的，笑而不语    \n     2013-05-15 15:41 |    \t\t3King \t\t\t( 普通白帽子  |\t\t\t        Rank:1129 漏洞数:81        | 【study at HNUST】非常感谢大家的关注~ 大...)\t\t \n  @Aofa @无我  你们执意要黑我  说我脱库 我也没办法    \n     2013-05-15 15:45 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @3King 清者自清吧 没事.....    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}