{"id": 66868, "wybug_id": "wooyun-2015-0143030", "wybug_title": "驴妈妈旅游网逻辑漏洞(恶意刷奖金/兑换劵)", "wybug_corp": "驴妈妈旅游网", "wybug_author": "Xmyth_Xi2oMin9", "wybug_date": "2015-09-23 19:12", "wybug_open_date": "2015-11-08 09:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "认证设计不合理", "搞笑有爱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-08：\t细节向公众公开  简要描述： RT 详细说明：  URL:http://m.lvmama.com/static/zt/3.0.0/1508/guoqing/?from=timeline&isappinstalled=1国庆促销活动（下单抽大奖）：\n1、活动时间：2015.9.9-2015.10.7；2、在2015.9.9-2015.10.7期间订购的旅游产品，用户可凭支付订单号抽奖一次；3、奖金相当于现金，请到客户端【我的-钱包】中查看，可在适用奖金抵扣的产品中使用；4、星巴克券，凭短信收到的券码登陆“到家美食会”官网或APP领取（此券仅限上海地区新用户使用）；5、实物奖品，用户完成游玩的第7个工作日将快递到家；\n问题出现在这：\nGET /activity/index.php?s=L1509/shiyiChoujiang&orderId=24405424[看这里看这里]&v=0.2912047831341624&callback=jQuery17203623770074918866_1443005183879&_=1443006150195 HTTP/1.1Host: m.lvmama.comProxy-Connection: keep-aliveAccept: text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.152 Safari/537.36Referer: http://m.lvmama.com/static/zt/3.0.0/1508/guoqing/?from=timeline&isappinstalled=1Accept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8\n根据要求我们首先去下单，获得一个订单号（24405434），再写一个脚本跑一些获取到大概三万多可以参加抽奖的订单号。\n\n举个栗子：\n244052332440523924405241244052442440524524405246244052482440525124405255244052562440525724405260244052612440526224405263244052652440526824405272244052742440527724405279244052802440528324405288244052902440529124405295244052962440529724405298244053002440530124405302244053072440531024405311244053132440531424405317244053182440532024405321244053222440532424405325244053272440533124405334244053362440533824405339244053402440534224405344244053452440534624405347244053502440535424405355244053572440535824405359244053632440536524405366244053712440537624405380244053822440538624405388\n然后我们就开始刷起来。 ：-）   漏洞证明：  因为是抽奖，多数都5元现金和星巴克兑换券。而我这里只是简单的脚本跑了一下就跑出三万多可以参与抽奖的！而我用别的账号测试了领取了85块了，然而星巴克劵多的吓人= =！\n\n\n\n我在想我会不会中一个马尔代夫或者1000元奖金呢。   修复方案：  加个验证码 核实订单号是否是参加抽奖的用户的订单   版权声明：转载请注明来源 Xmyth_Xi2oMin9@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-09-24 09:18 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-23 19:14 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  都很有想法：P    \n     2015-09-24 09:00 |    \t\tmtfly \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:10        | 啥都不会)\t\t \n  你抓住一家就不放了么？    \n     2015-09-24 09:21 |    \t\tXmyth_Xi2oMin9 \t\t\t( 普通白帽子  |\t\t\t        Rank:385 漏洞数:56        | 人来人往 喜欢却只能欣赏 再见了各位)\t\t \n  @mtfly 厂商有爱     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}