{"id": 17295, "wybug_id": "wooyun-2012-010000", "wybug_title": "360Shop网店系统多个漏洞", "wybug_corp": "杭州启博科技", "wybug_author": "an1k3r", "wybug_date": "2012-08-15 16:08", "wybug_open_date": "2012-09-29 16:09", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数字类型注射", "文件包含漏洞", "配置不当", "任意文件读取利用", "源码审核", "敏感端口对外访问", "默认口令"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-10-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-10-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-29：\t细节向公众公开  简要描述： 360Shop网店系统多个漏洞，部分漏洞可getshell。 详细说明：  官网：http://www.360shop.com.cn测试基于360Shop最新版本V3.0使用这套系统的有独立的站点，如http://www.iplaybox.nethttp://www.lpxxw.net也有托管给官方的网店,这个比较多，可能有几千个，如：http://09pf.taodiantong.comhttp://520mpai.taodiantong.com1. SQL注入测试地址：http://www.iplaybox.net/?do=display&mod=goods&id=10839Mysql错显Integer型注入，POST方法。\n\n后台地址：http://www.iplaybox.net/admin/login.php\n\n漏洞参数为xajaxargs\nfunction initProcessRequests()    {        $xajaxRequest = array();        $xajaxRequest['xajaxr'] = @$_GET['xajaxr'];        $xajaxRequest['xajax'] = @$_GET['xajax'];        // reset RequestMode        if(isset($_GET['xajax']))        {            $_GET['xajax'] = null;            unset($_GET['xajax']);        }        // get the upload file local path        foreach(array_keys($_FILES) as $name)        {            if(isset($_GET[$name]) && !isset($_POST[$name]))            {                $_POST[$name] = $this->_decodeUTF8Data($_GET[$name]);            }        }        $xajaxargs = array(get_original_data($_POST));        $xajaxRequest['xajaxargs'] = $xajaxargs;        $_POST = $xajaxRequest;}\n2. 本地文件包含。http://www.iplaybox.net/?do=display&id=3653&mod=../../../../../../../../../../etc/passwd%00.jpg\n\n普通用户没有上传点，后台上传的图片也都到了官方提供的服务器上了，漏洞比较鸡肋。3. Rsync任意文件上传。推测一些网店用的是360Shop官方提供的服务器，使用了同样版本的Linux，PHP和Nginx。其中部分服务器的Web目录直接Rsync可写，导致可直接上传Shell。\nrsync.exe 360shop/shell.php root@121.52.224.82::lsa/admin\n\n\n上传的shell。\n\n目前网上貌似没有暴出该网店系统的漏洞，且网店和支付宝有接口，有撞库的可能。请cncert通知官方，依情况看是否要发布此漏洞～   漏洞证明：  在详细说明里了。   修复方案：  1. 过滤。2. Rsync设置验证。   版权声明：转载请注明来源 an1k3r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-08-15 17:50 厂商回复： 添加对漏洞的补充说明以及做出评价的理由 最新状态： 2012-08-17：以上问题已修复，感谢an1k3r的贡献！  ", "replys": "漏洞评价：\n评论\n     2012-07-22 15:45 |    \t\twinston \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:7        | nothing)\t\t \n  最近正有客户用到这个系统，过来学习一下！    \n     2012-08-15 17:57 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个漏洞ID好    \n     2012-08-15 18:54 |    \t\t瓜瓜 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:25        )\t\t \n   传说中的第一万个？    \n     2012-09-05 01:33 |    \t\twinston \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:7        | nothing)\t\t \n  在测试中发现几个问题，想求教一下。1：是不是必须得是独立的空间才能出现Rsync的同步问题呢？如果 是一个空间中有很多个域名网站的应该如何操作？2：rsync: failed to connect to 122.224.72.219: Connection timed out (116)rsync error: error in socket IO (code 10) at clientserver.c(122) [sender=3.0.7] 总是出现这个问题，在google上面找了也没有找到解决的办法，请指点一下。谢谢！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}