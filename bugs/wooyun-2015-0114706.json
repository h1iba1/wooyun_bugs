{"id": 22612, "wybug_id": "wooyun-2015-0114706", "wybug_title": "蜜淘网某站存在sql注入漏洞影响300W+用户数据", "wybug_corp": "蜜淘网", "wybug_author": "堂吉诃德", "wybug_date": "2015-05-18 06:30", "wybug_open_date": "2015-07-02 06:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-02：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 内部系统存在sql注入漏洞，从而侵入成功,将数十万订单数据, 数百万手机号，姓名，身份证号码泄露 详细说明：  提交数据的时候可以嵌套js代码,完成后刷新页面能够执行   漏洞证明：  先看了下主站感觉没啥大漏洞，然后扫了下域名得知 beilou.com 是其前生，然后扫描端口Starting Nmap 6.46 ( http://nmap.org ) at 2015-05-17 22:37 CSTNmap scan report for beilou.com (182.92.111.61)Host is up (0.013s latency).Not shown: 978 closed portsPORT     STATE    SERVICE22/tcp   open     ssh80/tcp   open     http135/tcp  filtered msrpc139/tcp  filtered netbios-ssn445/tcp  filtered microsoft-ds593/tcp  filtered http-rpc-epmap901/tcp  filtered samba-swat1068/tcp filtered instl_bootc3128/tcp filtered squid-http4444/tcp filtered krb5245666/tcp open     nrpe5800/tcp filtered vnc-http5900/tcp filtered vnc6129/tcp filtered unknown6667/tcp filtered irc8009/tcp open     ajp138010/tcp open     xmpp8081/tcp open     blackice-icecap8090/tcp open     unknown8100/tcp open     xprint-server8200/tcp open     trivnet19001/tcp open     tor-orportduang~ duang~ 其中8081是gitlab的地址 然后发现8090和8010竟然不需要认证如下所示：\n\n这个促销系统做的还挺不错的\n\niOS设备的推送系统一般这种站，可能就不怎么严密估计有sql注入漏洞，果然就有一个POST /red_packet/list HTTP/1.1Host: monitor.beilou.com:8010Content-Length: 15Accept: application/json, text/javascript, */*; q=0.01Origin: http://monitor.beilou.com:8010X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.90 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://monitor.beilou.com:8010/html/red_packet/index.htmlAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: request_method=GET; _gitlab_session=d14a5da0f1dc414332f62d942b315172; JSESSIONID=8817444C85A594E71289965295F21805condition=12323这个condition就是可以注入的，然后上sqlmap跑一下\n\n跑出了数据库然后在跑一些数据吧 : )database management system users [1]:[*] 'beilouguest'@'%'\n\n\n\n用户表\n\n还有一些订单信息然后根据信息进入了后台。。。-------------好了不继续了，不然要被请喝茶了------   修复方案：  原本很难搞到这里的，只要把外面的内部系统做个权限控制，然后sql注入的bug修改掉即可加强安全意识啊   版权声明：转载请注明来源 堂吉诃德@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-05-18 12:52 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  密淘网最近广告做的挺火啊，怎么这么不注意细节    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}