{"id": 86381, "wybug_id": "wooyun-2016-0186502", "wybug_title": "好利网服务配置不当导致某重要敏感信息泄漏", "wybug_corp": "haolyy.com", "wybug_author": "路人甲", "wybug_date": "2016-03-19 10:07", "wybug_open_date": "2016-05-06 18:25", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-06：\t细节向公众公开  简要描述： 打卡ing 详细说明：  1、git信息泄漏\nhttp://weixin.haolyy.com/.git/config\n\n\n2、日志签名泄漏：\nhttp://vip.haolyy.com/log.txt\n\n\n   漏洞证明：   git泄漏了各种密钥、数据库配置信息等\n<?phpreturn array(    'MAX_MARKS' => '10000',//七夕活动最大体验金数    'ENABLE_VERIFY_CODE' => false, //是否启用图形验证码    'SEND_TYPE' => '4', //短信通道 3建周 4玄武 5艺美//    'RESOURCES_BASE_PATH' => '/', //模版中静态资源base路径    'ENCRYTP_KEY' => 'DRT1YLkwLug9vUpzEbw8l05WdlVTFn3X', //忘记密码用加密钥    'WX_SOURCE_KEY' => 'ART1YLkwLug9vUpzEbw8l05WdlVTFn3B',    'COOKIE_ENCRYPT_KEY' => 'qpa8Jk3lm5dAY7ZS', //cookie 加密密钥    'APP_TRANS_KEY' => 'fjeiowut34djsjd9', //APP交互信息加密密钥    ////    'SMS_PROVIDER' => 1,    'LOG_RECORD' => true,//    'LOG_LEVEL' => 'EMERG,ALERT,CRIT,ERR,WARN,NOTICE,INFO',    'URL_MODEL' => '2', //rewrite 模式//    'VAR_PATHINFO' => null, //为PATH_INFO解析使用 参照ThinkPHP/Lib/Core/Dispatcher.class.php//    'URL_PATHINFO_FETCH' => 'ORIG_PATH_INFO,REDIRECT_PATH_INFO,REDIRECT_URL,REQUEST_URI', //PATH_INFO使用REQUEST_URI解析    'URL_HTML_SUFFIX' => '',    'APP_AUTOLOAD_PATH' => '@.Common,@.Entity', //自动加载自定义类库目录    'SESSION_OPTIONS' => array(        'cache_limiter' => 'nocache', //页面缓存关闭，        'expire' => 86400, //session过期时间24小时    ),     'WEB_DOMAIN' => 'weixin.haolyy.com',  //网站顶级域名    'TEST_WEB_DOMAIN' => 'http://nweixin.haolyy.com',//测试网站顶级域名//表单token配置    'TOKEN_ON' => true,  // 是否开启令牌验证    'TOKEN_NAME' => '__hash__',    // 令牌验证的表单隐藏字段名称    'TOKEN_TYPE' => 'md5',  //令牌哈希验证规则 默认为MD5    'TOKEN_RESET' => true, //令牌验证出错后是否重置令牌 默认为true\n\n<?phpclass AdminxcmAction extends BaseAction {        public function _initialize() {//        parent::_initialize();        C('DB_HOST', 'rds340r7021k0w6w1131.mysql.rds.aliyuncs.com');        C('DB_NAME', 'xcm_pro');        C('DB_USER', 'xcm_v1');        C('DB_PWD', 'xiaocaimi123');        C('token', 'abcd78901234');        C('appID', 'wxe84211424b349cb1');        C('appsecret', '3b96864a1413caf27233cb4608f8700e');    }        public function _empty($name) {        R('Admin/'.$name);    }\n   修复方案：  1、删除屏蔽git2、删除日志3、清理服务器4、修改数据库配置信息5、让乌云给密钥打码   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-03-22 18:25 厂商回复： 感谢提供漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}