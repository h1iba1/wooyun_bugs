{"id": 82501, "wybug_id": "wooyun-2015-0150866", "wybug_title": "中国知网某功能设计逻辑缺陷可获取大量账号信息", "wybug_corp": "中国知网", "wybug_author": "修罗", "wybug_date": "2015-11-02 09:14", "wybug_open_date": "2015-12-21 17:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-21：\t细节向公众公开  简要描述： 中国知网某功能设计逻辑缺陷可获取大量账号信息 详细说明：  厂商：中国知网 (注：提交漏洞时选其它厂商总出错，提示“找不到该厂商”，无奈只好随便选了一个）漏洞地址：http://**.**.**.**/login.aspx漏洞描述：在未登录状态下，直接访问http://**.**.**.**/login.aspx，会出现登录界面，这里虽然看似有图片验证码，但实际上采用的是cookier验证访问，可轻松绕过从而实施各种弱口令的账户暴破，其中还包括有账户余额的账号。截获登录请求如下：\nPOST /login.aspx HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://**.**.**.**/login.aspxCookie: c_m_LinID=LinID=WEEvREcwSlJHSldTTGJhYlJWc3BLV1g3ZEdoVkNzM2Q4NGdoV2JWcURjOWVmTUgvY2dOVTJXOGtWaDZGcmZubFN5TT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!&ot=10/31/2015 15:31:32; SID=020101; ASP.NET_SessionId=veejydvw4k30ut34iq1kysuh; ImageV=LDFTConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 341__VIEWSTATE=vEc5wakjrGHE9NItNLSS82%2FnpDZ%2FghasVzdmmebnnQZDc6Bx%2Bhs30pXa%2BHrTBJff08N9NDmwk%2B09xLN9RN195r3h1RT3h%2BFZCYH%2F44hUYliiiF%2F2kQdsKlQuvpt7bbb34nayabgURlnjDQMulC495Cu85LqthyWxxb%2B9U6nPWt2sL2el25x6%2FyX6kwI%3D&__VIEWSTATEGENERATOR=C2EE9ABB&IsShowFlag=false&UserName=user&UNPWValue=111111&Code=ldft&MainSubmit=%E7%A1%AE+%E5%AE%9A\n可以看到在cookie中有图片验证码“ImageV=LDFT”，我们提交的验证码为“Code=ldft”，由于这里它是采用客户端脚本验证，事实上这两处的内容是否一致都可绕过验证，从而使用用户名和密码字典疯狂暴破大量账户信息。   漏洞证明：  以下为暴破到的密码为123456的账号：albanyambleapexappleaquilineartisticasassignaveravertbakerybastardblestbridgebutcherbycaaccairocantatachargerchariotchipschosencircuitcleanercombocomingcompletecompoundcontentscropcrosscupczardeprivedesiredevildropbyductileenclaveensignepicureequaleternalevadeexcitefighterfloorflossfloweryframefreshmanfullyfunnygangstergauntgloaminggohomegreasygreatergymhadbesthardnessherhoneydewiconinstinctjocundjunklamalaterleaflustermacabremailboxmakeformanmaterialmetermoneynooknounoddsoncepadpalpastpeeppigmentpleasurepolicereadilyrescuerobotsalaryscholarsciencescottsectorselectedshootshrinkshuddersicklesingskimsoftlysorrowspicestevestiffstillstresssuffixsupperswingtermthistokyotoothtorontotoweltoxictriangletrooptryingundulateunituntiluralusualvenetianviewwarpwattwhatwisewiselyyelp   修复方案：  1、采用服务端验证码机制；2、限制登录失败次数，超过次数限制登录一段时间。   版权声明：转载请注明来源 修罗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-11-06 17:49 厂商回复：  CNVD确认并复现所述技术风险点，已经由CNVD通过以往处置渠道向网站管理单位公开邮箱通报。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}