{"id": 48320, "wybug_id": "wooyun-2014-083445", "wybug_title": "钻石小鸟修改订单金额漏洞（感觉瞬间逆袭了，全场统一价400打包带回家）", "wybug_corp": "钻石小鸟", "wybug_author": "hkAssassin", "wybug_date": "2014-11-16 10:14", "wybug_open_date": "2014-12-31 10:16", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-31：\t细节向公众公开  简要描述： 全场统一400处理了。终于可以赢取白富美，走上人生巅峰了！ 详细说明：  \n订单提交后抓包，修改金额，经过测试发现，随便修改金额之后，最后提交到支付宝都变成400了。所以全场都可以统一400出售了。以下为两个订单的测试证明。\n\n\n修改orderamount这个参数值即可！！！\n\n\n\n\n\n\n\n   漏洞证明：  \n订单提交后抓包，修改金额，经过测试发现，随便修改金额之后，最后提交到支付宝都变成400了。所以全场都可以统一400出售了。以下为两个订单的测试证明。\n\n\n修改orderamount这个参数值即可！！！\n\n\n\n\n\n\n\n   修复方案：  ps:尼玛！！！！！我总感觉这是程序员自己留的坑。需要彻查啊！！！我要两个大钻石，来赢取白富美，走上人生巅峰！求高rank…………求大钻石！！！！！！   版权声明：转载请注明来源 hkAssassin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-11-17 15:33 厂商回复： 程序开发中，将商品金额这种关键数据也交由客户端提交了。我们已经对漏洞进行修补了。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-16 11:26 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  你买了多少    \n     2014-11-16 12:30 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @wefgod 我特别想全部买回来    \n     2014-11-17 16:02 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  开发人员已被开除    \n     2014-11-17 16:50 |    \t\t昔阳 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 菜鸟来装逼)\t\t \n  洞主买了什么？我也想买a.a    \n     2014-11-17 17:02 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  买吧！！哈哈！！    \n     2014-12-31 10:52 |    \t\t草榴社区 \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:26        | 未满18周岁,不准进入.)\t\t \n  为什么是400,不是4块?    \n     2015-01-23 16:49 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  支付一个试试看，看支付宝跳回去能不能完成订单    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}