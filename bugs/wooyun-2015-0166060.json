{"id": 75933, "wybug_id": "wooyun-2015-0166060", "wybug_title": "中国铁塔某系统CSRF恶意批量修改任意帐号密码漏洞和Java反序列化命令执行漏洞(JBOSS)", "wybug_corp": "中国铁塔股份有限公司", "wybug_author": "路人甲", "wybug_date": "2015-12-30 16:16", "wybug_open_date": "2016-02-12 18:49", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向公众公开  简要描述： 1.CSRF可恶意批量修改任意用户的密码；2.Java反序列化命令执行漏洞。 详细说明：  1.测试地址：http://101.227.240.110:8989/baf/jsp/uiframe/login.jsp这里随便输入一个帐号lili/888888，可以登陆成功，跳入修改密码界面，原始数据包：\n\n登陆成功，提示修改密码：\n\n这里测试将lili这个帐号的密码修改为liLIcs2015，并进行抓包：\n\n这里POST请求，其中userid= 0229541，这里我将POST请求改为GET方式请求，提交数据包：\n\n\n\n那么可以盲打任意帐号的密码：userid=0229542\n\n这里可以结合CSRF来恶意批量修改任意帐号的密码。2.JBOSS的站点，未授权的页面想jmx-console、invoker接口都未配置任何访问授权信息3.测试Java反序列化：\n\n成功获取系统shell：\n\nwebshell地址:http://101.227.240.110:8989/wooyun.jsp  w00yun@\n\n相关配置信息，包括数据库连接信息，我这里就不截图了，尽快修复吧。   漏洞证明：  1.测试地址：http://101.227.240.110:8989/baf/jsp/uiframe/login.jsp这里随便输入一个帐号lili/888888，可以登陆成功，跳入修改密码界面，原始数据包：\n\n登陆成功，提示修改密码：\n\n这里测试将lili这个帐号的密码修改为liLIcs2015，并进行抓包：\n\n这里POST请求，其中userid= 0229541，这里我将POST请求改为GET方式请求，提交数据包：\n\n\n\n那么可以盲打任意帐号的密码：userid=0229542\n\n这里可以结合CSRF来恶意批量修改任意帐号的密码。2.未授权访问jboss的站点，页面jmx-console、invoker接口都未配置任何访问授权信息：http://101.227.240.110:8989/invoker/EJBInvokerServlethttp://101.227.240.110:8989/invoker/JMXInvokerServlet\n\n3.Java反序列化：\n\n成功获取系统shell：\n\nwebshell地址:http://101.227.240.110:8989/wooyun.jsp  w00yun@\n\n相关配置信息，包括数据库连接信息，我这里就不截图了，尽快修复吧。   修复方案：  1.处理有效token，同时加强服务端对HTTP请求方法的校验；2.反序列化打补丁；3.服务降权。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-12-30 16:18 厂商回复： 感谢，处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}