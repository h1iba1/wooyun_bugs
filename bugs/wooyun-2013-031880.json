{"id": 63434, "wybug_id": "wooyun-2013-031880", "wybug_title": "篱笆网多处XSS漏洞可窃取用户cookie", "wybug_corp": "篱笆网", "wybug_author": "钝刀的老王", "wybug_date": "2013-07-23 17:05", "wybug_open_date": "2013-09-06 17:06", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-06：\t细节向公众公开  简要描述： 多处用户可输入部分XSS漏洞，几个地方的影响面不同。如果加上CSRF的话，可以形成蠕虫，可窃取用户Cookie及个人信息。 详细说明：  1、个人信息中的个人头衔，小范围的，只有别人访问了个人页面才会中招虽然html中限制了头衔的长度、以及一些词语过滤，不过后端没有限制、过滤xss\n\n2、网站活动的回复未做XSS过滤，直接就。。。。\n\n3、大杀器了，应该是篱笆访问量最高的应用了，社区帖子。篱笆有个很好的应用，叫做签名档，可是没做很好的防护啊。只是插入了一个简单的图片，其他什么脚本都能写呢。\n\n另外提一点，算是信息泄漏吧。在个人设置页面虽然隐去了手机号码的中间几位，但是在预约商户的时候却自动填写了完整的手机号。利用如上几个漏洞，如果写点脚本，自动去更新每个用户的头衔、签名档，就可以形成蠕虫了，可以自动收集用户的email、手机号，那面积就大了。   漏洞证明：  2、网站活动\n\n3、签名档\n\nAll，篱笆访问量还是蛮高的，才一会会就好多中招的了\n\n   修复方案：  篱笆应该用的是PHP吧，可以从框架上做一些XSS过滤，如果是支持富文本的，试试看http://htmlpurifier.org/   版权声明：转载请注明来源 钝刀的老王@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-07-23 17:37 厂商回复： 感谢提供，已安排相关人员进行处理。 最新状态： 2013-07-25：已修复  ", "replys": "漏洞评价：\n评论\n     2013-07-24 12:33 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  这个  - -你提交了就算了 我还准备提交 呵呵    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}