{"id": 20554, "wybug_id": "wooyun-2012-06502", "wybug_title": "MTK手机短信漏洞大曝光0day", "wybug_corp": "联发科技股份有限公司", "wybug_author": "小俊", "wybug_date": "2012-04-28 16:15", "wybug_open_date": "2012-04-28 16:15", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["手机安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-28：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-04-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 这些情况都是由于MTK手机支持的一种imy格式铃声引起的，在短信内容中加载不同的imy文件会造成不同的效果。这种imy文件的内容具体如下：（注意，代码为两行#之间的部分，不包括#） 　1.黑屏 ###########################BEGIN:IMELODYBEAT:1200MELODY:(ledoffbackoffvibeoffr5ledoffbackoffvibeoffr5@600)END:IMELODY########################### 　　2.猛震 ###########################BEGIN:IMELODYVERSION:1.2FORMAT:CLASS1.0BEAT:100MELODY:(ledoffledonbackoffbackonvibeon@300)END:IMELODY########################### 　　3.振铃 ###########################BEGIN:IMELODYVERSION:1.2FORMAT:CLASS1.0BEAT:200MELODY:(ledoffbackoffvibeonr5vibeoffledonbackonr5@200)END:IMELODY########################### 详细说明：  这个漏洞的精髓就是imy文件。据了解，imy文件是索爱最早支持的一种代码形式的单音节铃声，可以用代码调用手机的解码芯片发出一些声音甚至一些核心指令。所以代码里面如果是诸如黑屏、响铃等类似的命令，发送给对方后，一旦打开也就触发了这些命令，当然会造成相应的结果。目前看来，只要有人能够懂得这些代码的编写语言，发送格式化储存卡一类的短信应该是没有问题的。我手里就有一个格式化命令的imy文件，由于担心给他人造成不良后果，一直没有实验。 在我的实验过程中，我发现并非所有屏幕有灰色功能键的手机都能中招，也许这些手机使用的不是MTK方案吧。我推测，既然imy并非MTK手机专有格式，那么理论上所有支持imy铃声的手机都会中招。至于预防，我想这是很难的，毕竟只要触发就会中招，也许只能是看到类似的短信立即关闭，不继续翻阅从而避免激活imy文件代码，可能会有一些帮助。当然，这只是相对的，如果对方发送的短信是先插入的imy文件再写文字的话……   漏洞证明：  1.黑屏 ###########################BEGIN:IMELODYBEAT:1200MELODY:(ledoffbackoffvibeoffr5ledoffbackoffvibeoffr5@600)END:IMELODY########################### 　　2.猛震 ###########################BEGIN:IMELODYVERSION:1.2FORMAT:CLASS1.0BEAT:100MELODY:(ledoffledonbackoffbackonvibeon@300)END:IMELODY########################### 　　3.振铃 ###########################BEGIN:IMELODYVERSION:1.2FORMAT:CLASS1.0BEAT:200MELODY:(ledoffbackoffvibeonr5vibeoffledonbackonr5@200)END:IMELODY###########################   修复方案：     版权声明：转载请注明来源 小俊@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：6 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-04-28 16:31 |    \t\tlazypeople \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:6        )\t\t \n  @小俊 是人才    \n     2012-04-28 16:41 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  几年前，就出来的文章了。一些网站，又当冷饭炒。所以...    \n     2012-04-28 16:51 |    \t\t小俊 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        | 喜欢找各式各样的漏洞,喜欢做各式各样的恶...)\t\t \n  @zeracker 这东西一直都存在,只是一直未公布,那些新闻网站虽然公布了,但却公布在某个角落,谁会看得见呢?    \n     2012-04-28 16:58 |    \t\t笨猪 \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:13        | Jarett|最近忙，洞发得少。。)\t\t \n  几年前的东西了，又炒冷饭。。    \n     2012-04-28 17:36 |    \t\t1cefish \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:12        | 作为一个到处漂泊了5年的SB 表示黑客无处不...)\t\t \n  好久之前的东西了  - -  伤不起    \n     2012-04-28 18:10 |    \t\t牛奶坦克 \t\t\t( 普通白帽子  |\t\t\t        Rank:355 漏洞数:21        | 晚安,牛奶)\t\t \n  我是认为啊，不管凉饭热饭，起码几年前没出什么结果与实例，现在又出来了，给这个浮躁的圈子找点研究方向也是正确的，天天xss，注入，也腻了不是？wooyun会让我们看见新的目标，也会让我们看到被遗忘的角落，不是么？    \n     2012-04-28 18:59 |    \t\tqing \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 自由，平等，共享，互助)\t\t \n  支持！只要还存在就应该得到重视。    \n     2012-04-28 19:53 |    \t\t小俊 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        | 喜欢找各式各样的漏洞,喜欢做各式各样的恶...)\t\t \n  @牛奶坦克 说得很对!    \n     2012-04-28 19:53 |    \t\t小俊 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        | 喜欢找各式各样的漏洞,喜欢做各式各样的恶...)\t\t \n  @qing 说得对!!    \n     2012-05-01 06:27 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  请问imy代码怎么插入到短信里？明文，不至于吧？    \n     2013-03-08 14:58 |    \t\t包包 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 我是菜鸟，我怕谁？小弟新来，望大牛多多包...)\t\t \n  人才    \n     2013-03-27 14:43 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  亲，测试过么？    \n     2013-03-27 22:12 |    \t\t包包 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 我是菜鸟，我怕谁？小弟新来，望大牛多多包...)\t\t \n  @Lee 我是自己测过了    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 6, "Ranks": null}