{"id": 65772, "wybug_id": "wooyun-2015-0136145", "wybug_title": "中国电信某漏洞可获取全国电信用户身份信息（个人身份及其他业务信息）", "wybug_corp": "中国电信", "wybug_author": "鸟云厂商", "wybug_date": "2015-08-24 20:32", "wybug_open_date": "2015-10-10 18:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "认证设计不合理", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向公众公开  简要描述： 程序猿这种逻辑，基本也就告别安全了。 详细说明：  首先进入中国电信189的CRM中国电信4G营业受理http://crm.189.cn/ltePortal/通过社工得到一个工号，但是没有密码。进入重置密码页面选择地区，输入工号和验证码\n\n现在要输入手机验证码了\n\n随意输入，提交抓包现在的response是\n{\"successed\":false,\"code\":1,\"data\":\"验证码错误\"\n改为\n{\"successed\":true,\"code\":0,\"data\":\"验证码错误\"</\n可以输入新密码了呵呵\n\n改为w00yun\n\n登陆需要手机验证码，这一步不能用之前的方法了。我们直接爆破吧爆破出结果，把爆破结果的整个response复制下来，提交验证码抓包修改response。（因为包含了cookie和token）\n\n这里限制了验证码尝试3次，但是只要用的是同一个请求则不限制次数（请求中有参数可以判断）进入CRM\n\n查询用户的产品信息信息包括：姓名、套餐、业务开通和使用历史 、终端领用情况等等\n\n这里有个细节要注意查询的时候，请求里会有areaId，这是个必须和号码归属地匹配的参数，在登陆页的源代码里可以获取到，例如福建厦门直接在登陆页面选择地区为：福建>厦门，然后源码里就有了\n\n能给任意号码办套餐\n\n\n\n能给用户送流量包\n\n功能真不少啊\n\n接下来重头戏，查询全国电信用户身份信息了在刚才对业务功能的探测中我发现一个接口可以任意查询\nPOST /provPortal/cust/queryCust HTTP/1.1Host: crm.189.cn:84POST DATA：{\"acctNbr\":\"15396213305\",\"identityCd\":\"\",\"identityNum\":\"\",\"partyName\":\"\",\"diffPlace\":\"local\",\"areaId\":\"8350200\",\"queryType\":\"\",\"queryTypeValue\":\"\",\"identidies_type\":\"接入号码 \"}\n其中的acctNbr是接入号码也就是手机号码，areaId对应这个号码的归属地，前面我们说过怎么获取了。查了几个号码作为测试\n\n\n\n\n\n也可以根据以下信息查号码：接入号码合同号客户编码社会团体法人登记证书港澳居民来往内地通行证台湾居民来往内地通行证临时居民身份证外国公民护照单位介绍信公函+公章(仅用于党政军客户)组织机构代码武装警察身份证件居民身份证事业单位法人证书营业执照户口簿军人身份证件大批量获取公民信息的思路：根据号段生成一个PhoneNumberList，和areaId参数匹配，然后批量抓取response正则匹配出所有关键信息。完全可行，机场网络差搞不了太多。就给个证明吧\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 鸟云厂商@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-08-26 18:19 厂商回复： CNVD确认所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-22 20:32 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:247 漏洞数:32        | 杀猪刀啊，杀猪刀啊)\t\t \n  6666666    \n     2015-08-22 20:55 |    \t\tjanepeak520 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | janepeak是我的真爱(。・ˍ・。))\t\t \n  6666666666    \n     2015-08-22 21:22 |    \t\t雷少 \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:31        | 热爱网络的爱好者，需求同道中人。)\t\t \n  66666666666666    \n     2015-08-22 21:32 |    \t\t终于明白 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | 菜鸟·····)\t\t \n  我也能评论了么，哈哈    \n     2015-08-22 21:43 |    \t\tan0nym0u5 \t\t\t( 普通白帽子  |\t\t\t        Rank:172 漏洞数:31        )\t\t \n  黑阔 绝对是黑阔~    \n     2015-08-22 21:44 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1213 漏洞数:321        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  看了下，思路很明确，不错，涨姿势了，就是第二步的时候好像不是那么顺利 (请允许我装个X)    \n     2015-08-22 21:49 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1346 漏洞数:147        | 中国菜鸟)\t\t \n  @M4sk 事实上第二步确实在测试的时候遇到麻烦了，已解决：）    \n     2015-08-22 21:53 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1213 漏洞数:321        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  @鸟云厂商 看来我这B装的有深度！ ╮(╯▽╰)    \n     2015-08-22 21:54 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1242 漏洞数:317        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  看了下，你的三部的密码怎么拿到啊，还有第四部的后台好像没安全进去，加油啊    \n     2015-08-22 22:05 |    \t\t诚殷的小白帽 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 诚殷的小白帽)\t\t \n  666    \n     2015-08-22 22:16 |    \t\trrrfff \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:2        | 核心黑帽子 | Rank:-100 漏洞数:0)\t\t \n  嗯, 不正常途径看到了    \n     2015-08-22 22:35 |    \t\tzeracker  \t\t\t( 普通白帽子  |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  卧槽。。吓死我了。.. 幸好我不是电信的用户。    \n     2015-08-22 23:40 |    \t\t呆呆 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 小小白)\t\t \n  大牛！膝盖拿去    \n     2015-08-24 10:10 |    \t\t8点半 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:5        | 你当哥是CPU啊，人生价值就是执行指令?)\t\t \n  我电信好多年的用户了- -    \n     2015-08-24 11:38 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1346 漏洞数:147        | 中国菜鸟)\t\t \n  @zeracker 回头我搞搞移动，专搞188号段的。    \n     2015-08-26 18:21 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:399 漏洞数:87        | 什么狗屁爱，生活已乱套！人的一生中，...)\t\t \n  @鸟云厂商 为嘛前面很多人看过细节了？我找半天也没发现哪里可以看细节    \n     2015-08-26 18:39 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:48        | 不告诉你)\t\t \n  666    \n     2015-08-26 19:18 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1074 漏洞数:108        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  全国....这个叼    \n     2015-08-27 09:17 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:296 漏洞数:63        | 工作需要，暂别一段时间)\t\t \n  @牛 小 帅 除了三哥能看到，前面其他的都是装叉开玩笑的    \n     2015-10-10 18:22 |    \t\t魂淡 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我就是萌萌萌萌萌萌萌萌萌萌萌萌萌萌萌哒的...)\t\t \n  大牛666666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}