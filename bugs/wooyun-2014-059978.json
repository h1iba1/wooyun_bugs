{"id": 2369, "wybug_id": "wooyun-2014-059978", "wybug_title": "IBM BladeCenter Advanced Management Module存在任意代码执行及信息泄漏漏洞", "wybug_corp": "IBM", "wybug_author": "wefgod", "wybug_date": "2014-05-09 10:26", "wybug_open_date": "2014-08-07 10:28", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意代码执行", "命令执行", "渗透测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向公众公开  简要描述： IBM BladeCenter Advanced Management Module在如金融、运营商里使用非常广泛。该Module自带有web应用，但最近发现该web应用存在一处代码执行和一处信息泄漏漏洞。（剧透下，这货某处赫然发现了“OEM”三个大字……）最后再附送一下IBM Chassis Management Module的小漏洞一枚。 详细说明：  官网介绍：https://publib.boulder.ibm.com/infocenter/bladectr/documentation/index.jsp?topic=/com.ibm.bladecenter.advmgtmod.doc/adv_mgt_mod_product_page.html\n\n用户指引：http://www-947.ibm.com/support/entry/portal/docdisplay?lndocid=migr-5073887\n\nweb界面截图：\n\nCopyright © IBM Corporation 2005-2013. All rights reserved.系统多用于内网，一般都是在内网才可以访问。本次测试的范围也是内网十几台IBM的服务器。首先说下phpinfo信息泄漏，URL如下：http://1.1.1.1/phpinfo.php\n\n就是很常见的PHPINFO。测试的时候发现一堆IP都有这个问题：\n\n多放一个IP的截图吧：\n\n其它就不多发了。   漏洞证明：  接着说代码执行的问题，其实这简直就是一个后门啊，里面可以直接执行php的代码，url如下：http://1.1.1.1/test.php框里直接丢一个phpinfo();\n\n成功执行了phpinfo。随便乱输不成代码的东西还可以暴出路径：\n\n/usr/local/httpd/htdocs/直接获取shell（一点小技巧而已，这里不多说，服务器本身的web目录是只读的，好好想想怎么用神器菜刀哈）：\n\n去看看test.php：\n\n\n<pre><? $eval_time_start = microtime_float(); echo eval($code); ?></pre>eval你懂的。\n再来一份真相：\n\nOEM是什么情况？难道要秒杀一片OEM产品吗？\n\n源码给力啊：\n\n回去看了看phpinfo的信息：\n\n为什么这里是写2009呢？IBM忽悠了？不是写2013吗发现有该问题的机器很多哦：\n\n多放两个菜刀的截图吧：\n\n还有这个也多放几个截图：\n\n\n\nIBM Chassis Management Module的东西放在最后吧   修复方案：  这里是附送的礼包了，IBM Chassis Management Module存在心血的漏洞：界面是这样的\n\nLicensed Materials - Property of IBM Corp. © IBM Corporation and other(s) 2013. IBM is a registered trademark of the IBM Corporation in the United States, other countries, or both.测试的是下面三个IP\n\n可以获取到相关的信息：\n\n不过这漏洞就不深入太多了，poc可以直接获取到cookie，但是登录的时候必须是ssl登录，所以cookie一直都有问题，就不再测试了。   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-05-12 17:54 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-09 10:27 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  帅呆了。。    \n     2014-05-09 10:27 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  哇这个叼。。。    \n     2014-05-09 10:48 |    \t\t疯狂的dabing \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:9        | Hehe is golden.)\t\t \n  你关注的白帽子 wefgod 发表了漏洞 IBM BladeCenter Advanced Management Module存在任意代码执行及信息泄漏漏洞\t    \n     2014-05-09 10:50 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  国际化    \n     2014-05-09 10:56 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这特么是后门么？！    \n     2014-05-09 10:57 |    \t\tMoc \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:12        | 屌丝何苦为难屌丝)\t\t \n  你关注的白帽子 wefgod 发表了漏洞 IBM BladeCenter Advanced Management Module存在任意代码执行及信息泄漏漏洞    \n     2014-05-09 11:14 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  叼炸天~    \n     2014-05-09 11:20 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  你关注的绿帽子 wefgod 发表了漏洞 IBM BladeCenter Advanced Management Module存在任意代码执行及信息泄漏漏洞    \n     2014-05-09 11:21 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  虽然我看不懂，但好像很牛B的样子！    \n     2014-05-09 11:37 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 我觉得是类似后门，关键是为什么每台都有……？OEM产品留下的后门吗？    \n     2014-05-09 11:37 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @se55i0n @what_news @zeracker 实际上类似一个小后门而已，真没什么屌的地方的……    \n     2014-05-09 11:39 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  @wefgod 来 逐浪在等你     \n     2014-05-09 11:40 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @what_news 再说吧，唉。很纠结    \n     2014-05-09 11:44 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  @wefgod 不会被逐浪拉黑了吧    \n     2014-05-09 12:17 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @what_news 他能如何拉黑我。我纠结的可不是逐浪的事情    \n     2014-05-09 12:35 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  这个肯定会找不到厂商或者忽略的，早点公开吧    \n     2014-05-09 14:43 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  尼玛 ibm    \n     2014-05-09 14:54 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @GrayTrack 漏洞状态：\t 已交由第三方厂商(cncert国家互联网应急中心)处理    \n     2014-05-09 19:15 |    \t\t摩西 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 码农..)\t\t \n  坐等公开~ 高大上的感觉    \n     2014-05-09 19:21 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  你关注的白帽子 wefgod 发表了漏洞 IBM BladeCenter Advanced Management Module存在任意代码执行及信息泄漏漏洞    \n     2014-05-09 21:59 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:30        | Wow~~~哈哈~~~)\t\t \n  你关注的白帽子 wefgod 发表了漏洞 IBM BladeCenter Advanced Management Module存在任意代码执行及信息泄漏漏洞 \t    \n     2014-08-07 10:43 |    \t\tMirror \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:5        | ->_->)\t\t \n  帅呆了    \n     2015-02-11 20:21 |    \t\t风炫 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:5        | 菊花残，满地伤)\t\t \n  拿shell的方法才是本文的亮点，但一带而过~~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}