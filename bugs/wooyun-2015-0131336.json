{"id": 25474, "wybug_id": "wooyun-2015-0131336", "wybug_title": "大智慧某站svn信息泄露导致大量内网数据库配置泄露", "wybug_corp": "上海大智慧", "wybug_author": "路人甲", "wybug_date": "2015-08-03 17:31", "wybug_open_date": "2015-09-18 08:50", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向公众公开  简要描述： 大智慧某站svn信息泄露导致大量内网数据库配置泄露 详细说明：  大智慧某站svn信息泄露导致大量内网数据库配置泄露，可读任意目录，可读任cgi源代码导致内部多个系统数据库信息泄露！\nclass DBConnInfo{    static $URL = \"10.15.144.182:11123\";       //数据库地址    static $UserName = \"\";              //登录名    static $Password = \"\";           //登录密码    static $DbName = \"jtlcs\";                //数据库\n\n//discuz地址    static $DISCUZ_URL = \"http://10.15.44.72/discuz/forum.php?mod=guide&view=newthread&mobile=2\";    //discuz加密key(用于和家庭理财师或discode通信时加密)    static $DISCUZ_ENCRYPTION_KEY = \"homefinancial\";\n\n//websocket配置\tstatic $WS_SERVER = 'wss://fe.gw.com.cn/dataproxy';\t//static $WS_SERVER = 'ws://10.15.107.214:20718/dataproxy';\t//static $WS_SERVER = 'ws://10.15.107.138:20718/dataproxy';\t\t//金牌投顾理财师接口地址\tstatic $JPTG_LCS_SERVER = 'http://10.15.108.155:8891';\t//static $JPTG_LCS_SERVER = 'http://xctg.gw.com.cn';\t\t//金牌投顾自选股接口地址\tstatic $JPTG_ZXG_SERVER = 'http://10.15.108.155:8893';\n\n//账号中心-webservice api\tstatic $USERCENTER_NEW_URL = 'http://10.15.108.114:9001/AccService/AccServlet.do?'; \t\t//帐号中心-webservice appId userget接口需要    static $USERCENTER_APP_ID =5;\t\t//wap登录注册跳转地址 上线前需要提供域名给对方授权\tstatic $USERCENTER_URL= 'http://10.15.108.114:9001/UserCenter/page/account/';\t//wap登录注册需要的source\tstatic $USERCENTER_SOURCE = 41; \t\t//TOKEN 验证API\tstatic $TOKEN_SERVER = array('10.15.107.167'); \t//湘才开户\tstatic $XCKH_URL = 'http://10.15.108.151/xckhhd/wap/';\t\t//家庭理财师日志输出路径\tstatic $LOG_PATH = 'd:/logs/'; \tstatic $LOG_SERVER_URL = 'http://10.15.44.126:800/writeLog'; \t//crm 开户接口  资金重置\tstatic $CLOUND_API = 'http://10.15.88.57/bank/'; \t\t//家庭理财师提供给李宁接口设定的密钥\tstatic $API_KEY = 'jk;.fd/dfd@^d'; \t// 李宁接口\tstatic $USER_RANK_URL='http://10.15.108.154:9080/seca/api/familyfin';\t//static $USER_RANK_URL='http://10.10.1.37:9080/seca/api/familyfin'; //online\n   漏洞证明：  \n8dir50535https://svn.gw.com.cn:10000/svn/Platform/homefinancial/trunk/homefinancialhttps://svn.gw.com.cn:10000/svn/Platform2015-03-06T06:58:02.701200Z50532xiangshenhas-propssvn:special svn:externals svn:needs-lock852d2bc5-fa74-a04a-b0b0-a93b6df14016.htaccessfile2014-12-17T06:56:15.000000Z11c369ee2be2d63b4753ec6a615827922014-12-02T01:34:58.144000Z47924chenxueshuangbuild.propertiesfile2014-12-17T06:56:15.000000Ze9fe8151b00bd2456facc96f0219833a2014-12-16T09:29:57.524400Z48572xiangshencrondirdatadirdooframeworkdirglobaldirguesszddirindex.phpfile2015-01-06T05:46:14.000000Z13d6203030369c647097e99220db4bb52015-01-06T02:02:48.288400Z49015lihaiweiprotecteddir\n可读源代码http://jiacai.gw.com.cn/protected/config/.svn/text-base/system.conf.php.svn-base\n<?php class SystemConfig{\t//image、javascript、css、flv等文件服务地址\tstatic $RESOURCE_HOST = '';\t//memcache地址 host, port, persistent, weight\tstatic $MEMCACHE_SERVER = array(array('10.15.108.155', '21220', true, 40));\t\t//家庭理财师缓存redis 读写 队列 专用\tstatic $REDIS_SERVER = array('10.15.108.151:6380');  //redis\t//读取排行日期数据的redis接口-和二次计算共用的\tstatic $REDIS_SERVER_RANK = array('10.15.108.151:6380');  //redis\t\t//家庭理财师redis队列key\tstatic $REDIS_QUEUE_KEY ='jtlcs_msg_queue'; \t\t//经验值升级规则\tstatic $JYZ_UPGRADE_CONFIG = 1000;\t\t//交易赠送经验值配置 s每次赠送 limit每级上限\tstatic $TRADE_SEND_JYZ = array('s'=>50,'limit'=>500);\t\t//资金初始化配置\tstatic $FUNDS_INIT =array(0=>50000,1=>200000,2=>500000,3=>1000000,4=>1000000,5=>1000000,6=>1000000,7=>1000000,8=>1000000,9=>1000000);\t\t//每日登录送一次经验值\tstatic $LOGIN_SEND_JYZ = 10;\t\t//账号中心-webservice api\tstatic $USERCENTER_NEW_URL = 'http://10.15.108.114:9001/AccService/AccServlet.do?'; \t\t//帐号中心-webservice appId userget接口需要    static $USERCENTER_APP_ID =5;\t\t//wap登录注册跳转地址 上线前需要提供域名给对方授权\tstatic $USERCENTER_URL= 'http://10.15.108.114:9001/UserCenter/page/account/';\t//wap登录注册需要的source\tstatic $USERCENTER_SOURCE = 41; \t\t//TOKEN 验证API\tstatic $TOKEN_SERVER = array('10.15.107.167'); \t//湘才开户\tstatic $XCKH_URL = 'http://10.15.108.151/xckhhd/wap/';\t\t//家庭理财师日志输出路径\tstatic $LOG_PATH = 'd:/logs/'; \tstatic $LOG_SERVER_URL = 'http://10.15.44.126:800/writeLog'; \t//crm 开户接口  资金重置\tstatic $CLOUND_API = 'http://10.15.88.57/bank/'; \t\t//家庭理财师提供给李宁接口设定的密钥\tstatic $API_KEY = 'jk;.fd/dfd@^d'; \t// 李宁接口\tstatic $USER_RANK_URL='http://10.15.108.154:9080/seca/api/familyfin';\t//static $USER_RANK_URL='http://10.10.1.37:9080/seca/api/familyfin'; //online\t\t//token有效期6小时 登录cookie保存token6小时\tstatic $TOKEN_TIMEOUT = 21600;  \t\t//交易柜台地址    static $COUNTER_SOCKET = \"10.15.107.15:16990\"; \t\t//交易柜台活动id    static $COUNTER_HUODONG_ID = \"FAFP\"; \t\t\t//行情服务器配置\tstatic $HQ_SERVER = array(\t\t//host=主机名或IP地址，port=端口，weight=权重\t\tarray('host'=>'122.228.80.109','port'=>'12345','weight'=>10),\t\tarray('host'=>'122.228.80.112','port'=>'12345','weight'=>20),\t\tarray('host'=>'122.228.80.116','port'=>'12345','weight'=>30),\t\tarray('host'=>'122.228.80.124','port'=>'12345','weight'=>40),\t\t//......可添加多个\t);\t//phpsocket行情默认缓存时间（秒）\tstatic $HQ_EXPIRES = 60;\t\t//websocket默认超时时间（秒）\tstatic $WS_TIMEOUT = 3;\t\t//websocket配置\tstatic $WS_SERVER = 'wss://fe.gw.com.cn/dataproxy';\t//static $WS_SERVER = 'ws://10.15.107.214:20718/dataproxy';\t//static $WS_SERVER = 'ws://10.15.107.138:20718/dataproxy';\t\t//金牌投顾理财师接口地址\tstatic $JPTG_LCS_SERVER = 'http://10.15.108.155:8891';\t//static $JPTG_LCS_SERVER = 'http://xctg.gw.com.cn';\t\t//金牌投顾自选股接口地址\tstatic $JPTG_ZXG_SERVER = 'http://10.15.108.155:8893';    //跳转discuz url\tstatic  $LOGIN_TO_DISCUZ_URL = 'http://10.15.44.72/uchack/login.php';    //同步discuz頭像    static $SYNC_AVATAR_NICKNAME_URL = 'http://10.15.44.72/uchack/syncavatarnickname.php' ;    //discuz地址    static $DISCUZ_URL = \"http://10.15.44.72/discuz/forum.php?mod=guide&view=newthread&mobile=2\";    //discuz加密key(用于和家庭理财师或discode通信时加密)    static $DISCUZ_ENCRYPTION_KEY = \"homefinancial\";    //微社区url    static $WSQ_URL = \"http://wsq.qq.com/reflow/263998497\";\t//图片域名    static $IMP_HOST = \"http://static.ads.gw.com.cn/cdn\";\t\t//REDIS 中控服务器 同步微信 access_token  \tstatic $REDIS_WX_TOKEN = array('10.10.3.20:6379');  //redis} //mongodb配置信息class DBConnInfo{    static $URL = \"10.15.144.182:11123\";       //数据库地址    static $UserName = \"\";              //登录名    static $Password = \"\";           //登录密码    static $DbName = \"jtlcs\";                //数据库}class FunctionConfig{\tstatic $IS_HTTPS = false;\t//网站版本号\tstatic $VERSION = '1.00034';}\n   修复方案：  关闭   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-08-04 08:50 厂商回复： 已通知运维负责人处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}