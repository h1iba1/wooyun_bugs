{"id": 46237, "wybug_id": "wooyun-2015-0143217", "wybug_title": "看我尝试利用百度文库配合腾讯XSS漏洞打一次无聊体验", "wybug_corp": "腾讯", "wybug_author": "Xmyth_Xi2oMin9", "wybug_date": "2015-09-24 16:31", "wybug_open_date": "2015-09-25 18:59", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "利用技巧", "聊的人做了一件", "聊的事情"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 虽然危害不大 利用起来比较鸡肋 习惯性分享有趣的事情 详细说明：  事情起因：\n当我在认真学习windows内核编程的时候，像了解下IRP的原理。就开始找这方面的资料，就在百度文库中找到了一篇《IRP原理以及派遣函数基本工作流程》。看完之后觉得这好的文章，一定要和扣扣空间的小伙伴分享，就点击了分享到扣扣空间。\n\n\n\n\n然后我就习惯性的审查元素瞅瞅。就发现分享功能中把百度文库标题传进了value中。\n<input id=\"title\" class=\"view_title\" type=\"text\" maxlength=\"50\" value=\"【IRP原理以及派遣函数基本工作流程】(分享自@百度文库)南邮王下邀月熊——Windows 驱动开发学习..\">\n假设我们的把想要利用这个地方进行攻击。那应该怎么做？是不是需要一个场景呢？我就想了想利用的场景，前提是我需要去诱导别人去帮我分享这个文章到扣扣空间里，在他帮忙分享的过程中触发我构建好的XSSCODE。例如这样去让我们可爱的小伙伴帮忙分享：\n\n那么问题来了，如果控制构建的XSSCODE呢？不难发现我们需要做的就是控制value里面的值，也就是百度文库中的标题。那么就尝试去测试一下修改文章标题，而百度文库中修改标题是不需要审核的，但做了简单的限制就是不允许输入一些简单特殊的符号。\n\n刚输入就提示我们标题不能含有/\\:*?\"<>|等特殊字符哦！估计是在客户端做了验证。那我们就调整下思路，拦截数据试试。\n\n服务端也做了验证，但是我们发现了一个问题！这里&和#是没有被过滤的。    漏洞证明：  \n\n   修复方案：  打字打的辛苦 分享快乐 ：-）   版权声明：转载请注明来源 Xmyth_Xi2oMin9@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-09-25 18:59 厂商回复： 非常感谢您的报告，经评估该问题并不存在，故此忽略。如果您有任何的疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-24 16:34 |    \t\tXmyth_Xi2oMin9 \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:21        | 要感谢的人 太多 谢谢谢谢谢谢谢谢谢谢谢谢)\t\t \n  @疯狗 狗哥麻烦帮忙改下标题 多一个打字 看着我自己都难受 谢谢     \n     2015-09-25 23:52 |    \t\t小2b \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 努力赚钱)\t\t \n  我很想知道是不是給了0分    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}