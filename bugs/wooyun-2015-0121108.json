{"id": 10467, "wybug_id": "wooyun-2015-0121108", "wybug_title": "土巴兔装修网某接口可探测大量用户用户数据", "wybug_corp": "土巴兔装修网", "wybug_author": "路人甲", "wybug_date": "2015-06-17 12:48", "wybug_open_date": "2015-08-01 14:08", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄露", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-01：\t细节向公众公开  简要描述： 土巴兔装修网某接口可探测大量用户用户数据 详细说明：  在\nwww.to8to.com\n主站看见一个旗下的网站地址\nhttp://www.shejiben.com/account/login.php\n该登陆接口控制不严，无次数限制，并且无验证码，可以批量爆破用户密码。看下这个登陆地方。\n\n可以用用户名登陆，那就好办了。现在去找一些可以获取用户名的地方就行了。通过测试，这个三个地方都可以获取用户名\nhttp://www.shejiben.com/yz/3410927/http://www.shejiben.com/sjs/998338/http://www.shejiben.com/my/message.php?act=send&uid=1234567\n用户量大概是400百万左右。利用http://www.shejiben.com/my/message.php?act=send&uid=1234567这个接口获取了大概几百个用户名信息。\n\n\n\n然后在登陆处使用，观察登陆接口，使用用户名和md5加密的密码来登陆。这里仅仅用123456作为密码来测试。这个密码是够弱的直接用脚本来爆破\n\n\n\n发包频繁就会超时，脚本做了一下处理。拿着成功这几个登陆下。直接登陆主站。主站和shejiben.com用户数据库是一起的。主站和设计本这两个站都是可以登陆的。\n\n\n\n\n\n\n\n测试只用了123456来做密码。并且只有几百个用户名。按照这个成功率，换个大点的密码字典，400万的用户。成功率也是很大的，包括设计师和用户。   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-06-17 14:06 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}