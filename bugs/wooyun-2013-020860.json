{"id": 12850, "wybug_id": "wooyun-2013-020860", "wybug_title": "58同城任意修改、删除用户收货地址", "wybug_corp": "58同城", "wybug_author": "se55i0n", "wybug_date": "2013-03-29 09:21", "wybug_open_date": "2013-05-13 09:21", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "越权操作", "敏感操作校验不足", "敏感接口缺乏校验", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-13：\t细节向公众公开  简要描述： 58的大牛送个公仔呗！ 详细说明：  问题出在58同城的团购网站上。1）任意修改用户的收货地址1.1）注册两个帐号，分别用chrome、firefox登录帐号，收货地址都是空白的；\n\n\n\n1.2）在chrome用户下设置收货地址，点击保存并抓包；\n\n1.3）在数据中发现用户收货地址参数“t_58com_address”和用户身份标识“userid”；\n\n1.4）将“userid”参数修改成firefox登录用户的值并提交，查看结果，chrome用户收货地址为空，firefox用户收货地址则被成功设置；\n\n\n\n1.5）因为系统允许设置5个收货地址，所以以上面的方式添加会添加增加到用户的第二个地址里不会对第一个地址造成影响，但是我们有其他的办法；2）任意删除用户的收货地址；2.1）为chrome用户添加一个收货地址；\n\n2.2）点击修改用户地址，修改后点击保存并抓包得到如下数据；\nupprovincename=%E4%B8%8A%E6%B5%B7%3B%E4%B8%8A%E6%B5%B7%3B%E5%AE%9D%E5%B1%B1&upid=1730902&uplinkman=%E6%B5%8B%E8%AF%95%E5%88%A0%E9%99%A4&upprovince=3%3B%E4%B8%8A%E6%B5%B7&upprovince2=sh&upcity2=baoshan&upaddress=%E4%B8%8A%E6%B5%B7%E8%A1%97%E4%B8%8A%E6%B5%B7%E8%B7%AF100%E5%8F%B7&uppostcode=100100&upmobile=13318011920\n2.3）当然一眼就看出“upid”参数是我们修改地址的对应id标识，直接将其替换成firefox下用户的地址id并提交，返回刷新页面发现chrome下用户多了一个收货地址，而firefox下用户的收货地址已经为空了；\n\n\n\n2.4）以这样的方式我们可成功删除用户的地址，当然删完了之后我们就可以直接给用户添加地址了；   漏洞证明：  见详细说明   修复方案：  你们懂的   版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-03-29 11:32 厂商回复： 非常感谢提交漏洞，马上修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-08 23:19 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  别人的userid是随便看吗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}