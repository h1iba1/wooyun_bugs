{"id": 18085, "wybug_id": "wooyun-2012-09477", "wybug_title": "Discuz全版本数据库备份文件泄漏", "wybug_corp": "Discuz!", "wybug_author": "only_guest", "wybug_date": "2012-07-11 12:59", "wybug_open_date": "2012-08-25 12:59", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数据库被下载", "短文件名漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-25：\t细节向公众公开  简要描述： Windows short filenames造成的Discuz数据库备份文件泄漏.只适用于跑在windows下的apache下的DZ!不仅仅是DZ存在这个问题哦. 详细说明：  看详细之前请去自行了解下Windows short filenames这个漏洞的详情!首先.了解DZ的童鞋都知道.DZ的备份目录文件名/fourmdata/backup/或者是/data/backup/备份成功后是不会是在默认的backup下的.会生成一个新的文件夹命名规则为backup_6位随机数字_6位随机字母/然后让我们来数一数backup刚好6位.童鞋们.发现啥了么?按照短文件名这个漏洞.此类文件夹名称我们可以这样访问backup~1/backup~2/backup~3/呵呵.我们再来看一下备份文件的命名规则.110702_XNf2rv-1.sql日期_6位随机数-1.sql日期我们写个小字典跑一下就出来了...刚好也是6位..哈哈..我们用如下文件名来访问110702~1.sql备份的数据库文件就出来了.漏洞至此结束更多利用方法大家自己琢磨我把他归为是DZ的漏洞,比较牵强.但是如果DZ的备份规则不这么搞.也不会存在这个问题相同的程序还很多.大家自己研究   漏洞证明：  看详细之前请去自行了解下Windows short filenames这个漏洞的详情!   修复方案：  修改备份文件名规则吧.   版权声明：转载请注明来源 only_guest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2012-07-13 13:31 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-11 13:03 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  apache也有？不是说iis么？虽然短文件是微软的问题！难道apace访问也出错 坎举    \n     2012-07-11 13:10 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  C:\\Docume~1===C:\\Documents and Settings不知道是不是利用到提权里去    \n     2012-07-11 13:12 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  v5+1    \n     2012-07-11 13:17 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  只适用于跑在windows下的apache下  测试没有此问题！！除非你是有。net2的框架吧    \n     2012-07-11 13:26 |    \t\tZvall \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:14        | hello world)\t\t \n  @king 短标记确实是利用到提权了去了    \n     2012-07-11 13:38 |    \t\tsoftbug \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | 为人类设计最好的软件，解放人的双手,一起...)\t\t \n  only_guest 很会把漏洞跟现有产品结合起来，不亏为灵魂级的牛人！膜拜了    \n     2012-07-11 13:51 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  http://code.google.com/p/iis-shortname-scanner-poc/ 扫描器     \n     2012-07-11 14:18 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  @gainover cat好    \n     2012-07-11 15:16 |    \t\t情深 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        | 安全小白)\t\t \n  这个在wooyun社区有讨论的    \n     2012-07-11 15:29 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @king 为扫描器，mark    \n     2012-07-12 16:21 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  嘿嘿 早知道了想托几个库你就来报告了- - Dede一样你也提交吧    \n     2012-07-13 16:03 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  @_Evil 哦买嘎的，你犀利了，跨省    \n     2012-07-16 07:08 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  O'MARK    \n     2012-08-14 10:55 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  @king 看详细之前请去自行了解下Windows short filenames这个漏洞的详情!  这个是作者的话，我想你应该懂的。    \n     2012-08-14 14:29 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  @momo ?????啥意思呢！    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}