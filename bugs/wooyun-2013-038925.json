{"id": 8034, "wybug_id": "wooyun-2013-038925", "wybug_title": "百度百科页面某处跳转验证缺陷漏洞（可钓鱼）", "wybug_corp": "百度", "wybug_author": "n0b0dy", "wybug_date": "2013-10-11 18:00", "wybug_open_date": "2013-11-25 18:00", "wybug_type": "URL跳转", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["跳转", "钓鱼欺诈"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-25：\t细节向公众公开  简要描述： 百度某处跳转漏洞,过滤不严,可以利用到百度知道 贴吧等地方放链接, 黑帽seo 详细说明：  \nhttp://www.baidu.com/search/ressafe.html?q=%E7%99%BE%E5%BA%A6%E6%9F%90%E4%B8%80%E5%85%B3%E9%94%AE%E5%AD%97&ms=3&url=http://baike.baidu.com@google.com\n 可以控制q搜索框文字显示, 可以控制显示链接是指向百度百科还是百度的其它产品url \n\n   漏洞证明：  \n(function() {    var param = document.location.search;    if(param) {        var url = \"\", name = \"\", exist = false, query = \"\", ms = \"\";        var prd = [{\"name\":\"新闻\",\"domain\":\"news\"},{\"name\":\"贴吧\",\"domain\":\"tieba\"},{\"name\":\"知道\",\"domain\":\"zhidao\"},{\"name\":\"百科\",\"domain\":\"baike\"},{\"name\":\"文库\",\"domain\":\"wenku\"},{\"name\":\"MP3\",\"domain\":\"mp3\"},{\"name\":\"图片\",\"domain\":\"image\"},{\"name\":\"地图\",\"domain\":\"map\"},{\"name\":\"视频\",\"domain\":\"video\"},{\"name\":\"Ting\",\"domain\":\"ting\"},{\"name\":\"hao123\",\"domain\":\"hao123\"}];\t\tif(/\\?q=(.*?)&/i.test(param)) {\t\t\tquery = RegExp.$1;\t\t\tif(query != \"\"){\t\t\t\tdocument.f.tn.value = \"baiidu1\";\t\t\t}\t\t\tG(\"kw\").value = decodeURIComponent(RegExp.$1);        }        if(/[&?]url=(.*)$/i.test(param)) {            var domain = \"\", domain1 = \"\", domain2 = \"\";\t\t\turl = RegExp.$1;\t\t\tif(/^https?\\:\\/\\/(\\w+)\\.(baidu|hao123)\\.com/i.test(url)){\t\t\t\tdomain1 = RegExp.$1;\t\t\t\tdomain2 = RegExp.$2;\t\t\t\tif(domain2 == \"baidu\"){\t\t\t\t\tdomain = domain1;\t\t\t\t}else if(domain2 == \"hao123\"){\t\t\t\t\tdomain = domain2;\t\t\t\t}\t\t\t}\t\t\tfor(var i = 0; i < prd.length; i++) {\t\t\t\tif(prd[i].domain == domain){\t\t\t\t\tname = prd[i].name;\t\t\t\t\tG(\"warning\").style.display = \"block\";\t\t\t\t\tG(\"warning_name\").innerHTML = name;\t\t\t\t\tG(\"warning_url\").href = url;\t\t\t\t\texist = true;\t\t\t\t\tbreak;\t\t\t\t}\t\t\t}\n   修复方案：  还是不要这么简单的解析url了   版权声明：转载请注明来源 n0b0dy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2013-10-11 21:04 厂商回复： 感谢对百度安全的关注，安全组立即处理此问题。--“百度，因你更安全” 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-11 22:31 |    \t\tgoodboyhack \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | know it then hack it !)\t\t \n  --“百度，因你更安全”    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}