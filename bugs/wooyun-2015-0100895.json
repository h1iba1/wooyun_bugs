{"id": 44370, "wybug_id": "wooyun-2015-0100895", "wybug_title": "阿里云某漏洞或可导致进入内网", "wybug_corp": "阿里巴巴", "wybug_author": "杀器王子", "wybug_date": "2015-03-12 13:50", "wybug_open_date": "2015-04-26 13:52", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-26：\t细节向公众公开  简要描述： 阿里云某漏洞或者导致进入内网 详细说明：  http://42.156.166.30/cdn/index.php由于服务器配置 代码无法解析 直接下载\n<?phpdefine(\"ROOT\", dirname(__FILE__) . \"/\");date_default_timezone_set('Asia/Chongqing');ini_set('session.save_handler', 'User');require('lib/session.lib.php');$session = new SessionHandler();$session->setDbDetails('kunlun146076.cm4', 'tb_cdn', 'ttj1tds2', 'taobao_cdn');$session->setDbTable('cdn_session');session_set_save_handler(array($session, 'open'),                        array($session, 'close'),                        array($session, 'read'),                        array($session, 'write'),                        array($session, 'destroy'),                        array($session, 'gc'));require('lib/Buc.Lib.php');$ark_info = $_SESSION['data'];$ark_info['WorkId'] = $ark_info['empId'];if(preg_match('/^\\/proxyApi/', $_SERVER['REQUEST_URI'])){    $url = preg_replace('/^\\/proxyApi/', '', $_SERVER['REQUEST_URI']);    // $url = \"http:/\n\nmask 区域\n\n*****.195*****\n\n\n\n:9999{$url}\";    $url = \"http://v125005080.bja:9999{$url}\";    $curl = curl_init();\n泄露内网数据库配置 通过层层include 下载到部分代码 并确认是阿里云昆仑镜监控平台的代码\n\n\n\n\n\n\n\ncdn监控报告库还有内部api泄露   漏洞证明：  我们回到上面\nif(preg_match('/^\\/proxyApi/', $_SERVER['REQUEST_URI'])){    $url = preg_replace('/^\\/proxyApi/', '', $_SERVER['REQUEST_URI']);    // $url = \"http://\n\nmask 区域\n\n*****195.*****\n\n\n\n:9999{$url}\";    $url = \"http://v125005080.bja:9999{$url}\";\n这这一段明显是个http代理但是注释的ip已经不可访问 url是内网host由于9999数据非常见端口 收集全国的ip地址 使用zmap进行扫描匹配最终找到下面几个ip42.96.128.742.96.128.24042.96.128.22042.96.128.14142.96.128.111以第一个为例http://42.96.128.7:9999/\n\n应该就是这个代理服务器 但是由于不知道参数无法代理成功爆破或者下载更多源码可能会有收获   修复方案：  下线   版权声明：转载请注明来源 杀器王子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-03-12 14:41 厂商回复： 经测试代码泄露为边缘代码，且数据库是内网使用。感谢您对阿里巴巴安全的关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-12 16:12 |    \t\t崔超杰 \t\t\t( 普通白帽子  |\t\t\t        Rank:192 漏洞数:53        | 知仙)\t\t \n  我刚成为会员，请问什么时候升级到普通白帽子啊    \n     2015-03-12 18:07 |    \t\t无名 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 我是一只小菜鸟呀，伊雅伊尔哟。)\t\t \n  666666    \n     2015-03-12 19:59 |    \t\t感染者 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:16        | 喜欢探索，愿与君共勉！)\t\t \n  听说直接提交到他们自己的报告平台会有mac送的    \n     2015-03-12 20:31 |    \t\t崔超杰 \t\t\t( 普通白帽子  |\t\t\t        Rank:192 漏洞数:53        | 知仙)\t\t \n  感觉还是提交到第三方好些，乌云理念就是：自由平等开放，自己网站的自家漏洞平台，估计很难做到这点！    \n     2015-03-12 21:03 |    \t\t麦香浓郁 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 前排膜拜乌云ph m锅 凤凰 a11 dot 各种师傅)\t\t \n  @崔超杰 你大喊三声疯狗万岁 立马普通白帽子     \n     2015-03-12 21:37 |    \t\t崔超杰 \t\t\t( 普通白帽子  |\t\t\t        Rank:192 漏洞数:53        | 知仙)\t\t \n  @麦香浓郁 好吧，作为新人的我应该多观察少说话    \n     2015-03-12 22:56 |    \t\torange \t\t\t( 普通白帽子  |\t\t\t        Rank:185 漏洞数:38        | 戒骄戒躁。)\t\t \n  @崔超杰 100rank    \n     2015-03-12 22:58 |    \t\t崔超杰 \t\t\t( 普通白帽子  |\t\t\t        Rank:192 漏洞数:53        | 知仙)\t\t \n  @orange 10个漏洞提交    \n     2015-04-26 20:37 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  坚持精神    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}