{"id": 58522, "wybug_id": "wooyun-2014-050921", "wybug_title": "佳品网两处平行权限漏洞", "wybug_corp": "佳品网", "wybug_author": "niliu", "wybug_date": "2014-02-14 12:07", "wybug_open_date": "2014-03-31 12:08", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "越权操作", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-31：\t细节向公众公开  简要描述： 再来一发... 详细说明：  问题出现在3g.jiapin.com可越权删除他人收藏商品。首先我登陆用户1：tang，随便收藏一个商品，firebug看一下删除商品收藏id，219885。\n\n截获一下删除请求\nPOST /myinfo/ajaxdelfav HTTP/1.1Host: 3g.jiapin.comUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; zh-CN; rv:1.9.2.8) Gecko/20100722 Firefox/3.6.8Accept: */*Accept-Language: zh-cn,zh;q=0.5Accept-Encoding: gzip,deflateAccept-Charset: GB2312,utf-8;q=0.7,*;q=0.7Keep-Alive: 115Proxy-Connection: keep-aliveContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://3g.jiapin.com/myinfo/mycollectContent-Length: 13Cookie: __utmPragma: no-cacheCache-Control: no-cachefav_id=219885\n然后登陆账号2：cao，看一下收藏商品id。219886\n\n把请求里的fav_id替换成账号2（cao）的219886并发包\n\n\\u5220\\u9664\\u6210\\u529f 转码 删除成功\n\n然后回到用户cao的收藏中看一下\n\n已经删除了。。。这里如果我对fav_id从1-219887遍历一遍，就可以把所有用户收藏的商品清空！这里只是举个例子测试了一下，并没有恶意删除。第二处：未对订单信息做权限判断，导致可以遍历他人订单信息用户cao登陆，下单查看一下订单信息\nhttp://3g.jiapin.com/orders/getorderinfo?order_id=V313571140214111419\n\n\n再登陆tang的账号，看一下订单信息，记录下订单号。\n\n订单号：V47427140214112206测试发现，47427为用户id，140214为当天日期年月日，112206为下单时间时分秒。直接用cao的账号刚问这个tang的订单信息是可以越权访问的。\nhttp://3g.jiapin.com/orders/getorderinfo?order_id=V47427140214112206\n\n\n这个订单号获取比较难，可以对id进行遍历，也可以对日期进行遍历猜解。太麻烦所以利用难度高危害低。就提一下吧。   漏洞证明：  上面   修复方案：  佳品网的小伙伴们双节快乐啊~ ：）   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-02-17 10:49 厂商回复： 谢啦，谢啦 最新状态： 2014-02-18：礼物已发出，请确认，再次感谢，希望更多关注佳品网！ 2014-02-19：已经修复，感谢，请再次关注佳品网  ", "replys": "漏洞评价：\n评论\n     2014-02-14 12:20 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @xsser @疯狗 @Finger 怎么小厂商了... 这可是第一次越权。。    \n     2014-02-14 12:29 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @niliu 来顶一下    \n     2014-02-14 12:31 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @xsser @疯狗 @Finger 又添加了一处越权，帮忙审核一下，顺便改下别小厂商啦：）    \n     2014-02-14 12:31 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @小川 哈哈，第一次就悲剧了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}