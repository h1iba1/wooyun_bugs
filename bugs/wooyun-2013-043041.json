{"id": 7062, "wybug_id": "wooyun-2013-043041", "wybug_title": "PHPCMS 2008 后台死限制Getshell的另类方法", "wybug_corp": "phpcms", "wybug_author": "AC_TEAM", "wybug_date": "2013-11-16 20:04", "wybug_open_date": "2013-12-31 20:05", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-31：\t细节向公众公开  简要描述： PHPCMS 2008 网上的那些后台getshell方法都不可用的时候，还有一个逻辑设计错误。导致后台直接getshell，还不会报错。getshell的方式完全不影响源程序的正常运作。 详细说明：  偶然得到某站点的后台帐号密码，看到站点为PHPCMS2008，按照常规方法进行getshell。发现常规的getshell方法已被禁用，百度一下另类PHPCMS2008的getshell方法，发现此站点的限制很死，已经不能按照网上的方法来进行取shell。另类的PHPCMS2008后台getshell的猥琐手法开始了。（本次演示用本地站点进行操作）PHPCMS2008版本为SP4全补丁关闭了 ACTION_TEMPLATE （在线编辑模板） 搜索木马：\n\n搜索到任意php文件：网上的getshell方法都是 查看然后可以直接修改的。可是这个版本没有修改按钮。所有不能按照网上的方法。。看到下面有一个批量替换。亮瞎了。\n\n勾选一个文件。替换一句话内容进去。额。我实战的时候发现是有安全狗的。很多一句话不过。报错。替换一句话的位置不对。也报错。你懂的。菜刀连之。。。\n\n虽然都是修改，官方的不科学啊。禁止了直接修改按钮。却出现了一个批量替换。还可以勾选替换文件的内容。   漏洞证明：  \n\n   修复方案：  逻辑设计问题。大神比我懂。   版权声明：转载请注明来源 AC_TEAM@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-11-18 16:43 厂商回复： 已收到！2008问题比较多，用户可以通过修改后台路径防止登陆后台！！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-06 12:30 |    \t\t扁扁 \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:11        | 就你事多！)\t\t \n  挺好用的    \n     2014-01-07 11:52 |    \t\tAC_TEAM \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:2        | 专注社工三十年)\t\t \n  @扁扁 留个联系方式。一起探讨好么    \n     2014-04-18 15:36 |    \t\tevil_webshell \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 致力于web层面的安全，热爱黑客技术，正在...)\t\t \n  看来问题是比较多，都只能用修改后台地址的方法来实现了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}