{"id": 61243, "wybug_id": "wooyun-2013-040338", "wybug_title": "chshcms 程氏CMS V3.0 注射（已在官方演示站测试）", "wybug_corp": "chshcms.com", "wybug_author": "lxj616", "wybug_date": "2013-10-22 18:49", "wybug_open_date": "2014-01-20 18:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "注射漏洞利用技巧", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-12-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-20：\t细节向公众公开  简要描述： chshcms 程氏CMS V3.0 注射（已在官方演示站测试）图片中演示站为http://www.dj221.com 详细说明：  /user/do.php\nfunction TOPIC(){        if(isset($_COOKIE[\"cs_name\"])){\t   $cscms_name=$_COOKIE[\"cs_name\"];\t}else{\t   exit(Msg_Error('你还没有登入或者登入已经超时!','login.php'));\t}\t$op=CS_Request(\"op\");       //使用安全的CS_request addslash\t...省略无关代码若干        }elseif($op=='zjadd'){\t    $tid=CS_Request(\"tid\"); //使用安全的CS_request addslash\t    $id=trim($_GET[\"id\"]);  //呵呵呵，曲项向天歌，CS_Request哭了                                    //下面直接就进查询语句了               if($db->query(\"update \".Getdbname('dance').\" set CS_TID=\".$tid.\" where cs_user='\".$cscms_name.\"' and CS_ID in (\".$id.\")\")){\t            exit(Msg_Error('恭喜您，加入成功了!','javascript:history.go(-1);'));               }else               ………省略以下无关代码………        }}\n建议全面审查代码，严格按照安全结构开发代码下面用官方演示站点进行证明   漏洞证明：  由于注射点在个人中心里，因此需要注册一下\n\n\nhttp://www.dj221.com/user/space.php?ac=topic&op=zjadd&tid=3118&id=2\n请注意我创建了一个专辑，因为注射点在专辑那里，id=2请自行修改为自己的值在Havij里设置cookie（必须）\n\n注射开始吧\n\n   修复方案：  $tid=CS_Request(\"tid\"); //使用安全的CS_request addslash $id=trim($_GET[\"id\"]);  //别这么写，这样不好建议将所有有GET的地方全用CS_Request   版权声明：转载请注明来源 lxj616@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-10-22 21:26 厂商回复： 非常感谢提醒，已经修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-16 18:06 |    \t\t乌云 \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:14        | a)\t\t \n  学习    \n     2014-12-04 23:40 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  我很好奇你怎么知道这个文件用在个人中心的    \n     2014-12-13 02:56 |    \t\t叮咚叮咚 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 热爱生活，热爱技术)\t\t \n  $tid=CS_Request(\"tid\"); //使用安全的CS_request addslash$id=trim($_GET[\"id\"]);太大意了吧、、    \n     2014-12-30 17:18 |    \t\tsky \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:33        | 有一天，我带着儿子@jeary 去@园长 的园长...)\t\t \n  ..想问下你的 tid 是怎么获得的？    \n     2015-02-07 22:36 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  @Mosuan chschcms的user文件夹就是对应用户中心    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}