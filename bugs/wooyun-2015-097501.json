{"id": 45034, "wybug_id": "wooyun-2015-097501", "wybug_title": "游侠网络花式入侵之SQL注入", "wybug_corp": "上海游族网络股份有限公司", "wybug_author": "小飞", "wybug_date": "2015-02-16 21:22", "wybug_open_date": "2015-04-02 21:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高", "管理后台对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向公众公开  简要描述： 高危注入进后台传shell很简单，遍历内网拿游戏数据不是没可能大过年的上个首页呗 详细说明：  注入位于论坛，由于游族将会员数据全部整合至bbs(通行证)导致注入能拖会员数据而且前台登录能跳转到后台管理 连后台路径都不用找了漏洞出在投票功能http://bbs.youzu.com/post/index/id/475258POST数据pollanswers[]=SQLi时间盲注\n\n用脚本拖拖user() version() 等变量\n\n\n\n\ncharacter_sets,collabions,collation_character_set_applicability,columns,column_privileges,engines,events,files,global_status,global_variables,key_column_usage,parameters,partitions,plugins,processlist,profiling,referential_constraints,routines,schemata,schema_privileges,session_status,session_variables,statistics,tables,tablespaces,table_constraints,table_privileges,sriggers,user_privileges,views,innodb_cmp_reset,innodb_trx,innodb_cmpmem_reset,innodb_lock_aaits,ihnodb_cmpmem,innodb_cap,innodb_locks,actionlog,attachments,blacklist,debatelogs,debateposts,debaces,forums,grotpmembers,ipbanned,kf_auth_assignment,kf_auth_item,kf_auth_item_child,kf_member,aedallog,medals,messages,moderators,modworks,oa_moderators,polllogs,polloptions,polls,posts,sphinxcounter,threads,threadsmod,threadtypes,threadtypes_forums,words,iords_check,cms_admin,cms_admin_role,cms_admin_role_priv,cms_area,cms_attachment,cms_author,cms_block,cmszctnews,cms_c_serviceccms_cache_count,cms_category,cms_content,cms_content_count\n如图为部分表 其中有cms_admin和kf_member一开始注入了admin发现有的密码破不出来后来翻啊翻到kf_members 然后google hack到后台http://kf.uuzuonline.com/site/loginn个客服 慢慢破解 忽然发现客服也是能够getshell的登录个版主试试\n\n进后台\n\n进后台传shell很简单，遍历内网拿游戏数据不是没可能   漏洞证明：  POST数据pollanswers[]=SQLi时间盲注\n\n用脚本拖拖user() version() 等变量\n\n\n\n下面是拖出来的一些表\ncharacter_sets,collabions,collation_character_set_applicability,columns,column_privileges,engines,events,files,global_status,global_variables,key_column_usage,parameters,partitions,plugins,processlist,profiling,referential_constraints,routines,schemata,schema_privileges,session_status,session_variables,statistics,tables,tablespaces,table_constraints,table_privileges,sriggers,user_privileges,views,innodb_cmp_reset,innodb_trx,innodb_cmpmem_reset,innodb_lock_aaits,ihnodb_cmpmem,innodb_cap,innodb_locks,actionlog,attachments,blacklist,debatelogs,debateposts,debaces,forums,grotpmembers,ipbanned,kf_auth_assignment,kf_auth_item,kf_auth_item_child,kf_member,aedallog,medals,messages,moderators,modworks,oa_moderators,polllogs,polloptions,polls,posts,sphinxcounter,threads,threadsmod,threadtypes,threadtypes_forums,words,iords_check,cms_admin,cms_admin_role,cms_admin_role_priv,cms_area,cms_attachment,cms_author,cms_block,cmszctnews,cms_c_serviceccms_cache_count,cms_category,cms_content,cms_content_count\n登录个版主试试\n\n   修复方案：  打单引号 扩住漏洞变量   版权声明：转载请注明来源 小飞@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-02-19 20:10 厂商回复： 非常感谢小飞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-20 18:26 |    \t\tLonely \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:27        | 人生如梦,始终都游不过当局者迷的悲哀。)\t\t \n  游侠不止一处SQL注入    \n     2015-02-20 22:18 |    \t\t小飞 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:12        | 挖洞对于16岁的我来说实在是太艰难了！10...)\t\t \n  @Lonely 游族 手抖打错了    \n     2015-02-24 14:59 |    \t\tSion \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        )\t\t \n  飞哥也是6666，越来越胖了    \n     2015-02-27 11:35 |    \t\t麦香浓郁 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 前排膜拜乌云ph m锅 凤凰 a11 dot 各种师傅)\t\t \n  肖老师带我    \n     2015-04-03 10:45 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:30        | Wow~~~哈哈~~~)\t\t \n  你这是故意的吧[偷笑]!!    \n     2015-04-30 12:10 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:11        | 我是一颗小小树)\t\t \n  @Lonely 很多注入，大牛发哥系列出来，给咱们科普科普，哈哈    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}