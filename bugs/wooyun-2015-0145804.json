{"id": 65931, "wybug_id": "wooyun-2015-0145804", "wybug_title": "九阳智能豆浆机设备设计不当存在安全隐患可被远程控制（有利用前提）", "wybug_corp": "joyoung.com", "wybug_author": "路人甲", "wybug_date": "2015-10-10 16:22", "wybug_open_date": "2015-10-15 16:24", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "认证设计不合理", "智能设备"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 九阳智能豆浆机设备设计不当，存在一定的安全隐患，可以被远程控制。 详细说明：  九阳豆浆机本身开放两个端口1. 80 端口开放 http 服务，需要 basic 认证；2. 8899 端口为 tcp 端口；对固件进行分析可能会更彻底些，通过如下两种途径都能够获取到固件1. 通过类似 http://api.joyoung.com:8089/ia/appfiles/2015/06/30/f66c88cd3d804f75b4ad9a191763fbe6.bin（该地址已经失效） 地址从官网获取固件；2. 拆机从 flash 中 dump 固件；通过 strings 和 ida 对固件进行分析，得到如下信息：1. 设备 WIFI 模块使用的是 Hi-Flying 的 HF-LPB100 解决方案2. HF-LPB100 提供 80 服务，默认用户名密码均为 admin，九阳修改为：Joyoung-IOT / jyyjy3. 8899 为 WIFI 模块的 tcp 调试端口，通过 Hi-Flying 提供的工具可以对 WIFI 模块远程调试4. 智能设备在云端认证的设备 id 是通过云端随机生成的，并且通过对设备端代码分析，没有对云端和用户端做任何权限控制通过以上信息可以知道九阳豆浆机设备存在的安全隐患为：1. 接入和豆浆机同一网络后可以通过 80 8899 端口对豆浆机进行任意操作PS：HF-LPB100 是通过 basic 认证的，并且有 csrf 漏洞，其实不用接入到豆浆机所在网络也能够进行攻击   漏洞证明：  我的设备目前已经被拆解了，之前没保留远程控制的图片，不过你们看漏洞描述应该就明白了。\n\n   修复方案：  1. 限制 80 8899 端口，尽量关闭   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-15 16:24 厂商回复：  漏洞Rank：8  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-10 16:28 |    \t\t我的邻居王婆婆 \t\t\t( 实习白帽子  |\t\t\t        Rank:100 漏洞数:31        | 我的邻居王婆婆发表了****漏洞)\t\t \n  正准备换一台，你是换了一台开始测试吗    \n     2015-10-10 16:40 |    \t\t撸管 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 别人笑我太猥琐,我笑着朝她猛颜射.[出乌云...)\t\t \n  实乃报复仇人的必备方法！我要入侵邻居家豆浆机让他喝半成品！！！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}