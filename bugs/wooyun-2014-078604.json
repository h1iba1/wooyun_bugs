{"id": 49452, "wybug_id": "wooyun-2014-078604", "wybug_title": "腾讯某论坛核心配置文件备份可下载导致敏感信息泄露", "wybug_corp": "腾讯", "wybug_author": "猪猪侠", "wybug_date": "2014-10-08 11:10", "wybug_open_date": "2014-11-22 11:10", "wybug_type": "服务弱口令", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-22：\t细节向公众公开  简要描述： 同样类似的问题，怎么补都补不完，补了又有，补了又有，而且数据库密码又是弱口令。。。http://security.tencent.com/index.php/blog/msg/68 详细说明：  \n网站: http://bbs.paipai.com 存在信息泄露:网址：http://bbs.paipai.com/config/config_global.php.bak\n\n\n   漏洞证明：  \n<?php$_config = array();// ----------------------------  CONFIG DB  ----------------------------- //$_config['db']['1']['dbhost'] = '10.**.**.222';$_config['db']['1']['dbuser'] = 'ppbbsdb';$_config['db']['1']['dbpw'] = 'ppbbsdb@db';$_config['db']['1']['dbcharset'] = 'gbk';$_config['db']['1']['pconnect'] = '0';$_config['db']['1']['dbname'] = 'ppbbs';$_config['db']['1']['tablepre'] = '';/************************************ begin ****************************************/// 数据库从服务器设置( slave, 只读 ), 支持多组服务器设置, 当设置多组服务器时, 系统每次随机使用$_config['db']['slave'] = array();$_config['db']['slave']['1']['dbhost'] = '10.**.**.143';$_config['db']['slave']['1']['dbuser'] = 'ppbbsdb';$_config['db']['slave']['1']['dbpw'] = 'ppbbsdb@db';$_config['db']['slave']['1']['dbcharset'] = 'gbk';$_config['db']['slave']['1']['pconnect'] = '0';$_config['db']['slave']['1']['dbname'] = 'ppbbs';$_config['db']['slave']['1']['tablepre'] = '';$_config['db']['slave']['2']['dbhost'] = '10.**.**.222';$_config['db']['slave']['2']['dbuser'] = 'ppbbsdb';$_config['db']['slave']['2']['dbpw'] = 'ppbbsdb@db';$_config['db']['slave']['2']['dbcharset'] = 'gbk';$_config['db']['slave']['2']['pconnect'] = '0';$_config['db']['slave']['2']['dbname'] = 'ppbbs';$_config['db']['slave']['2']['tablepre'] = '';/* 2014-1-7 取消对10.**.**.235的读操作$_config['db']['slave']['3']['dbhost'] = '10.**.**.235';$_config['db']['slave']['3']['dbuser'] = 'ppbbsdb';$_config['db']['slave']['3']['dbpw'] = 'ppbbsdb@db';$_config['db']['slave']['3']['dbcharset'] = 'gbk';$_config['db']['slave']['3']['pconnect'] = '0';$_config['db']['slave']['3']['dbname'] = 'ppbbs';$_config['db']['slave']['3']['tablepre'] = '';*//** * paipai, zhuxun. 手动启用还是自动启用从库的开关 * 0 => 不使用从库; * 1 => 自动使用从库; * 2 => 手动使用从库; */$_config['db']['slaveswitch'] = 1;/** * 数据库 分布部署策略设置 * * @example 将 common_member 部署到第二服务器, common_session 部署在第三服务器, 则设置为 * $_config['db']['map']['common_member'] = 2; * $_config['db']['map']['common_session'] = 3; * * 对于没有明确声明服务器的表, 则一律默认部署在第一服务器上 * */$_config['db']['map'] = array();/** * 数据库 公共设置, 此类设置通常对针对每个部署的服务器 */$_config['db']['common'] = array();/** *  禁用从数据库的数据表, 表名字之间使用逗号分割 * * @example common_session, common_member 这两个表仅从主服务器读写, 不使用从服务器 * $_config['db']['common']['slave_except_table'] = 'common_session, common_member'; * */$_config['db']['common']['slave_except_table'] = '';/****************************** end ********************************/// --------------------------  CONFIG MEMORY  --------------------------- ////10.**.**.81,172.**.**.144,10.**.**.117$_config['memory']['prefix'] = 'jjXlau_';$_config['memory']['eaccelerator'] = 0;$_config['memory']['xcache'] = 0;$_config['memory']['memcache']['server']['1'] = '10.**.**.81';$_config['memory']['memcache']['port']['1'] = 11383;$_config['memory']['memcache']['pconnect']['1'] = 1;$_config['memory']['memcache']['timeout']['1'] = 1;$_config['memory']['memcache']['server']['2'] = '172.**.**.144';$_config['memory']['memcache']['port']['2'] = 11383;$_config['memory']['memcache']['pconnect']['2'] = 1;$_config['memory']['memcache']['timeout']['2'] = 1;$_config['memory']['memcache']['server']['3'] = '10.**.**.117';$_config['memory']['memcache']['port']['3'] = 11383;$_config['memory']['memcache']['pconnect']['3'] = 1;$_config['memory']['memcache']['timeout']['3'] = 1;// --------------------------  CONFIG SERVER  --------------------------- //$_config['server']['id'] = 1;// -------------------------  CONFIG DOWNLOAD  -------------------------- //$_config['download']['readmod'] = 2;$_config['download']['xsendfile']['type'] = '0';$_config['download']['xsendfile']['dir'] = '/down/';// ---------------------------  CONFIG CACHE  --------------------------- //$_config['cache']['type'] = 'sql';// --------------------------  CONFIG OUTPUT  --------------------------- //$_config['output']['charset'] = 'gbk';$_config['output']['forceheader'] = 1;$_config['output']['gzip'] = '0';$_config['output']['tplrefresh'] = 1;$_config['output']['language'] = 'zh_cn';$_config['output']['staticurl'] = 'http://static.paipaiimg.com/dz/';$_config['output']['ajaxvalidate'] = '0';// --------------------------  CONFIG COOKIE  --------------------------- //$_config['cookie']['cookiepre'] = 'tD1v_';$_config['cookie']['cookiedomain'] = '';$_config['cookie']['cookiepath'] = '/';// -------------------------  CONFIG SECURITY  -------------------------- //$_config['security']['authkey'] = '512b45sO****lMn6';$_config['security']['urlxssdefend'] = 1;$_config['security']['attackevasive'] = '0';$_config['security']['querysafe']['status'] = 1;$_config['security']['querysafe']['dfunction']['0'] = 'load_file';$_config['security']['querysafe']['dfunction']['1'] = 'hex';$_config['security']['querysafe']['dfunction']['2'] = 'substring';$_config['security']['querysafe']['dfunction']['3'] = 'if';$_config['security']['querysafe']['dfunction']['4'] = 'ord';$_config['security']['querysafe']['dfunction']['5'] = 'char';$_config['security']['querysafe']['daction']['0'] = 'intooutfile';$_config['security']['querysafe']['daction']['1'] = 'intodumpfile';$_config['security']['querysafe']['daction']['2'] = 'unionselect';$_config['security']['querysafe']['daction']['3'] = '(select';$_config['security']['querysafe']['daction'][] = 'unionall';$_config['security']['querysafe']['daction'][] = 'uniondistinct';$_config['security']['querysafe']['daction']['6'] = '@';$_config['security']['querysafe']['dnote']['0'] = '/*';$_config['security']['querysafe']['dnote']['1'] = '*/';$_config['security']['querysafe']['dnote']['2'] = '#';$_config['security']['querysafe']['dnote']['3'] = '--';$_config['security']['querysafe']['dnote']['4'] = '\"';$_config['security']['querysafe']['dlikehex'] = 1;$_config['security']['querysafe']['afullnote'] = 1;// --------------------------  CONFIG ADMINCP  -------------------------- //// -------- Founders: $_config['admincp']['founder'] = '1,2,3'; --------- //$_config['admincp']['founder'] = '123009415,518800120,171550539,86189013,55320364,518810171,518800254,518800362,43725553,518800214,305595435';$_config['admincp']['forcesecques'] = '0';$_config['admincp']['checkip'] = 1;$_config['admincp']['runquery'] = 1;$_config['admincp']['dbimport'] = 1;// --------------------------  CONFIG PUBSWITCH  -------------------------- ////note 是否开启积分统计$_config['pubclose']['statcredit'] = 1;//$_config['pubclose']['reupdateposts'] = 1;$_config['paipai']['api']['ip'] = array('172.23.155.72','10.130.0.100','172.23.155.87','172.23.28.145','172.23.28.232','172.23.28.233','172.27.28.147','172.27.28.148');define('CSSCACHECDN', 'http://static.paipaiimg.com/dz/');//note 在这之前的帖子 htmlon 状态只看帖子中的标记$_config['pubclose']['htmlonfrompost'] = '2011-01-01 00:00:00';// -------------------  THE END  -------------------- //?>\n   修复方案：     版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-10-08 11:42 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 2014-10-08：感谢反馈，此漏洞已修复。paipai业务已归属于京东，后续paipai的安全问题请直接反馈给京东。  ", "replys": "漏洞评价：\n评论\n     2014-10-08 11:56 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  mark    \n     2014-10-08 12:04 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  全过程见入侵者的自述：又一次失败的漫游腾讯内网过程 。虽然被黑了有点脸上无光，不过连经验丰富的猪猪侠都说“腾讯在PHP安全领域的防护实力，当属国内第一”，这点还是很让人欣慰。    \n     2014-10-08 12:28 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  嗯，这评价不错    \n     2014-10-08 12:31 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  弱口令容易寄    \n     2014-10-08 12:54 |    \t\tKnight \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:10        | 刚刚上洗手间，看到一个玉树临风的少年，气...)\t\t \n  猪哥刷腾讯漏洞刷烦了的样子。    \n     2014-10-08 13:11 |    \t\tNoxxx \t\t\t( 普通白帽子  |\t\t\t        Rank:509 漏洞数:41        )\t\t \n  【对抗中成长：V的故事】 \t道哥在《中国黑客传说——游走在黑暗中的精灵》中描述了超级黑客V的故事。没错，今天的主角就是V。 \t笔者根据一些线索以及不愿意透露姓名的接近V的人士爆料推测，V在乌云上的ID叫猪猪侠。翻看猪猪侠在乌云提交过的漏洞，可以看出这是一个顶尖高手。继续爆料，他还有一个名字叫ring04h，很早就活跃在互联网安全圈了（不熟悉的同学可以百度一下这个关键字），很多年前ring04h就给我们提交过漏洞。 \t当然，以上只是基于福尔摩斯演绎法的推论，笔者不保证这个推论的正确性。    \n     2014-10-08 14:19 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  【对抗中成长：V的故事】 道哥在《中国黑客传说——游走在黑暗中的精灵》中描述了超级黑客V的故事。没错，今天的主角就是V。 笔者根据一些线索以及不愿意透露姓名的接近V的人士爆料推测，V在乌云上的ID叫猪猪侠。翻看猪猪侠在乌云提交过的漏洞，可以看出这是一个顶尖高手。继续爆料，他还有一个名字叫ring04h，很早就活跃在互联网安全圈了（不熟悉的同学可以百度一下这个关键字），很多年前ring04h就给我们提交过漏洞。 当然，以上只是基于福尔摩斯演绎法的推论，笔者不保证这个推论的正确性。    \n     2014-10-08 17:05 |    \t\tfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:664 漏洞数:79        | 想刷个6D)\t\t \n  哈哈，说是说，做是做    \n     2014-10-08 17:23 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  @猪猪侠 猪哥 ，楼上是说的真的吗？    \n     2014-10-08 18:12 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  猪哥只是个传奇，只能用演绎法推断。    \n     2014-10-08 19:14 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  【对抗中成长：V的故事】 道哥在《中国黑客传说——游走在黑暗中的精灵》中描述了超级黑客V的故事。没错，今天的主角就是V。 笔者根据一些线索以及不愿意透露姓名的接近V的人士爆料推测，V在乌云上的ID叫猪猪侠。翻看猪猪侠在乌云提交过的漏洞，可以看出这是一个顶尖高手。继续爆料，他还有一个名字叫ring04h，很早就活跃在互联网安全圈了（不熟悉的同学可以百度一下这个关键字），很多年前ring04h就给我们提交过漏洞。 当然，以上只是基于福尔摩斯演绎法的推论，笔者不保证这个推论的正确性。     \n     2014-10-08 19:45 |    \t\tgone \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 来学习的)\t\t \n  很早就知道ring04h...没想到是猪猪侠..    \n     2014-10-11 21:16 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  paipai已经和京东合并了？    \n     2014-10-11 22:38 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  @猪猪侠 猪哥厉害啊~    \n     2014-10-13 15:02 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  paipai业务已归属于京东，后续paipai的安全问题请直接反馈给京东。拍拍已经被卖了。。。    \n     2014-11-22 13:57 |    \t\t有点小鸡冻 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  给你一百块钱可以别挖洞了吗?    \n     2014-11-22 15:00 |    \t\t孤月寒城 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  全过程见入侵者的自述：又一次失败的漫游腾讯内网过程 。虽然被黑了有点脸上无光，不过连经验丰富的猪猪侠都说“腾讯在PHP安全领域的防护实力，当属国内第一”，这点还是很让人欣慰。     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}