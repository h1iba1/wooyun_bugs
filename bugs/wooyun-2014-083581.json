{"id": 43156, "wybug_id": "wooyun-2014-083581", "wybug_title": "汇文图书管理系统SQL注入", "wybug_corp": "libsys.com.cn", "wybug_author": "路人甲", "wybug_date": "2014-11-20 11:43", "wybug_open_date": "2014-12-30 14:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-25：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向公众公开  简要描述： 大量高校在使用该系统，测试了多个版本，都存在同样的问题。 详细说明：  看了下你们用户列表中的高校，基本上都用的是4.5或5.0版本的，都有同样的问题，找回密码处存在注入。\n\n#1  OPAC V4.5 测试站点：http://210.27.80.82/reader/redr_mail.php\n\n\n\n'or '1’=’1 时 和 ‘or ‘1’=’2 时返回不同，此处明显是存在注入的，是布尔型盲注。拿出sqlmap跑跑，居然告诉我不能注入，不科学啊。反复修改参数试了几次，还是只能时间盲注，看来有时候神器也不好使。时间盲注就时间盲注吧，也比我自己动手快，尝试跑了下数据。\nSqlmap -r 1.txt -p cert_id --dbms Oracle --level 3\n\n\n\n\n#2  OPAC V4.5 测试站点：http://opac.lib.ustc.edu.cn/reader/get_pwd.php\n\n此处就真的只能时间盲注了。\nSqlmap -r 2.txt -p cert_id --dbms Oracle --level 3 --technique T\n\n\n\n\n   漏洞证明：  测试过的其他案例：\nhttp://210.27.80.82/reader/redr_mail.phphttp://opac.niit.edu.cn/reader/get_pwd.phphttp://mylib.cau.edu.cn/reader/get_pwd.phphttp://opac.forestpolice.net/reader/get_pwd.phphttp://opac.jsafc.net/reader/redr_mail.phphttp://opac.lib.xjtlu.edu.cn/reader/redr_mail.phphttp://202.119.185.6/reader/redr_mail.php\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-30 14:44 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}