{"id": 66370, "wybug_id": "wooyun-2015-0128672", "wybug_title": "新为软件E-learning管理系统无需登录任意文件上传漏洞", "wybug_corp": "新为软件", "wybug_author": "路人甲", "wybug_date": "2015-07-25 17:05", "wybug_open_date": "2015-10-26 08:44", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传", "代码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-31：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向公众公开  简要描述： 无需登录，直接Getshell~ 详细说明：  新为软件E-learning系统。官方使用案例很多，有许多大企业和政府以及高校在使用。http://www.newv.com.cn/case_enterprise.html可以谷歌几个关键字：inurl:nwc_755_newvexam inurl:nwc_user_cloud inurl:nwc_user_enterpris这些关键字只能搜索到大众点的，有些有个性化定制的，修改了目录名字。\n\n\n\n\n\n审计了下代码，发现如下fileservice/FileUpload.aspx 文件。\n\n无任何限制上传，直接构造上传脚本上传任意文件。随手上传了几个。http://xuexuexue.nipponpaint.com.cn/pass.aspx passhttp://222.195.242.203/pass.aspx passhttp://chrysler.infolearning.so/pass.aspx pass \n\n\n\n   漏洞证明：  新为软件E-learning系统。官方使用案例很多，有许多大企业和政府以及高校在使用。http://www.newv.com.cn/case_enterprise.html可以谷歌几个关键字：inurl:nwc_755_newvexam inurl:nwc_user_cloud inurl:nwc_user_enterpris这些关键字只能搜索到大众点的，有些有个性化定制的，修改了目录名字。\n\n\n\n\n\n审计了下代码，发现如下fileservice/FileUpload.aspx 文件。\n\n无任何限制上传，直接构造上传脚本上传任意文件。随手上传了几个。http://xuexuexue.nipponpaint.com.cn/pass.aspx passhttp://222.195.242.203/pass.aspx passhttp://chrysler.infolearning.so/pass.aspx pass \n\n\n\n   修复方案：  限制上传啊。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-07-28 08:42 厂商回复： CNVD确认所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件（和电话）通报，由其后续提供解决方案并协调相关用户单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-23 17:15 |    \t\tzeracker  \t\t\t( 普通白帽子  |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  用这套系统的 金融/政府/教育等行业的客户很多很多很多吧？  洞主能给个清单么    \n     2015-07-23 17:18 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1115 漏洞数:306        | 通　　　　　　　　　　　　　　　　　　　...)\t\t \n  @zeracker 据说360也在用 哈哈！ http://www.newv.com.cn/case_enterprise.html     \n     2015-07-23 17:19 |    \t\t闪电小子 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:5        | PKAV技术宅社区！---闪电小子！)\t\t \n  @zeracker 301又在调皮了。    \n     2015-07-24 10:43 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  @闪电小子 匿名狗！被我发现了！    \n     2015-07-24 10:43 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  @闪电小子 匿名狗！被楼上发现了！    \n     2015-07-24 10:47 |    \t\t闪电小子 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:5        | PKAV技术宅社区！---闪电小子！)\t\t \n  @only_guest 汪汪。。    \n     2015-10-26 15:07 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  这个类没继承权限设置的类吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}