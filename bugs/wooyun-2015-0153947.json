{"id": 81342, "wybug_id": "wooyun-2015-0153947", "wybug_title": "招行某漏洞可刷豹子号银行卡(且旧卡号依然可以支付与收款)", "wybug_corp": "招商银行", "wybug_author": "Slcio", "wybug_date": "2015-11-18 15:52", "wybug_open_date": "2015-11-25 09:00", "wybug_type": "账户体系控制不严", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 招商银行银行卡号随意刷，未做限制大量8A、9A尾号等你拿。。存50W三个月的用户才能订制后4位，我们可以订制后8位！！ 详细说明：  电子一卡通通过大众版，专业版，手机登陆。。。有一个升降级功能，可以无限刷好吗，通过Luhn算号出来，然后刷就可以了。。另外号码是一个月更换一次，但是实际测试是第二天就可以继续更换，所以认为计划任务跑设置错时间了。。。已经开发出插件刷号，写了vbs算号。利用工具发布在论坛中多数用户已经刷到号码。http://bbs.51credit.com/forum.php?mod=viewthread&tid=2315957\ncardnum = InputBox(\"请输入当前卡号：\")dim fso, fset fso = CreateObject(\"Scripting.FileSystemObject\")If IsNumeric(cardnum) = False Then    MsgBox \"请输入正确卡号！！\"    Wscript.QuitEnd IfIf Len(cardnum) = 16 Then    Dim sss(8000)    For i = 0 To 999        If Len(i) < 4 Then            s1 = \"00\" & i            s1 = Right(s1, 3)            sss(i) = s1 & 1111        End If    Next    For i = 0 To 999        If Len(i) < 4 Then            s1 = \"00\" & i            s1 = Right(s1, 3)            sss(1 & s1) = s1 & 2222        End If    Next        For i = 0 To 999        If Len(i) < 4 Then            s1 = \"00\" & i            s1 = Right(s1, 3)            sss(2 & s1) = s1 & 3333        End If    Next        For i = 0 To 999        If Len(i) < 4 Then            s1 = \"00\" & i            s1 = Right(s1, 3)            sss(3 & s1) = s1 & 5555        End If    Next        For i = 0 To 999        If Len(i) < 4 Then            s1 = \"00\" & i            s1 = Right(s1, 3)            sss(4 & s1) = s1 & 6666        End If    Next        For i = 0 To 999        If Len(i) < 4 Then            s1 = \"00\" & i            s1 = Right(s1, 3)            sss(5 & s1) = s1 & 7777        End If    Next        For i = 0 To 999        If Len(i) < 4 Then            s1 = \"00\" & i            s1 = Right(s1, 3)            sss(6 & s1) = s1 & 8888        End If    Next        For i = 0 To 999        If Len(i) < 4 Then            s1 = \"00\" & i            s1 = Right(s1, 3)            sss(7 & s1) = s1 & 9999        End If    Next        Set f = fso.CreateTextFile(\"./cardnum.txt\", True)        For n = 0 To 7999            newcard = Mid(cardnum, 1, 9) & sss(n)            If newcard >= cardnum then                s = Luhn_Test(newcard)                If s = 0 Then                    f.WriteLine strreverse(newcard)                End If            End If        Next    f.Close()Else    MsgBox \"请输入16位正确卡号！！\"    Wscript.QuitEnd IfFor i = 0 To 999    If Len(i) < 3 Then        s1 = \"00\" & i        s1 = Right(s1, 3)        sss(i) = s1 & 1111    End IfNextFunction Luhn_Test(cc)    cc = RevString(cc)    s1 = 0    s2 = 0    For i = 1 To Len(cc)        If i Mod 2 > 0 Then            s1 = s1 + CInt(Mid(cc, i, 1))        Else            tmp = CInt(Mid(cc, i, 1)) * 2            If tmp < 10 Then                s2 = s2 + tmp            Else                s2 = s2 + CInt(Right(CStr(tmp), 1)) + 1            End If        End If    Next    If Right(CStr(s1 + s2), 1) = \"0\" Then        Luhn_Test = \"0\"    Else        Luhn_Test = \"1\"    End IfEnd Function Function RevString(s)    For i = Len(s) To 1 Step -1        RevString = RevString & Mid(s, i, 1)    NextEnd Function\n\n\n我刷到的号码\n\n写的插件最开始试用按键精灵，然后是浏览器插件。。。本来一个月的更换期，实际是一天即可更换。。。。发漏洞时发现已经关闭了该功能，但是手机端未关闭，通过https://mobile.cmbchina.com/MobileHtml/Login/LoginA.aspx登陆依然可以刷号，登陆提示必须手机改user-agent 就行了chrome就支持模拟，新插件开发中。。   漏洞证明：  2.招商银行，电子一卡通如果更换过卡号是可以查询历史记录的。并且旧卡号可以用于支付与收款。。我用旧卡号绑定的其他第三方付款，还是可以支付费用！！会出现A帐户付款，扣B帐户的钱。。如果用户旧卡号泄露会造成风险！！新产品，新场景可能并没有考虑到吧。。。\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  加验证码，重新设置更换时间。。。   版权声明：转载请注明来源 Slcio@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-11-25 09:00 厂商回复：  漏洞Rank：2  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-11-18 15:55 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:76        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  老板，来一打9个8的卡，顺便帮我存50万。    \n     2015-11-18 16:00 |    \t\t浩天  \t\t\t( 核心白帽子 |\t\t\t        Rank:925 漏洞数:80        | 哈！躁起来！)\t\t \n  传说已有大量888888、666666的给配卡了，太帅了    \n     2015-11-18 16:10 |    \t\tSlcio \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        | 白帽)\t\t \n  @浩天 还有个招行关于一卡通的逻辑，或者说风控问题的洞，通过下。。    \n     2015-11-18 16:20 |    \t\tSlcio \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        | 白帽)\t\t \n  @浩天 亲。。还有个洞。。审核下。。标题有错别字帮改下。。。    \n     2015-11-18 16:20 |    \t\t浩天  \t\t\t( 核心白帽子 |\t\t\t        Rank:925 漏洞数:80        | 哈！躁起来！)\t\t \n  @Slcio 你有好多靓号吖    \n     2015-11-18 16:26 |    \t\tSlcio \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        | 白帽)\t\t \n  @浩天 写完插件，建群讨论。。最牛的地区码正好最后一位8加上后面8位8是9个8另外一个刷了8个8。。我也就玩下，刷了6个1制卡了    \n     2015-11-18 16:47 |    \t\tYang \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:105        | 作为菜鸟，大米手机摔破了怎么办？)\t\t \n  求帮刷6个222222 最主要帮我存222222    \n     2015-11-18 17:15 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1296 漏洞数:131        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  没明白是什么意思  是可以办 豹子号的卡还是用别人的卡?    \n     2015-11-18 18:53 |    \t\t红客十年 \t\t\t( 普通白帽子  |\t\t\t        Rank:376 漏洞数:76        | 去年离职富士康，回到家中上蓝翔，蓝翔毕业...)\t\t \n  洞主，来一打9个4的卡，顺便帮我存100万.    \n     2015-11-18 19:11 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:98        | The quiter you are,the more you're able ...)\t\t \n  如果利用这个漏洞的话，会触犯法律么 - -。如果是边缘，发财了啊 -     \n     2015-11-18 23:07 |    \t\tMujj \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:4        | 乌云指定IDC)\t\t \n  我有50万，求大哥帮我刷个8个9的    \n     2015-11-19 08:58 |    \t\tgodsec \t\t\t( 普通白帽子  |\t\t\t        Rank:251 漏洞数:39        | 不走小厂商,我们还是好朋友@乌云)\t\t \n  我有500万 给我刷一个8888888888888888    \n     2015-11-19 14:21 |    \t\tSlcio \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        | 白帽)\t\t \n  @godsec 500万就像要这么好的号，，做梦吧。。。800万才私行级别，你没个几万亿，银行不会鸟你的！    \n     2015-11-19 14:23 |    \t\tSlcio \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        | 白帽)\t\t \n  @Me_Fortune 有啥发财啊？卖卡号？？无任何盈利价值啊。。。    \n     2015-11-19 14:47 |    \t\tgodsec \t\t\t( 普通白帽子  |\t\t\t        Rank:251 漏洞数:39        | 不走小厂商,我们还是好朋友@乌云)\t\t \n  @Slcio 现在5位的QQ都得上万了,更别说银行连号了- -    \n     2015-11-19 16:19 |    \t\tSlcio \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        | 白帽)\t\t \n  @godsec 银行连号资源就像我说的一般就是日均50W在银行，就可以申请白金级别储蓄卡，然后有一项功能，订制卡号最后4未或者6位。前面是银联，银行，地区识别码是不能变的。。后面才是卡号，最后一位是效验码    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}