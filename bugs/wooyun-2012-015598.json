{"id": 15072, "wybug_id": "wooyun-2012-015598", "wybug_title": "杭州游趣网络（ACFUN）某分站代码执行导致可获得shell", "wybug_corp": "杭州游趣网络有限公司", "wybug_author": "txcbg", "wybug_date": "2012-12-04 15:03", "wybug_open_date": "2013-01-18 15:03", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-18：\t细节向公众公开  简要描述： 杭州游趣网络某分站代码执行导致可获得shell，并造成一些敏感信息的泄露。 详细说明：      杭州游趣网络wiki分站http://wiki.acfun.tv/存在IIS源码泄露及文件类型解析错误漏洞，注册用户后上传包含PHP代码的jpg文件，PHP代码成功执行。在图片中插入生成PHP一句话木马的PHP代码，获得shell。通过翻看服务器上的文件，获得了MySQL的root用户的密码，并成功登录了phpmyadmin，发现了可能是另一个分站http://dts.acfun.tv/的用户信息，导致信息泄露。    另外，在网站目录下还发现了两个比较有意思的文件，http://wiki.acfun.tv/1.txt和http://wiki.acfun.tv/qq.txt，猜测前面已经有别人拿到过网站的shell了。    没敢尝试提权。   漏洞证明：      访问http://wiki.acfun.tv/images/2/28/Acgirl-00002.png/1.php，发现解析漏洞存在。上传插入了<?php phpinfo();?>代码的图片文件Tu1.jpg，访问http://wiki.acfun.tv/images/0/0b/Tu1.jpg/1.php，发现插入的php代码被执行了，如图1。在图片文件中插入在当前目录下生成PHP一句话木马文件的PHP代码，访问http://wiki.acfun.tv/images/8/8d/12.jpg/1.php，生成shell文件jhihhfdtfr5uyfdfd.php，用lanker一句话PHP后门客户端连接http://wiki.acfun.tv/images/8/8d/jhihhfdtfr5uyfdfd.php，密码jkmgh，获得shell，如图2。在网站根目录下的backup-LocalSettings.php文件中发现了MySQL的root用户的密码，网站有phpmyadmin（http://wiki.acfun.tv/phpmyadmin/），直接登录进去，发现了可能是另一个分站http://dts.acfun.tv/的用户信息，如图3。\n\n\n\n\n\n   修复方案：  网站管理员懂的。   版权声明：转载请注明来源 txcbg@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2012-12-04 18:42 厂商回复： WIKI不属于ACFUN管辖范围，已向服务器管理员发出通知 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}