{"id": 31029, "wybug_id": "wooyun-2015-0115080", "wybug_title": "叉叉助手某管理后台SQL注入/源码泄露等安全漏洞", "wybug_corp": "xxzhushou.cn", "wybug_author": "mango", "wybug_date": "2015-05-20 10:46", "wybug_open_date": "2015-05-25 10:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 叉叉助手某管理后台SQL注入/源码泄露等安全漏洞 详细说明：   WooYun: 叉叉助手APP客户端xss盲打管理员(已入后台) 看这里 发现存在sql注入\nPOST /man/action/admin_action.php HTTP/1.1Content-Length: 192Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://125.88.168.100:9091/man/admin_login.phpCookie: PHPSESSID=rju5kba31k3qn5h0se2ih33na4Host: 125.88.168.100:9091Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoAccept: */*action=check_passwd&admin_pwd=1&admin_user_name=1&from=form\nadmin_user_name 参数问题\n\n\n\n   漏洞证明：  \n\n并且此战还存在.svn泄漏\n\n$DB_CONFIG = array(                'read' => array(                            array('dbms'     => 'mysql',                                  'host'     => '192.168.1.130',                                  'user'     => 'analytics',                                  'password' => 'xxanal123&*(',                                  'port'     => 3306,                                  'dbname'   => 'analytics',                                  'charset'  => 'utf8'                                 )                                //多个从库在这里填写                               ),                'write' => array(                            array('dbms'     => 'mysql',                                  'host'     => '192.168.1.130',                                  'user'     => 'analytics',                                  'password' => 'xxanal123&*(',                                  'port'     => 3306,                                  'dbname'   => 'analytics',                                  'charset'  => 'utf8'                                 )                                ),                'api_backend' => array(                            array('dbms'     => 'mysql',                                  'host'     => '192.168.1.131',                                  'user'     => 'testXXDb',                                  'password' => 'testXXDb123',                                  'port'     => 3306,                                  'dbname'   => 'testXXDb',                                  'charset'  => 'utf8'                                 )                                ),                'api_feedback' => array(                            array('dbms'     => 'mysql',                                  'host'     => '192.168.1.130',                                  'user'     => 'api_flamingo',                                  'password' => 'lad9Ad9@3^ladk*A',                                  'port'     => 3306,                                  'dbname'   => 'XXFeedBack',                                  'charset'  => 'utf8'                                 )                                ),                'analyticsUser' => array(                            array('dbms'     => 'mysql',                                  'host'     => '192.168.1.130',                                  'user'     => 'analytics',                                  'password' => 'xxanal123&*(',                                  'port'     => 3306,                                  'dbname'   => 'XXUser',                                  'charset'  => 'utf8'                                 )                                ),                'statistics' => array(                            array('dbms'     => 'mysql',                                  'host'     => '192.168.1.131',                                  'user'     => 'xxstatistics',                                  'password' => 'xxst123789',                                  'port'     => 3306,                                  'dbname'   => 'XXStatistics',                                  'charset'  => 'utf8'                                 )                                ),                'package' => array(                            array('dbms'     => 'mysql',                                  'host'     => '192.168.1.131',                                  'user'     => 'xxstatistics',                                  'password' => 'xxst123789',                                  'port'     => 3306,                                  'dbname'   => 'package',                                  'charset'  => 'utf8'                                 )                                ),                'eventlog' => array(                            array('dbms'     => 'mysql',                                  'host'     => '192.168.1.131',                                  'user'     => 'xxstatistics',                                  'password' => 'xxst123789',                                  'port'     => 3306,                                  'dbname'   => 'eventlog',                                  'charset'  => 'utf8',                                  'persistency'  => true                                 )                                ),                'bbs' => array(                            array('dbms'     => 'mysql',                                  'host'     => '192.168.1.131',                                  'user'     => 'xxbbs',                                  'password' => 'xxBbs789!3',                                  'port'     => 3306,                                  'dbname'   => 'XXBbs',                                  'charset'  => 'utf8',                                 )                                ),                'testUserWrite' => array(                    array('dbms'     => 'mysql',                        'host'     => 'localhost',                        'user'     => 'testXXUser',                        'password' => 'testXXUser123',                        'port'     => 3306,                        'dbname'   => 'testXXUser',                        'charset'  => 'utf8'                    ),                ),                'testGuopan' => array(                    array('dbms'     => 'mysql',                        'host'     => 'localhost',                        'user'     => 'testGuopan',                        'password' => 'testGp123@',                        'port'     => 3306,                        'dbname'   => 'testGuopan',                        'charset'  => 'utf8'                    ),                ),                //更多数据库在这里填写        );\t/////////////////////////////////////////////////////////////////////\t\t\t//缓存配置,  use_config 为0表示使用第一项配置,为1表示使用第2项\t$CACHE_CONFIG = array(\t\t'use_config' => 'memcache' ,\t\t'memcache'   => \t\t\tarray('type'     => 'memcache',\t\t\t  'server'   => array(//\t\t\t  \t\t\tarray('host' =>'server1', 'port' => '11211', 'weight' => '10'),\t\t\t  \t\t\tarray('host' =>'192.168.1.130', 'port' => '11211', 'weight' => '10')\t\t\t  \t\t\t),\t\t\t  'ttl'      => 7200,\t\t\t  'compress' => false,\t\t\t  ),\t\t'file'       =>\t\t\tarray('type'     => 'file',\t\t\t  'cache_dir'=> SYSDIR_CACHE . '/tmp/',\t\t\t  'ttl'      => 600,  \t\t\t  )\t\t\t  \t); \t/////////////////////////////////////////////////////////////////////\t\t \t/////////////////////////////////////////////////////////////////////\t\t\t//SESSION配置,  use_config 为0表示使用第一项配置,为1表示使用第2项\t$SESSION_CONFIG = array(\t\t'use_config' => 'memcache' ,\t\t'memcache'   => \t\t\tarray('type'     => 'memcache',\t\t\t  'save_path'    => 'tcp://192.168.1.130:11210',\t\t\t  'cache_expire' => 7200,  //minutes\t\t\t  ),\t\t\t\t\t'files'       =>\t\t\tarray('type'     => 'files',\t\t\t  'save_path'    => SYSDIR_CACHE . '/sessions/',\t\t\t  'cache_expire' => 180,  //minutes\t\t\t  )\t\t\t  \t);\t/////////////////////////////////////////////////////////////////////\t\t//REDIS配置 主要用于统计类的集合    $REDIS_CONFIG = array(        'write' => array(            array(                'host'  => '192.168.1.131',                'port'  => '6379',                'password' => '',            ),        ),        'read' => array(            array(                'host'  => '192.168.1.131',                'port'  => '6379',                'password' => '',            ),        ),        'api' => array(            array(                'host'  => '192.168.1.132',                'port'  => '6379',                'password' => '',            ),        ),        'testUser' => array(            array(                'host'  => '192.168.1.131',                'port'  => '6379',                'password' => '',            ),        ),        'user' => array(            array(                'host'  => '192.168.1.130',                'port'  => '6379',                'password' => '',            ),        ),        'testDm_level' => array(            array(                'host'  => '192.168.1.131',                'port'  => '6379',                'dbN'  => 1,                'password' => '',            ),        ),    );?>   修复方案：     版权声明：转载请注明来源 mango@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-25 10:48 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-20 22:29 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  http://wooyun.org/bugs/wooyun-2015-0115085这个也是你们的    \n     2015-05-23 09:28 |    \t\tj2ck3r \t\t\t( 普通白帽子  |\t\t\t        Rank:406 漏洞数:92        | 别关注我，跟你不熟。)\t\t \n  @mango 这个厂商的漏洞全都都是忽略 我擦    \n     2015-05-23 09:51 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @j2ck3r 没事~~乌云会补rank    \n     2015-05-23 12:10 |    \t\tj2ck3r \t\t\t( 普通白帽子  |\t\t\t        Rank:406 漏洞数:92        | 别关注我，跟你不熟。)\t\t \n  @mango 我从来都没见过忽略后给我补过rank    \n     2015-05-23 14:18 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @j2ck3r   上个月 就执行了    \n     2015-05-23 15:10 |    \t\tj2ck3r \t\t\t( 普通白帽子  |\t\t\t        Rank:406 漏洞数:92        | 别关注我，跟你不熟。)\t\t \n  @mango 为什么我没有得到补的rank    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}