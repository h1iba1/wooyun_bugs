{"id": 34137, "wybug_id": "wooyun-2015-0107137", "wybug_title": "苏宁易购Android客户端远程代码执行漏洞", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "ali", "wybug_date": "2015-04-16 17:00", "wybug_open_date": "2015-07-18 16:14", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-18：\t细节向公众公开  简要描述： 苏宁易购Android版存在远程代码执行漏洞 详细说明：  苏宁易购Android版导出2个js接口，可以导致远程代码执行漏洞   漏洞证明：  \n\n导出2个js接口：\nprotected void onCreate(Bundle arg4) {        super.onCreate(arg4);        this.setIsUseSliding(false);        this.setContentView(2130903250);        this.backToLastPage(((SuningEBuyActivity)this), false);        this.c();        this.b();        if(TextUtils.isEmpty(this.a)) {            this.displayToast(2131363958);            this.finish();        }        else {            if(this.a != null && (this.a.contains(\"mapp.suning.com/a.php\")) && (this.a.contains(\"pack=com.suning.mobile.ebuy\"))                    ) {                this.displayToast(2131364682);                this.startHomeActivity(\"com.suning.mobile.ebuy.tabChanedHome\");                this.finish();                return;            }            this.b(this.a);            this.l = this.findViewById(2131493929);            this.d = this.findViewById(2131494725);            this.d.a(((SuningEBuyActivity)this));            this.d.addJavascriptInterface(this, \"client\");            this.d.addJavascriptInterface(this, \"SNNativeClient\");            this.d.b(this.g);            this.d.c(this.k);            this.d.b(this.j);            if(!this.isLogin()) {                g.b(((Context)this), this.a);            }            boolean v1 = this.i;            String v2 = this.a;            String v0 = this.c == null ? \"\" : this.c;            this.a(v1, v2, v0);        }    }\n可通过外部输入恶意html导致远程代码执行攻击：\nprivate void b() {        Intent v0 = this.getIntent();        this.g = v0.getStringExtra(\"activityName\");        this.a = v0.getStringExtra(\"background\");        this.c = v0.getStringExtra(\"param\");        this.h = v0.getBooleanExtra(\"isShowTitle\", true);        this.i = v0.getBooleanExtra(\"isPost\", false);        this.j = v0.getBooleanExtra(\"isNeedClearTop\", true);        this.k = v0.getStringExtra(\"webview_source\");    }\n   修复方案：  addJavascriptInterface存在高危远程代码执行漏洞，应尽量避免使用，API 17中用@JavascriptInterface 代替addjavascriptInterface;移除系统webkit内置的危险接口searchBoxJavaBridge_,accessibility,accessibilityTraversal   版权声明：转载请注明来源 ali@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-04-19 16:13 厂商回复： 感谢提交，移动客户端问题较多，一并处理，谢谢。 最新状态： 2015-05-27：稍后送上苏宁易购200元礼品卡。 2015-06-08：请路人甲站内留下联系方式，以便发放礼品卡，谢谢。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}