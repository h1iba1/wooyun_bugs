{"id": 86853, "wybug_id": "wooyun-2016-0176999", "wybug_title": "金山KingGate防火墙远程任意命令执行（未授权到撸穿源代码）", "wybug_corp": "金山软件集团", "wybug_author": "老虎皮", "wybug_date": "2016-02-19 14:21", "wybug_open_date": "2016-05-19 15:20", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-04-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-19：\t细节向公众公开  简要描述： 无需登录，远程任意命令执行（root权限)，直接撸穿源代码，随意控制防火墙 详细说明：    无需登录，远程任意命令执行（root权限)，直接撸穿源代码，随意控制防火墙  该设计缺陷新旧版本的KingGate防火墙通杀 \n\n \n\n   具体案例参考http://**.**.**.**/bugs/wooyun-2013-0135128  ￥￥   通过测试发现该防火墙系统未授权访问，即所有页面均采用javascript跳转控制，如访问**.**.**.**/src/system/sysmanage.php（后台管理页面） \n\n    其中就js跳转 \n<script language=\"JavaScript\"><!--parent.parent.location.href='../../src/system/login.php';// --></script>\n  所以只要禁止跳转，我们就可以登录后台了。如何禁止跳转，如图 \n\n \n\n   我们就可以对整个后台进行了控制    在对后台测试中，发现的上传点都未办法执行，包括注入都已测试，没有发现  在偶然测试中，发现一枚远程命令执行 \n\n \n-rw-rw-rw- 1 root root 13654 Jan 24 2008 default.php -rw-rw-rw- 1 root root 3868 May 10 2015 default.tgz -rw-rw-rw- 1 root root 2859 Apr 11 2008 dhcp.php -rw-rw-rw- 1 root root 1888 May 10 2015 dhcp.tgz -rw-rw-rw- 1 root root 4316 May 10 2015 dhcp_dialog.php -rw-rw-rw- 1 root root 28785 Apr 11 2007 dialset.php drw-rw-rw- 2 root root 856 Jan 1 2000 get -rw-rw-rw- 1 root root 11528 Nov 12 2007 ipmac.php -rw-rw-rw- 1 root root 5510 Jun 13 2010 login.php -rw-rw-rw- 1 root root 1055 Mar 26 2007 logout.php -rw-rw-rw- 1 root root 3428 May 5 2008 modeset.php -rw-rw-rw- 1 root root 6561 May 24 2007 modifyuserperm.php -rw-rw-rw- 1 root root 6192 Feb 25 2008 netflow.php -rw-rw-rw- 1 root root 4451 Jan 24 2008 netmanage.php drw-rw-rw- 2 root root 1208 Jan 1 2000 post -rw-rw-rw- 1 root root 9168 Mar 26 2007 post_test.php -rw-rw-rw- 1 root root 3759 Jun 18 2008 remote_login.php -rw-rw-rw- 1 root root 17052 Jun 19 2008 snmp.php -rw------- 1 root root 0 Feb 19 13:23 sss -rw------- 1 root root 0 Feb 19 13:23 ssssss -rw------- 1 root root 0 Feb 19 13:22 ssssssssss -rw------- 1 root root 0 Feb 19 13:22 ssssssssssssss -rw-rw-rw- 1 root root 4296 Mar 21 2008 sysmanage.php -rw-rw-rw- 1 root root 1625 May 10 2015 sysmanage.tgz drw-rw-rw- 3 root root 136 Jan 1 2000 system_config drw-rw-rw- 2 root root 1208 Jan 1 2000 tab -rw-rw-rw- 1 root root 5185 Mar 31 2008 update.php -rw-rw-rw- 1 root root 2120 May 10 2015 update.tgz\n  案例一、  \n\n  案例二、 \n\n  案例三、\n\n   撸穿源代码 \n\n   附件中提供测试exp  其他案例请参考如下：**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.phphttps://**.**.**.**/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**/src/system/login.phphttps://**.**.**.**/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.phphttps://**.**.**.**/src/system/login.phphttps://**.**.**.**/src/system/login.phphttps://**.**.**.**/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**/src/system/login.phphttps://**.**.**.**/src/system/login.php**.**.**.**:8443/src/system/login.phphttps://**.**.**.**/src/system/login.phphttps://**.**.**.**/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**/src/system/login.phphttps://**.**.**.**/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**:8443/src/system/login.php**.**.**.**/src/system/login.php**.**.**.**:8443/src/system/login.php     漏洞证明：   \n\n \n\n   我们就可以对整个后台进行了控制    在对后台测试中，发现的上传点都未办法执行，包括注入都已测试，没有发现  在偶然测试中，发现一枚远程命令执行 \n\n \n-rw-rw-rw- 1 root root 13654 Jan 24 2008 default.php -rw-rw-rw- 1 root root 3868 May 10 2015 default.tgz -rw-rw-rw- 1 root root 2859 Apr 11 2008 dhcp.php -rw-rw-rw- 1 root root 1888 May 10 2015 dhcp.tgz -rw-rw-rw- 1 root root 4316 May 10 2015 dhcp_dialog.php -rw-rw-rw- 1 root root 28785 Apr 11 2007 dialset.php drw-rw-rw- 2 root root 856 Jan 1 2000 get -rw-rw-rw- 1 root root 11528 Nov 12 2007 ipmac.php -rw-rw-rw- 1 root root 5510 Jun 13 2010 login.php -rw-rw-rw- 1 root root 1055 Mar 26 2007 logout.php -rw-rw-rw- 1 root root 3428 May 5 2008 modeset.php -rw-rw-rw- 1 root root 6561 May 24 2007 modifyuserperm.php -rw-rw-rw- 1 root root 6192 Feb 25 2008 netflow.php -rw-rw-rw- 1 root root 4451 Jan 24 2008 netmanage.php drw-rw-rw- 2 root root 1208 Jan 1 2000 post -rw-rw-rw- 1 root root 9168 Mar 26 2007 post_test.php -rw-rw-rw- 1 root root 3759 Jun 18 2008 remote_login.php -rw-rw-rw- 1 root root 17052 Jun 19 2008 snmp.php -rw------- 1 root root 0 Feb 19 13:23 sss -rw------- 1 root root 0 Feb 19 13:23 ssssss -rw------- 1 root root 0 Feb 19 13:22 ssssssssss -rw------- 1 root root 0 Feb 19 13:22 ssssssssssssss -rw-rw-rw- 1 root root 4296 Mar 21 2008 sysmanage.php -rw-rw-rw- 1 root root 1625 May 10 2015 sysmanage.tgz drw-rw-rw- 3 root root 136 Jan 1 2000 system_config drw-rw-rw- 2 root root 1208 Jan 1 2000 tab -rw-rw-rw- 1 root root 5185 Mar 31 2008 update.php -rw-rw-rw- 1 root root 2120 May 10 2015 update.tgz\n  案例一、  \n\n  案例二、 \n\n  案例三、\n\n   撸穿源代码 \n\n   附件中提供测试exp   修复方案：     版权声明：转载请注明来源 老虎皮@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2016-02-19 15:11 厂商回复： 感谢对金山安全的关注，此设备是由原先深圳金山团队开发（目前设备已经停止更新与维护），并且为公开安全漏洞，很抱歉给大家造成不便 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-02-19 16:28 |    \t\t老虎皮 \t\t\t( 普通白帽子  |\t\t\t        Rank:296 漏洞数:49        | 我是一枚又萌又可爱的女汉子)\t\t \n  @金山软件集团   吹牛逼，这属于公开漏洞？ 你给我个地址？ 真不想吐槽你    \n     2016-02-24 16:49 |    \t\t欧尼酱 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:7        | 技术马马虎虎)\t\t \n  @老虎皮 666    \n     2016-03-03 13:55 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:337 漏洞数:112        | The quiter you are,the more you're able ...)\t\t \n  妹子？    \n     2016-03-03 14:34 |    \t\tsangfor.org \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:25        | 天下熙熙，皆为利来；天下攘攘，皆为利往...)\t\t \n  @老虎皮 直接公开吧    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}