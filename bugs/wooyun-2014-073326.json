{"id": 51796, "wybug_id": "wooyun-2014-073326", "wybug_title": "九贸网山东检验检疫局getshell+大量信息泄露", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "CoffeeSafe", "wybug_date": "2014-08-21 17:59", "wybug_open_date": "2014-10-05 18:00", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "补丁不及时"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向公众公开  简要描述：  九贸网山东检验检疫局getshell+大量信息泄露  详细说明：  九贸网山东检验检疫局getshell+大量信息泄露 涉及地址：9trade.cnciqflow.9trade.cnoriclass.9trade.cnconquery.9trade.cnciqcode.9trade.cn等旗下相关地址。包含内容：CIQ代码查询 通关单信息查询 报检单信息查询 集装箱登记 集装箱状态查询青岛产地证分类管理0x01:漏洞类型0x02:涉及信息0x03:权限执行0x04:小总结   漏洞证明：  0x01:漏洞类型：9trade.cn 站点存在struts2漏洞导致旗下所有站点以及查询接口受到影响\n\n0x02:涉及信息：\n<bean id=\"dataSource\"\t\tclass=\"com.mchange.v2.c3p0.ComboPooledDataSource\"\t\tdestroy-method=\"close\">\t\t<property name=\"driverClass\" value=\"com.mysql.jdbc.Driver\">\t\t</property>\t\t<property name=\"jdbcUrl\"\t\tvalue=\"jdbc:mysql://42.121.55.139:3306/ciqcode\">\t\t</property>\t\t<property name=\"user\" value=\"ciqtontuser\"></property>\t\t<property name=\"password\" value=\"ciqtontpwd\"></property>\t\t<property name=\"maxPoolSize\" value=\"15\"></property>\t\t<property name=\"minPoolSize\" value=\"1\"></property>\t\t<property name=\"initialPoolSize\" value=\"2\"></property>\t\t<property name=\"maxIdleTime\" value=\"60\"></property>\t\t</bean>\n\n<bean id=\"dataSource\"\t\tclass=\"org.apache.commons.dbcp.BasicDataSource\"\t\tdestroy-method=\"close\">\t\t<property name=\"driverClassName\"\t\t\tvalue=\"com.mysql.jdbc.Driver\">\t\t</property>\t\t<property name=\"url\"\t\t\tvalue=\"jdbc:mysql://127.0.0.1:3306/ciqcode\">\t\t</property>\t\t<property name=\"username\" value=\"ciqtontuser\"></property>\t\t<property name=\"password\" value=\"ciqtontpwd\"></property>\t\t<property name=\"maxActive\" value=\"15\"></property>\t\t<property name=\"maxIdle\" value=\"5\"></property>\t\t<property name=\"minIdle\" value=\"2\" />\t\t<property name=\"testOnBorrow\" value=\"true\"></property>\t\t<property name=\"validationQuery\" value=\"select now()\"></property>\n\n</bean>\t<!-- 娉ㄥ?浜?? -->\t<bean id=\"transactionManager\"\t\tclass=\"org.springframework.jdbc.datasource.DataSourceTransactionManager\">\t\t<property name=\"dataSource\">\t\t\t<ref bean=\"dataSource\" />\t\t</property>\t</bean>\t<!-- ?ㄦ敞瑙ｆ?瀹??浜??绠＄? -->\t<tx:annotation-driven transaction-manager=\"transactionManager\"\t\tproxy-target-class=\"true\" />\t<!-- ??疆Jdbc妯℃? -->\t<bean id=\"jdbcTemplate\"\t\tclass=\"org.springframework.jdbc.core.JdbcTemplate\">\t\t<property name=\"dataSource\">\t\t\t<ref bean=\"dataSource\" />\t\t</property>\t</bean>\t<bean id=\"dao\" abstract=\"true\">\t\t<property name=\"jdbcTemplate\">\t\t\t<ref bean=\"jdbcTemplate\" />\t\t</property>\t</bean>\t<!-- ??疆Dao -->\t<bean id=\"dataBaseImpl\" parent=\"dao\"\t\tclass=\"com.ninetowns.dao.BaseDaoImpl\">\t</bean>\t<!-- ??疆action -->\t<bean id=\"QueryBasicCodeAction\"\t\tclass=\"com.ninetowns.action.QueryBasicCodeAction\" scope=\"prototype\">\t\t<property name=\"dataBaseImpl\" ref=\"dataBaseImpl\"></property>\t</bean></beans>\n\n\n0x03:权限执行\n\n附url:http://ciqcode.9trade.cn/coffeesafe.txt   修复方案：  0x04:小总结修复方案：升级+配置涉及众多信息，虽未实施，但代码中体现的很清楚了！   版权声明：转载请注明来源 CoffeeSafe@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-08-26 10:17 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给山东分中心，由山东分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}