{"id": 56586, "wybug_id": "wooyun-2014-057240", "wybug_title": "西安交通大学抓包绕过前端验证注入POST参数进而完全控制服务器", "wybug_corp": "西安交通大学", "wybug_author": "Winnie", "wybug_date": "2014-04-16 10:49", "wybug_open_date": "2014-05-31 10:51", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "字符类型注射", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-31：\t细节向公众公开  简要描述： 应用采用前端验证用户输入，服务器端并未对POST参数进行严格过滤，因而可以通过抓取HTTP头信息、改头注入。注入后发现数据库是SQL Server,而且用户是SA，这下杯具了= = 详细说明：  问题站点：http://202.117.3.62该站点访问后自动跳转http://202.117.3.62:5002/Login/LoginPageForuserB.aspx?SchoolName=%u897F%u5B89%u4EA4%u901A%u5927%u5B66&LogoutURL=http://202.117.3.62:5002/Default.htm尝试注入\n\n发现前端js有检查，尝试抓取HTTP头修改绕过：\n\n发现注入点，顺便爆出数据库名：\n\n那就拿到sqlmap里面跑一跑吧，指定注入点后sqlmap探测出系统指纹：\n\n看到这儿我也吓了一跳。。= =这、、、懂的都懂了，就不再多说。遍历数据库所有数据遍历文件系统甚至控制系统服务、进程...顺便提一句，数据库的xp_cmdshell存储过程也没有删除，导致任意命令执行，最高权限已经取得，服务器可以完全被控制。据说这个站点很重要，里面有办公系统及大量真实数据，可能导致严重的隐私泄露事件，还是尽快修补吧。   漏洞证明：  如上所示。   修复方案：  1、过滤非法参数，或者预处理。2、不要使web应用直接用sa用户访问数据库，这将导致极大的安全隐患。降权运行。   版权声明：转载请注明来源 Winnie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2014-04-16 11:27 厂商回复： 已通知西交大处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}