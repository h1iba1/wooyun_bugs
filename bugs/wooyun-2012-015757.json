{"id": 14999, "wybug_id": "wooyun-2012-015757", "wybug_title": "深信服ssl vpn远程代码执行漏洞", "wybug_corp": "深信服", "wybug_author": "A.L", "wybug_date": "2012-12-08 15:39", "wybug_open_date": "2013-01-22 15:39", "wybug_type": "默认配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-02-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-22：\t细节向公众公开  简要描述： 深信服SSLVPN存在远程代码执行漏洞，可完全控制VPN服务器，并可以此为跳板对系统实施攻击. 详细说明：  基于php-cgi的设置在解析php文件查询字符串参数时存在缺陷，php-cgi接收查询字符串作为命令行参数，这些参数允许命令行开关如-s, -d或-c传递给php-cgi进程，可被利用泄露源代码或执行任意代码。深信服SSLVPN使用PHP-CGI进行CGI解析，其配置环境符合CVE-2012-1823的触发条件，此漏洞利用前提为开放管理端口1000。恶意攻击者可利用此问题对其实施攻击。   漏洞证明：  测试人员确认目标访问某VPN后台 http://url:1000/cgi-bin/php-cgi/html/redirect.php?-s\n\n使用攻击脚本直接写入一句话shell\n\n使用菜刀连接，root权限\n\n   修复方案：  厂商应该已经发现此问题，并进行了部分修改.   版权声明：转载请注明来源 A.L@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-12-12 18:34 厂商回复： 抱歉，回复晚了 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2012-12-13 16:52 |\t\t\t\t\tcncert国家互联网应急中心(乌云厂商)\t\t\t\t\t\t\t\n  @xsser @深信服 深信服公司，请跟北京公司联系，该漏洞详情以及CNCERT提供的metasploit测试脚本已经发送给北京公司了，当中包括两个实测案例，确认为通用衍生漏洞。CERT也是你们的用户，还好不是用的这个VPN版本，怕怕。    \n     2012-12-13 19:42 |\t\t\t\t\t深信服(乌云厂商)\t\t\t\t\t\t\t\n  该漏洞是已知漏洞，厂商已发布过补丁，最近几个版本的设备都不存在该问题。但漏洞本身确属高危，故依然确定为高等级漏洞，感谢A.L。    \n   \n \n     2012-12-08 19:40 |    \t\t句子 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:6        | ...)\t\t \n  o，my，god！    \n     2012-12-08 19:42 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @句子 怎么这么多只提交一个漏洞的帐号    \n     2012-12-08 21:07 |    \t\tcnbird \t\t\t( 普通白帽子  |\t\t\t        Rank:547 漏洞数:47        | http://blog.csdn.net/cnbird2008)\t\t \n  求漏洞细节，求A.L的联系方式    \n     2012-12-08 23:39 |    \t\thongygxiang \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:12        | 蛋疼)\t\t \n  坐等细节    \n     2012-12-09 05:03 |    \t\t冰锋刺客 \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:14        | 请在监护人陪同下与本人交流)\t\t \n  严重关注     \n     2012-12-09 15:03 |    \t\trootsecurity \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:20        | 关注开源，关注网络安全！INSERT INTO `w...)\t\t \n  坐等细节    \n     2012-12-09 18:39 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  坐等忽略~    \n     2012-12-10 14:24 |    \t\t深信服(乌云厂商)\t\t \n  火钳留名！坐等楼主的further infomation    \n     2012-12-10 14:37 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @深信服 这个问题不存在？    \n     2012-12-10 15:31 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @A.L 作者更新下详细信息吧    \n     2012-12-10 15:51 |    \t\t無情 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 根据相关法律法规和政策，此信息未予显示。)\t\t \n  细节就是，，，，   远程代码执行漏洞   ^_^    \n     2012-12-10 15:55 |    \t\t冷冷的夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:135 漏洞数:12        )\t\t \n  火前留名    \n     2012-12-10 17:03 |    \t\t深信服(乌云厂商)\t\t \n  @xsser 需要在准确环境复现。等等，还在同A.L私信。    \n     2012-12-10 17:13 |    \t\tA.L \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | 喜迎世界末日)\t\t \n  @深信服 晚上我会给你发详细的内容并更新详情。    \n     2012-12-11 23:11 |    \t\txiya \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  Mark.    \n     2012-12-13 16:49 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  这个漏洞影响危害还是比较严重的，12月13日下午，CNCERT已经直接联系深信服北京公司，A.L是CERT的那位同志？    \n     2012-12-13 16:52 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  @xsser @深信服 深信服公司，请跟北京公司联系，该漏洞详情以及CNCERT提供的metasploit测试脚本已经发送给北京公司了，当中包括两个实测案例，确认为通用衍生漏洞。CERT也是你们的用户，还好不是用的这个VPN版本，怕怕。    \n     2012-12-13 19:42 |    \t\t深信服(乌云厂商)\t\t \n  该漏洞是已知漏洞，厂商已发布过补丁，最近几个版本的设备都不存在该问题。但漏洞本身确属高危，故依然确定为高等级漏洞，感谢A.L。    \n     2012-12-14 08:41 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  咦，昨晚不是看到细节了么……    \n     2012-12-14 09:04 |    \t\t牛￡金钢 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        | 我是新手，还需要学习，大神们要指点下了.....)\t\t \n  对啊，昨天不是忽略了吗    \n     2012-12-14 09:12 |    \t\t深信服(乌云厂商)\t\t \n  @一刀终情 @牛￡金钢 白天一直不方便上乌云，没来得及确认。。    \n     2012-12-14 16:03 |    \t\t紫梦芊 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:9        | 踏踏实实做测试)\t\t \n  哎 深信服 不可信啊~还不如自己搭建个pptp    \n     2013-01-23 11:46 |    \t\t無情 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 根据相关法律法规和政策，此信息未予显示。)\t\t \n  传上去，，没有执行权限。。。  杯具。。    \n     2013-01-24 10:24 |    \t\t紫梦芊 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:9        | 踏踏实实做测试)\t\t \n  @無情  相关漏洞  WooYun: 深信服ssl vpn远程代码执行漏洞  深信服远程SHELL执行关于本漏洞 你可以远程包含那里加一句php的chmod     \n     2013-01-25 09:30 |    \t\t無情 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 根据相关法律法规和政策，此信息未予显示。)\t\t \n  @紫梦芊  ;thx ...    \n     2013-02-26 09:45 |    \t\t紫梦芊 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:9        | 踏踏实实做测试)\t\t \n  深信服 为什么总爱说 是已知漏洞 却不批量下发补丁。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}