{"id": 79780, "wybug_id": "wooyun-2015-0157359", "wybug_title": "东兴证券某管理系统SQL注入（system权限）", "wybug_corp": "东兴证券股份有限公司", "wybug_author": "路人甲", "wybug_date": "2015-12-01 19:11", "wybug_open_date": "2015-12-06 19:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 登录框，POST注入，mssql2008，xp_cmdshell可用，system权限。脱裤提权啥不能干？好了，我只说这些。 详细说明：  东兴证券的OA系统，登陆框，存在post注入。主站链接：http://www.dxzq.net/\n\nOA系统链接：http://oa.dxzq.net/c6/Jhsoft.Web.login/PassWordSlide.aspx\n\nOA管理登陆链接：http://oa.dxzq.net/C6/Jhsoft.mobileapp/login/login.html\n\nPOST注入。开始吧。登陆抓包：\n\n修改user和pwd参数如下图所示：\n\nok。上神器吧：\n\n可以看到是MSSQL22008，查看当前用户：\n\n查看当前是否为dba：\n\n查看数据库内容：\n\n查看数据库C6里的内容，发现有1360张表，水管小，不一一读了：\n\nMSSQL的数据库必须尝试下能不能调用xp_cmdshell，成功调用，执行\"whoami\"：\n\n行了。至此。脱裤，拿服务器，啥都能干了，还是OA系统。点到为止，不深入咯。厂商赶紧修复吧。   漏洞证明：  附赠修改后的可用POST包吧：\nPOST /C6/Jhsoft.mobileapp/login/CheckPwd.ashx HTTP/1.1Host: oa.dxzq.netContent-Length: 90Accept: */*Origin: http://oa.dxzq.netX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://oa.dxzq.net/C6/Jhsoft.mobileapp/login/login.htmlAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ASPSESSIONIDQQRSDCDT=ABOOCIBCPDNJNEBHEPDEMOKC; ASP.NET_SessionId=kxttbobusb5m2g45ynub35mh; pgv_pvi=2337883136; pgv_si=s9081551872; myie=false<root><User>admin</User><Pwd>123456</Pwd><type>login</type></root>\n   修复方案：  过滤。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-12-06 19:12 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 2016-01-09：已收到 2016-01-09：收到，勿公开  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}