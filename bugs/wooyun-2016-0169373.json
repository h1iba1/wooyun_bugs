{"id": 74443, "wybug_id": "wooyun-2016-0169373", "wybug_title": "某省IPTV服务器漏洞通过控制服务器可逐步控制机顶盒", "wybug_corp": "中国联通", "wybug_author": "路人甲", "wybug_date": "2016-01-12 18:22", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["补丁不及时", "远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述：  详细说明：  北京联通IPTV服务器Jboss反序列化漏洞漏洞起源URL **.**.**.**:8080/invoker/JMXInvokerServlet其他信息: (以下公网地址分别对应着内网地址)IPTV固件下载地址: (负载均衡)**.**.**.**/softVersion/**.**.**.**/softVersion/IPTV开机画面文件:**.**.**.**/launcher/data/内网地址和相关如下:\n#开机画面ftp服务器配置,上传时对应的目录为/usr/local/isimp/upgradefile/picVersionepg.ftp.server.ip=**.**.**.**,**.**.**.**,**.**.**.**,**.**.**.**epg.ftp.user.name=picitmsepg.ftp.password=picitms!@2014epg.ftp.server.port=21#上传文件根路径 不配置默认取\"jboss.server.home.dir\" 调试改为D:/之类#/usr/local/isimp/jboss-6.0.0.Final/server/defaultupload.rootpath=#版本文件路径version.rootpath=**.**.**.**/softVersionversion.picpath=**.**.**.**/picVersion\n该地址只能在联通家用宽带中访问,其他运营商不能访问.而且不能通过路由器访问,必须通过光猫直接访问,因为跟宽带不是同一个VLAN.   漏洞证明：  对IPTV机顶盒进行抓包,发现以下请求:\n\n对该地址进行深入分析,发现存在漏洞\n\nROOT权限,可以读shadow\n\n可执行任意命令,内网IP地址如下: \n\nGETSHELL\n\n简单的用FTP登陆系统,并替换开机画面的zip包,可以控制北京联通所有机顶盒的开机画面;---未做实际尝试,影响太大家用的机顶盒都是安卓系统,支持版本检查与升级,用于更新开机画面压缩包的FTP服务器和软件升级的FTP服务器被控制以后可以做很多事情.因此通过控制服务器,可逐步控制机顶盒   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-01-15 17:06 厂商回复： CNVD未复现所述情况，暂未列入处置流程。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-01 13:28 |    \t\t阿啸 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:15        | 小渣渣努力中。)\t\t \n  机顶盒如何抓包？求教    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}