{"id": 55685, "wybug_id": "wooyun-2014-060210", "wybug_title": "CSDJCMS 程式舞曲 绕过过滤注入两处 （demo 成功）", "wybug_corp": "chshcms.com", "wybug_author": "′雨。", "wybug_date": "2014-05-10 22:45", "wybug_open_date": "2014-08-08 22:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向公众公开  简要描述： 上个漏洞出事的是一个通用函数,所以造成了多个注入。然后这次厂商直接应该是直接修改了这函数的代码(我没看啊.猜测)。这次没看代码, 直接fuzz 绕过。应该来说 只要仔细找 肯定是不止这两处的,我只大概看了看 找到了这两处。 详细说明：  这次没看代码啊, 就没分析代码的了。 WooYun: CSDJCMS 程式舞曲 最新 Sql 一枚。 (无需登录,测试官网成功) 上个漏洞的地址http://demo.chshcms.com/index.php/open/bangopenid=x&username='&denglu=login&userpass=aaa这样再去测试一下厂商 发现已经不报错了。  应该是过滤了单引号, 测试一下转义符Error Number: 1064You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' or cs_email='\\'' at line 1SELECT CS_Pass,CS_SID,CS_ID,CS_Name,CS_LogNum,CS_Cion,CS_LogTime FROM cscms_user where cs_id='\\' or cs_name='\\' or cs_email='\\'这里有3个可控的, 但是这三个可控的都是一个变量的。 构造构造。_____________________________________________________________________第二处在user/login/add处。见漏洞证明。   漏洞证明：  \n\n再次成功绕过。第二处漏洞。\n\n   修复方案：  过滤。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-05-10 23:04 厂商回复： 真心感谢，已经修复~！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-10 23:13 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @程氏舞曲CMS  每次响应都很快,赞一个。    \n     2014-05-10 23:16 |    \t\t程氏舞曲CMS(乌云厂商)\t\t \n  @′  雨。 感谢你们，已经修复~    \n     2014-05-24 22:40 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @程氏舞曲CMS 确定修复了? 官网依旧成功。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}