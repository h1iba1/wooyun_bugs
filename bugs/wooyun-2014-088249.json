{"id": 45419, "wybug_id": "wooyun-2014-088249", "wybug_title": "某同志社交网站日志上传模块没有进行安全过滤", "wybug_corp": "feizan.com", "wybug_author": "kongkongyzt", "wybug_date": "2014-12-23 13:34", "wybug_open_date": "2015-03-23 13:36", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "4", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-23：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 某同志社交网站的日志上传模块没有对日志内存进行安全处理，导致可以插入<script>标签，远程执行js文件 详细说明：  1.飞赞的web端网站的发表新日志板块，发表一篇文章后，编辑该文章，通过chrome/Firefox修改content的内容，在其中添加<script>标签。\n\n2.点击提交，会发现<script>标签并未被转义，而是直接执行了，也就是说，可以使用script加载自己写的js脚本，当别人访问该页面的时候，触发js。利用这个就可以自由发挥了。自由发挥时间：1.首先，分析并找出飞赞中发动态和给别人发私信的接口。2.写一篇标题极具诱惑力的文章，然后在文章中插入两段js，一个是jquery，一个是自己写的js脚本，该脚本的作用一个是每当有人访问日志的时候，alert一个欢迎窗口（写着好玩的），另一个作用就是获得当前用户的cookie3.由于ajax有跨域的问题，使用jsonp的方式将访问用户的cookie传到放在SAE上的应用4.放在SAE上的该应用获得cookie后，将cookie存储在本地，并且利用该用户的cookie发表一条动态以及给某个随机用户发送私信，内容均为“这篇日志好神奇！！！ http://www.feizan.com/xxxxxxxxxx(该日志的地址)”，以吸引更多的人点击，进而造成更大范围内的传播   漏洞证明：  几个账号点击后自动发布信息的截图：\n\n\n\n\n\n\n\n部分人的cookie截图:\n\n用户的cookie被窃取的危害性大家都知道的   修复方案：  我只是一个大三学生，相信你们比我更专业   版权声明：转载请注明来源 kongkongyzt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-12-26 10:18 厂商回复： 感谢白帽子对本飞赞网的关注 最新状态： 2014-12-26：技术人员已修复该漏洞  ", "replys": "漏洞评价：\n评论\n     2014-12-23 09:55 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  凌绝顶    \n     2014-12-23 13:39 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @浩天 同性有关的漏洞总能看到你的名字：（    \n     2014-12-23 14:41 |    \t\tc4bbage \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:7        | var_dump($me);)\t\t \n  @浩天 同性有关的漏洞总能看到你的名字 XD    \n     2014-12-23 15:12 |    \t\t我是壮丁  \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 专业打酱油)\t\t \n  @浩天 同性有关的漏洞总能看到你的名字：（    \n     2014-12-26 10:39 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  祝楼上四位天长地久，恩恩爱爱！    \n     2014-12-26 11:21 |    \t\tsco4x0 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:13        | O_o)\t\t \n  祝楼上五位天长地久，恩恩爱爱！    \n     2015-03-24 09:05 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  我只是好奇楼主为什么去访问这个网站？楼上几位危险了，除了梧桐雨妹子 - -！ 楼下赶紧闪  哈哈    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}