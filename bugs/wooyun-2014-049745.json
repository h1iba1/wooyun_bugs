{"id": 58768, "wybug_id": "wooyun-2014-049745", "wybug_title": "BIWEB商城版XSS盲打cookie", "wybug_corp": "BIWEB", "wybug_author": "pandas", "wybug_date": "2014-02-18 17:06", "wybug_open_date": "2014-05-19 17:07", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-05-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某处存储型xss可盲打管理cookie 详细说明：  message\\include\\index.inc.php 文件26-36行（不止这一处）\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\"){\tif(empty($_POST['contact'])) check::AlertExit('对不起，姓名必须填写!',-1);\tif(empty($_POST['tel'])) check::AlertExit('对不起，联系电话必须填写!',-1);\tif(empty($_POST['email'])) check::AlertExit('对不起，E-Mail必须填写!',-1);\tif(empty($_POST['title'])) check::AlertExit('对不起，留言标题必须填写!',-1);\tif(empty($_POST['intro']))\tcheck::AlertExit('对不起，留言内容必须填写!!',-1);//只是简单判断了POST提交的数据是否为空\t$strIP = check::getip();\t$_POST['user_ip'] = $strIP;\t$objWebInit->saveInfo($_POST,0);//跟踪函数saveInfo\tcheck::AlertExit(\"\",$arrGWeb['WEB_ROOT_pre'].\"/message/\");}跟踪函数saveInfofunction saveInfo($arrData,$intModify=0,$isAlert=true){\t\t$arr = array();\t\t$arr = check::SqlInjection($this->saveTableFieldG($arrData));\t\tif($intModify == 0){\t\t\tif(!empty($_SESSION['user_id'])) $arr['user_id'] = intval($_SESSION['user_id']);//判断是否已经登录\t\t\tif($this->insertInfo($arr)){\t//入库了，没有任何过滤\t\t\t\tif($isAlert) check::Alert(\"发布成功，我们会尽快做出处理并告知您\",-1);\t\t\t\tcheck::AlertExit(\"\",$arrGWeb['WEB_ROOT_pre'].\"/message/\");\t\t\t}else{\t\t\t\tcheck::Alert(\"发布失败\",-1);;\t\t\t}\t\t}else{\t\t\tif($this->updateInfo($arr)){\t\t\t\tcheck::Alert(\"修改成功！\");\t\t\t}else{\t\t\t\tcheck::Alert(\"修改失败\");;\t\t\t}\t\t}\t}\n   漏洞证明：  都没有过滤，可以填入我们的xss code：\n\n管理员查看留言即触发xss代码\n\n   修复方案：  过滤   版权声明：转载请注明来源 pandas@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}