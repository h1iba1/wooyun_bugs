{"id": 8112, "wybug_id": "wooyun-2013-035194", "wybug_title": "Discuz! 再次绕过安全密码安装插件", "wybug_corp": "Discuz!", "wybug_author": "江南的鱼", "wybug_date": "2013-08-25 17:13", "wybug_open_date": "2013-11-23 17:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-10-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-23：\t细节向公众公开  简要描述： 第一版的绕过安全密码装插件：http://www.wooyun.org/bugs/wooyun-2013-032644第一版后台拿shell：利用插件拿Discuz!论坛shell的文章http://zone.wooyun.org/content/5275第二版：Discuz! 后台第三方插件上传任意后缀文件，拿shell， 还未审核今天谈的是第二版绕过安全密码装插件。 详细说明：  Discuz!应用中心，会员忘记密码找回，出现了逻辑问题，并没有验证URL是否为当前用户所有，从而造成了会员密码更改，继而安装插件，最终可后台拿webshell。利用条件： 自己有一个webshell 。原理：将下载的 校验文件 addonreset.txt 上传到自己 WEBSHELL的网站根目录， 网站URL里面写 webshell的目录，然后验证，然后更改密码，再然后用更改的密码安装插件！图解实现过程：1.登陆论坛后台，【应用】-->【应用中心】-->【 网站信息】-->【修改密码】\n\n2. 点击【忘记密码】,网站 URL: 写自己webshell的网址【或者自己的网站网址】，然后将校验文件 addonreset.txt，下载下来，放到webshell的根目录下\n\n3. 点击【校验】，会出现校验成功，这就是有意思的地方，没有对URL做任何判断。\n\n4. 输入我们自己的密码.\n\n5.来装个插件验证下.\n\n配合插件任意文件上传，完美拿shell！   漏洞证明：  \n\n成功更改安全密码   修复方案：  你们更专业   版权声明：转载请注明来源 江南的鱼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2013-08-26 09:49 厂商回复： 已经修复，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-12 16:36 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  我有shell了为什么还要装插件呢？    \n     2013-12-13 16:12 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  @乌帽子 是没说清楚，webshell是其他站 discuz 没判断url - -    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}