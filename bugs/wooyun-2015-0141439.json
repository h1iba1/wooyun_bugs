{"id": 66582, "wybug_id": "wooyun-2015-0141439", "wybug_title": "某漏洞可控制青松智慧多个域名解析(内部信息泄露)", "wybug_corp": "青松智慧", "wybug_author": "路人甲", "wybug_date": "2015-09-16 10:12", "wybug_open_date": "2015-10-31 10:14", "wybug_type": "网络敏感信息泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-10-31：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 青松创新的自助式SaaS平台可为企业快速部署DDoS云端防御，提供所见即所得的产品体验。未来青松将完全开放防御技术给更多的IDC服务商，全面提升IDC服务商抵御DDoS攻击的能力，为互联网企业提供更为灵活的一站式防御。 详细说明：  某位员工上传了内部代码:https://github.com/yeyingcai/soft/blob/d9cdf45598b778662e905e54e774832a4922914a/qssec_local_settings_product.py# -*- coding:utf8 -*-QS_MIND_DIR ='/usr/local/qs_mind'DEBUG = FalseADMINS = (    ('wuzuxin', 'wuzx@qssec.com'),    ('guanchao', 'guanchao@qssec.com'),    ('wangying', 'wangying@qssec.com'),    ('wangjiye', 'wangjy@qssec.com'),)DATABASES = {    'default': {        'ENGINE': 'django.db.backends.mysql',        'NAME': 'qingsong_db',        'USER': 'hera',        'PASSWORD': 'A73B3CAF848BF3**',        'HOST': '139.217.3.127',        'PORT': '3306',    },    'admin': {        'ENGINE': 'django.db.backends.mysql',        'NAME': 'admin_db',        'USER': 'hera',        'PASSWORD': 'A73B3CAF848BF3**',        'HOST': '139.217.3.127',        'PORT': '3306',    }}# 设置session过期行为和时间：（浏览器关闭即session过期，过期时间设定为30分钟）SESSION_SAVE_EVERY_REQUEST = True      # 每次请求会更新sessions有效期限SESSION_EXPIRE_AT_BROWSER_CLOSE = TrueSESSION_COOKIE_AGE = 60 * 30#alipayALIPAY_PARTNER = '2088411889535893'                           # alipay return numberALIPAY_PRIVATE_KEY = '99hwj5kd1dnsuuzsfmwlcqt1cbea93**'       # alipay return keyALIPAY_SELLER_ID = '2088411889535**3'ALIPAY_SELLER_EMAIL = 'sundw@qssec.com'ALIPAY_NOTIFY_IP = (        \"121.0.26.0/23\",        \"110.75.128.0/19\",        \"115.124.16.0/24\",        )# 扫描主机记录的URLSCAN_URL ='http://139.217.2.130:8888/api/domainprobe.cgi?domain=%s&type=normal'# 报表历史记录数据IPREPORT_MYSQL_IP ='139.217.7.23'# 报表历史记录数据PORTREPORT_MYSQL_PORT =3306# 报表历史记录数据USERREPORT_MYSQL_USER ='qingsong'# 报表历史记录数据PASSWORDREPORT_MYSQL_PASSWORD ='9mefqkZbESyO6iwRFU**'# 报表历史记录数据DBREPORT_MYSQL_DB = 'cc_log'# ERROR MAILERROR_EMAIL = ('wuzx@qssec.com', 'guanchao@qssec.com', 'wangying@qssec.com', 'wangjy@qssec.com')# EMAIL CONFIGEMAIL_HOST_USER = 'alarm@qssec.com'EMAIL_HOST_PASSWORD = 'qssec2014'EMAIL_HOST = 'smtp.exmail.qq.com'SERVER_EMAIL = 'alarm@qssec.com'# 提醒管理员需要审核的手机配置ADMIN_PHONE = ('18500789814', '18600196205')# NS指向的dns服务器DNS_SERVERS = ('ns1.qssec.com', 'ns2.qssec.com')# 网络的域名或者ip, 供邮件里发送网站信息, 以及支付时使用DOMAIN = 'www.qssec.com'#扫描dns记录的ns服务器NS_LIST={    '114dns':'114.114.114.114',    'google-dns':'8.8.8.8',    'opendns':'208.67.222.222',    'beijing-telecom':'219.141.136.10',    'beijing-unicom':'202.106.0.20',    'beijing-edu':'202.112.144.30',    'Hong-Kong':'202.45.84.58',}NOTIFY_WORKER_ORDER_EMAIL = ('sundw@qssec.com', 'wuzx@qssec.com', 'fanyb@qssec.com', 'panhf@qssec.com', 'guanchao@qssec.com',)NOTIFY_INVOICE_EMAIL = ('sundw@qssec.com', 'wuzx@qssec.com', 'panhf@qssec.com',)# 扫描网页截图的路径配置SCREENSHOTS_PATH = '/var/www/screenshots/'SCREENSHOTS_URL = 'http://www.qssec.com/screenshots/'   漏洞证明：  一、泄露DNSPOD登录账号和密码# DNSPODDNSPOD_USER ='sundw@qssec.com'DNSPOD_PWD ='qssec2014!@#'DNSPOD_DOMAIN ='7cname.com'主域名:qssec\n\n\n\n二、内部邮箱泄露：# EMAIL CONFIGEMAIL_HOST_USER = 'alarm@qssec.com'EMAIL_HOST_PASSWORD = 'qssec2014'EMAIL_HOST = 'smtp.exmail.qq.com'SERVER_EMAIL = 'alarm@qssec.com'给过测试发现：管理员admin与运营的qingshou账号使用同一个密码：qssec2014!@#\n\n\n\n\n\n   修复方案：  1.删除代码2.加强内部信息安全培训   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}