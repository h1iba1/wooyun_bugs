{"id": 21147, "wybug_id": "wooyun-2012-04147", "wybug_title": "新浪博客两处存储跨站", "wybug_corp": "新浪", "wybug_author": "youstar", "wybug_date": "2012-02-02 10:52", "wybug_open_date": "2012-03-18 10:53", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "黑盒测试技巧", "安全策略绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-02-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-02-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-02-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-03-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-03-18：\t细节向公众公开  简要描述： 漏洞原来已经报告新浪了。新浪博客自定义模块和头像昵称处存在存储跨站。 详细说明：  新浪博客头像昵称处没有对提交的数据进行过滤，攻击者可以提交恶意代码。同时修改昵称处没有验证码等安全设置，应该可以造成CSRF漏洞（未测试）。同时在自定义模块中没有对Unicode中文编码进行过滤处理，造成了存储跨站（只能影响IE6、7）。   漏洞证明：  头像昵称处，需要抓包改包，提交：\nyoustar<script>alert(/youstar/)</script>\n自定义模块：\n<IMG SRC=&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;&#100;&#111;&#99;&#117;&#109;&#101;&#110;&#116;&#46;&#99;&#111;&#111;&#107;&#105;&#101;&#41;>\n   修复方案：  1、对博客每个页面提交的内容存入数据库后，取出数据的时候需要进行过滤和编码处理后再显示。2、跨站攻击方面需要对各类编码进行分类，然后进行过滤。   版权声明：转载请注明来源 youstar@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2012-02-02 16:10 厂商回复： 谢谢提供 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}