{"id": 12386, "wybug_id": "wooyun-2013-022378", "wybug_title": "第三方支付平台支付通爆严重漏洞,短信验证码直接隐藏在页面", "wybug_corp": "支付通", "wybug_author": "rico", "wybug_date": "2013-04-23 17:12", "wybug_open_date": "2013-06-07 17:13", "wybug_type": "网络敏感信息泄漏", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感信息泄漏", "设计不当导致攻击界面扩大", "支付安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-07：\t细节向公众公开  简要描述： 在找回密码的时候，给手机发送短信验证码，用POST拦截了一下，结果发现账号，手机验证码，密码，支付密码什么的直接全部显示了。 下面上图 详细说明：  点击获取验证码\n\n之后做POST拦截  拦截短信效验码\n\n注意看 红色的部分 是我拦截到的手机验证码下面在看看 我手机收到的验证码是多少\n\n   漏洞证明：  看到了吧 收到的和拦截的 是一样的。 这个太危险了只要知道任何账户的手机号，通过密码找回，拦截短信 直接通过这个验证码就能找回 账户的密码\n\n直接可以修改用户的密码了到此就可以登录他的账户了。不过 这个还不算完了，还有 更严重的漏洞看下面的拦截数据就知道了红色的部分是 身份证号 密码MD5值（可以去碰撞）别的涉及到太多的账户信息 比如支付密码，绑定的银行卡号，支付平台的服务器地址 和银行通信的密码 数字签名，证书等  就不一一去截图了\n\n   修复方案：  尽量不要将敏感信息存在session cookie 里，生成的短信用服务端生成，修改密码不要单用一个手机号就可以修改，应该还有隐藏的 注册邮箱一些信息   版权声明：转载请注明来源 rico@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-04-27 22:37 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-23 17:14 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:134        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  要挨批了。    \n     2013-04-23 17:15 |    \t\tiiiiiiiii \t\t\t( 普通白帽子  |\t\t\t        Rank:680 漏洞数:89        | )\t\t \n  还以为是支付宝。。    \n     2013-04-23 17:18 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  支付通是谁家的？    \n     2013-04-23 17:20 |    \t\tiiiiiiiii \t\t\t( 普通白帽子  |\t\t\t        Rank:680 漏洞数:89        | )\t\t \n  @疯狗 北京海科融通信息技术有限公司    \n     2013-04-23 17:33 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:134        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  厂商你摊上大事了    \n     2013-04-23 17:39 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:134        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  还有更严重的。    \n     2013-04-23 18:25 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  这标题太明显了吧...    \n     2013-04-23 20:20 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  。。又是这么低级的错误。    \n     2013-04-24 09:03 |    \t\t小乐天 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:12        | From KnownSec)\t\t \n  那不是可以直接盗取别人的信息，太危险了    \n     2013-04-24 11:55 |    \t\tByakuya \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | /whitehat_detail.php?whitehat=Byakuya)\t\t \n  我还以为是支付宝呢。。。。好低级的错误。。。。。    \n     2013-04-24 18:36 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  支付通果然强大    \n     2013-04-25 13:11 |    \t\tLove \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 学习)\t\t \n  现在目测已经拦截不到数据了    \n     2013-04-25 13:23 |    \t\tbittertea \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:7        | 不责人之过，不接人隐私，不念人旧恶)\t\t \n  肯定不行了啊    \n     2013-04-28 10:24 |    \t\t墨水心_Len \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:15        | PKAV技术宅 | 每一个有文化的东西，我们都...)\t\t \n  咋一看，还以为是支付宝...    \n     2013-06-08 08:59 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:89        | 一名普通的phper开发者，关注web安全。)\t\t \n  水印是亮点！@xsser 能不能拒绝非原创？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}