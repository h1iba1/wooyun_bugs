{"id": 15793, "wybug_id": "wooyun-2012-015872", "wybug_title": "千千静听皮肤文件堆溢出", "wybug_corp": "百度", "wybug_author": "AntBean", "wybug_date": "2012-12-11 12:18", "wybug_open_date": "2012-12-13 12:48", "wybug_type": "拒绝服务", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端程序设计错误", "拒绝服务", "客户端安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 千千静听6.1.0存在堆溢出漏洞，成功利用可能导致任意代码执行 详细说明：  千千静听6.1.0在读取皮肤文件时，未判断皮肤文件名长度，导致堆溢出Call Stack:0x7C920000[1240B] ntdll.dll: stricmp[+F7](3475,2069728,3475,16121856)0x7C920000[125C3] ntdll.dll: stricmp[+2AF](18849792,24576,3475,0)0x7C920000[109BA] ntdll.dll: wcsncpy[+43B](16121856,0,18846952,0)0x00400000[1AD6C3] TTPlayer.exe: (18846952,5343191,18846952,18742704)0x00400000[3E19] TTPlayer.exe: (1239860,18846964,18816740,1239420)0x00400000[117BA3] TTPlayer.exe: (1239860,18421588,18744064,1239860)0x00400000[115E6C] TTPlayer.exe: (1239860,18531092,18699828,1239860)0x00400000[114727] TTPlayer.exe: (18421588,1,1,255)0x00400000[113F69] TTPlayer.exe: (1239860,18699792,18400892,1)0x00400000[101AF0] TTPlayer.exe: (18408888,0,0,18409208)0x00400000[F7394] TTPlayer.exe: (657772,15,0,0)0x00400000[10AB46] TTPlayer.exe: (18409208,15,0,0)0x77D10000[8734] USER32.dll: GetDC[+6D](126755008,657772,15,0)0x77D10000[8816] USER32.dll: GetDC[+14F](0,126755008,657772,15)0x77D10000[18EA0] USER32.dll: DefWindowProcW[+180](9537440,15,0,0)0x77D10000[18EEC] USER32.dll: DefWindowProcW[+1CC](1240432,24,9537440,15)0x7C920000[E473] ntdll.dll: KiUserCallbackDispatcher[+13](1244680,0,1,5405375)0x77D10000[8A10] USER32.dll: DispatchMessageW[+F](1244680,2088801098,1244748,6482024)0x00400000[127ABF] TTPlayer.exe: (6482024,6487072,6487072,1878327296)0x00400000[1346A9] TTPlayer.exe: (1,0,1878327296,0)0x74680000[34FA] MSCTF.dll: DllCanUnloadNow[+16AA](69,1381240,1376256,1458944)0x7C920000[10222] ntdll.dll: RtlAllocateHeap[+15E](2090008987,2090009051,0,1242068)0x7C920000[10222] ntdll.dll: RtlAllocateHeap[+15E](2090009051,0,1242068,0)0x7C920000[1019B] ntdll.dll: RtlAllocateHeap[+D7](0,1242068,0,2088833792)0x7C920000[101DB] ntdll.dll: RtlAllocateHeap[+117](2009056201,3866624,0,2009056206)0x7C920000[101DB] ntdll.dll: RtlAllocateHeap[+117](3866624,0,2009056206,0)0x77BE0000[1C3C9] msvcrt.dll: free[+1AE](0,0,1952978263,14764)0x77BE0000[1C3CE] msvcrt.dll: free[+1B3](14764,1240868,1376256,2090009122)0x74680000[1557] MSCTF.dll: (69,1381240,1376256,1458944)0x7C920000[10222] ntdll.dll: RtlAllocateHeap[+15E](2090008987,2090009051,0,1242204)   漏洞证明：  千千静听6.1.0的皮肤文件为zip格式。解压后将其中的Skin.xml打开，修改字段值为超长字符串\n\n重新压缩。之后在千千静听中换肤，即可触发崩溃   修复方案：  对皮肤文件做校验，并对字段长度做检查   版权声明：转载请注明来源 AntBean@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-12-13 12:48 厂商回复： 根据你的描述，我们无法复现漏洞，如果有进一步发现或者补充，请随时联系我们，我们将第一时间跟进，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-11 15:33 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  千千静听？百度？我混乱了。。。    \n     2012-12-13 14:25 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  千千静听怎么是百度旗下的了？    \n     2013-01-07 10:46 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @鬼魅羊羔 发现爱奇艺的也提交的是百度。。好吧我out了    \n     2013-01-07 20:10 |    \t\t蓝风 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:25        | 崬汸慾哓 嗼檤焄垳皁 沓猵圊屾亾沬荖 颩憬...)\t\t \n  @AntBean  神马情况啊    \n     2013-01-10 17:06 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  @px1624 爱奇艺的确有百度的股份。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}