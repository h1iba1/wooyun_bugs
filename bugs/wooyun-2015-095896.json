{"id": 38611, "wybug_id": "wooyun-2015-095896", "wybug_title": " 某通用型Ess(高层主管支持系统)与PSA(经理平台)两类管理系统均可Getshell（3例测试，含三十余处本地配置与数据库）", "wybug_corp": "诺明软件", "wybug_author": "路人甲", "wybug_date": "2015-02-11 15:58", "wybug_open_date": "2015-04-30 18:48", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数据库泄露", "命令执行", "敏感文件泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：    某通用型Ess(高层主管支持系统)与PSA(经理平台)均存在漏洞Getwebshell!（以下给予三例测试，包含三十余处本地配置信息以及数据库信息），相关站点摸索也是大型企业！（有一例貌似是爱立信还是宜通世纪等）|乌云漏洞平台改革了，ID：疯狗也说了，越详细奖励越多，这次我就整理与写的比较详细，支持乌云！支持重视网络安全的大中小企业！未来、互联网会更好！ 详细说明：      诺明软件1999年成立以来，一直坚持“软件助力企业发展，软件让管理更轻松”的理念，致力于企业管理软件的开发和推广。我们既借鉴国际先进的管理实践，又兼顾中国本地企业的管理文化，借助领先的信息技术和丰富的行业经验，搭建起知识和价值的桥梁，帮助中国本地企业优化业务流程，提高管理水平，实现业务增值。\n系统开发商www.norming.com.cn，看了系统开发商介绍，ESS与PSA好像是核心业务\nNorming Ess 管理系统所处均存在Struts2命令执行漏洞。给予3例测试\nEss(高层主管支持系统)http://220.249.82.196:8082/ess/Homepage.actionhttp://101.231.48.155:8888/ess/Homepage.actionhttp://117.79.225.151:8080/ess/ss/Homepage.action\n\nPSA(经理平台)http://220.249.82.196:8082/psa/Homepage.actionhttp://101.231.48.155:8888/psa/Homepage.actionhttp://117.79.225.151:8080/psa/Homepage.action\n1、命令执行 \n以上给予测试链接均可以作为Struts2命令执行入口\n2、默认配置 \n三案例大多默认配置一致，mysql|oraclr|sqlserver数据库默认密码等风险\n3、Database \n包含数据库与默认信息每站高达10+以上，影响较大！\nGetshell之后：\nhttp://220.249.82.196:8082/ess/Homepage.action\n\n\n \n<code>http://117.79.225.151:8080/psa/Homepage.action\n</code>\n\n\nhttp://101.231.48.155:8888/ess/Homepage.action\n\n\n   漏洞证明：  \n数据库信息具体列出了220……的，其余的部分大小异同！因为部分库是默认配置\n\nhttp://220.249.82.196:8082/ess/Homepage.action数据库及敏感信息\n\nESS（管理系统）nor_conn_local.propertieshibernate.url=jdbc:jtds:sqlserver://172.16.130.179:1433;databasename=teamsun1219hibernate.username=sahibernate.password=sql_2005hibernate.dialect=org.hibernate.dialect.SQLServerDialecthibernate.driver=net.sourceforge.jtds.jdbc.Driverhibernate.url=jdbc:jtds:sqlserver://jlh:1433;databasename=test1129_1226hibernate.username=sahibernate.password=sa2005hibernate.dialect=org.hibernate.dialect.SQLServerDialecthibernate.driver=net.sourceforge.jtds.jdbc.DriverlobHandler=defaultLobHandlerhibernate.url=jdbc:oracle:thin:@192.168.1.199:1521:ORCLhibernate.username=psahibernate.password=psahibernate.dialect=org.hibernate.dialect.Oracle9Dialecthibernate.driver=oracle.jdbc.driver.OracleDriverhibernate.showsql=truehibernate.format_sql=truehibernate.url=jdbc:oracle:thin:@59.174.243.54:1521:ORCLhibernate.username=efmdbhibernate.password=efmdbhibernate.dialect=org.hibernate.dialect.Oracle9Dialecthibernate.driver=oracle.jdbc.driver.OracleDriverhibernate.showsql=truehibernate.format_sql=truehibernate.url=jdbc:oracle:thin:@atlas:1521:efuture3hibernate.username=systemhibernate.password=dell1hibernate.dialect=org.hibernate.dialect.Oracle9Dialecthibernate.driver=oracle.jdbc.driver.OracleDriverhibernate.showsql=truehibernate.format_sql=truehibernate.url=jdbc:jtds:sqlserver://192.168.1.141:1533;databasename=zjk;hibernate.username=sahibernate.password=zryh2008hibernate.dialect=org.hibernate.dialect.SQLServerDialecthibernate.driver=net.sourceforge.jtds.jdbc.Driverhibernate.showsql=truehibernate.format_sql=truelobHandler=defaultLobHandlerteam_conn_local.propertieshibernate.url=jdbc:oracle:thin:@172.16.1.27:1521:STDBhibernate.username=nuominghibernate.password=nm1122hibernate.dialect=org.hibernate.dialect.Oracle9Dialecthibernate.driver=oracle.jdbc.driver.OracleDriverlobHandler=defaultLobHandlerhibernate_conn_local.propertieshibernate.url=jdbc:oracle:thin:@192.168.1.27:1521:orclhibernate.username=psahibernate.password=psahibernate.dialect=org.hibernate.dialect.Oracle9Dialecthibernate.driver=oracle.jdbc.driver.OracleDriverhibernate.showsql=falsehibernate.format_sql=truelobHandler=oracle9iLobHandlerstruts.propertiesstruts.i18n.reload=truestruts.devMode=truestruts.multipart.maxSize=10485760struts.configuration.xml.reload=truestruts.url.http.port=8080struts.multipart.saveDir=C:\\\\Documents and Settings\\\\AdministratorPSA（管理系统）nor_conn_local.propertieshibernate.url=jdbc:oracle:thin:@192.168.1.27:1521:efmdbhibernate.username=efmdbhibernate.password=efmdbhibernate.dialect=org.hibernate.dialect.Oracle9Dialecthibernate.driver=oracle.jdbc.driver.OracleDriverlobHandler=defaultLobHandlernorming-config.properties#app urlpath.ess=http://221.232.80.212:8082/ess/path.ehr=http://221.232.80.212:8082/psa/path.erc=http://localhost:8080/erc/path.tomcat=D:/Tomcat 6.0/webapps/psa/appname=ehr#for AD User #sso.adurl=http://192.168.1.133/ext/ssoforj2ee.aspx#id=psa #pass=psaooo.folder=C:/Program Files (x86)/OpenOffice.org 3/program/ooo.host=localhostooo.port=8181rmi.host=rmi.port=50000team_conn_local.propertieshibernate.url=jdbc:oracle:thin:@localhost:1521:orclhibernate.username=efmdb1hibernate.password=efmdb1hibernate.dialect=org.hibernate.dialect.Oracle9Dialecthibernate.driver=oracle.jdbc.driver.OracleDriverhibernate.showsql=truehibernate.format_sql=truelobHandler=defaultLobHandlerhibernate_conn_local.propertieshibernate.url=jdbc:oracle:thin:@192.168.1.27:1521:orclhibernate.username=psahibernate.password=psahibernate.dialect=org.hibernate.dialect.Oracle9Dialecthibernate.driver=oracle.jdbc.driver.OracleDriverhibernate.showsql=falsehibernate.format_sql=truelobHandler=oracle9iLobHandler(sql).properties#############################################  \\u7487\\u5cf0\\u6087\\u9477\\ue047\\ue195\\u7f03\\ufffd# 192.168.1.137:1433############################################hibernate.url=jdbc:jtds:sqlserver://localhost:1433;databasename=ehrhibernate.username=sahibernate.password=sahibernate.dialect=org.hibernate.dialect.SQLServerDialecthibernate.driver=net.sourceforge.jtds.jdbc.Driverhibernate.showsql=truehibernate.format_sql=truelobHandler=defaultLobHandler(or).propertieshibernate.url=jdbc:oracle:thin:@192.168.1.36:1521:oraclehibernate.username=HRMShibernate.password=HRMShibernate.dialect=org.hibernate.dialect.Oracle9Dialecthibernate.driver=oracle.jdbc.driver.OracleDriverhibernate.showsql=truehibernate.format_sql=truelobHandler=oracle9iLobHandler(mysql).propertieshibernate.url=jdbc:mysql://localhost:3306/ehr?useOldAliasMetadataBehavior=true&useUnicode=true&characterEncoding=utf-8hibernate.username=roothibernate.password=roothibernate.dialect=org.hibernate.dialect.MySQL5Dialecthibernate.driver=com.mysql.jdbc.Driverhibernate.showsql=truehibernate.format_sql=truelobHandler=defaultLobHandler<code>http://117.79.225.151:8080/psa/Homepage.action数据库部分信息\n\nhttp://117.79.225.151:8080/psa/Homepage.action数据库及敏感信息-(疑似为爱立信/宜通世纪)ESS（管理系统）hibernate_conn_local.propertieshibernate.url=jdbc:jtds:sqlserver://localhost:46937;databasename=PSA630_ETONEhibernate.username=sahibernate.password=Etone2012hibernate.dialect=org.hibernate.dialect.SQLServerDialecthibernate.driver=net.sourceforge.jtds.jdbc.Driverhibernate.showsql=falsehibernate.format_sql=truelobHandler=defaultLobHandlernorming-config.properties# page config.page.size=15page.max.size=5000path.ehr=http://localhost:8080/psa/path.ess=http://localhost:8080/ess/#login.control=1appname=esssdf.default = yyyy-MM-dd#sso.adurl=http://192.168.1.33/ext/ssoforj2ee.aspx#ooo.folder=D:/Program Files/OpenOffice.org 3/program/#ooo.host=localhost#ooo.port=8181rmi.port=50000PSA(经理平台)norming-config.properties#app urlpath.ess=http://localhost:8080/ess/path.ehr=http://localhost:8080/psa/path.erc=http://localhost:8080/erc/appname=ehr#for AD User #sso.adurl=http://192.168.1.133/ext/ssoforj2ee.aspxid=psapass=psa#ooo.folder=D:/Program Files/OpenOffice.org 3/program/#ooo.host=localhost#ooo.port=8181db.lock_timeout=20000\n\nhttp://101.231.48.155:8888/ess/Homepage.action数据库部分信息\n\nESS（管理系统）norming-config.properties# page config.page.size=15page.max.size=5000path.ehr=http://192.168.1.250:8888/psa/path.ess=http://192.168.1.250:8888/ess/#login.control=1appname=esssdf.default = yyyy-MM-dd#sso.adurl=http://192.168.1.33/ext/ssoforj2ee.aspx#ooo.folder=D:/Program Files/OpenOffice.org 3/program/#ooo.host=localhost#ooo.port=8181rmi.port=50000hibernate_conn_local.properties#Fri May 10 17:44:40 CST 2013hibernate.password=salobHandler=defaultLobHandlerhibernate.driver=net.sourceforge.jtds.jdbc.Driverhibernate.showsql=falsehibernate.dialect=org.hibernate.dialect.SQLServerDialecthibernate.url=jdbc\\:jtds\\:sqlserver\\://localhost\\:1433;databasename\\=psaprchibernate.username=sahibernate.format_sql=truePSA(经理平台)hibernate_conn_local.properties#Thu May 16 13:46:54 CST 2013hibernate.password=salobHandler=defaultLobHandlerhibernate.driver=net.sourceforge.jtds.jdbc.Driverhibernate.showsql=falsehibernate.dialect=org.hibernate.dialect.SQLServerDialecthibernate.url=jdbc\\:jtds\\:sqlserver\\://localhost\\:1433;databasename\\=psaprchibernate.username=sahibernate.format_sql=true\n\n由于分析时间过长文件也太多，在这里当然也只列出部分，更多请详细盘查。在这里仅仅列出http://220.249.82.196:8082/ess/Homepage.action数据库以及配置的相关密码其余2例测试，部分默认是一致的。一组组密码：sa  sql_2005  efmdb  efmdbpsa psasystem dell1nuoming nm1122efmdb1root rootHRMS HRMSsa   sasa zryh2008\n\n部分信息属于贵公司利益敏感信息未列出！望见谅！\n   修复方案：  1、贵公司也看到此系统的配置以及运行环境所处的风险，希望贵公司能正确对待！（以上3例要是更加深入去链接数据库以及挖掘会更大影响到用户的利益与风险，但此漏洞我只需列出案例的测试与包含的风险。更多也请贵公司多多包涵，不吝指教！）2、作为一名白帽子这是我应该做的！希望大家都关注、注重网络安全事件以及自身安全！3、#$奖励有没有？    #$礼物有没有呢？   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}