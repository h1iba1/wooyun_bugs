{"id": 48948, "wybug_id": "wooyun-2014-075929", "wybug_title": "北创软件某检索系统存在任意命令执行漏洞影响“量”巨大", "wybug_corp": "www.bcrj.com.cn", "wybug_author": "linadmin", "wybug_date": "2014-09-12 18:00", "wybug_open_date": "2014-12-11 18:02", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-11：\t细节向公众公开  简要描述： 北创软件某检索系统某框架版本过久导致任意命令执行（猜到了么？）爱读书的妹子们任咱们。。。哎~~ 详细说明：  北创软件开发的公共检索系统如下：\n\nGOOGLE:inurl:opac_two多用于图书馆，公共搜索等系统和网站，google使用量还是挺大的！这个系统采用的Struts2组件太老，可以任意命令执行（s15-16）以前没注意，前几天突然发现原来这个东西是通用软件,我TM还以为是搬砖者们。。。因而去搜了一下都谁在安装这个东西，顿时惊呆了。。我就各种试啊试啊。。这个系统可以执行任意命令的地方估计很多..（洒家木有源码）我知道的能执行的也是我测试用的2条链接：/opac_two/mylibrary/comment/queryAllComment.action/opac_two/mylibrary/leaveword/queryAllLeaveword.action其实Struts2漏洞没什么，但是大多数struts2任意命令执行都是系统管理员权限但是这种检索系统尤其是大学，注册的人特别多（某些站多到上万）但是这类检索系统被大量公共图书馆，学校图书馆，小说检索等安装但是这玩意儿还可以作为系统内网渗透的入口但是这玩意儿还可以经常装在图书馆入口的电脑上，可以当着旁观者装逼。。。ok了送20个shell略表寸心http://211.68.68.197/opac_two/mylibrary/comment/queryAllComment.actionhttp://219.218.26.4:85//opac_two/mylibrary/comment/queryAllComment.actionhttp://218.107.150.8/opac_two/mylibrary/comment/queryAllComment.actionhttp://219.242.31.130:8080//opac_two/mylibrary/comment/queryAllComment.actionhttp://202.118.84.134:8080//opac_two/mylibrary/comment/queryAllComment.actionhttp://202.205.160.120:8080//opac_two/mylibrary/comment/queryAllComment.actionhttp://opac.lnu.edu.cn//opac_two/mylibrary/comment/queryAllComment.actionhttp://202.197.224.89:8088//opac_two/mylibrary/comment/queryAllComment.actionhttp://202.118.8.2:8080//opac_two/mylibrary/comment/queryAllComment.actionhttp://210.77.83.73:8080//opac_two/mylibrary/comment/queryAllComment.actionhttp://202.204.234.3:100//opac_two/mylibrary/comment/queryAllComment.actionhttp://kaitong.cafa.com.cn:8080/opac_two/mylibrary/comment/queryAllComment.actionhttp://lib.fjjxxy.cn:8080/opac_two/mylibrary/comment/queryAllComment.actionhttp://202.4.153.19:8080/opac_two/mylibrary/comment/queryAllComment.actionhttp://219.218.26.4:85//opac_two/mylibrary/comment/queryAllComment.actionhttp://222.29.99.40:8080//opac_two/mylibrary/comment/queryAllComment.actionPS:严肃的说影响量确实很大！使用量很大（图书馆，公共检索，资料查询等）+注册信息量非常大，泄露大量数据就不好玩了。。   漏洞证明：  http://211.68.68.197/opac_two/mylibrary/comment/queryAllComment.actionhttp://219.218.26.4:85//opac_two/mylibrary/comment/queryAllComment.actionhttp://218.107.150.8/opac_two/mylibrary/comment/queryAllComment.actionhttp://219.242.31.130:8080//opac_two/mylibrary/comment/queryAllComment.actionhttp://202.118.84.134:8080//opac_two/mylibrary/comment/queryAllComment.actionhttp://202.205.160.120:8080//opac_two/mylibrary/comment/queryAllComment.actionhttp://opac.lnu.edu.cn//opac_two/mylibrary/comment/queryAllComment.actionhttp://202.197.224.89:8088//opac_two/mylibrary/comment/queryAllComment.actionhttp://202.118.8.2:8080//opac_two/mylibrary/comment/queryAllComment.actionhttp://210.77.83.73:8080//opac_two/mylibrary/comment/queryAllComment.actionhttp://202.204.234.3:100//opac_two/mylibrary/comment/queryAllComment.actionhttp://kaitong.cafa.com.cn:8080/opac_two/mylibrary/comment/queryAllComment.actionhttp://lib.fjjxxy.cn:8080/opac_two/mylibrary/comment/queryAllComment.actionhttp://202.4.153.19:8080/opac_two/mylibrary/comment/queryAllComment.actionhttp://219.218.26.4:85//opac_two/mylibrary/comment/queryAllComment.actionhttp://222.29.99.40:8080//opac_two/mylibrary/comment/queryAllComment.action\n\n   修复方案：  更新组件   版权声明：转载请注明来源 linadmin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-09-17 05:27 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-12 18:05 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  厉害！我就是想知道关键字是什么    \n     2014-09-12 18:30 |    \t\tlinadmin \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:30        | 低调进取，低调为人)\t\t \n  @U神 乃们都是大牛，猜猜看    \n     2014-09-12 18:58 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @linadmin 洞主为何要把量字用引号括起来呢？    \n     2014-09-12 19:05 |    \t\tlinadmin \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:30        | 低调进取，低调为人)\t\t \n  @U神 额。。装B而已    \n     2014-12-11 19:10 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @linadmin 我已经把这个系统刷烂了    \n     2014-12-11 21:01 |    \t\tlinadmin \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:30        | 低调进取，低调为人)\t\t \n  @U神 哈哈，碉堡了。。。我也测过，漏洞确实很多。。。    \n     2014-12-11 21:03 |    \t\tlinadmin \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:30        | 低调进取，低调为人)\t\t \n  @U神 在裤袋被人刷翻天，原来是你。。。    \n     2014-12-11 21:59 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @linadmin 一处SQL 又一处SQL 又又一处SQL 又又又一处sql 又又又又一处SQL 又又又又又一处SQL   你懂得    \n     2014-12-11 22:17 |    \t\tlinadmin \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:30        | 低调进取，低调为人)\t\t \n  @U神 秒懂，不亏大牛    \n     2014-12-17 22:12 |    \t\tlinadmin \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:30        | 低调进取，低调为人)\t\t \n  @U神 你有研究过360_safe3.php这个防注入脚本么，碰到就几个洞，被它拦截了，求指导    \n     2015-03-23 10:38 |    \t\tmtfly \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:6        | 啥都不会)\t\t \n  哎，已经被提交了 %>_<% 还以为发现了通用的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}