{"id": 74303, "wybug_id": "wooyun-2016-0169507", "wybug_title": "首汽约车APP越权查询和取消任意订单及获取所有约车司机信息", "wybug_corp": "首汽约车", "wybug_author": "采花大盗", "wybug_date": "2016-01-13 09:19", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄露", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： 约车APP越权查询任意订单信息及取消任意订单以及获取所有约车司机信息，可遍历！！！ 详细说明：  1、模拟正常用户下单      操作步骤：打开首汽约车APP－－预约用车－－下一个订单2、查看订单预定信息      操作步骤：我的行程－－个人行程－－刚才下的订单－－右上角预订信息 抓取数据包，数据包如下\nPOST /car-rest/webservice/passenger/myTrip/getTripBooking_V3_0 HTTP/1.1Host: passenger.01zhuanche.comcar-ps: AppStoreAccept: */*car-pf: IOScar-sv: 8.4.1Accept-Language: zh-Hans;q=1, en;q=0.9Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedcar-mv: iPhone 5SContent-Length: 60User-Agent: GuoBinTeam/18 (iPhone; iOS 8.4.1; Scale/2.00)Connection: keep-alivecar-vs: 3.0car-mi: 06181f297beorderId=2000000&token=yourToken\n修改orderId的值 即可获取他人订单信息。\n\n\n\n3、取消他人订单订单中有个charteredNo参数，将订单信息中的charteredNo值替换即可取消\n\n4、查询所有司机的信息，可遍历！！！（包括车牌、车型、姓名、手机号、驾龄等）\n\n\n\n   漏洞证明：  1、获取他人订单信息\n\n\n\n\n\n2、取消他人订单\n\n3、获取所有司机信息\n\n\n\n   修复方案：  对请求做身份校验   版权声明：转载请注明来源 采花大盗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2016-01-13 10:40 厂商回复： 感谢您的反馈，我们正在进行处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}