{"id": 47548, "wybug_id": "wooyun-2015-092250", "wybug_title": "央视网任意用户密码重置", "wybug_corp": "中国网络电视台", "wybug_author": "covertops", "wybug_date": "2015-01-16 19:30", "wybug_open_date": "2015-01-21 19:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 央视网任意用户密码重置 详细说明：  漏洞URL为：http://reg.cntv.cn/forgetPassword/findPassword.jsp找回密码\n\n输入之前注册的测试账号作为目标账号：\n\n选择重置密码到注册邮箱：\n\n此时抓包，将choose_Email参数改为自己的邮箱（目标id是163邮箱，攻击者邮箱为126邮箱）：\n\n未对邮箱进行校验，导致将目标账号的重置凭证发送到攻击者邮箱：\n\n点击链接，登录到修改密码页面，并用新密码成功登陆：\n\n\n\n需要说明的是，从央视网来看，用户的注册邮箱是看不到的，显示的是用户昵称，但是一个人的常用邮箱是多少应该不能算作一个密码吧另外这个重置链接中，usridSecret、compareFlag参数都是可得到的，如上面截图，有人有思路这个code参数是怎么来的不？：http://reg.cntv.cn/forgetPassword/forgetPasswordReset.action?usridSecret=a61df9b7ca12886d65d2d9341e05868091933bfb578da1e5e5a6e6ee74f0e074ef64c1baa72e4a3a&compareFlag=6b031e783ad8750155ec817300e0b59a&code=67A83019E298968167E9454FB8A3DDBA8863EE8C审核人员勿点，12小时有效。。。   漏洞证明：  如上   修复方案：  后台验证邮箱   版权声明：转载请注明来源 covertops@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-01-21 19:32 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-16 19:32 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  前排围观，拍我拍我！    \n     2015-01-16 19:33 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  CCAV看这里！    \n     2015-01-16 20:03 |    \t\t无心、 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:20        | 你不是风儿，我也不是沙，再怎么缠绵也到不...)\t\t \n  ccav.大家好！嗨    \n     2015-01-19 20:56 |    \t\t一只寂寞的小鸟 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:3        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  CCAV看这里！    \n     2015-01-22 00:34 |    \t\txiaohao \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 我要去找到那力量，让所有的生命都超越界限...)\t\t \n  感谢分享。 1024    \n     2015-01-22 14:14 |    \t\tcovertops \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:23        | wooyun)\t\t \n  @疯狗 疯狗大大，能否补rank啊？    \n     2015-01-22 17:29 |    \t\t李宇航的小柠檬 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 小柠檬甜不甜)\t\t \n  这是啥工具    \n     2015-01-23 09:35 |    \t\tcovertops \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:23        | wooyun)\t\t \n  @李宇航的小柠檬 抓包的么？burp啊    \n     2015-02-25 16:08 |    \t\t李宇航的小柠檬 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 小柠檬甜不甜)\t\t \n  @covertops 哦    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}