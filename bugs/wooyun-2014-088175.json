{"id": 41636, "wybug_id": "wooyun-2014-088175", "wybug_title": "慕课网分站存在SQL盲注+phpinfo+泄露整套源码", "wybug_corp": "imooc.com", "wybug_author": "星明月稀", "wybug_date": "2014-12-22 19:25", "wybug_open_date": "2014-12-27 19:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 今天看到了36Kr有篇文章写《站在MOOC的风口，果壳网获得2000万美元C轮融资》，就随便测了下imooc咯，接下去就有了：慕课网分站存在SQL盲注+phpinfo+泄露整套源码！！！点到为止，未深入，望及时修复！只求高rank！谢谢哈！ 详细说明：  问题站点：http://oetc.imooc.com/(1)SQLi:====================\nPOST /course/classmates HTTP/1.1Host: oetc.imooc.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:31.0) Gecko/20100101 Firefox/31.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: Hm_lvt_f0cfcccd7b1393990c78efdeebff3968=1419236047; Hm_lpvt_f0cfcccd7b1393990c78efdeebff3968=1419236047X-Forwarded-For: 8.8.8.8Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 25cid=303&total=4\n验证如下：\n\n\n\n详细再见下面证明部分！（2）phpinfo信息泄露http://oetc.imooc.com/phpinfo.php\n\n（3）svn泄露http://oetc.imooc.com/.svn/entries同样我们再写个小脚本遍历下entries的各个目录内容，整套源码就下来额！！！可参考：http://drops.wooyun.org/tips/352\n\n   漏洞证明：  我们用sqlmap跑下盲注内容！（1）数据库类型\n\n（2）全部数据库\n\n（3）course库中的所有表\n\n   修复方案：  （1）过滤参数（2）删掉phpinfo.php文件（3）如果已经线上的生产环境已经有了.svn目录不想删掉可以在服务器上设置禁制访问此目录：另外svn更新至1.7+ .svn/entries目录就不包含文件目录列表了。Apache:<Directory ~ \"\\.svn\">Order allow,denyDeny from all</Directory>Nginx:location ~ ^(.*)\\/\\.svn\\/ {return 404;}   版权声明：转载请注明来源 星明月稀@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-27 19:26 厂商回复：  最新状态： 2015-01-02：感谢，目前漏洞已经修复。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}