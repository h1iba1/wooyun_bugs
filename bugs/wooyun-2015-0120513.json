{"id": 44083, "wybug_id": "wooyun-2015-0120513", "wybug_title": "金山安全套装（新毒霸\"悟空\"+ 金山卫士）远程代码执行漏洞", "wybug_corp": "金山毒霸", "wybug_author": "cssembly", "wybug_date": "2015-06-14 22:05", "wybug_open_date": "2015-09-12 23:10", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行", "客户端安全", "缓冲区溢出", "栈溢出"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-12：\t细节向公众公开  简要描述： 金山安全套装防护模块存在漏洞，导致所有加载该防护模块（带UI的程序均会加载该模块）并使用特定网络套接字的程序均存在远程代码执行风险 详细说明：  金山网络防护模块kswebshield.dll存在漏洞\n\n该函数对HTTP回应包进行解析，查找数据包中是否存在“Content-Range:”字段，然后对后续的“bytes”字段进行查找，返回的地址放入v5种，然后从v5开始查找“－”，得到位置v7，后面调用 memcpy_0(String, v6, v7 - (_DWORD)v6)讲数据拷入String中，并未校验长度，导致缓冲区溢出，最终任意代码执行通过IDA，简单查看调用链，可以看到该函数是WSARecv的挂钩函数，也就是说凡事采用了WSARecv的接收数据的程序，加载该库之后都存在任意代码执行问题\n\n此外，int __stdcall sub_1008D1F0(int a1)函数海存在一个整形溢出漏洞，如题，v10的比较存在问题\n\n   漏洞证明：  以ie为例，构造poc，监听本地80端口\n\n打开之后，可以看到弹出了计算器\n\n   修复方案：     版权声明：转载请注明来源 cssembly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-06-14 23:10 厂商回复： 收到，感谢提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-14 22:07 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:373        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  沙发    \n     2015-06-14 22:21 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  特定的网络套接字。。很久没见过这样的漏洞了    \n     2015-06-14 22:21 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  特定的网络套接字。。很久没见过这样的漏洞了    \n     2015-06-14 22:26 |    \t\tcssembly \t\t\t( 普通白帽子  |\t\t\t        Rank:202 漏洞数:23        | 天资不足，勤奋有余！)\t\t \n  @梧桐雨 我是懒得调试代码了，通过IDA看了一下，有一类套接字是直接可以看到是肯定存在问题的    \n     2015-06-14 22:31 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @cssembly 洞主好久不见    \n     2015-06-14 22:38 |    \t\t泪雨无魂 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:21        )\t\t \n  6666   洞主好牛逼。。    \n     2015-06-14 22:45 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:12        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  6666 洞主好牛逼。。    \n     2015-06-14 22:58 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  6月闪电好多！    \n     2015-06-14 22:59 |    \t\tcssembly \t\t\t( 普通白帽子  |\t\t\t        Rank:202 漏洞数:23        | 天资不足，勤奋有余！)\t\t \n  @xsser 是呀，好久不挖洞了，前面一直在drops写文章    \n     2015-06-14 23:39 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:134        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @cssembly 屌屌的。主站诈尸了    \n     2015-06-15 07:50 |    \t\t白非白 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:39        | ♫ Freedom - Anthony Hamilton ♫)\t\t \n  厉害！    \n     2015-06-15 08:40 |    \t\tcssembly \t\t\t( 普通白帽子  |\t\t\t        Rank:202 漏洞数:23        | 天资不足，勤奋有余！)\t\t \n  @zeracker 偶尔诈尸，哈哈    \n     2015-06-15 09:00 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  很给力    \n     2015-06-18 11:24 |    \t\t数据流 \t\t\t( 普通白帽子  |\t\t\t        Rank:716 漏洞数:88        | all or nothing,now or never)\t\t \n   好久不见洞主了    \n     2015-06-18 21:27 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 学姿势，学思路。)\t\t \n  好厉害的代码执行。    \n     2015-06-19 08:05 |    \t\trange \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:22        | 这个人有点懒，没有写个人简介)\t\t \n  看成金山安全套了    \n     2015-06-19 15:13 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:2        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n  好像明白了一点 ，很感兴趣的样子        \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}