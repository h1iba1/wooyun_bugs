{"id": 18641, "wybug_id": "wooyun-2012-08480", "wybug_title": "拉卡拉任意修改其他用户密码漏洞", "wybug_corp": "拉卡拉网络技术有限公司", "wybug_author": "唐尸三摆手", "wybug_date": "2012-06-19 15:14", "wybug_open_date": "2012-08-03 15:15", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当导致攻击界面扩大", "边界绕过", "认证缺陷", "盲目信任用户数据", "认证设计不合理", "逻辑错误", "设计不当", "前台限制绕过", "支付行业敏感", "业务逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-03：\t细节向公众公开  简要描述： 拉卡拉网站用户中心存在逻辑缺陷，可以任意修改其他用户密码，从而登陆进入其他用户账号查看消费记录，处理消费余额，查看个人隐私信息，甚至进行账号转账等等操作 详细说明：  在查找用户操作的敏感逻辑中，我们发现整个重制密码的流程存在严重安全隐患，首先自己重置下自己的密码得到如下连接：\nhttp://user.lakala.com/default/pwdResetRequestByEmail.do?uid=1000244181&code=9qxHvn7L\n进入该链接发现即可重新设置密码，关键逻辑代码为：\n<form id=\"passwordResetForm\" name=\"passwordResetForm\" method=\"post\" action=\"/default/passwordReset.do\">      <input type=\"hidden\" id=\"userId\" name=\"userId\" value=\"1000244181\">   \t  <ul class=\"list3\">      <li>        <div class=\"n1\">新密码:</div>        <input type=\"password\" name=\"password\" id=\"password\" class=\"inp1 required\">        <label></label>        <div class=\"n2\">          <p>8-16位字符，请使用字母加数字或符号的组合密码，不要单独使用数字，字母或符号。</p>        </div>      </li>      <li>        <div class=\"n1\">确认密码:</div>        <input type=\"password\" name=\"re_passwd\" id=\"re_passwd\" class=\"inp1 required\">        <label></label>        <div class=\"n2\">          <p>请再次输入密码！</p>        </div>      </li>      <li>        <div class=\"n2\">          <p><input type=\"button\" onclick=\"passwordResetSubmit()\" value=\"下一步\" class=\"btn1\"></p>        </div>      </li>      </ul>      </form>\n从代码看并无更多的条件限制，只是将客户ID和新的密码提交到服务器，如果在服务器里并无session等进行二次的验证，将导致严重安全隐患，为了测试我们注册一个新的账户，并且记录新账户的ID，修改用户的ID之后提交\n\n立即重置成功\n\n使用测试的账号可直接登陆成功   漏洞证明：  不多说了吧   修复方案：  不多说了吧   版权声明：转载请注明来源 唐尸三摆手@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-06-19 16:42 厂商回复： 谢谢，漏洞已发现，正在处理中。 最新状态： 2012-06-19：缺陷已修复，多谢您了。  ", "replys": "漏洞评价：\n评论\n     2012-06-19 15:16 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  我信洞主，以后不敢用拉卡拉还信用卡了，别不知道给谁还了。。    \n     2012-06-19 15:20 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  玩过火了。我擦    \n     2012-06-19 15:25 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  拉卡拉网站用户中心存在逻辑缺陷，可以任意修改其他用户密码，从而登陆进入其他用户账号查看消费记录，处理消费余额，查看个人隐私信息，甚至进行账号转账等等操作  ......碉堡了    \n     2012-06-19 15:25 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  洞主保重...    \n     2012-06-19 16:03 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  个人觉得这种简介有危险~~    \n     2012-06-19 16:21 |    \t\tzidane \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:2        | 噢 乖，你们应该明白 这样下去对我们谁都不...)\t\t \n  关注此类型漏洞    \n     2012-06-19 16:50 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  最近这类漏洞真火！！    \n     2012-06-19 17:54 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @拉卡拉网络技术有限公司 修复得真快，天气这么热，送点冰棍吃吧～    \n     2012-06-19 17:55 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @xsser 俺要乌云牌的。    \n     2012-06-19 21:32 |    \t\tAの碎碎念 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:4        | 腐宅求妹子~)\t\t \n  我擦    \n     2012-06-20 16:09 |    \t\tHenry:bobo \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:22        | 本胖吊！~又高又肥2个奶奶像地雷)\t\t \n  洞主我信了    \n     2012-07-23 14:17 |    \t\tzidane \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:2        | 噢 乖，你们应该明白 这样下去对我们谁都不...)\t\t \n  跟当年某网游一模一样    \n     2012-07-23 16:35 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  擦，跟我们公司内部的系统一个德行……一个开发公司么~~    \n     2012-07-23 16:36 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @一刀终情 请问你们家公司是什么 分享下    \n     2012-07-23 18:05 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @xsser 好像是个小公司，时代电子？还是天钥科技的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}