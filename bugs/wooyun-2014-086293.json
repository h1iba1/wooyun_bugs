{"id": 42260, "wybug_id": "wooyun-2014-086293", "wybug_title": "TCL碰碰猫商城随机登录其他用户", "wybug_corp": "TCL官方网上商城", "wybug_author": "白非白", "wybug_date": "2014-12-08 11:09", "wybug_open_date": "2015-01-22 11:10", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄露", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向公众公开  简要描述： 这个是伪随机，实际上是可控的。说是随机登录，实际上是越权操作，只是越权的地方有点巧妙。 详细说明：  书接上回，上一个订单注入问题时提到了碰碰猫商城登录方式的奇葩：只要有真实姓名+邮箱就可以登录，那么真实姓名和邮箱从哪里来呢？1.搜集信息+社工，猜测。可行，但是效率不高2.邮箱系统，可行，但是暂时还没有拿到这个权限。3.sql注入,可行，但是表太多数据太多，懒得跑4.要是能从某个地方获取到这种信息就好了，嗯，运气不错，真找到了这个地方。上一个漏洞提到了注入点http://125.93.53.9/account/buyer/orderDetail.html?order_id=3631030。正要关闭页面时，发现了这么两处敏感信息。\n\n为了验证我的想法，把订单号用instruder跑一下，并且抓一下邮件关键字。instruder设置如下：\n\n\n\n\n\n看一下结果：\n\n尝试一下登录吧：\n\n   漏洞证明：  随机性在于订单号对应的用户是未知的，不是可预见的。影响范围：所有在碰碰猫商城购物过的用户。   修复方案：  查看订单时核实用户身份。   版权声明：转载请注明来源 白非白@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-12-08 12:07 厂商回复： 感谢您的关注和工作，已转交相关单位确认处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}