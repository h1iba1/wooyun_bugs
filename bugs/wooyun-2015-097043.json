{"id": 45192, "wybug_id": "wooyun-2015-097043", "wybug_title": "有货官方某接口设计不当可平行越权修改他人资料及订单等", "wybug_corp": "YOHO!有货", "wybug_author": "月小对", "wybug_date": "2015-02-13 11:21", "wybug_open_date": "2015-03-30 11:22", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-30：\t细节向公众公开  简要描述： 晚上在家装android studio，哎不说了都是泪，“网络不好”，你懂得。 详细说明：  打开手机APP，逛下潮店“有货”，发现平行越权了，汗1.下载个官方APP，查看自己的购物车，然后burp修改uid，爆破遍历，看存在哪些有用的uid从返回长度可以得知，存在7039963这个uid用户\n\n抓包，修改uid重发此包截图：看到7039963这个用户的购物车\n\n然后，我们再删除此用户购物车的内容，同样抓包修改uid，很简单\n\nok,看到结果，删除成功\n\n2.接下来测试越权查看订单接口同样遍历，看哪些uid存在订单号（看订单是get提交的）\n\n重发此包ok，get 别人订单页面\n\n此用户由于订单已付款，我就不测撤销订单了。。。3.再看看浏览他人用户信息，这次换个uid=7033175。app里面右下角点击“我的”按钮一样的抓包改包\n\n结果：\n\n还好界面里没有修改密码的地方，也没有送YOHU币啥的，不然更危险了。else，至于将商品加进其他人购物车，我没有去验证，麻烦自己测吧   漏洞证明：  1.下载个官方APP，查看自己的购物车，然后burp修改uid，爆破遍历，看存在哪些有用的uid从返回长度可以得知，存在7039963这个uid用户\n\n抓包，修改uid重发此包截图：看到7039963这个用户的购物车\n\n然后，我们再删除此用户购物车的内容，同样抓包修改uid，很简单\n\nok,看到结果，删除成功\n\n2.接下来测试越权查看订单接口同样遍历，看哪些uid存在订单号（看订单是get提交的）\n\n重发此包ok，get 别人订单页面\n\n此用户由于订单已付款，我就不测撤销订单了。。。3.再看看浏览他人用户信息，这次换个uid=7033175。app里面右下角点击“我的”按钮一样的抓包改包\n\n结果：\n\n还好界面里没有修改密码的地方，也没有送YOHU币啥的，不然更危险了。else，至于将商品加进其他人购物车，我没有去验证，麻烦自己测吧   修复方案：  模糊uid，用随机的加密的，长度适当的，不可猜测的方式来分配uid对不起被我删除删除购物车的兄弟了！@@！   版权声明：转载请注明来源 月小对@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-02-13 12:02 厂商回复： 感谢大虾对我们系统的关注，我们会尽快修改。请多多指教 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}