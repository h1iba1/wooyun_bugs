{"id": 8134, "wybug_id": "wooyun-2013-039154", "wybug_title": "安财费用报销系统V7.6.3.16存在任意文件上传漏洞及可任意文件遍历获取所有用户信息", "wybug_corp": "安财(www.acsoft.com.cn)", "wybug_author": "袋鼠妈妈", "wybug_date": "2013-10-09 08:38", "wybug_open_date": "2013-11-23 08:39", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-23：\t细节向公众公开  简要描述： 1.安财费用报销系统V7.6.3.16存在任意文件上传漏洞，虽然对比7.0对文件格式做了限制，但效果有限2.可任意文件遍历获取所有用户信息 详细说明：  测试站点:http://demo.51able.com/ 同样属于杭州安财软件有限公司一、1.继续利用其测试账户登入 TC0012.点击“费用报销”-“新建报销单”（我这里在chrome里无法显示，换的IE），照例随便选择一个报销类型，点击右上角的“附件”\n\n3.依旧添加附件，这次选一个.exe后缀试试，\n\n对的，点击“保存”之后，会提示上传的文件格式有误，但其实文件已经上传.\n\n4.由于其可以遍历目录(7.0也一样),根据7.0的路径，找到文件目录FormAttFile/翻查，最终依然找到了刚刚上传的exe，前面的警告提示如同虚设\n\n二、1.按图索骥，遍历目录时发现WebServices,平时见过觉得熟悉，(Web Services 可使您的应用程序成为 Web 应用程序。 通过 Web 进行发布、查找和使用，基础的 Web Services 平台是 XML + HTTP)进去有文件WebServiceSSOUser.asmx，点进去发现GetUserList,一堆的用户名及MD5密码,由于demo站点用户较少，找了个多的截图\n\n\n\n\n\n\n\n\n\n照例，通过web.config中的sa密码连接内网数据库\n\n\n\nOVER:每个公司报销系统内部定义的用户名规则不一样，故流程该是先用webservices获取站点的用户密码，登录后再通过上传网马获取权限。   漏洞证明：  \n\n\n\n   修复方案：  限制上传格式及目录遍历？请专家定夺   版权声明：转载请注明来源 袋鼠妈妈@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-10-13 21:25 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-14 09:38 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  这个其实就是@杭州爱铂财务管理信息服务有限公司 属下的吧，以后转给他们就好了，@xsser @疯狗 @Finger     \n     2013-10-14 10:05 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @小胖子 怪不得7.5进去显示的是爱铂在线...    \n     2014-08-28 20:12 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @袋鼠妈妈 这个需要账号密码就不用发了，demo的肯定是有的，但对于其它用户，这个漏洞无法用上，属于后台getshell    \n     2014-08-28 20:18 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @U神  不用发了？这个发了很久了啊，而且，可以通过webservices接口获取用户和密码，所以即使没有用户也是可以用上的。我在描述里面有写清楚滴，你看完了吗？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}