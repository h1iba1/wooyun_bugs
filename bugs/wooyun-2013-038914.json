{"id": 9025, "wybug_id": "wooyun-2013-038914", "wybug_title": "泛微E-office OA管理系统存在任意文件下载及文件上传导致任意代码执行（已getshell）", "wybug_corp": "上海泛微网络科技股份有限公司", "wybug_author": "Coody", "wybug_date": "2013-10-06 00:29", "wybug_open_date": "2013-10-11 00:29", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 继续 applychen 的脚步，因为之前我遇到过这个系统，最新官方demo中也确实存在问题。感谢 applychen 提供的测试账号。@cncert国家互联网应急中心 有什么问题，可以私信我。 详细说明：  \n继续  WooYun: 泛微E-office OA管理系统存在SQL注射漏洞可查库  的挖掘官方demo http://eoffice8.weaver.cn:8028/login.php测试账号还是那个 xj\n存在两个问题：\n0x01:任意文件下载漏洞测试链接 http://eoffice8.weaver.cn:8028/inc/attach.php?OP=1&ATTACHMENT_NAME=index.php&ATTACHMENT_ID=5402024843其中，参数 ATTACHMENT_NAME 未有效的控制其范围，导致任意文件下载配置文件下载（程序zend加密，在网站http://www.showmycode.com/中可以解密）http://eoffice8.weaver.cn:8028/inc/attach.php?OP=1&ATTACHMENT_NAME=../../inc/oa_config.php&ATTACHMENT_ID=5402024843数据库连接文件下载http://eoffice8.weaver.cn:8028/inc/attach.php?OP=1&ATTACHMENT_NAME=../../mysql_config.ini&ATTACHMENT_ID=5402024843\n\n0x02:文件上传导致任意代码执行经分析inc/utility_all.php 的源码可知附件上传的路径为：attachment/$ATTACHMENT_ID /$ATTACHMENT_NAME建立个人日志--上传附件，查看源码得到相应的 ATTACHMENT_ID 及 ATTACHMENT_NAME 的值，从配置文件中可以知道，附件中未禁止php4格式的文件上传，因此可以直接getshell通过以上分析，最终得到的shell地址是：http://eoffice8.weaver.cn:8028/attachment/2506423447/conf1g.php4 密码是8（system权限）\n   漏洞证明：  \n0x01:任意文件下载漏洞\n\n\n\n\n\n\n\n\n\n\n\n0x02:文件上传导致任意代码执行\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  确实存在通用性。   版权声明：转载请注明来源 Coody@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-10-11 00:29 厂商回复：  漏洞Rank：20  (WooYun评价) 最新状态： 2013-10-11：CNVD在官方demo上确认所述情况，根据提取的应用特征查找到一些实例，由于未能取得当前测试用户权限，对于通用性还需要进一步确认。未及时确认，向白帽子致歉，根据行业用户潜在影响，rank 20（请剑心补上吧）  ", "replys": "漏洞评价：\n评论\n     2013-10-06 01:29 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  @cncert国家互联网应急中心  。。。。很好奇一个月前那份泛微的报告谁写的 8081端口  默认口令 之类的。。。。命令执行还真没细看    \n     2013-10-06 01:34 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @淡漠天空 亲，今夜无眠？？    \n     2013-10-06 02:02 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  @Coody 听说朋友网可以看妹子QQ   正在聊。。。。        \n     2013-10-06 08:01 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  @疯狗 为什么我的洞审核每次都慢一点。。。    \n     2013-10-06 08:05 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @Mas 不要急、请耐心等待一下哈，都比较辛苦哈    \n     2013-10-06 15:46 |    \t\tapplychen \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:16        | 白发现首)\t\t \n  这个漏洞是关于下载文件路径的那个算法的吗    \n     2013-10-06 15:59 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @applychen 上传及下载都有。。。。    \n     2013-10-10 11:28 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @cncert国家互联网应急中心    \n     2013-10-11 07:46 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  无影响？？？？？    \n     2013-10-11 09:08 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  2013-10-11：CNVD在官方demo上确认所述情况，根据提取的应用特征查找到一些实例，由于未能取得当前测试用户权限，对于通用性还需要进一步确认。未及时确认，向白帽子致歉，根据行业用户潜在影响，rank 20（请剑心补上吧）    \n     2013-10-11 09:12 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @xsser  @疯狗    \n     2013-10-11 09:14 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  我去把我自己测试时上传的马删掉吧    \n     2013-10-11 11:38 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Coody 给了    \n     2013-10-11 11:41 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @疯狗 3Q...    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}