{"id": 149, "wybug_id": "wooyun-2014-077242", "wybug_title": "TRS WCM存储型跨站脚本（指谁打谁）", "wybug_corp": "北京拓尔思信息技术股份有限公司", "wybug_author": "夏殇", "wybug_date": "2014-09-25 10:26", "wybug_open_date": "2014-11-09 10:28", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-09：\t细节向公众公开  简要描述： TRS WCM存储型跨站脚本，指谁打谁 详细说明：  测试版本为V6.0。共两处存储型跨站脚本。一处在用户名那里，指谁打谁。另一处是在日程安排处，估计只能自己打自己。一.用户名处。因为用户名是在客户端做了限制，属性设置成了readonly，然后因为是弹出的小窗口，所以F12也弹不出来开发者工具。我这里是通过抓取数据包改的。因为当时测试的时候没有吧用Fiddlers抓取的数据包给截图。后来想再改回去正常的用户名的时候也改不回去了。改完之后用户名是超过20个字符了，在修改信息页面点击确定之后会出现一个用户名超过20个字符的弹窗。所以是抓取不了提交修改用户名的数据包了。这里只能给出修改之后的一个截图证明。用户名修改为<script>alert(1)</script>.\n\n修改完之后刷新一下页面就看到弹窗啦。\n\n漏洞利用的话，可以通过给其他用户发送短消息来获取任意用户的cookie，指谁打谁。\n\n还有一个地方就是用户在查看当前在线用户的时候也可以触发跨站，谁看打谁。\n\n二.日程安排处。日程安排处新建日程。标题和内容输入<script>alert(/XSS/)</script>。\n\n\n\n   漏洞证明：  看详细说明~   修复方案：  实施安全编码规范，输入过滤，输出编码。   版权声明：转载请注明来源 夏殇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-09-25 16:03 厂商回复： 感谢您的反馈，经确认，存在跨站脚本隐患，但因为实施攻击和受攻击的用户均必须为系统内部合法注册用户（可追溯），加之页面层已做控制，且限定信息长度（脚本长度受限），对隐患可能会产生的破坏性做综合分析判定后，认为此问题属于较低级别。本着对安全问题的重视，已安排相关技术人员做针对性的修复和补丁包发布。*** 安全无止境，我们一直在努力！*** 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-25 10:28 |    \t\t狗狗侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:497 漏洞数:55        | 我是狗狗侠)\t\t \n  能打我吗。哈哈    \n     2014-09-25 12:37 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @狗狗侠 来试试，保证不打你    \n     2014-09-25 12:40 |    \t\t狗狗侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:497 漏洞数:55        | 我是狗狗侠)\t\t \n  保证不打死吗    \n     2014-09-25 12:46 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @狗狗侠 不敢打大牛！    \n     2014-09-25 12:47 |    \t\t狗狗侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:497 漏洞数:55        | 我是狗狗侠)\t\t \n  @夏殇  我保证不打死你。 哈哈    \n     2014-09-25 12:49 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @狗狗侠 居然有反打技术，快教我    \n     2014-09-25 13:13 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  乌云一般的商业网站的XSS都走小漏洞，你这个cms内部的xss居然都走正常流程。    \n     2014-09-25 14:45 |    \t\t少帅 \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:14        )\t\t \n  外网的XSS?    \n     2014-09-25 17:31 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @夏殇 基友，上头条了。    \n     2014-09-25 19:31 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @大亮 我也不知道怎么回事,第一次上首页啊。想想还有点小激动    \n     2014-09-25 19:32 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @ki11y0u 求带飞    \n     2014-09-25 19:40 |    \t\tl0u1s \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:3        | 崇尚自由、开放、共享、简约。)\t\t \n  @夏殇 夏老大求带！    \n     2014-09-25 20:00 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @l0u1s 颖哥带我飞    \n     2014-09-25 20:41 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @夏殇 哈哈，想想还有点小激动。    \n     2014-09-25 22:13 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @夏殇 求搞基，求交流~    \n     2015-04-02 10:15 |    \t\t路人丶乙 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:13        | 花谢花飞飞满天 红消香断有谁怜)\t\t \n  @大亮 你怎么看出来是走正规流程的？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}