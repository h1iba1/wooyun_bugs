{"id": 50861, "wybug_id": "wooyun-2014-076547", "wybug_title": "泛微某系统漏洞集合（不拿shell不是合格的白帽子）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2014-09-19 19:13", "wybug_open_date": "2014-12-18 19:14", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向公众公开  简要描述： 连锁反应...走起...SQL注入 --- 文件上传（需登录） ---  文件上传（无需登录） 详细说明：  继续 e-cology ... WooYun: 泛微某系统通用型SQL注入(无需登录) 无奈走了小厂商流程...￣□￣｜｜--------------通过之前的SQL注入，可轻易的获取登录帐号。测试过程中，找了两个存在弱口令的系统直接登录（并未跑取数据）。发现漏洞如下：①登录状态下的文件上传②无需登录直接getshell--------------① 登录状态下的文件上传导致任意代码执行漏洞漏洞模块为：我的邮件 -- 联系人 -- 导入 -- 以逗号为分隔符的CVS文件漏洞描述：对于用户上传的文件格式未进行限制且并未重命名文件名，可导入jsp文件。通过查看数据包，得到存储的路径为：webroot/email/csv/ 。最终得到的文件路径为：http://www.xxoo.com/email/csv/上传的文件名.jsp\n\n\n\n\n\n漏洞证明：http://oa.nws.gov.cn/email/csv/wooyun.jsp\n\nhttp://oaf.yitoa.com:6688/email/csv/wooyun.jsp\n\n② 无需登录直接getshell在程序目录中翻了又翻，发现 tools/SWFUpload/upload.jsp ，并未验证当前用户是否为登录状态，提交文件，可直接写入根目录下。最终得到的文件访问路径为：http://www.xxoo.com/null上传的文件名.jsp本地构造提交表单\n<form method='post' action='http://www.xxoo.com/tools/SWFUpload/upload.jsp'  enctype=\"multipart/form-data\" > <input type=\"file\" id=\"file\" name=\"test\" style=\"height:20px;BORDER: #8F908B 1px solid;\"/><button type=submit value=\"getshell\">getshell</button> </form>\n漏洞证明：http://220.248.243.186:8081/nullwooyun.jsp\n\nhttp://oa.hnnc.net:82/nullwooyun.jsp\n\nhttp://oa.yangtzeu.edu.cn/nullwooyun.jsp\n\n   漏洞证明：  部分案例供cncert国家互联网应急中心测试：http://gl.triolion.com/http://zmoa.warom.com:801/http://www.yzjoa.com/http://oa.nws.gov.cn/http://www.cweme.net/http://cyoa.warom.com:803/http://220.248.243.186:8081/http://sys.cdc.zj.cn/http://cygf.warom.com:805/http://oa.cncie.com/http://oa.uuzz.com/http://oa.hnnc.net:82/http://oa.yangtzeu.edu.cn/http://oaf.yitoa.com:6688/… More …   修复方案：  ①对于测试中躺枪的站点深表歉意。②厂商的态度是所有白帽子们的根本动力。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-24 08:29 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-17 09:41 |    \t\t这只猪 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 南无阿弥陀佛！)\t\t \n  mark一下    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}