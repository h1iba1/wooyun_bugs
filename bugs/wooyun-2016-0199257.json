{"id": 87607, "wybug_id": "wooyun-2016-0199257", "wybug_title": "运营商安全之中国联通某管理系统命令执行（多站管理账户泄漏）                                      ", "wybug_corp": "中国联通", "wybug_author": "李旭敏", "wybug_date": "2016-04-22 15:30", "wybug_open_date": "2016-06-10 09:50", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-10：\t细节向公众公开  简要描述： 听说几何黑店来签到了，我也就出山了 详细说明：  \n**.**.**.**:8080/whz/to_Login_login.html\n存在struts2命令执行对应的url地址是\nhttp://**.**.**.**:8080\n\n**.**.**.**:8080/whz/md5.jsp\n传了webshell可以直接执行命令进服务器啦\n\n\n\n   漏洞证明：  \n\n\n\n确实是联通的通过查看3389的端口发现改为了63389，且连接进去提示终端用户过多，登不进去。有个小技巧，远程连接服务时加个console即可绕过**.**.**.**:63389/console\n\n一般说windows找敏感信息的最好的方法就是去管理桌面。然后找到了这个\n\n一堆内网的账户密码还有服务器的登录账户密码。\n\n作者还在写php嗯，感觉有注入的样子\nif ($action==\"shen\"){\t$id=$_GET[\"id\"];\t$sql1=\"update wo_tuan set shen=1 where id='$id'\";\t$query1=@mysql_query( $sql1 ) or die(\"SQL语句执行错误！\");\techo \"<SCRIPT LANGUAGE=JavaScript>window.location.href='api_tuangou_admin.php?page={$page}{$myurl}';</script>\";\t}if ($action==\"noshen\"){\t$id=$_GET[\"id\"];\t$sql2=\"update wo_tuan set shen=0 where id='$id'\";\t$query2=@mysql_query( $sql2 ) or die(\"SQL语句执行错误！\");\techo \"<SCRIPT LANGUAGE=JavaScript>window.location.href='api_tuangou_admin.php?page={$page}{$myurl}';</script>\";\t}if ($action==\"tj\"){\t$id=$_GET[\"id\"];\t$sql1=\"update wo_tuan set tuijian=1 where id='$id'\";\t$query1=@mysql_query( $sql1 ) or die(\"SQL语句执行错误！\");\techo \"<SCRIPT LANGUAGE=JavaScript>window.location.href='api_tuangou_admin.php?page={$page}{$myurl}';</script>\";\t}if ($action==\"notj\"){\t$id=$_GET[\"id\"];\t$sql2=\"update wo_tuan set tuijian=0 where id='$id'\";\t$query2=@mysql_query( $sql2 ) or die(\"SQL语句执行错误！\");\techo \"<SCRIPT LANGUAGE=JavaScript>window.location.href='api_tuangou_admin.php?page={$page}{$myurl}';</script>\";\t}if($action==\"del\"){\t$id=$_GET[\"id\"];\t$sql=\"select * from wo_tuan where id='$id'\";\t$query=mysql_query($sql) or die(\"SQl语句出错！！\");\tif(!$rs=mysql_fetch_array($query)){\t\techo \"<SCRIPT LANGUAGE=JavaScript>alert ('您查看的信息不存在！^_^');window.location.href='api_tuangou_admin.php?page={$page}{$myurl}';</script>\";\t\t}else{\t\t$sql=\"delete from wo_tuan where id='$id'\";\t\t$query=mysql_query($sql) or die(\"SQl语句出错！！\");\t\techo \"<SCRIPT LANGUAGE=JavaScript>alert ('删除成功！^_^');window.location.href='api_tuangou_admin.php?page={$page}{$myurl}';</script>\";\t}}?>\n24行，自行检查吧。。\n\nmask 区域\n*****smtp.host**********me=zjn**********glec@**.**********32100&lt*****\n\n\n\n\nmask 区域\n\n*****^^管理地址\t网站帐号\t^***********\t**.**.**.**/kns50um\tcnki\tcnki\t\t\t\t2**********\t\t\t\t**********70721@cqjky\t图书^**********dmin/admin_login.asp\talan\tspecte**********angbo#cqj**********网\t**.**.**.**(www.**.**.**.**)\twww.**.***********.**.**/ess2.0/login.asp\tadmini**********dmin_login.asp\talan\tspecte**********angbo#cqj**********/admin/admin_login.asp\ta************.**/cqyx/admin_login.asp\tala**********jky_xxzx\t\tliq**********zx\t\t**.**.**.**\t\tyb\t136094**********.**.**/admin/admin_lo**********\t\t\t\t**********\t\t\t\t**********^号：杨博/63602448\t**.**.**.**/o**********.**)\t**.**.**.**/cqyx/admin_login.asp\talan\tspecter#crowxp_007\t**.***********jky_xxzx\t\tliq**********//**.**.**.**/admin/Admin_login.asp\ty**********min_login.asp\tya***********.**/admin/admin_login**********\t\t\t\t************.**.**)\t**.**.**.**/cqyx/admin_login.asp\t**********x/admin_login.asp\tcrowxp\tsp**********xxzx\t\tyangbo\tya**********blog/cqyx/admin_login.***********)\t**.**.**.**/cqyx/admin_login.asp\tyb\tc**********qyx/admin_login.asp\t杨^**********.**.**.**/cqxt/manage/login.asp**********83\t\t\tser-u^**********nistrato*****\n\n\n\n\n\n<alias>CommProxool</alias>    <driver-url>jdbc:oracle:thin:@**.**.**.**:1521:ORCL</driver-url>    <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>    <driver-properties>      <property name=\"user\" value=\"zscomm_db2\"/>      <property name=\"password\"  value=\"zsjlcomm_188db\"/>    </driver-properties>    <maximum-connection-count>70</maximum-connection-count>    <simultaneous-build-throttle>20</simultaneous-build-throttle>    <house-keeping-test-sql>select CURRENT_DATE</house-keeping-test-sql>  </proxool>   <proxool>    <alias>LocalProxoolHZ</alias>    <driver-url>jdbc:oracle:thin:@**.**.**.**:1521:ORCL</driver-url>    <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>    <driver-properties>      <property name=\"user\" value=\"u_zshz_db\"/>      <property name=\"password\"  value=\"zsjl_188hzdb\"/>    </driver-properties>    <maximum-connection-count>100</maximum-connection-count> <simultaneous-build-throttle>20</simultaneous-build-throttle>    <house-keeping-test-sql>select CURRENT_DATE</house-keeping-test-sql>  </proxool>  <proxool>    <alias>LocalProxool</alias>    <driver-url>jdbc:oracle:thin:@**.**.**.**:1521:ORCL</driver-url>    <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>    <driver-properties>      <property name=\"user\" value=\"u_ltllyy_db\"/>      <property name=\"password\"  value=\"u_ltllyy_db\"/>    </driver-properties>    <maximum-connection-count>100</maximum-connection-count>    <house-keeping-test-sql>select CURRENT_DATE</house-keeping-test-sql>  </proxool>\n   修复方案：     版权声明：转载请注明来源 李旭敏@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2016-04-26 09:45 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国联通集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-22 16:20 |    \t\tDotaer \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:8        | 多学习，多挖洞！)\t\t \n  大牛是不是有神器啊？求分享    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}