{"id": 14911, "wybug_id": "wooyun-2012-015978", "wybug_title": "扬子晚报官方购物平台百万用户信息泄漏", "wybug_corp": "扬子晚报网", "wybug_author": "se55i0n", "wybug_date": "2012-12-13 23:03", "wybug_open_date": "2013-01-27 23:03", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-27：\t细节向公众公开  简要描述： 剑心，我真的没脱裤~ 详细说明：  1）整个事件起源于一处SQL注射，好久之前发了剑心没给过，下午偶然看到记录，就挖掘了下~~注射点:http://service.xhby.net/yiliao/item.php?id=695  再友情赠送一枚：http://meirong.yangtse.com/chanel.php?id=142）不知道管理员怎么想的，之前发现这个注入点的时候数据库权限并不是root，今天再次测试发现成了root权限，顿时来了兴趣；\n\n3）既然是root权限，就可以使用load_file()查看配置文件获取我们想要的信息，查看apache默认配置文件，发现同服务器的存在几个重要网站（信息作了部分处理）；\n#</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/xxx/    ServerName blog.yzwb.net    ErrorDocument 404 http://www.yangtse.com/#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/xxx/    ServerName blog.yangtse.com    ErrorDocument 404 http://www.yangtse.com/#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/xxx/    ServerName service.yangtse.com    ErrorDocument 404 http://www.yangtse.com/#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/xxx/    ServerName service.yzwb.net    ErrorDocument 404 http://www.yangtse.com/#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/eshop/test/xxx/    ServerName www.dalibao.cn#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/eshop/test/xxx/    ServerName www.960961.cn#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/eshop/test/xxx/    ServerName www.960961.net#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/eshop/test/xxx/    ServerName shop.yzwb.net#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/eshop/test/xxx/    ServerName shop.yangtse.com#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/xxx/    ServerName app.yzwb.net#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/xxx/    ServerName app.yangtse.com#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/eshop/test/xxx/    ServerName www.960961.com#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/eshop/test/xxx/    ServerName 960961.com#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/eshop/test/xxx/    ServerName 960961.cn#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/eshop/test/xxx/    ServerName www.960961.cn#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/eshop/test/xxx/    ServerName 960961.net#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/eshop/test/xxx/    ServerName www.960961.net#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/shop/xxx/    ServerName tg.960961.com#   ErrorLog error_log#   CustomLog culog</VirtualHost><VirtualHost *:80>    DocumentRoot /var/www/html/service/xxx/    ServerName baby.yzwb.net#   ErrorLog error_log#   CustomLog culog</VirtualHost>####   ----------------------- xhby ---------------          ###<VirtualHost *:80>    ServerName   service.xhby.net    DocumentRoot \"/var/www/html/xxx/\"</VirtualHost><VirtualHost *:80>    ServerName   ly2012.xhby.net    DocumentRoot \"/var/www/html/path/myphp/xxx/\"</VirtualHost><VirtualHost *:80>   ServerName  ocar.com.cn   DocumentRoot \"/var/www/html/path/xxx/\"</VirtualHost><VirtualHost *:80>   ServerName  www.ocar.com.cn   DocumentRoot \"/var/www/html/path/xxx/\"</VirtualHost><VirtualHost *:80>     ServerAdmin xyz@xhby.net     ServerName  \"www.jslegal.com\"     DocumentRoot \"/var/www/html/path/xxx/\"</VirtualHost><VirtualHost *:80>     ServerAdmin xyz@xhby.net     ServerName  \"77.xhby.net\"     DocumentRoot \"/var/www/html/path/xxx/\"</VirtualHost>\n4)有了网站路径信息，接下来就能读取数据库配置信息了，然后就能...（YY），读取到数据库配置信息如下：\n<?php $dbuser       = 'root';  //用户名$dbpwd        = 'a7vztx';//密码$dbname       = 'yiliao';//数据库名称$dbz          = '';      //数据库表前缀?>\n5）好吧~数据库用户名、密码都有了，能远程连接到数据库么~~哈哈，不能连接也没有本文咯；\n\n6）好吧~这里才是keypoint,扬子晚报官方购物平台的数据库，当然还有一下其他数据库，信息非常丰富；\n\n6.1）去，还有工作单位；\n\n6.2）\n\n6.3）\n\n6.4）\n\n   漏洞证明：  见详细说明~   修复方案：     版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2012-12-18 15:41 厂商回复： CNVD确认漏洞并复现所述情况，转由CNCERT江苏分中心协调涉事单位处置。按完全影响机密性进行评分，基本危害评分7.79（高危），发现技术难度系数1.0，涉及行业或单位影响系数1.4，综合rank=10.906，涉及多家单位，rank +2 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-14 01:56 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  各种报纸都来了。@xsser。是不是应该让报纸成为直接的厂商咧，然后帮我们登点新闻，征婚啥的，多欢乐    \n     2012-12-14 08:26 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  楼上正解。。下次谁不老实，就直接在报纸上登“XX，入侵了哪个哪个站点，乌云有图有文章”。。看谁还敢起那么霸气的标题，吓死他丫的。。    \n     2012-12-14 08:33 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @gainover @鬼魅羊羔  哈哈～啥子时候能把江苏台收为厂商就好了……搞不好还能来个乌云专场……嘎嘎    \n     2012-12-18 12:50 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @cncert国家互联网应急中心 看来你们想忽略这个洞哇~    \n     2012-12-18 12:55 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser cncert肿么了，这洞马上就要公开了，不晓得会被多少人脱裤呀？    \n     2013-01-28 08:38 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  你这个就是想证明你是黑阔呀    \n     2013-01-28 09:11 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @小胖胖要减肥 我是白帽子~    \n     2013-01-28 09:35 |    \t\tLeadUrLife \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:14        | 好好学习 天天向上)\t\t \n  纳闷，这个点当初我咋没找到呢？。。。    \n     2013-01-28 21:44 |    \t\t暗夜清风 \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:10        | 大哥,你的娃娃掉了.举手之劳,不必以身相许)\t\t \n  洞主。。其实数据库外联是我开的。。没想到你也搞上了。。    \n     2013-01-29 09:12 |    \t\t马甲哥 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:9        | nice to meet you,i am 马甲哥~)\t\t \n  楼上牛X    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}