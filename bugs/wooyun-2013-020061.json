{"id": 13182, "wybug_id": "wooyun-2013-020061", "wybug_title": "新网已补漏洞继续利用（使用mydns的所有域名劫持）", "wybug_corp": "新网华通信息技术有限公司", "wybug_author": "Finger", "wybug_date": "2013-03-14 16:34", "wybug_open_date": "2013-04-28 16:34", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理", "用户密码泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-28：\t细节向公众公开  简要描述： 新网已补漏洞继续利用（使用mydns的所有域名劫持） 详细说明：   WooYun: 新网漏洞之主机管理越权和使用mydns的所有域名劫持 漏洞补了 但漏洞补的不够严谨最重要的是 能够获取域名管理密码的MD5值始终是个漏洞（未补）取得管理密码MD5值 即便没有其他地方来利用这个MD5密码 使用暴力碰撞解密MD5 获得域名的管理密码 登陆域名自主管理平台http://dcp.xinnet.com还是会对用户造成危害新网域名管理密码系统随机生成的密码为8位大小写字母+数字的组合 现在用好点儿的显卡跑 组成集群去破解 应该不会太久 攻击一个大点儿的目标 跑几个月 一年都是值得的言归正传 说说 WooYun: 新网漏洞之主机管理越权和使用mydns的所有域名劫持 未能修补的问题http://mydns3.xinnet.com/mydns/recordsList.do?DomainName=xinnet.com&mystring=[MD5]&mystring2=[跟代理商有关的一个编号]登陆新闻代理平台 进入【域名管理】=》【服务器商品】页面在地址栏执行：javascript:submitDNSFormaaa('域名') 会打开一个域名管理页面我们在【国际域名实名审核资料提交】中获取该域名管理密码的md5值留用在代理商域名管理页面随便打开一个域名的Mydns 用Burp代理截取\nGET /mydns/recordsList.do?DomainName=xinnet.com&mystring=[MD5]&mystring2=[跟代理商有关的一个编号] HTTP/1.1Accept: */*Referer: http://agent.xinnet.com/domain/manage.do?method=list&serviceState=02&forward=inusingAccept-Language: zh-cnUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET4.0C; .NET4.0E)Cookie: cookie内容Accept-Encoding: gzip, deflateProxy-Connection: Keep-AlivePragma: no-cacheHost: mydns3.xinnet.com\n发送至intruder 将域名和MD5替换成攻击目标的 我们来猜解mystring2的值 mystring2一般为136开头共7位猜解出mystring2的值之后我们在一个已经打开的域名mydns管理页面直接输入url（利用该cookie）：http://mydns3.xinnet.com/mydns/recordsList.do?DomainName=[目标域名]&mystring=[目标域名的MD5]&mystring2=[跟代理商有关的一个编号]这样就进入了目标域名的Mydns管理页面之后劫持吧 伙计！说明可能有点儿乱 如果不能复现 可以联系我。   漏洞证明：  漏洞受害者由新网出演：我们的目标：xinnet.com\n\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 Finger@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-03-18 14:02 厂商回复： 非常感谢！漏洞报告已收到 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-14 16:34 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  风中凌乱了    \n     2013-03-14 17:03 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  风中凌乱了    \n     2013-03-14 17:44 |    \t\t影刺 \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:25        | 关注web安全)\t\t \n  疯中凌乱了。    \n     2013-03-14 18:07 |    \t\tHxai11 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:218        | 于是我们奋力向前游，逆流而上的小舟，不停...)\t\t \n  lz专注新网漏洞三十年，从未变过。    \n     2013-03-14 18:41 |    \t\t溪水流淌 \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 如果一切都任我欲为，我会有迷失在这自由深...)\t\t \n  疯中凌乱了。    \n     2013-03-14 22:19 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  风中凌乱了    \n     2013-03-15 00:06 |    \t\t小色 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 撸的一手好管)\t\t \n  撸主在来一季 就把WB全送给你    \n     2013-03-15 08:49 |    \t\tnull \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 左岸是无法忘却的回忆，右岸是值得把握的青...)\t\t \n  新网的人恨不得马上查楼主水表    \n     2013-03-15 10:46 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  我凌乱了。    \n     2013-03-15 11:21 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  各种凌乱    \n     2013-03-15 13:53 |    \t\t小黑要低调 \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:4        | 小黑一枚)\t\t \n  最佳洞主又要成最撸力的了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}