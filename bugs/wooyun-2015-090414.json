{"id": 47923, "wybug_id": "wooyun-2015-090414", "wybug_title": "从一个上传到傲游内网", "wybug_corp": "傲游", "wybug_author": "Matt", "wybug_date": "2015-01-07 09:32", "wybug_open_date": "2015-01-12 09:34", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 从一个上传到傲游内网 详细说明：  从一个上传到傲游内网   漏洞证明：  首先是发现一个子域名的上传custom.maxthon.cn在上传图标的时候只验证了content-type没有对文件后判断\n\n简单改包拿到shell\n\n发现一些配置信息\n$_Database_Config = array('dbhost' => '10.0.8.48',     'dbuser' => 'm_backend_cn',     'dbpass' => 'aoOJ1beLIDApfJC',     'dbname' => 'adbrw_admin',     'charset' => 'utf8',     'pconnect' => '0',     'environments' => 'production''mail.maxthon.cn',                                   'port'     =>     '25',                                   'auth'     =>     'true',                                   'user'     =>     'zhaohongfeng@maxthon.cn',                                   'pass'     =>     '@2010'     /*$_Database_Config = array(     'dbhost'     =>     'localhost',                                        'dbuser'     =>     'root',                                        'dbpass'     =>     '123456',                                        'dbname'     =>     'adbmac_admin',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'                                   );*/     //?版.搴.??ワ?绾夸?                                  $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'odbmac_admin',                                        'dbpass'     =>     'BvYinxtAiS9P05P',                                        'dbname'     =>     'odbmac_admin',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'     $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'odbmac_admin',                                        'dbpass'     =>     'BvYinxtAiS9P05P',                                        'dbname'     =>     'odbmac_admin',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'                                        'dbuser'     =>     'm_mad_cn',                                        'dbpass'     =>     'zLXM5NoF107bS8l',                                        'dbname'     =>     'adbrw_mad',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'     $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'm_plugins_cn',                                        'dbpass'     =>     'MD2xPBtiyrf0z0Y',                                        'dbname'     =>     'adbrw_plugins',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'     $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'm_feedback_cn',                                        'dbpass'     =>     'Th8K6k7vw6g2eZy',                                        'dbname'     =>     'feedback',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'     $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'adbrw_project',                                        'dbpass'     =>     '1q@W3e$R',                                        'dbname'     =>     'adbrw_channel',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'     $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'm_backendwp_cn',                                        'dbpass'     =>     'GrW651KCwDByFdH',                                        'dbname'     =>     'wp_admin',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0',                                        'environments' => 'development'                                        'dbuser'     =>     'm_webapp_cn',                                        'dbpass'     =>     '63KlZYVG',                                        'dbname'     =>     'adbrw_webapp',                                        'charset'     =>     'utf8',                                    'pconnect'     =>     '0'smtp_main_send( array('zhaohongfeng@maxthon.net','cuiwei@maxthon.net','linhongbin@maxthon.net')     $mail->Host       = \"mail.maxthon.net\";          $mail->Username   = \"Maxthon-MM@maxthon.net\";              $mail->Password   = \"1qaz2wsx\";\n并且这个邮箱密码成功登录～  \n\n然后就提了个权\n\n\nroot:$1$v4vAHK1L$p3MlF0AWUa3xMKMTBxG3f0:15733:0:99999:7:::bin:*:15267:0:99999:7:::\n随便扫了一下内网zabbix \n\ncacti\n\n\n\n\n\n\n\n还有这个不知道是什么玩意\n\n254是个华为的路由 看登录界面总感觉就像是办宽带电信送的。。恩。。没接触什么重要的东西，，点到为止，，差不多一点拿到的shell，到现在结束～   修复方案：  首先是发现一个子域名的上传custom.maxthon.cn在上传图标的时候只验证了content-type没有对文件后判断\n\n简单改包拿到shell\n\n发现一些配置信息\n$_Database_Config = array('dbhost' => '10.0.8.48',     'dbuser' => 'm_backend_cn',     'dbpass' => 'aoOJ1beLIDApfJC',     'dbname' => 'adbrw_admin',     'charset' => 'utf8',     'pconnect' => '0',     'environments' => 'production''mail.maxthon.cn',                                   'port'     =>     '25',                                   'auth'     =>     'true',                                   'user'     =>     'zhaohongfeng@maxthon.cn',                                   'pass'     =>     '@2010'     /*$_Database_Config = array(     'dbhost'     =>     'localhost',                                        'dbuser'     =>     'root',                                        'dbpass'     =>     '123456',                                        'dbname'     =>     'adbmac_admin',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'                                   );*/     //?版.搴.??ワ?绾夸?                                  $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'odbmac_admin',                                        'dbpass'     =>     'BvYinxtAiS9P05P',                                        'dbname'     =>     'odbmac_admin',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'     $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'odbmac_admin',                                        'dbpass'     =>     'BvYinxtAiS9P05P',                                        'dbname'     =>     'odbmac_admin',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'                                        'dbuser'     =>     'm_mad_cn',                                        'dbpass'     =>     'zLXM5NoF107bS8l',                                        'dbname'     =>     'adbrw_mad',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'     $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'm_plugins_cn',                                        'dbpass'     =>     'MD2xPBtiyrf0z0Y',                                        'dbname'     =>     'adbrw_plugins',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'     $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'm_feedback_cn',                                        'dbpass'     =>     'Th8K6k7vw6g2eZy',                                        'dbname'     =>     'feedback',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'     $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'adbrw_project',                                        'dbpass'     =>     '1q@W3e$R',                                        'dbname'     =>     'adbrw_channel',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0'     $_Database_Config = array(     'dbhost'     =>     '10.0.8.48',                                        'dbuser'     =>     'm_backendwp_cn',                                        'dbpass'     =>     'GrW651KCwDByFdH',                                        'dbname'     =>     'wp_admin',                                        'charset'     =>     'utf8',                                        'pconnect'     =>     '0',                                        'environments' => 'development'                                        'dbuser'     =>     'm_webapp_cn',                                        'dbpass'     =>     '63KlZYVG',                                        'dbname'     =>     'adbrw_webapp',                                        'charset'     =>     'utf8',                                    'pconnect'     =>     '0'smtp_main_send( array('zhaohongfeng@maxthon.net','cuiwei@maxthon.net','linhongbin@maxthon.net')     $mail->Host       = \"mail.maxthon.net\";          $mail->Username   = \"Maxthon-MM@maxthon.net\";              $mail->Password   = \"1qaz2wsx\";\n并且这个邮箱密码成功登录～  \n\n然后就提了个权\n\n\nroot:$1$v4vAHK1L$p3MlF0AWUa3xMKMTBxG3f0:15733:0:99999:7:::bin:*:15267:0:99999:7:::\n随便扫了一下内网zabbix \n\ncacti\n\n\n\n\n\n\n\n还有这个不知道是什么玩意\n\n254是个华为的路由 看登录界面总感觉就像是办宽带电信送的。。恩。。没接触什么重要的东西，，点到为止，，差不多一点拿到的shell，到现在结束～   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-01-12 09:34 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-07 09:41 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  还以为是遨游内网    \n     2015-01-07 09:43 |    \t\tMatt  \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:107        | 承接代码审计 http://codescan.cn/)\t\t \n  @玉林嘎 哈哈    \n     2015-01-07 12:05 |    \t\thuc-ray \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:7        | 菜鸟一枚)\t\t \n  @玉林嘎 遨游内网还是遨游内网？汉字博大精深    \n     2015-01-12 09:51 |    \t\t杀器王子  \t\t\t( 普通白帽子  |\t\t\t        Rank:1532 漏洞数:121        | 磨刀霍霍向猪羊)\t\t \n  无良    \n     2015-01-12 09:55 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  厂商机智得关闭了网站    \n     2015-01-12 12:11 |    \t\tStardustsky \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | ……)\t\t \n  竟然忽略了！！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}