{"id": 5505, "wybug_id": "wooyun-2013-045164", "wybug_title": "ESPCMS某处SQL注入漏洞", "wybug_corp": "易思ESPCMS企业网站管理系统", "wybug_author": "neal", "wybug_date": "2013-12-11 10:55", "wybug_open_date": "2014-03-11 10:56", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-16：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-11：\t细节向公众公开  简要描述：  问题出在修复,这个开发的人已经是第二次修复有遗留问题了.上次修复 会员个人资料注入 有3个字段 结果就修复了2个字段,这次的问题跟这个差不多.  不过这个漏洞还是有点让人无语.真的很无语.  算通用吗? 详细说明：   问题出在邮件订阅. 其实就是这个漏洞http://wooyun.org/bugs/wooyun-2010-023688 但是官方没有修复完整 public.php 修复了. 但是 3gwap_public.php 未修复完.    问题是一样的.\n\n  查询出来未过滤,是存在二次注入.  好了现在就说这个漏洞的无语把.(因为这个问题没办法注入) \n\n  什么意思? WTF?  复制代码复制多了? 那必须是啊!    mailinvite_list 这个表是放订阅人的信息.     第一次个查询应该就是是否已订阅,如果订阅了就返回神马神马信息.   第二个查询 未毛是一样的表,一样的条件啊?     待我细心观察以后,发现了.其实下面查询的表应该是mailinvite_type!    为什么? 去看看就知道了.       因为订阅有很多type,可以订阅不同的type.    第二个查询意思应该是查询订阅的type是否存在.   不存在就返回神马神马的.    所以呢,我不止提交了一个SQL注入漏洞,还给您提交了一个BUG! \n\n   这就是新安装后订阅的问题.   总结下: 只要能注册会员, 首页能订阅邮件,就能二次注入.      最新的程序,是不能注入的,因为没办法订阅,但是老版本是行的,当然如果已经有了订阅数据也是行的.因为主要是第二个条件,只要有订阅数据就过了.(BUG)    漏洞证明：   \n\n   修复方案：   \n\n  记住! 2个文件都要改!   然后WAP文件里面addslashes($rsMember['alias']);   版权声明：转载请注明来源 neal@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-12-13 10:42 厂商回复： 感谢您提供此漏洞，我们会尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}