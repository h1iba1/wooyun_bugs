{"id": 47880, "wybug_id": "wooyun-2014-085124", "wybug_title": "新浪某站任意用户密码修改（验证码与取回逻辑设计不当）", "wybug_corp": "新浪", "wybug_author": "s3xy", "wybug_date": "2014-11-28 17:48", "wybug_open_date": "2015-01-12 17:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-12：\t细节向公众公开  简要描述： 新浪某站任意用户密码修改，影响大量用户 详细说明：  问题网站http://esf.sina.com.cn/  【新浪二手房】在主站登录处点击登录\n\n随后点击忘记密码在http://broker.esf.sina.com.cn/login/findpassword  界面输入用户名时抓包\n\n可以看到返回数据中含有该用户的手机号通过解密，得到此用户shenzhen的手机号为182****7672在密码找回处输入解密后的手机号，并点发送验证码。再次抓包\n\n可见短信验证码加密后返回给了浏览器，我们解密。得出验证码为234589。成功重置密码\n\n   漏洞证明：  ****************************下面就是有意思的了通过几次测试，发现该网站的验证码程序很有意思。所有验证码为6位，且依次每位均比左边一位大。比如会出现123456，但一定不会出现123465的情况。重置后的密码也遵循此规律。另外验证码第一位只会是2、3、4。****************************下面给出我的破解字典\n234567234568234569234579234589234578234679234678234789235789236789245678245679245689245789246789256789345678345679456789\n成功破出重置后的密码为246789\n\n至此，成功登录该用户。\n\n   修复方案：  验证码程序的问题得改不要把敏感数据返回浏览器   版权声明：转载请注明来源 s3xy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-12-01 11:06 厂商回复： 感谢关注新浪安全，此为合作方的网站，是网站自有账号体系，新浪账号不受此影响。将会通知合作方进行整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-28 18:37 |    \t\tp4ssw0rd \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:92        | 不作死就不会死)\t\t \n  :)    \n     2014-11-28 20:05 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:142        | 相忘于江湖，不如相濡以沫)\t\t \n  :(    \n     2014-11-28 20:07 |    \t\ts3xy \t\t\t( 核心白帽子 |\t\t\t        Rank:832 漏洞数:113        | 相濡以沫，不如相忘于江湖)\t\t \n  @bey0nd @p4ssw0rd :|    \n     2014-11-28 21:58 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:471 漏洞数:110        | X)\t\t \n  &%……&%￥%……￥%……￥%#    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}