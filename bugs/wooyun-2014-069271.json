{"id": 52998, "wybug_id": "wooyun-2014-069271", "wybug_title": "pageadmin注入漏洞", "wybug_corp": "pageadmin.net", "wybug_author": "Vigoss_Z", "wybug_date": "2014-07-22 11:00", "wybug_open_date": "2014-10-20 11:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-20：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： rt 详细说明：  管理员登陆处。获得管理员登陆ip并记录，获得ip方式有问题。x-forwarded-for注入。\nhttp://bbs.pageadmin.net/showtopic-28377.aspx\n20140415本机测试，X-FORWARDED-FOR:8.8.8.8','20140721');\nselect * from pa_member where @@version>0 --\n。官网,demo改了登陆url./e/master/login.aspx\n<% @ Page Language=\"c#\" Inherits=\"PageAdmin.master_login\"%>\n看ilspy里面的PageAdmin master_login的SRDuaCUjVn函数，存在x-forwarded-for则记录，关键代码：\ntext = master_login.smnQ8wkbBIPFSYwavp0(this).ServerVariables[\"HTTP_X_FORWARDED_FOR\"];\n后续也没有做处理。vCBu9t9Jd6():\nthis.cx1UsTbPYR = master_login.IJfrrCknPpUqP4RXYZs(new object[]\t\t{\t\t\t\"update pa_member set lastdate='\",\t\t\tdateTime,\t\t\t\"',lst_ip='\",\t\t\tthis.C40Uh8y68l,\t\t\t\"',beizhu='\",\t\t\tthis.mHfUkK4Wdy,\t\t\t\"',logins=logins+1 where username='\",\t\t\ttext,\t\t\t\"'\"\t\t});\n   漏洞证明：  \n\n\n\n   修复方案：  （稍候补ilspy的图）   版权声明：转载请注明来源 Vigoss_Z@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-07-22 11:20 厂商回复： 谢谢，我司将在下个版本统计修复此问题。 最新状态： 2014-10-17：最新版本已经修复了此问题  ", "replys": "漏洞评价：\n评论\n     2014-07-28 13:29 |    \t\tVigoss_Z \t\t\t( 普通白帽子  |\t\t\t        Rank:404 漏洞数:63        | 楞娃)\t\t \n  @Finger现在还能修改么    \n     2014-07-29 09:25 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Vigoss_Z 厂商确认了，不行了吧    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}