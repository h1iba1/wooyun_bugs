{"id": 26811, "wybug_id": "wooyun-2015-0127621", "wybug_title": "劳动用工备案管理信息系统某应用设计不当导致getshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-07-21 19:05", "wybug_open_date": "2015-09-07 16:06", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向公众公开  简要描述： 劳动用工备案管理信息系统某应用设计不当导致getshell+内网漫游 详细说明：  网址：http://ptpm.mohrss.gov.cn:8080/用户名：wangxiangyu密码：888888\n\n上传头像处存在任意文件上传。、\nfunction checkPic(){\t\t\t\tvar picPath=document.getElementById(\"picPath\").value;\t\t\t\tvar type=picPath.substring(picPath.lastIndexOf(\".\")+1,picPath.length).toLowerCase();\t  \t\t\tif(type!=\"jpg\"&&type!=\"bmp\"&&type!=\"gif\"&&type!=\"png\"){\t\t   \t\t\talert(\"请上传正确的图片格式\");\t\t \t\t\treturn ;\t \t\t\t}\t \t\t}\t \tfunction closeWin(){\t\t\twindow.close();\t\t}\n直接改下就可以上传了。\nif(type!=\"jpg\"&&type!=\"bmp\"&&type!=\"gif\"&&type!=\"png\"&&type!=\"jsp\"){\n然后直接上传jsp文件，或许shell。\n\n直接内网渗透，因为是政府敏感单位，不敢深入了。\nC:\\pmis2\\> ipconfigWindows IP 配置以太网适配器 本地连接:   连接特定的 DNS 后缀 . . . . . . . :    本地链接 IPv6 地址. . . . . . . . : fe80::2078:9363:f0f3:2ae8%12   IPv4 地址 . . . . . . . . . . . . : 10.1.112.63   子网掩码  . . . . . . . . . . . . : 255.255.255.0   默认网关. . . . . . . . . . . . . : 10.1.112.254隧道适配器 isatap.{7C9B5EB9-CA25-4E51-8077-9CE8AFC019FC}:   媒体状态  . . . . . . . . . . . . : 媒体已断开   连接特定的 DNS 后缀 . . . . . . . : 隧道适配器 本地连接* 6:   连接特定的 DNS 后缀 . . . . . . . :    IPv6 地址 . . . . . . . . . . . . : 2001:0:9d38:90d7:1cba:173c:f5fe:8fc0   本地链接 IPv6 地址. . . . . . . . : fe80::1cba:173c:f5fe:8fc0%11   默认网关. . . . . . . . . . . . . : ::\n\n#jdbc.driverClassName = oracle.jdbc.driver.OracleDriver#jdbc.url = jdbc\\:oracle\\:thin\\:@192.168.1.246\\:1521\\:lbsdata#jdbc.username = pm**#jdbc.password =pm**jdbc.driverClassName = oracle.jdbc.driver.OracleDriverjdbc.url = jdbc\\:oracle\\:thin\\:@10.1.70.31\\:1521\\:orcljdbc.username = pmi**jdbc.password =pmi**#jdbc.driverClassName = oracle.jdbc.driver.OracleDriver#jdbc.url = jdbc\\:oracle\\:thin\\:@192.168.1.210\\:1521\\:orcl#jdbc.username = pm**#jdbc.password =pm**\n   漏洞证明：  网址：http://ptpm.mohrss.gov.cn:8080/用户名：wangxiangyu密码：888888\n\n上传头像处存在任意文件上传。、\nfunction checkPic(){\t\t\t\tvar picPath=document.getElementById(\"picPath\").value;\t\t\t\tvar type=picPath.substring(picPath.lastIndexOf(\".\")+1,picPath.length).toLowerCase();\t  \t\t\tif(type!=\"jpg\"&&type!=\"bmp\"&&type!=\"gif\"&&type!=\"png\"){\t\t   \t\t\talert(\"请上传正确的图片格式\");\t\t \t\t\treturn ;\t \t\t\t}\t \t\t}\t \tfunction closeWin(){\t\t\twindow.close();\t\t}\n直接改下就可以上传了。\nif(type!=\"jpg\"&&type!=\"bmp\"&&type!=\"gif\"&&type!=\"png\"&&type!=\"jsp\"){\n然后直接上传jsp文件，或许shell。\n\n直接内网渗透，因为是政府敏感单位，不敢深入了。\nC:\\pmis2\\> ipconfigWindows IP 配置以太网适配器 本地连接:   连接特定的 DNS 后缀 . . . . . . . :    本地链接 IPv6 地址. . . . . . . . : fe80::2078:9363:f0f3:2ae8%12   IPv4 地址 . . . . . . . . . . . . : 10.1.112.63   子网掩码  . . . . . . . . . . . . : 255.255.255.0   默认网关. . . . . . . . . . . . . : 10.1.112.254隧道适配器 isatap.{7C9B5EB9-CA25-4E51-8077-9CE8AFC019FC}:   媒体状态  . . . . . . . . . . . . : 媒体已断开   连接特定的 DNS 后缀 . . . . . . . : 隧道适配器 本地连接* 6:   连接特定的 DNS 后缀 . . . . . . . :    IPv6 地址 . . . . . . . . . . . . : 2001:0:9d38:90d7:1cba:173c:f5fe:8fc0   本地链接 IPv6 地址. . . . . . . . : fe80::1cba:173c:f5fe:8fc0%11   默认网关. . . . . . . . . . . . . : ::\n\n#jdbc.driverClassName = oracle.jdbc.driver.OracleDriver#jdbc.url = jdbc\\:oracle\\:thin\\:@192.168.1.246\\:1521\\:lbsdata#jdbc.username = pm**#jdbc.password =pm**jdbc.driverClassName = oracle.jdbc.driver.OracleDriverjdbc.url = jdbc\\:oracle\\:thin\\:@10.1.70.31\\:1521\\:orcljdbc.username = pmi**jdbc.password =pmi**#jdbc.driverClassName = oracle.jdbc.driver.OracleDriver#jdbc.url = jdbc\\:oracle\\:thin\\:@192.168.1.210\\:1521\\:orcl#jdbc.username = pm**#jdbc.password =pm**\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-07-24 16:04 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向国家上级信息安全协调机构上报,由其后续协调网站管理单位处置. 同时发北京分中心处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}