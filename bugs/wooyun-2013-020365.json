{"id": 12099, "wybug_id": "wooyun-2013-020365", "wybug_title": "华安保险JBoss JMX-console HTTP认证绕过，远程写shell漏洞", "wybug_corp": "华安保险", "wybug_author": "慕林", "wybug_date": "2013-03-20 15:43", "wybug_open_date": "2013-06-18 15:43", "wybug_type": "默认配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "配置不当", "认证绕过", "远程代码执行漏洞", "远程命令执行", "任意文件上传", "漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-05-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-18：\t细节向公众公开  简要描述： 华安保险端口为8899的JBoss服务爆出jboss配置漏洞，虽然不能直接通过 IP/jmx-console访问，但， 如给IP/jmx-console发送HEAD请求时， 可以绕过认证从而远程挂马。华安财产保险股份有限公司(以下简称华安保险)是经中国人民银行批准，于1996年10月18日正式创立的一家专业性保险公司，总部设于深圳，主要经营各种财产险、责任险、信用保证险、农业险、意外伤害险和短期健康险业务。 详细说明：  JBoss JMX控制台存在弱口令，导致如HEAD、PUT或DELETE等未在配置文件中允许的方法能够直接以jbossadmin身份调用GET处理器，并可以通过JBoss的HtmlAdaptor模块部署WebShell。   漏洞证明：  \n\n上图所示， 如果直接访问， 是需要输入管理员的用户密码的。 但用这样的代码发HEAD请求里， 就能成功部署一个webshell:\n\n再访问上传的webshell页面， 就可以这样了：\n\n   修复方案：  删除$JBOSS_HOME/[server]/all/deploy和$JBOSS_HOME/[server]/default/deploy下的Jmx-console.war、Web-console.war文件卸载控制台。或者去掉“jmx-console-web.xml”里的<http-method>GET</http-method>和<http-method>POST</http-method>， 这样就能使所有HTTP类型的请求都要登录才能成功。   版权声明：转载请注明来源 慕林@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-03-24 22:52 厂商回复： CNVD确认并复现所述情况，同时确认该漏洞在wooyun非首报，参见http://www.wooyun.org/bugs/wooyun-2010-015650。看来处置还不够彻底，权限绕过未完全修复。rank 8 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-20 16:07 |    \t\tnoah \t\t\t( 普通白帽子  |\t\t\t        Rank:384 漏洞数:40        )\t\t \n  关注...    \n     2013-03-20 16:43 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  这个关注很久了。。。    \n     2013-03-20 17:27 |    \t\tEnjoy_Hacking \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:8        | 时间无言，如此这般。)\t\t \n  = =吓我、我还以为出0day了    \n     2013-03-21 11:01 |    \t\tGetshell \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        )\t\t \n  搞过一次jboss，但是马儿没能被下载执行…    \n     2013-06-19 16:47 |    \t\tp0di \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 1+1 = 2 ？)\t\t \n  @慕林 求科普。    \n     2015-04-14 10:02 |    \t\tForever80s \t\t\t( 普通白帽子  |\t\t\t        Rank:820 漏洞数:85        )\t\t \n  http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0738    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}