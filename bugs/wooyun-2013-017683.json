{"id": 14916, "wybug_id": "wooyun-2013-017683", "wybug_title": "8种方法siteserver后台getwebshell", "wybug_corp": "百容千域软件技术开发有限责任公司", "wybug_author": "superbing", "wybug_date": "2013-01-22 18:09", "wybug_open_date": "2013-01-27 18:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 后台geetwebshell 详细说明：  第一种：模版管理直接修改文件源码可得webshell第二种：编辑器漏洞http://demo2.siteserver.cn/siteserver/TextEditor/fckeditor/ 可得webshell第三种：模版添加 居然有添加asp aspx文件的模版 在得webshell第四种：页面命名规则，居然完全可自定义，如利用iis解析漏洞，依旧得webshell第五种：CMS建站 栏目 网站建立 我把网站名称建立为asp.asp 配合解析漏洞 此网站下将全是webshell第六种：网站下面的栏目建立我命名为asp.asp 你生成就会有那个目录，配合解析漏洞又是webshell第七种：论坛附件上传类型定义，我定义cer asa php4 php5等文件类型，直接上传又是webshell第8种： CMS里面的备份功能居然有新建文件夹，还有改名功能。配合解析漏洞。。。。webshell           另外备份的文件名居然是这么简单的文件名，不怕别人下载哈。Site_2013-01-08-17-**.zip 就2位，爆破分分秒秒。        不单只备份功能，我发现居然还有个文件管理。。。直接改名，建立文件夹。无语了！        CMS的上传文件也可以自定义。。。cer asa php4 php5 秒了问题太多了不一一说了，给点建议一个一个自己去看吧。   漏洞证明：  图太多！！！   修复方案：  总的来说给几点建议：1：安全贵公司的立场就选择错了，要站在如果后台被人进入后，怎么防止被拿webshell，而不是光为了些花俏的功能。2：任何建立文件夹，修改文件名，修改文件，修改上传类型，自定义目录，文件管理，sql操作都是有害的。要做到以下几点就算安全基本合格了：1：上传限制好。2：防止解析漏洞的发生。3：什么模版的修改，网站程序的上传，网站目录下的改名，数据库操作都不是后台应该有的功能。FTP下去弄吧。4：编辑器那些第三方的洞修补好了在放程序里去。貌似支持5个编辑器。。。。安全够难做的。一个新0DAY就秒了。5：什么数据库备份，文件备份那些玩意很容易出问题，限制不好就会被下载或者被利用。省省免了这功能吧。   版权声明：转载请注明来源 superbing@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-01-27 18:10 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-22 19:59 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  碉堡了、    \n     2013-01-23 00:02 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  geetwebshell==>getwebshell    \n     2013-01-23 21:15 |    \t\t革命往事 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 革命已成往事)\t\t \n  8种方法~    \n     2013-01-27 19:13 |    \t\tJonasen \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:9        | have no)\t\t \n  忽略了。。。。囧了    \n     2013-01-28 14:02 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  忽略了。。。    \n     2013-07-17 00:27 |    \t\tdarksn0w \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 无折腾,不生活！)\t\t \n  这种厂商居然忽略这么严重的漏洞 @xsser 剑心我觉得按照wooyun的规则你不屏蔽了厂商，大家不会开心的。。。全是重要部门的    \n     2013-07-17 00:29 |    \t\tdarksn0w \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 无折腾,不生活！)\t\t \n  @xsser     \n     2014-01-05 13:42 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n  这··· 忽略了··     \n     2014-01-05 13:47 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @廷廷 因为只是说，一个图都没有。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}