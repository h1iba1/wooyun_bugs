{"id": 15073, "wybug_id": "wooyun-2013-017484", "wybug_title": "xss.tw 存储型xss一枚，偷cookie", "wybug_corp": "xss.tw", "wybug_author": "小囧", "wybug_date": "2013-01-18 12:43", "wybug_open_date": "2013-01-18 12:43", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-01-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： xss.tw 存储型xss一枚，偷cookie，  安全做得不错呀，本想偷别人的劳动成果的 结果失败了。 详细说明：  cookie偷到了登录的时候有验证用户环境，应该user-agent 和ip 一起验证的。还没伪造php试。只能算个  存储跨站攻击脚本了。用户可以在xss代码后附加代码，由于页面Content-Type:text/html 所以任意代码都行，\n\n\n\n然后想个办法让这些用户来访问这个页面，于是乎，分析xss代码可知 http://xss.tw/76/?keepsession=&location=  来接收参数的。那么我就伪造点数据进去写了个脚本 1-169所有的用户都发送一条记录 \n\n很多人看了自己突然冒出了这么条信息， 应该都会打开   那个http://t.cn/zjDyshd 我想要的就是这个效果。只要一打开就被xss了，截获的cookie信息\n\n然后尝试登录  改了user-agent 和 seesionid  \n\n又经过测试 发现若同1ip下就不会出现该问题，应该是user-agent 和ip一起来判断用户环境的。    漏洞证明：  蛮多人的..\n\n   修复方案：  像这种特殊文件，你想让它作为js去执行 输出个头吧   Content-Type:application/x-javascript   这样就不会有这样的问题了。。   版权声明：转载请注明来源 小囧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-01-18 13:14 |    \t\ttxcbg \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:53        | 说点什么呢？)\t\t \n  围观    \n     2013-01-18 13:17 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  碉堡的厂商    \n     2013-01-18 13:46 |    \t\t‫‌ \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        )\t\t \n  @小囧 直接取页源码,偷他内容 哈哈.~    \n     2013-01-18 14:00 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  这算不算是X别人反被X    \n     2013-01-18 14:02 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  @Wdot    \n     2013-01-18 14:09 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  @小威  威哥所言极是！    \n     2013-01-18 16:04 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @Passer_by 很多人提醒他，可惜还是修补得不全。    \n     2013-01-18 16:24 |    \t\t冰封 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | 认真做事,低调求发展! Mr.Fz's)\t\t \n  情何以看啊!  被反X了    \n     2013-01-18 16:27 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  不算反x哈～ 玩玩而已    \n     2013-01-18 16:42 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @小囧 月初的时候xss.me的ref没有过滤然后就XXOO。    \n     2013-01-18 16:44 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @园长 呢，这个参数都过滤了的 已经尝试了哈。。  它做了用户环境认证的， user-agent 和 ip一起来判断的。  所以不好搞 拿到cookie无用    \n     2013-01-18 17:27 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @小囧 没懂我意思，不解释。哈哈    \n     2013-01-18 18:49 |    \t\t‫‌ \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        )\t\t \n  @小囧 不管判断不判断。可以试试直接取源码啊 这个页面是在内容显示页啊 搭配xss.js什么都能干    \n     2013-01-19 16:36 |    \t\tWdot \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:12        | it came too later)\t\t \n  哈哈，原来是你，昨天我也发现了。    \n     2013-01-19 16:37 |    \t\tWdot \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:12        | it came too later)\t\t \n  @小囧 下次试试这个头 Content-Type:application/x-javascript     \n     2013-01-19 16:38 |    \t\tWdot \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:12        | it came too later)\t\t \n  @Wdot 那个HELLO就是我发的撒～～    \n     2013-01-19 16:48 |    \t\tWdot \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:12        | it came too later)\t\t \n  @小囧 那个HELLO就是我发的撒～～用户登陆验证过程的实现 ： http://wdot.cc/Defense/92.html    \n     2013-01-19 16:49 |    \t\tWdot \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:12        | it came too later)\t\t \n  @冷静 这个厂商竟然不是我。。。    \n     2013-01-19 16:51 |    \t\tWdot \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:12        | it came too later)\t\t \n  @园长 每接到一个反馈，我基本上都是立即修复的。。    \n     2013-01-19 19:30 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @Wdot  我也郁闷  再怎么也要给我1rank撒    \n     2013-01-19 19:31 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @Wdot 做得蛮细致的哈，顶一个    \n     2013-01-19 22:22 |    \t\tWdot \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:12        | it came too later)\t\t \n  @小囧 我再次声明这个厂商不是我。。。。    \n     2013-01-20 12:08 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  跟 @xsser 反馈下。。    \n     2013-01-21 12:59 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @Wdot 那次批量alert...本来是测试下偷URL的。邪恶下。    \n     2013-01-21 13:50 |    \t\tWdot \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:12        | it came too later)\t\t \n  @园长 都是喜欢玩的，发现缺陷都先玩玩，之后再反馈。。。    \n     2013-01-21 15:53 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @Wdot 慢慢来吧，人少了也测不出来这些问题。有问题表明有人在用，说明有存在的价值。    \n     2013-03-22 16:21 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @Wdot  师兄，能给个账号不，测试个东西。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}