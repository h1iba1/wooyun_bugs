{"id": 15722, "wybug_id": "wooyun-2012-014150", "wybug_title": "中国联通手机邮箱csrf+xss利用，一次奇遇的挖洞", "wybug_corp": "中国联通", "wybug_author": "shack2", "wybug_date": "2012-10-31 22:47", "wybug_open_date": "2012-12-15 22:48", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-11-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-15：\t细节向公众公开  简要描述： 再次感谢乌云真是一个不错的学习平台，看着各种牛人挖洞，真学到不少东西啊，一次csrf+xss的利用，哈哈，腾讯邮箱这些都被你们搞了，咱想不过，也要挖一个csrf 详细说明：  嘿嘿进入正题：中国联通手机邮箱csrf+xss利用由于我是联通的忠实用户，前面看你挖xss，我就到联通邮箱去看了一下，粗略的看了下，子发现日程管理的日程可以xss，但是只能xss自己，郁闷放弃走人了最近两天看都在csrf，于是我又去看了一下，这下这个xss自己就起作用了额上图1.测试邮箱内容<img src=\"updata.jsp?to=to\"/>,打开邮件看图片的连接\n\n测试可以csrf2.于是找到一个get连接，添加白名单的连接antiTrash.action?actionType=addBWwithQuery&type=1&emails=1341413415%40qq.com\n\n\n\n\n\n\n\n点开邮件添加白名单成功3.想到以前的自能xss自己的，那么要是利用csrf添加一个日程，哈哈，要是邮箱主人点开日程管理哪cookie不就是发出来了这个就是那个xss\n\n发csrf邮件\n\n查看邮件\n\n日程自动添加了一个\n\n4.收cookie了查看是否收到了cookie\n\n5.其他的地方很多都能csrf，这个邮箱是Java做的，我想很多方法都是get,post都能调用吧\n\n这个要是在加上6.这就是让我最悲剧的时候了，咋个直接都能xss了，我是想不懂了，根本没过滤，我还以为这里一般都会过滤，太让我惊讶了\n\n哎呀我的妈呀，我的小心脏，挖了半天结果可以xss，我想死啊，20个rank救活我吧   漏洞证明：  1.测试邮箱内容<img src=\"updata.jsp?to=to\"/>,打开邮件看图片的连接\n\n测试可以csrf2.于是找到一个get连接，添加白名单的连接antiTrash.action?actionType=addBWwithQuery&type=1&emails=1341413415%40qq.com\n\n\n\n\n\n\n\n点开邮件添加白名单成功3.想到以前的自能xss自己的，那么要是利用csrf添加一个日程，哈哈，要是邮箱主人点开日程管理哪cookie不就是发出来了这个就是那个xss\n\n发csrf邮件\n\n查看邮件\n\n日程自动添加了一个\n\n4.收cookie了查看是否收到了cookie\n\n5.其他的地方很多都能csrf，这个邮箱是Java做的，我想很多方法都是get,post都能调用吧\n\n这个要是在加上6.这就是让我最悲剧的时候了，咋个直接都能xss了，我是想不懂了，根本没过滤，我还以为这里一般都会过滤，太让我惊讶了\n\n哎呀我的妈呀，我的小心脏，挖了半天结果可以xss，我想死啊，20个rank救活我吧   修复方案：     版权声明：转载请注明来源 shack2@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2012-11-04 16:34 厂商回复： CNVD确认漏洞情况，限于时间周期以及复现的复杂度，暂未复现，直接转由CNCERT通报中国联通集团公司处置，而wo邮箱的XSS缺陷在今年上半年已经通报中国联通公司，看来并未进行彻底修复。 shack2的csrf发现也是一个新的缺陷点。按需要弱用户认证，完全影响机密性，部分影响可用性进行评分，基本危害评分6.56，发现技术难度系数（csrf+XSS）1.2，涉及行业或单位危害系数1.5,综合rank=11.808 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-01 10:11 |    \t\tpromise \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:4        | 低调的各种路过！！！)\t\t \n  表示看到你们这种牲口我感到鸭梨很大！现在挖个洞都不容易了！    \n     2012-11-01 10:21 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  哈哈，找人家还没有去的地方    \n     2012-11-01 13:24 |    \t\tpromise \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:4        | 低调的各种路过！！！)\t\t \n  你觉得现在还有几个点木有人去，那些牲口都不知道为什么那么活跃....    \n     2012-11-03 13:14 |    \t\t0x0F \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:60        | 尖刀安全 (JDSec.Com).......................)\t\t \n  ..V5    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}