{"id": 12678, "wybug_id": "wooyun-2013-021366", "wybug_title": "luocms 2.0 Local File Inclusion Vulnerability", "wybug_corp": "luocms", "wybug_author": "knife", "wybug_date": "2013-04-08 10:41", "wybug_open_date": "2013-05-23 10:41", "wybug_type": "文件包含", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "文件包含漏洞", "源码审核", "源码分析", "文件包含", "本地文件包含利用", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-08：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-05-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 有点鸡肋 详细说明：  /*******************************************************//* luocms 2.0 Local File Inclusion Vulnerability/* ========================         /* By:     : Kn1f3     /* E-Mail   : 681796@qq.com/*========================/*******************************************************//* Welcome to http://www.90sec.com *//*******************************************************/\n//首先看看首页<?phprequire_once \"inc/const.php\";$id = getvar(\"id\"); //查看函数 getvar$fid = getvar(\"fid\");$cid = getvar(\"cid\");$act = getvar(\"act\");$p = getvar(\"p\");$p = !empty($p) ? $p : 1;$p_l = new cls_tpl();$p_l->tpl_main($act,$id,$cid,$sitepath,$p);?>\n\n//跟入tpl_main 函数function tpl_main($act,$id,$cid,$sitepath,$p){\t\t\t//$stime=microtime(true); //获取程序开始执行的时间\t\t\t$tpl_addr = $this->get_tpl($act);\t\t\t$temp = $this->load_tpl($tpl_addr);\t\t\t$temp = $this->get_include_file($temp);//包含产生\t\t\t$temp = $this->get_sys_tag($temp,$id,$cid);\t\t\t$temp = $this->get_list_tag($temp,$id,$cid,$p);\t\t\t$temp = $this->get_url_path($temp);\t\t\t$temp = $this->get_sort_tag($temp,$id,$cid);\t\t\t$temp = $this->get_title_tag($temp,$id);\t\t\t$temp = $this->get_sitepath($temp,$act,$id,$cid);\t\t\tif ($id != \"\"){\t\t\t\t$temp = $this->get_content_content($temp,$id);\t\t\t\t$temp = $this->get_prv_next($temp,$id);\t\t\t}\t\t\techo $temp;\t\t\t//$etime=microtime(true);//获取程序执行结束的时间\t\t\t//$total=$etime-$stime;   //计算差值\t\t\t//echo \"<br />$total times\";\t\t}\t\t//跟入get_tpl函数function get_tpl($act){\t\t\tif ($act != \"\") {\t\t\t\t$temp = $GLOBALS[templatedir].$act.$GLOBALS[rewriteext];\t\t\t}else{\t\t\t\t$temp = $GLOBALS[templatedir].$GLOBALS[indextemplate];\t\t\t}\t\t\treturn $temp;\t\t}//$GLOBALS[templatedir].$act.$GLOBALS[rewriteext]; 看看赋值$installdir = \"\";$templatedir = 'template/';$databasePrefix = \"luo_\";$indexname = \"LUOCMS首页\";$indextemplate = 'index.html';$httpurl = \"http://127.0.0.1/lUOCMS_UTF8_V2.0.101201/upload/\";$defaultext = 'html';$sitepathsplit = ' > ';$titlepathsplit = ' - ';$rewriteext = '.html';$author = \"Admin\";$source = \"本站\";$site_beian = \"123456\";$manager_email = \"admin@luocms.com\";$sysversion = \"V2.0.101108_UTF8\";$issetup = \"0\";//ok template/$act.html  $act 可控 产生包含\n   漏洞证明：  官网开启转义了我也不知道咋证明了。。poc: http://www.luocms.com/index.php?act=../upload/file/3.txt%00   修复方案：  过滤   版权声明：转载请注明来源 knife@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}