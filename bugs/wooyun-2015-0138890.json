{"id": 66140, "wybug_id": "wooyun-2015-0138890", "wybug_title": "中国商务订房网某系统存在注入(11万客户信息\\上万余订单)", "wybug_corp": "中国商务订房网", "wybug_author": "路人甲", "wybug_date": "2015-09-06 11:54", "wybug_open_date": "2015-10-21 11:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-10-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 注入造成的信息泄露，难怪垃圾短信很有定位的就能找到我们。 详细说明：  网站：http://www.51booking.cn公司简介：     中国商务订房网（ www.51booking.cn）创立于2005年，隶属于广州忠侨咨询服务有限公司，是中国领先的在线旅游预订服务提供商之一，运用网络概念成功整合了高科技产业与传统旅行业，向超过100万会员提供国内酒店预订，城市旅游指南等，会员酒店覆盖全国550个商旅城市，酒店信息高达18,000余家。     作为国内领先的订房专业机构，中国商务订房网率先拥有了呼叫排队系统、客户管理系统、房量管理系统、订单处理系统、服务质量监控系统，依靠这些先进的服务理念和管理系统，为消费者提供更加专业化、个性化的高品质服务；让客户享有方便、快捷、优质、超值的服务！\n后台地址：http://www.51booking.cn/system/\n说是有100多万的会员，不过我们找到，但是找到十几万的会员信息下面就开始了。   漏洞证明：  http://www.51booking.cn/system/password处存在注入，因此用户名任意填写，password处万能密码'or'1'='1\n\n\n\n找到会员管理页面，发现有十几万的用户信息，用户的密码直接就是明文记载，这对做诈骗和黑产的就是一块肉！\n\n里面的明文密码和用户的住址，不炸骗你诈骗谁？\n\n这边还有一个订单的选项，打开看了看，注册人数和订单不成正比呢，这么少，我感觉这应该不是唯一的一个管理系统，否则那一百万的会员怎么来的呢？难道是。。。你懂得？\n\n直接就可以查出来谁和谁一块入住酒店了。。。\n\n下面的是火车票的预定\n\n之后有测试了一下这个网站的前台，发现一处搜索框的地方存在注入忘了在哪里找到了，贴上数据包\nPOST /Destinations/search.asp HTTP/1.1Host: www.51booking.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://www.51booking.cn/Destinations/Cookie: ASPSESSIONIDCAARTDRD=GPFHOJLDCOEEPCNNAMHGMEGN; cck_lasttime=1441282274365; cck_count=0; Hm_lvt_a33d6db9e45abd7559b81eac5dff4deb=1441282276; Hm_lpvt_a33d6db9e45abd7559b81eac5dff4deb=1441282276; outTime=2015%2D9%2D5; inTime=2015%2D9%2D4; ASPSESSIONIDAQRCACCA=CBJDIMODFOEKIIDJHNFFCDDPConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 34seastr=%27&Submit.x=14&Submit.y=12\n   修复方案：  先把数据保护好再说吧   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}