{"id": 80548, "wybug_id": "wooyun-2015-0155673", "wybug_title": "某知名安防厂家又一缓冲区溢出漏洞", "wybug_corp": "海康威视", "wybug_author": "BeShadow", "wybug_date": "2015-11-25 10:26", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "设计不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2016-01-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 某安防厂家大量摄像机存在协议上的漏洞，导致缓冲区溢出问题 详细说明：  上周提交问题，因描述太简单，被咔嚓，这次完整的复现整个问题。0x01 涉及问题的厂家设备\t摄像机是从淘宝淘的海康IPC，型号：DS-2CD2820FWD，主控版本：V5.2.3\t从海康官网下载这款摄像机最新的升级包V5.3.0：\thttp://**.**.**.**/cn/download_more_714.html \t影响的型号和版本信息声明如下： \n\n         问题涉及到的型号还是不少的，目前其他设备也躺枪。 \t升级完设备版本： \n\n 0x02 利用漏洞\tONVIF协议是安防行业最通用的摄像机接入平台的协议，服务端与客户端的数据交互采用SOAP协议，默认80端口。\t从实现角度看，可以简单的看为，通过HTTP协议传输XML消息。 \t所以重放问题的方法就是：向设备的80端口，构造一段伪造的ONVIF请求的XML请求消息，对XML消息中个别字段进行放大。\t\t细节参考Poc的Python文件构造的消息，重点破坏的字段有：\tpayload += 'utf-8' *1000\tpayload += '<wsse:Username>' * 1000\tpayload += ' </s:Envelope>' *1000\t当这3个字段通过人为构造超长后，摄像机还是按照固定的长度去解析，就必然出现缓存区溢出漏洞，设备直接重启。\t PS：之前已爆出的RTSP溢出问题，但貌似海康还是没有投入资源去做好安全这块的防护。详细问题请度娘“海康棱镜门”   漏洞证明：  0x04 漏洞证明\t见照片。\n\n \t还要证明的话，只能用ZoomEye搜海康在互联网的摄像机，但这样太不厚道了。\t或者，请厂家自测下。   修复方案：  严格校验外部来源的消息，最少，超长的得过滤掉。   版权声明：转载请注明来源 BeShadow@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-11-29 18:31 厂商回复： 感谢提交，属于拒绝服务，未造成溢出点。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}