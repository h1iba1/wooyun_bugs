{"id": 55347, "wybug_id": "wooyun-2014-061259", "wybug_title": "Iwebsns sql 第四枚(可直接修改其他用户密码)。", "wybug_corp": "Iwebsns", "wybug_author": "′雨。", "wybug_date": "2014-05-19 19:37", "wybug_open_date": "2014-08-17 19:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-19：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-08-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 过滤不严。 详细说明：  在action\\privacy\\home_access_set.action.php中\n$h_access_para=short_check(get_argp('home_acess'));\t$access_q_1=short_check(get_argp('question_1'));\t$access_q_2=short_check(get_argp('question_2'));\t$access_q_3=short_check(get_argp('question_3'));\t$access_a_1=short_check(get_argp('answer_1'));\t$access_a_2=short_check(get_argp('answer_2'));\t$access_a_3=short_check(get_argp('answer_3'));\n这里全部会被转义。 \nif($h_access_para=='3'){  \t  \t  $sql_part=\",access_questions='$access_q_1,$access_q_2,$access_q_3'\";  \t  $sql_part=$sql_part.\",access_answers='$access_a_1,$access_a_2,$access_a_3'\";  }\t\t$sql=\"update $t_users set access_limit=$h_access_para $sql_part where user_id=$user_id\";\t\techo $sql;\t\texit;\n这里可以看到$h_access_para  直接带入了update查询中 且没有单引号所以被转义也没有什么。而且直接在set位 所以可以直接修改其他会员的密码之类的。   漏洞证明：  \n\n   修复方案：  单引号来上。、   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-05-19 19:37 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  大神，不能再这样刷人民币了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}