{"id": 9658, "wybug_id": "wooyun-2013-033130", "wybug_title": "海底捞查看任意订单&amp;&amp;用户信息泄露", "wybug_corp": "haidilao.com", "wybug_author": "xfkxfk", "wybug_date": "2013-08-01 14:07", "wybug_open_date": "2013-09-15 14:08", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "逻辑错误", "越权操作", "未授权访问", "用户敏感信息泄露", "认证设计不合理", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-15：\t细节向公众公开  简要描述： 海底捞查看任意订单&&用户信息泄露 详细说明：  使用xfkxfk下一个订单，订单号：WBJ022013080101688：\n\n然后我们来查询一下xfkxfk的订单，点击修改：\n\n此时的url为：\nhttp://hi.haidilao.com/pages/haidl/order_iframe.jsp?url=aHR0cDovL2NhdGVyLmhhaWRpbGFvLmNvbTo4MC9DYXRlci9vcmRlck1vZGlmeS90b09yZGVyTW9kaWZ5LmFjdGlvbj9vcmRlcklkPVdCSjAyMjAxMzA4MDEwMTY4OCZ0eXBlPTM=#height=1021\n我们任意访问一下这个url都可以看到订单信息和用户信息，下面是没有登陆可以查看：\n\n还有这个url中有一个url参数，参数的值是base64编码的，如图：\n\n访问此url一样可以看到订单。好，下面我们来看看那7月31号有那些订单：\n\n\n\n有这么多订单呢！！！随便看一个：\n\n   漏洞证明：  见详细说明   修复方案：  控制权限。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-08-01 14:26 厂商回复： 此漏洞我方已高度关注，礼物申请在走流程，希望能得到完善的解决方案；万分感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-01 14:10 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @海底捞 这个应该没有人提交吧，再有人提交了我就不给你提交漏洞了。。。    \n     2013-08-01 14:15 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @xfkxfk  = = 这厂商再被你气跑我就和你拼了    \n     2013-08-01 14:16 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @mango @xfkxfk 这里的厂商回复有亮点你们都没发现？？？？ WooYun: 海底捞某处存储型xss可打任意指定用户    \n     2013-08-01 14:18 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @VIP 白手套啊    \n     2013-08-01 14:19 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @VIP @xfkxfk http://www.wooyun.org/bugs/wooyun-2013-033112/trace/acccb698682c725d8e08b7a1f268dd2c    \n     2013-08-01 14:19 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @mango 没事，我把管理员叫过来领漏洞的，他跑了我在把他叫回来。    \n     2013-08-01 14:19 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @xfkxfk 我去。。。我的没审核呢。。。。你的是哪里？    \n     2013-08-01 14:23 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @mango 我两不会重复吧。。。    \n     2013-08-01 14:30 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @mango 我的已经说是重复了，估计你的先提交    \n     2013-08-01 14:35 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @xfkxfk 可是我还没审核    \n     2013-08-01 14:38 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @mango 人家正在验证吧，急什么嘛，==    \n     2013-08-01 14:39 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @xfkxfk  = = 怎么申请加精？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}