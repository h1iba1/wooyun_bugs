{"id": 4130, "wybug_id": "wooyun-2014-055828", "wybug_title": "乐视TV APP漏洞可获取账户与充值等敏感信息", "wybug_corp": "乐视网", "wybug_author": "进化程序猿", "wybug_date": "2014-04-07 13:42", "wybug_open_date": "2014-05-22 13:42", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "19", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["乐视", "用户信息泄露", "用户帐户信息"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-22：\t细节向公众公开  简要描述： 乐视TV android app有明显的漏洞，随意获取到用户帐户信息 详细说明：  与上次提交的漏洞一样，可以通过http请求传入用户昵称获取到用户id,总点数，充值点，创建时间等信息。结合上个漏洞通过id获取用户详细信息的漏洞，应该就拿到用户的几乎全部数据了吧？乐视TV不给俺送个礼物，奖金么？通过用户昵称获取了用户的充值信息，用户信息，帐户信息，充值信息加一块是不是可以进行人群消费水平划分了？感觉很恐怖   漏洞证明：  url：http://dynamic.app.m.letv.com/android/dynamic.php?starttime=&endtime=&deptid=&productid=&username=123456&act=queryrecord&ctl=index&day=0&mod=passport&pid=&pcode=010110329&query=02&version=5.0其中username是可以随便填写的\n\n将query参数修改为01，没想到看到了充值记录有图为证：\n\n   修复方案：  说一下这两个bug怎么发现的吧，过程其实很简单，乐视TV的手机app在5.0或者之前版本（前几个版本没测试）存在这个问题，一开始进去会强制升级，可能你们已经意识到这个问题了吧，其实最新版本app发现你们都是用tk去获取用户信息的，加密了。但是之前的api接口没有废掉？虽然5.0app有强制升级，但是我从app开始运行就瞅准用户中心那个点一直点下去，跳过了你们的升级提示，直接登录了。后面的就很简单了，抓包开始，一串http请求全下来了，图片为证：\n\n小白阶段，后面的ssotk是否安全这个我暂时还没能力去校验。建议：先废掉5.0版本调用的http接口，反正都强制升级了，今天看见那个用户id获取数据接口居然还能访问？   版权声明：转载请注明来源 进化程序猿@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：19  确认时间：2014-04-07 14:51 厂商回复： 感谢挖掘，马上修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-07 14:29 |    \t\t进化程序猿 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:2        | su -)\t\t \n  还有一个用户充值记录泄露的漏洞没有提交成功，把url里的query参数变为01就能看到了    \n     2014-04-07 14:31 |    \t\tdave \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:12        | ส้้้้้้้้้้้้้้้้้้้...)\t\t \n  乐视  最近真忙    \n     2014-04-07 14:33 |    \t\t进化程序猿 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:2        | su -)\t\t \n  @dave 咦 这个个人简介很有特色哦    \n     2014-04-07 21:55 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  乐视现在还是小厂商么？    \n     2014-04-08 09:10 |    \t\t进化程序猿 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:2        | su -)\t\t \n  @孤独雪狼 上市公司，乐视电视和盒子都不错，卖的很好    \n     2014-04-08 10:05 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  @进化程序猿 我知道你是得到19WB么    \n     2014-04-08 10:21 |    \t\t进化程序猿 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:2        | su -)\t\t \n  @孤独雪狼 19WB 啥意思呀？乌云币现在38    \n     2014-04-08 12:27 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  @进化程序猿 坑爹呀 @疯狗 为啥我上次走的是小厂商？    \n     2014-04-08 12:53 |    \t\t进化程序猿 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:2        | su -)\t\t \n  @孤独雪狼 哈哈 看见你那个漏洞里的评论了    \n     2014-04-08 23:01 |    \t\t进化程序猿 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:2        | su -)\t\t \n  @孤独雪狼 貌似这个漏洞应该放在 通用性软件里的    \n     2014-05-22 21:09 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  奖了你多少钱呀。。    \n     2014-05-23 09:18 |    \t\t进化程序猿 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:2        | su -)\t\t \n  @ddy 木有money，连个小礼物也木有    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 19, "Ranks": null}