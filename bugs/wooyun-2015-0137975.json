{"id": 66086, "wybug_id": "wooyun-2015-0137975", "wybug_title": "某省联通核心交换机管理员信息通过SNMP泄露（可登陆，且大量网络设备存在SNMP信息泄露）", "wybug_corp": "黑龙江联通", "wybug_author": "wy007", "wybug_date": "2015-09-02 08:40", "wybug_open_date": "2015-10-20 08:14", "wybug_type": "基础设施弱口令", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "敏感信息泄露", "安全意识不足", "默认配置不当", "默认口令"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-20：\t细节向公众公开  简要描述： 说好的联通也该和大家见面了... 详细说明：  老洞了，不说太多，直接上利用过程。华为S9306核心交换机IP地址：（以下地址都是同一台交换机，不同VLAN接口地址）60.219.1.6660.219.1.6960.219.1.7160.219.100.12660.219.0.149开放端口信息：\n\n可以看到开放了22（SSH）、23（Telnet）远程管理接口，这样我们只要通过SNMP获取交换机的管理员登录用户名和密码，即可拿到控制权限。使用SNMP工具读取交换机的管理员账号信息：（这里使用的是Public团体名称）\n\n可以看到已经获取明文密码：用户名：huawei@inner?domain                                             \"密码：huafeihuaWUFEIWU接下来，我们可以使用终端连接工具，直接SSH或者Telnet来登录交换机：\n\n可以看到已经成功登录，并进入全局配置模式，使用display current-configuration命令可以查看当前交换机全局配置\n\n可以看到，密码在交换机中是进行加密过的，然并卵...对于这种加密算法，已经有很多工具可以进行解密\n\n这个是问题出现的关键，既然已经设置了其它的SNMP读权限团体名称，就可以把Public删除了，且SNMP端口不要对外访问，防火墙做一下策略限制。以上只针对一台核心交换机进行了测试，设备数量太多，未一一进行测试，用户回头自行安排工程师进行安全扫描吧。虽然很多只是开放了SNMP端口没有开放22和23端口，但是默认Public团体名称，依然可以导致很多关键信息的泄露。如果被别有用心的人利用的话，后果也是可想而知的...   漏洞证明：  设备数量太多，请自行排查吧...\n\n   修复方案：  上面已经提到过了。1.如果未进行设备采集，可禁用SNMP2.限制SNMP对外访问，防火墙添加策略控制3.修改SNMP默认Public、Private等团体名称为强密码字符串   版权声明：转载请注明来源 wy007@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-09-05 08:13 厂商回复： CNVD确认所述情况(未确认是否核心交换机),已经转由CNCERT下发给黑龙江分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}