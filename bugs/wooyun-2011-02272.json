{"id": 22529, "wybug_id": "wooyun-2011-02272", "wybug_title": "顺丰宝业务逻辑漏洞", "wybug_corp": "顺丰宝", "wybug_author": "空虚浪子心", "wybug_date": "2011-06-17 14:07", "wybug_open_date": "2011-07-17 18:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感操作逻辑错误", "点卡", "敏感数据缺乏完整性校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-06-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-07-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 请原谅，这个窗口不能多说！总之这个漏洞不会让你失望就是。 详细说明：  顺丰宝存在支付逻辑漏洞，可以允许用户1元变1亿元。这个漏洞在其他网站很难存在，原因是页面交互都使用了对字段做签名。但是顺丰宝没做签名，导致支付金额可以被修改为任意数值。猜测成因是开发人员为了快速实现功能，而忽略了其中数据签名的步骤。可以想象，如果我充值1个亿，然后再使用取款功能，会产生神马效果。   漏洞证明：  1、登陆就不说了，来到充值页面。   我的余额为1元。\n\n2、充值，选择招商银行。\n\n   提交看到一个页面。\n\n3、确认这个页面，同时开启修改数据包。   修改数据包中的金额，为1分。\n\n4、提交。招行付账。\n\n5、成功！招行扣了1分钱。\n\n6、查询顺丰宝，充值了1元。\n\n   修复方案：  和银行交易时，做数据签名，对用户金额和订单签名。   版权声明：转载请注明来源 空虚浪子心@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：20 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-07-11 17:56 |    \t\tkEvin1986 \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:6        | $ ? #)\t\t \n  to 空虚浪子心，后果就是...你肯定又出名又死的很惨- -    \n     2011-07-12 01:21 |    \t\t冷冷的夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:135 漏洞数:12        )\t\t \n  快递公司，额....    \n     2011-07-17 21:14 |    \t\t空虚浪子心 \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:4        | 力争漏洞评论师)\t\t \n  打电话过去报告了，漏洞早就修补了。    \n     2011-07-18 11:40 |    \t\txti9er \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:6        )\t\t \n  这个要顶    \n     2011-07-18 11:43 |    \t\t冷冷的夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:135 漏洞数:12        )\t\t \n  -.-    \n     2011-07-18 12:51 |    \t\tsoftbug \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | 为人类设计最好的软件，解放人的双手,一起...)\t\t \n  看到是浪子发的文章，必须顶起！哈哈    \n     2011-07-18 15:40 |    \t\t爱梅小礼 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:16        | 我怀念的是无话不说)\t\t \n  这个签名应该怎么加呢？    \n     2012-02-04 23:17 |    \t\tpestu \t\t\t( 普通白帽子  |\t\t\t        Rank:170 漏洞数:13        | 关注计算机网络安全 lnmpa技术)\t\t \n  生成最终订单的时候根据商户ID、订单ID、订单金额、返回商户地址、加密密钥等生成一个MD5校验串，即所谓的签名.加密密钥一般是在第三方支付平台的管理后右那里设置的。    \n     2012-02-04 23:24 |    \t\tpestu \t\t\t( 普通白帽子  |\t\t\t        Rank:170 漏洞数:13        | 关注计算机网络安全 lnmpa技术)\t\t \n  一般银行和第三方支付平台都应该会校验商户的订单数据签名,但是快钱的支付接口有一个参数用来设置是否检验商户的订单数据签名，不校验签名就很容易被篡改，不知道为啥还有这么一个选项，不能理解。    \n     2012-05-06 23:10 |    \t\t网路游侠 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:2        | 不玩渗透好多年……)\t\t \n  呵呵，偶校友的，必须支持。    \n     2012-05-06 23:25 |    \t\tlyon \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | HackerTop)\t\t \n  这个给力~·业务安全~~    \n     2012-06-06 17:46 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  1楼回复真亮。    \n     2013-04-08 19:41 |    \t\tkain \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 保密)\t\t \n  白帽子不怕出名    \n     2014-04-22 23:43 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 20, "Ranks": null}