{"id": 78562, "wybug_id": "wooyun-2015-0160137", "wybug_title": "某建站系统通用型任意文件上传,可getshell", "wybug_corp": "北京金方时代", "wybug_author": "路人甲", "wybug_date": "2015-12-16 19:16", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向公众公开  简要描述：  北京金方时代 http://bjjfsd.com/    任意文件上传可getshell北京金方时代科技有限公司于2008年在工商行政管理部门注册成立，注册资金1000万元。金方时代面向企业、事业单位、政府机关提供网站建设服务。公司自成立七年以来，针对市场动向进行技术创新，110人的团队中，技术人员达到60人左右。除企业展示网站外，对B2C 电子商务平台、B2B电子商务平台、BBS社区、P2P平台..在乌云搜了一下发现http://www.wooyun.org/bugs/wooyun-2015-0142872有提到这个漏洞，然而厂商忽略了。。。 详细说明：  企业、事业单位、政府机关...客户量丰富，部分案例如下\n\ngoogle搜索：技术支持：金方时代\n\n漏洞url:\nhttp://***/?c=utils&m=upload&formname=form2&editname=simg&uppath=static/upfile&pn=\n\n\n\n\n\n\n\n<script type=\"text/javascript\">function checknull() {    var file = $('#file').val();    if(file == '') {        alert('请选择你要上传的文件!');        return false;    }}</script>\n只判断有没有选择文件，没有判断过滤后缀名，任意文件上传，导致getshell   漏洞证明：  从url中或者源代码中就可看出上传后的路径为/static/upfile,可更改\n<form action=\"\" method=\"post\" enctype=\"multipart/form-data\" name=\"form1\" id=\"form1\" onsubmit=\"return checknull();\">  上传文件：    <input type=\"file\" name=\"file\" id=\"file\"/>    <input name=\"pn\" type=\"hidden\" id=\"pn\" value=\"\" />    <input name=\"formname\" type=\"hidden\" id=\"formname\" value=\"form2\" />    <input name=\"editname\" type=\"hidden\" id=\"editname\" value=\"simg\" />    <input name=\"uppath\" type=\"hidden\" id=\"uppath\" value=\"static/upfile\" />    <input type=\"submit\" name=\"Submit\" value=\"上传\" /></form>\n文件名查看源代码就能看到\n\n\nhttp://**.**.**.**/static/upfile/201512101928077356.php\n\nhttp://**.**.**.**/static/upfile/201512101843543887.php\n\n\n\n\n\n\n\n\n   修复方案：  对上传的文件要进行判断和过滤啊==，程序员该反省了   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-12-18 10:41 厂商回复： CNVD确认并复现所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}