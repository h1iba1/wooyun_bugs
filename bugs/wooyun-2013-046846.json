{"id": 5352, "wybug_id": "wooyun-2013-046846", "wybug_title": "大汉通版jis统一身份认证系统漏洞打包", "wybug_corp": "南京大汉网络有限公司", "wybug_author": "xcoder", "wybug_date": "2013-12-23 22:23", "wybug_open_date": "2014-03-23 22:24", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当导致攻击界面扩大"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-23：\t细节向公众公开  简要描述： 大汉通版jis统一身份认证系统漏洞打包，政府部门使用居多 详细说明：  大汉通版jis统一身份认证系统:\n\n在用户修改信息时进行抓包发现\n\n\nPOST:http://10.11.5.201:9080/jis/front/upduser_do.jspCONTENT:c_id=00000&vc_loginid=admin&vc_password=123456&vc_pwd=123456&vc_username=系统管理员&vc_headship=&vc_comptel=&vc_compfax=&vc_mobile=&vc_email=&vc_qq=&vc_msn=&vc_hometel=&vc_usergroupid=&vc_usergroupname=\n经过验证c_id为权限控制字段，00000为管理员，vc_loginid为登陆名称，vc_password以及vc_pwd为密码，(1)用户权限提升:   在修改个人信息时进行抓包，将c_id修改成0000，即可提升为系统管理员，\n\n(2)重置管理员密码   将c_id改为00000以及将登陆名称vc_loginid改成admin 密码修改为自己的即可\n\n(3)任意文件上传漏洞\n\n\n上传地址:http://url//jis/update/update.jsp\n去掉本地js验证\nshell地址:http://10.11.5.201:9080/jis/update/data/上传的文件名\n\n\n-----------------------------------------------------   漏洞证明：  大汉通版jis统一身份认证系统:\n\n在用户修改信息时进行抓包发现\n\n\nPOST:http://10.11.5.201:9080/jis/front/upduser_do.jspCONTENT:c_id=00000&vc_loginid=admin&vc_password=123456&vc_pwd=123456&vc_username=系统管理员&vc_headship=&vc_comptel=&vc_compfax=&vc_mobile=&vc_email=&vc_qq=&vc_msn=&vc_hometel=&vc_usergroupid=&vc_usergroupname=\n经过验证c_id为权限控制字段，00000为管理员，vc_loginid为登陆名称，vc_password以及vc_pwd为密码，(1)用户权限提升:   在修改个人信息时进行抓包，将c_id修改成0000，即可提升为系统管理员，\n\n(2)重置管理员密码   将c_id改为00000以及将登陆名称vc_loginid改成admin 密码修改为自己的即可\n\n(3)任意文件上传漏洞\n\n\n上传地址:http://url//jis/update/update.jsp\n去掉本地js验证\nshell地址:http://10.11.5.201:9080/jis/update/data/上传的文件名\n\n\n-----------------------------------------------------   修复方案：  控制   版权声明：转载请注明来源 xcoder@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-27 20:56 厂商回复： CNVD暂未在互联网实例上确认或复现所述情况，按照此类软件的部署通适性，先行确认，由CNVD尝试通过公开渠道联系软件生产厂商处置。 最新状态： 2013-12-30：对CNVD漏洞处置和验证情况进行补充：根据测试结果，已经转由CNCERT下发给浙江、辽宁、江苏等分中心，由其后续协调涉及的地方政府部门进行处置，同时尝试联系软件生产厂商处置。  ", "replys": "漏洞评价：\n评论\n     2013-12-23 23:09 |    \t\tdoor \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 没什么说明)\t\t \n  楼主，可以MK不？    \n     2013-12-24 00:13 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  jcms getshell    \n     2013-12-24 08:56 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  shell！！    \n     2013-12-26 16:22 |    \t\tdoor \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 没什么说明)\t\t \n  怎样getshell？    \n     2013-12-26 16:23 |    \t\tdoor \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 没什么说明)\t\t \n  @园长 怎样getshell？    \n     2013-12-26 22:52 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @door 漏洞公开了你就知道了，等吧。    \n     2013-12-30 11:03 |    \t\tBloodwolf \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:8        | whoami)\t\t \n  做等对比    \n     2014-01-17 10:27 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  围观    \n     2014-01-30 12:39 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  我用手上的代码分析过这个问题了，c_id=00000&vc_loginid=admin是可以控制，但是实际上c_id这个参数作为primary key在数据库里面是无法修改的，所以修改还是改的loginid，然后有部分页面判断权限是根据loginid来判断的……要么就是写死是admin字符串要么就是正好读出了id为0的那个admin的权限，回头就成管理员权限了。按理来说是这样的，而不是连c_id都改了    \n     2014-01-30 17:55 |    \t\txcoder \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:9        | 一个世界有你，一个世界没有你，让两者的不...)\t\t \n  @wefgod 我是通过分析jcms的数据库字段来判断jis的权限字段，并且本人也测试过c_id的确为权限控制字段单纯的修改c_id完全可以控制权限，如果c_id为主键，那么我想当有很多个管理员的时候，就有多个c_id的值相同了，那么就违背了主键唯一的规则了，下面来说vc_loginid这个问题，我觉得，它认为如果vc_loginid它的值为admin就是管理员，对于大汉通的产品，我只是偶尔发现学校用的是这套系统，还有门户等等，然后就搞下来，并没有做太多研究，如果有说的不对的地方，请纠正！    \n     2014-01-31 13:25 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @xcoder 我看的是另外一个版本的，2012的，我看洞主截图的是2011的，不过数据库表里的主键按理来说应该还是不能修改的。多半是版本问题吧，可能以前的版本是没有设置主键    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}