{"id": 59133, "wybug_id": "wooyun-2014-048458", "wybug_title": "万达集团万汇网任意用户密码重置漏洞Ⅱ（爆破）", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "se55i0n", "wybug_date": "2014-01-10 12:01", "wybug_open_date": "2014-02-24 12:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "认证设计不合理", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-24：\t细节向公众公开  简要描述： RT 详细说明：  今天不小心看到你们web上添加了密码找回功能，简单测试了下，发现了下面的问题~1）首先，在web页面使用手机找回密码功能；\n\n2）获取验证码后发现还是6位纯数字，未限制校验错误次数，无有效期限制；\nPOST /ajax/account/forgetpassword/verifytel HTTP/1.1Host: passport.wanhui.cnUser-Agent: Mozilla/5.0 Accept: application/json, text/javascript, */*; q=0.01Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateDNT: 1Content-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: https://passport.wanhui.cn/account/forgetpassword/step1/?wpid=1000292Content-Length: 40Cookie: WPID=1000292; SESSIONID=e725c59e5xxxxxxxxxxxx7650bdConnection: keep-alivePragma: no-cacheCache-Control: no-cachetel=13800138000&verification_code=123456\n3）对参数verification_code进行暴力破解；\n\n4）在获取到真实验证码后，发现返回页面填入真实验证码无法进入下一步操作，而会提示“验证码错误”。\n\n5）还是同样的思路，自己完整的重现一遍过程并抓包分析过程。经过分析在直接填入真实验证码进行下一步操作的过程中，并没有生成其他的验证凭证，也就是说整个过程仅仅校验了验证码，而校验了验证码之后则直接进入了下一步的密码重置页面，链接如下：\nhttps://passport.wanhui.cn/account/forgetpassword/step2/?wpid=1000292\n6）整个过程一下就清晰了，只要验证码校验成功就能进入密码重置页面（见上），也就是说当我们暴力破解到真实验证码之后，直接就可以访问密码重置页面重置用户密码；\n\n7)填入想要重置的密码即可完成，然后使用新密码登陆用户帐号；\n\n   漏洞证明：  见详细说明   修复方案：  限制校验错误次数   版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-01-10 13:16 厂商回复： 感谢se55i0n同学的关注与贡献！该漏洞目测存在，马上通知业务部门整改。谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-10 12:19 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser 又小厂商，你没发现这不是一般意义的爆破么：（    \n     2014-01-10 12:20 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @se55i0n 6位数    \n     2014-01-10 12:20 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser 你没仔细看内容呀，    \n     2014-01-10 12:24 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @se55i0n 难道不是？    \n     2014-01-10 12:27 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser 是暴爆了验证码，但是这不是重点呀~见4）和5）呀    \n     2014-01-10 12:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @se55i0n 几位数的验证码？    \n     2014-01-10 12:39 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser 我去，审核了...你就看不了详情了？    \n     2014-01-10 21:55 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  楼上两位好欢乐    \n     2014-01-11 11:00 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @风萧萧 过年刷点WB不容易呀：）    \n     2014-02-09 14:58 |    \t\tTestRoot \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:19        | sys)\t\t \n  @xsser 为什么万达算小厂商    \n     2014-02-23 16:15 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @se55i0n 就是说只要挂着机器在哪里爆破就好了，然后等他完了就直接可以访问重置界面了？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}