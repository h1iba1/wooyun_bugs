{"id": 47597, "wybug_id": "wooyun-2014-080188", "wybug_title": "74cms 最新版sql注入漏洞", "wybug_corp": "74c,s.com", "wybug_author": "玉林嘎", "wybug_date": "2014-10-21 17:14", "wybug_open_date": "2015-01-19 17:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-19：\t细节向公众公开  简要描述： rt 详细说明：  今天之前找了个 刚下下来一会你们就发布新的 WooYun: 74cms SQL注入漏洞 但是最新版 的那个注入跟我发的那个一样的漏洞文件;wap/company/wap_company_collect_reusme.php67-85行\nelseif($act==\"ajax_collect_resume_add\"){\t$resume_id=$_POST[\"resume_id\"];\t$sql=\"select * from \".table(\"company_favorites\").\" where resume_id=$resume_id and company_uid=$_SESSION[uid] \";\t$collect_resume=$db->getone($sql);\tif($_SESSION[\"utype\"]!=1){\t\texit(\"企业会员登录后收藏简历\");\t}\telse if($collect_resume)\t{\t\texit(\"您已经收藏过此简历\");\t}\telse\t{\t\t$setsqlarr[\"resume_id\"]=$resume_id;\t\t$setsqlarr[\"company_uid\"]=$_SESSION[\"uid\"];\t\t$setsqlarr[\"favoritesa_ddtime\"]=time();\t\tinserttable(table('company_favorites'),$setsqlarr)?exit(\"ok\"):exit(\"err\");\t}\n一样的resume_id 未做单引号保护   漏洞证明：  \n\n跟之前一样的 不过多证明了   修复方案：  整套系统新功能很多 未做单引号保护 只是有些 不好操作 仅能更改些数据但是都要过滤求rank 之前忽略很伤的 - -   版权声明：转载请注明来源 玉林嘎@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-10-22 11:03 厂商回复： 感谢反馈! 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-21 17:16 |    \t\tPower \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:22        | 还需要等待.........)\t\t \n  二次注入果然不给力    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}