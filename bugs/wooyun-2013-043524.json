{"id": 6944, "wybug_id": "wooyun-2013-043524", "wybug_title": "北航course grading系统漏洞(按照名单涉及29所学校)", "wybug_corp": "北京航空航天大学", "wybug_author": "HoerWing", "wybug_date": "2013-11-21 13:09", "wybug_open_date": "2014-01-05 13:10", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-05：\t细节向公众公开  简要描述： 我是北京航空航天大学附属小学一年级的一名小学生，刚上小学一个月的时候交C语言作业，我就想，能不能不做作业又能得满分呢，所以，我把我的小手伸向了C语言教辅平台的服务器和数据库。（麻麻说这么写才够装逼，装逼才能火） 详细说明：  这算是成功入侵事件吧，拿下了北航两台服务器，按照名单上说，还有上海大学计算中心等28所高校在用这个系统，名单：http://www.course.sei.buaa.edu.cn/Users/。另外北航使用的都是1.1.3版本，似乎1.1.6版本这个bug已经修复了，谁知道呢，没人用1.1.6。下面详细讲说一下入侵过程：北航使用这个平台的服务器有两台，一个是http://judge.sei.buaa.edu.cn/，另一个是http://crs.sei.buaa.edu.cn/，测试请到http://crs.sei.buaa.edu.cn/，学号stu，密码stu（这个账号和密码是在http://www.course.sei.buaa.edu.cn/demo/上对外公开的）。废话不多说，漏洞很简单0x00截断上传，古老的漏洞。进入学生页面之后，我们找到在线答疑，随便点开一个论坛，之后发新帖，点file\n\n上传jsp网马，burpsuite截断数据包，在文件名后面加0x00\n\n\n\n上传成功：\n\n下面，提权脱库一条龙服务，不多说，你懂得。   漏洞证明：  数据库user.MYD\n\nwebshell\n\n   修复方案：  按照这个过滤jsp文件的方式，我大体估计了一下我们假设有这么一个函数get_type(name)，因为要扫文件扩展名，所以从后往前扫，如果我们在末尾加了一个0x00那么就判断无文件扩展名，而保存文件时，我们是从前往后扫所以遇到0x00就认为字符串结束，所以过滤不掉，那么修复方案很简单，把传递给外部Java的实参进行过滤，先从前往后扫直到0x00，之后把这个字符串传递给Java类。   版权声明：转载请注明来源 HoerWing@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2013-11-25 22:30 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-26 16:29 |    \t\t有关部门 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 没错，我是代表爱和正义的有关部门！)\t\t \n  洞主的描述大亮，如今大家都爱装嫩啊。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}