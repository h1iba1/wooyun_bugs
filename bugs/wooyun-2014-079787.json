{"id": 49865, "wybug_id": "wooyun-2014-079787", "wybug_title": "某通用考试网络报名系统后台bypass（sql注入）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2014-10-20 11:09", "wybug_open_date": "2015-01-18 11:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向公众公开  简要描述： 某通用考试网络报名系统后台bypass 详细说明：  某通用考试网络报名系统后台bypass   漏洞证明：  某通用考试网络报名系统后台bypass该套网络报名系统名称：小小网络报名系统国内很多教育站、政府站、考试测试站报名均采用此网络报名系统此套系统后台存在致命缺陷，可导致绕过，下面一起来看源代码：后台submit到check.asp\n<!--#include file=\"conn.asp\" --><%exec=\"select * from admin\"set rs=server.CreateObject(\"adodb.Recordset\")rs.open exec,conn,1,1%><%if rs(\"name\")=request.Form(\"name\")and rs(\"password\")=request.Form(\"password\") thensession(\"name\")=request.Form(\"name\")session(\"check\")=1Response.Redirect(\"admin_index.asp\")elseResponse.Redirect(\"login.asp\")end if%>\n这里\nRequest.Form(\"mame\")\n 在网页获取到数据时，没有进行过滤再来看这一段很关键\nif rs(\"name\")=request.Form(\"name\")and rs(\"password\")=request.Form(\"password\") then\n如果获取到的是   '0' or 1=1比如：\nrs(\"name\")是admin,rs(\"password\")也为admin,那么：if admin='0' or 1=1 and admin='0' then\n就变成了\nif admin='admin' and admin='0' or 1=1 then\n我们写个程序来看下真假\n\n可以看到，判断为真，成功绕过了验证登录名填写admin，密码填写 0'or'1'='1或者登录名和密码都填写  0'or'1'='1     或者简便的     'or'=1     都是一样的即可成功权限验证，直接进入报名系统后台。========================================================================================分析到此结束，让我们来看一些具体存在案例：\nhttp://www.lmtjy.com/pthbm/admin/login.asphttp://www.lzxxkx.com:8080/admin/admin_index.asphttp://www.lzsjyzg.com/pthbm/admin/login.asphttp://www.lxjxedu.com/ks/admin/login.asphttp://www.kaiyuan.cc/bao/admin/login.asphttp://guoshi.lxjxedu.com/ks/admin/login.asphttp://www.xjpx.org/wsbm/admin/login.asp\n然后，哇塞，这么多的妹子，这么多的数据~~~身份证啊全有了\n\n看到网站设置了，和良精后台的网站配置是一个模子，拿shell直接插即可，稳稳的\n\n   修复方案：  2处都修复   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-10-25 09:57 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}