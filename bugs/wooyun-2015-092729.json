{"id": 39991, "wybug_id": "wooyun-2015-092729", "wybug_title": "万达电影某处设计不当可导致非法获得电影票", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "g0odnight", "wybug_date": "2015-01-20 15:17", "wybug_open_date": "2015-03-06 15:18", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-06：\t细节向公众公开  简要描述： 某处设计不当，可通过爆破来刷电影票。审核君，涉及到经济利益的不会也走小厂商吧？ 详细说明：  \n\n万达电影兑换码添加兑换码处缺少验证，并且万达的电影2D/3D兑换券码是19位数字，可通过爆破刷电影票.\n\n写了个测试代码穷举所有可能的兑换码，10的18次方......吓尿了....1T才10的12次方，1P才10的15次方，不过这个对电脑来说不是问题~就随机选取一段，通过bp爆破。穷举316XXXXXXXXXXXXX里的一些。\nint arr[19] = { 3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };\tint i = 18;\twhile (arr[0] == 3)\t{\t\tarr[18] += 1;\t\tarr[13] += 1;\t\tarr[7] += 1;\t\twhile (i > 14)\t\t{\t\t\tif (arr[i] >= 10)\t\t\t{\t\t\t\tarr[i - 1] += 1;\t\t\t\tarr[i] = 0;\t\t\t\tif (arr[i - 1] >= 10)\t\t\t\t{\t\t\t\t\tarr[i - 2] += 1;\t\t\t\t\tarr[i - 1] = 0;\t\t\t\t}\t\t\t}\t\t\ti--;\t\t}\t\twhile (i > 8)\t\t{\t\t\tif (arr[i] >= 10)\t\t\t{\t\t\t\tarr[i - 1] += 1;\t\t\t\tarr[i] = 0;\t\t\t\tif (arr[i - 1] >= 10)\t\t\t\t{\t\t\t\t\tarr[i - 2] += 1;\t\t\t\t\tarr[i - 1] = 0;\t\t\t\t}\t\t\t}\t\t\ti--;\t\t}\t\twhile (i > 2)\t\t{\t\t\tif (arr[i] >= 10)\t\t\t{\t\t\t\tarr[i - 1] += 1;\t\t\t\tarr[i] = 0;\t\t\t\tif (arr[i - 1] >= 10)\t\t\t\t{\t\t\t\t\tarr[i - 2] += 1;\t\t\t\t\tarr[i - 1] = 0;\t\t\t\t}\t\t\t}\t\t\ti--;\t\t}\n\n\n\n\n可以看到红圈中的正确\n\n兑换码成功添加可以看电影了~   漏洞证明：  \n\n可以看到红圈中的正确\n\n   修复方案：  加入验证码检验   版权声明：转载请注明来源 g0odnight@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-01-20 17:03 厂商回复： 感谢路人甲同学的关注与贡献！马上通知业务整改！请私信留Q联系礼物事宜 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-31 09:12 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  唉药我去！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}