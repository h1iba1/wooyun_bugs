{"id": 38506, "wybug_id": "wooyun-2015-096147", "wybug_title": "艺龙Android APP敏感信息泄露(泄露用户名、密码等)", "wybug_corp": "艺龙旅行网", "wybug_author": "nullnu", "wybug_date": "2015-02-12 12:59", "wybug_open_date": "2015-05-13 17:48", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["秘钥管理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-04-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-13：\t细节向公众公开  简要描述： 艺龙Android APP敏感信息泄露包括用户名、明文密码等 详细说明：      艺龙Android客户端（当前版本8.1.0）秘钥管理不当，容易导致用户名、密码等敏感信息泄露。    登陆的逻辑：使用org.bouncycastle.crypto里面的AES算法对{\"loginNo\":\"userid\",\"password\":\"password\"}\"进行加密，然后对得到的结果做一个编码，最后将编码的后结果发往服务器。    其中，AES加密时使用的秘钥是固定的，在Android客户端里面可以很容易得到；后面的编码、解码函数也可以很容易的从Android客户端里抠出来。黑客从Android客户端得到这两个东西之后，就可以从网络流量中直接提取出用户名和明文密码了。\n\n\n\n   漏洞证明：  1.使用用户名13406825924，密码qwert123登陆并抓包\n\n2.将req=后面字符串（PwgjhTprhSNelLWTjdIa0ViQwyNI9nzJ03aXLs%2BXuS8gbEi2YxfbeEL604YTTJm8）中的%开头的十六进制表示转换成ascii码-》PwgjhTprhSNelLWTjdIa0ViQwyNI9nzJ03aXLs+XuS8gbEi2YxfbeEL604YTTJm83.将PwgjhTprhSNelLWTjdIa0ViQwyNI9nzJ03aXLs+XuS8gbEi2YxfbeEL604YTTJm8调用解码、解密函数，得到用户名和密码的原始信息\n\n   修复方案：  需要重新考虑下秘钥管理的方法。   版权声明：转载请注明来源 nullnu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-02-12 17:46 厂商回复： 感谢白帽子关注艺龙网安全。属于内部已知问题，后面会进行整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}