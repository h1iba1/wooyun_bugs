{"id": 15687, "wybug_id": "wooyun-2012-014221", "wybug_title": "新浪微博gsid劫持", "wybug_corp": "新浪", "wybug_author": "seclab_zju", "wybug_date": "2012-11-02 11:44", "wybug_open_date": "2012-12-17 11:45", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-11-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-17：\t细节向公众公开  简要描述： 上次发了个gsid有效期太长，这次来贴一个劫持gsid的方法。仅限手机浏览器登录微博的用户。 详细说明：  用户使用手机浏览器登录新浪微博weibo.cn，获得的session id被存储在URL内:weibo.cn/?gsid=3_5xxxx，这就使得只要该页面存在外链（即使通过301/302跳转），外链的目标服务器就可以从Referer得到gsid。新浪目前对此类外链防范非常好，大都在跳转页面去掉了gsid，或者直接使用<meta>跳转方式，从而不会留下Referer痕迹，但如果用户输入的链接是一个IP地址的形式，如http://10.10.10.10，就会被url shortener转成一个http://t.cn/xxxxx的跳转，此时跳转后的页面如下图(中)所示。用户点击“手机版”后会跳转到目标服务器，从而留下Referer trace，从而劫持gsid。自评Rank 20的原因在于，盗取到gsid后，可以扫描更多发帖来源是“新浪微博手机版”的用户，有针对性的发出@并评论他们的帖子，诱使他们点击链接，使session劫持呈蠕虫式扩散。方法参见http://en.wikipedia.org/wiki/Samy_(XSS)   漏洞证明：  \n\n   修复方案：  你们防外链的老办法。   版权声明：转载请注明来源 seclab_zju@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2012-11-02 19:59 厂商回复： 多谢对新浪的关注，已经安排人员进行了修得。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-02 11:48 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  洞主，应该不局限于微博吧？    \n     2012-11-02 12:08 |    \t\tRona \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:23        | test)\t\t \n  东主，应该不局限于，手机网络吧。    \n     2012-11-02 12:53 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  洞主，应该不局限于gsid吧？    \n     2012-11-02 13:12 |    \t\tseclab_zju \t\t\t( 实习白帽子  |\t\t\t        Rank:78 漏洞数:11        | 白帽子土人一枚)\t\t \n  洞主，应该不局限于新浪吧？    \n     2012-11-02 14:11 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  楼市队伍好整齐    \n     2012-11-02 21:31 |    \t\tclzzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:18        )\t\t \n  表示关注~~    \n     2012-11-08 17:06 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  洞主，应该不局限于提供手机网页版的厂商吧？    \n     2012-12-17 11:51 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  这个问题基本广泛存在把，不说session劫持，很多连接带了csrf的参数    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}