{"id": 23034, "wybug_id": "wooyun-2015-0104148", "wybug_title": "微软某开发框架多个版本存在问题可用来提权", "wybug_corp": "microsoft", "wybug_author": "路人甲", "wybug_date": "2015-03-27 15:24", "wybug_open_date": "2015-06-30 13:16", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程代码执行", "提权"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-30：\t细节向公众公开  简要描述： 微软.NET框架配置不当，可利用技巧来提权。NET Framework 是一个普及的开发平台，用于构建 Windows、Windows Store、Windows Phone、Windows Server 和 Microsoft Azure 的应用程序。 .NET Framework 平台包括 C# 和 Visual Basic 编程语言、 公共语言运行库和广泛的 类库。 详细说明：  受影响的版本为：Microsoft .NET Framework 2.0 Microsoft .NET Framework 3.5Microsoft .NET Framework 3.5.1Microsoft .NET Framework 4Microsoft .NET Framework 4.5Microsoft .NET Framework 4.5.1利用条件：1.需要支持aspx并且高于Microsoft .NET Framework 1.14版本2.安全模式除外（现在还没有能突破.net安全模式的方法）漏洞说明：该漏洞可直接赋予文件权限（让没权限的文件执行）   漏洞证明：  不太会表达  直接演示吧我们现在拿星外虚拟主机的环境来测试漏洞，星外主机权限是出了名的小 我们都知道的 没有可写目录是不可能执行命令并提权的 至于在根目录下执行cmd是根本不可能的事，下面我将利用此漏洞来见证这奇妙的一瞬间 http://www.blpty.com/js/style/cun.aspx  密码c   (星外主机环境shell  用于演示漏洞)现在根目录下执行set命令显示拒绝访问 （没权限）\n\n接下来上传我们的cmd文件 (建议上传windows xp  cmd.exe)并设置为终端 setp E:\\fxhost\\blptycom\\web\\cmd.exe\n\n图中的cmd是没权限的，下面开始使用我们的exp赋予cmd.exe权限 并执行他\n\n\n\n已经成功赋予权限 并执行了set命令\n\n\n\n\n\n再一次演示了 从无权限执行到有权限执行   附测试案例：http://www.cumt-ge.com/Admin/LinkModule/PicLink/PicLins.aspx 密码c因为需要.net  又要找权限极低的环境 手里没那么多   审核莫怪！此漏洞可用于提升权限然后执行危险文件造成服务器沦陷  危害也是很大的   审核哥哥复现时有问题可联系我  exp贴在下面了QQ 859565496求打雷   修复方案：  修复   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-01 13:15 厂商回复： CNVD已经接收到相关信息,同时感谢白帽子后续提供的EXP信息,目前,该信息仍然转由微软(中国)进行协调研判.尚待官方的确认. 因未能确认,rank 10 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-27 15:27 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:29        | 是金子总会发光，在还未发光之前，先打磨打...)\t\t \n  这个叼    \n     2015-03-27 15:29 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  这个真的叼    \n     2015-03-27 16:56 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  QTVA-2015-198545    \n     2015-03-27 19:45 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  再次惊现提权神器    \n     2015-06-30 16:09 |    \t\tMark \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 渗透你的心)\t\t \n  叼啊    \n     2015-06-30 16:09 |    \t\t小杰哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:155 漏洞数:25        | 逆水行舟，不进则退。)\t\t \n  卧槽  真叼!     \n     2015-06-30 17:15 |    \t\t娃哈哈 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:6        | 伟大的科学家)\t\t \n  这个6    \n     2015-07-01 17:15 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  牛逼。。。    \n     2015-07-01 17:30 |    \t\t冰箭 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 冰箭很懒什么都没留下)\t\t \n  嗯，贴出来了，在下面看到了。    \n     2015-07-01 17:31 |    \t\tx0ers \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:4        | 专注计算机：开机关机重启20年。)\t\t \n  谁买了的，我们一人一WB和他再买回来。你这次出几个WB，我们一人一WB买回来，你就赚了，我先WB了。    \n     2015-07-01 17:32 |    \t\t神在堕落 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 醉舞向山行)\t\t \n  EXP     ==。=。=。=。=。。。=。。=。。。=。。=。=。。=。    \n     2015-07-01 17:33 |    \t\t核心粉木耳 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | 。。。)\t\t \n  人手一份你们还玩个JJ啊      \n     2015-07-01 17:56 |    \t\t黑哥 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:3        | 爱挖洞)\t\t \n  @x0ers 我买了 私聊我吧    \n     2015-07-01 19:56 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  这个很赞啊。。       测试成功了。    \n     2015-07-01 20:29 |    \t\t核心粉木耳 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | 。。。)\t\t \n  @′雨。 感谢雨牛赏脸啊    \n     2015-07-02 20:42 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  http://stackoverflow.com/questions/5298905/add-everyone-privilege-to-folder-using-c-net    \n     2015-07-03 21:46 |    \t\tXser233 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | ‮员人斗战非排后  ‭)\t\t \n  噗..呕血了，那个是菜刀自带的ccc插件啊啊啊啊啊啊    \n     2015-07-04 14:07 |    \t\t核心粉木耳 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | 。。。)\t\t \n  @Xser233  是么？   你看看你菜刀里有跟我一样的插件么？  小学生    \n     2015-07-07 14:54 |    \t\t黑名单 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:13        | 像个傻瓜似的，为什么。)\t\t \n  http://loudong.360.cn/vul/info/id/66180 楼主不道德 两边提交    \n     2015-07-22 15:19 |    \t\tSnake~ \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 0.0)\t\t \n  他那个set了两次，所以系统找不到文件，不是拒绝访问，他赋权限完了以后setp正确了，这样科学吗？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}