{"id": 52173, "wybug_id": "wooyun-2014-072078", "wybug_title": "CMSEASY防护代码设计缺陷导致防御绕过", "wybug_corp": "cmseasy", "wybug_author": "酱油甲", "wybug_date": "2014-08-12 19:34", "wybug_open_date": "2014-11-07 19:36", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-17：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-07：\t细节向公众公开  简要描述： CMSEASY 最新版 5_5_0_20140802防护代码设计缺陷导致防御绕过 详细说明：  为什么要说“CMSEASY防护代码设计缺陷导致防御绕过”而不提360webscan有问题，这是因为只有CMSEASY一家是这样配置360webscan的，其他家并无出现以下问题！ 因此，这并不是360的通用问题，而属于CMSEASY设置问题！我们看下CmsEasy/webscan360/360safe/webscan_cache.php\n$webscan_white_url = array(\t\tarray('index.php' => 'admin_dir=admin'),\t\tarray('index.php' => 'case=file'),\t\tarray('post.php' => 'job=postnew&step=post'),\t\tarray('edit_space_info.php'=>''),\t\tarray('index.php' =>'case=admin')\t);\n这里，使用了$webscan_white_url ，通过读取代码我们可以发现，只要在url参数中出现admin_dir=admin等，即可完全无视360webscan的防御，我们做下官网测试：1.我们直接访问：http://demo.cmseasy.cn/index.php?case=archive&act=search&id=select%20*%20from%20admin可以看到提示：\n\n然后我们知道，url中连个参数，前一个会被后一个覆盖，因此我们提交：http://demo.cmseasy.cn/index.php?admin_dir=admin&admin_dir=&case=archive&act=search&id=select%20*%20from%20admin的时候，代码并不会解析admin_dir=admin，而是空，那么我们不但绕过了360webscan，还访问了正常功能~\n\n   漏洞证明：  \n\n   修复方案：  修改配置文件，可以参考其他使用360webscan的网站，比如phpyun等   版权声明：转载请注明来源 酱油甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-07 19:36 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-12 19:34 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个之前已经有报告过了    \n     2014-08-12 20:51 |    \t\t酱油甲 \t\t\t( 普通白帽子  |\t\t\t        Rank:645 漏洞数:126        | 打个酱油，吃个海蜇~)\t\t \n  额……@xsser，我看的0802最新版的，莫非厂商没补？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}