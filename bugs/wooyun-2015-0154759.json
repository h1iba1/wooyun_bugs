{"id": 80964, "wybug_id": "wooyun-2015-0154759", "wybug_title": "74cms3.6后台验证码绕过", "wybug_corp": "74cms.com", "wybug_author": "Xser", "wybug_date": "2015-11-23 14:04", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-30：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 74cms_v3.6_20151030最新 详细说明：  由于没有对验证码刷新，导致可以重复多用看看后台的\n$captcha=get_cache('captcha');\tif(empty($postcaptcha) && $captcha['verify_adminlogin']=='1')\t{\t\theader(\"Location:?act=login&err=\".urlencode('验证码不能为空'));\t\texit(); \t}\tif ($captcha['verify_adminlogin']=='1' && strcasecmp($_SESSION['imageCaptcha_content'],$postcaptcha)!=0)\t{\t\twrite_log(\"<span style=\\\"color:#FF0000\\\">验证码填写错误</span>\",$admin_name,2);\t\theader(\"Location:?act=login&err=\".urlencode('验证码填写错误'));\t\texit();\n可见并没有置空$_SESSION，所以可以重复多用先用错误的提交，再提交正确的看看返回什么\n\n\n\n可以看到成功转向后台index页面   漏洞证明：  由于没有对验证码刷新，导致可以重复多用看看后台的\n$captcha=get_cache('captcha');\tif(empty($postcaptcha) && $captcha['verify_adminlogin']=='1')\t{\t\theader(\"Location:?act=login&err=\".urlencode('验证码不能为空'));\t\texit(); \t}\tif ($captcha['verify_adminlogin']=='1' && strcasecmp($_SESSION['imageCaptcha_content'],$postcaptcha)!=0)\t{\t\twrite_log(\"<span style=\\\"color:#FF0000\\\">验证码填写错误</span>\",$admin_name,2);\t\theader(\"Location:?act=login&err=\".urlencode('验证码填写错误'));\t\texit();\n可见并没有置空$_SESSION，所以可以重复多用先用错误的提交，再提交正确的看看返回什么\n\n\n\n可以看到成功转向后台index页面   修复方案：  刷新   版权声明：转载请注明来源 Xser@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-11-27 18:58 厂商回复： 感谢反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}