{"id": 45405, "wybug_id": "wooyun-2015-0119531", "wybug_title": "中国移动飞信MAC客户端漏洞可远程代码执行或打开应用（需一个简单的触发条件）", "wybug_corp": "飞信", "wybug_author": "blackchef", "wybug_date": "2015-06-10 14:35", "wybug_open_date": "2015-09-09 16:32", "wybug_type": "远程代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-09：\t细节向公众公开  简要描述： 奇怪的洞 详细说明：  其实这应该算是一个XSS的漏洞，原因是飞信的聊天记录查看窗体是一个webview形式的，但是这个webview没有对用户数据进行处理，造成任意JS脚本，和html标签都能被执行，有搞死mac的风险。给任意一个人发送\n<script>prompt('blackchef\\n');</script>\n\n\n如果对方查看聊天记录，就会弾框\n\nmac系统有URL Scheme机制可以通过js打开应用，这个漏洞就可以用来打开好友应用\n<script>window.location = \"macappstores://\";</script>\n输入上面的代码给好友，当好友查看聊天记录时会打开appstore\n\n   漏洞证明：  鉴于这个是飞信的群聊功能也存在这个洞，那就可以发挥一下想象，我们群发一条下面的消息\n<script>while(true){prompt('blackchef\\n');}</script>\n或者\n<script>while(true){window.location = \"macappstores://\";}</script>\n然后告诉群里面的同学，打开群聊天记录有惊喜。。。没敢试   修复方案：  过滤？编码？或者你们其他的好办法   版权声明：转载请注明来源 blackchef@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-06-11 16:30 厂商回复： 感谢支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-10 14:37 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  用的人应该不多，但比较经典的设计漏洞    \n     2015-06-10 14:47 |    \t\tblackchef \t\t\t( 普通白帽子  |\t\t\t        Rank:191 漏洞数:25        | 爱技术，炸得一手好花生，：-）)\t\t \n  @疯狗 哇 多谢狗哥回复啊  好兴奋    \n     2015-06-10 15:10 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @blackchef PC开发者这几年被洗礼，现在轮到Mac开发者了    \n     2015-06-10 17:01 |    \t\tsky \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:30        | 有一天，我带着儿子@jeary 去@园长 的园长...)\t\t \n  看看    \n     2015-06-10 17:48 |    \t\tblackchef \t\t\t( 普通白帽子  |\t\t\t        Rank:191 漏洞数:25        | 爱技术，炸得一手好花生，：-）)\t\t \n  @疯狗 狗哥帮忙伸张正义  WooYun: 携程主站和酒店管理系统存储型XSS（已盲打到后台）  这个洞我的rank值为啥只拿到了4个呐 已经上首页了，挖洞不易啊 /—_—\\    \n     2015-06-10 18:55 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @blackchef 不可能啊，在瞧瞧？是在首页的。    \n     2015-06-10 18:57 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @blackchef 搞清楚了，是20个不哭    \n     2015-06-10 19:13 |    \t\tblackchef \t\t\t( 普通白帽子  |\t\t\t        Rank:191 漏洞数:25        | 爱技术，炸得一手好花生，：-）)\t\t \n  @疯狗 多谢狗哥    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}