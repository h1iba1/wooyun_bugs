{"id": 1540, "wybug_id": "wooyun-2014-069578", "wybug_title": "悠哉旅游网50多万订单信息可遍历（姓名、手机号）", "wybug_corp": "悠哉旅游网", "wybug_author": "PythonPig", "wybug_date": "2014-07-24 18:12", "wybug_open_date": "2014-09-07 18:18", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-07：\t细节向公众公开  简要描述： 悠哉旅游网设计不当，可遍历50多万订单放暑假了，准备和妹子出去旅游，就来悠哉旅游网了，结果发现了这个漏洞，更重要的是，妹子利用这个漏洞看到了我7.10的一个订单，上面写着2成人海南8日游，然后妹子厉质问我：你不是刚放暑假的嘛？！你和谁去的海南？！！然后就没有然后了。屌丝注定是屌丝啊~~ 详细说明：  问题出在手机APP上（只测试了android版，估计ios也一样的情况）。订单号是逐一增加的，从小于100到540150都可以遍历，把用户的个人信息和出行计划都泄漏了~和别人妹子出去旅游的孩子们可要小心了~0x00：这次遍历先从我悲剧的第一步说起。用自己的账号登录悠哉旅游网手机APP后，点击全部订单，然后抓包，就有了下面这张图\n\n然后我的悲剧就是一直不断和尝试UserID，各种添加、修改，然后又把目标放在UzaiToKen上面，也是各种试，然后又各种找UserID、用户名、邮箱、UzaiToKen之间的关系，花了不少时间，还是没成功，然后就要放弃了嘛？放弃了？然后没有做任何修改，直接下一步，然后看到了我自己的订单。0x01：点击我自己的订单，再抓包一看\n\n直接疯掉了有木有，还是存在UserID、UzaiToKen这几个参数啊，不过觉得不对啊，我点击的是一个订单，它显示的是这个订单的详情，APP除了UserID、UzaiToKen参数这外，肯定还有别的参数，然后我就看到了OrderID，我试着改了一下OrderID,激动的事情发生了，看到了别人的订单详情~~\n\n\n\n   漏洞证明：  见详细说明，再加两张图吧\n\n\n\n   修复方案：  在用户查看自己的订单详情的时候，既然UserID和UzaiToKen这两个参数都传到服务器了，为什么不验证该订单号是否属于该UserID呢？上面是愚见，其实你们才是专家   版权声明：转载请注明来源 PythonPig@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-07-24 18:44 厂商回复： 已确认，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-24 18:14 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  屌丝    \n     2014-07-24 18:20 |    \t\t阿萨帝 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:68        | 不发礼物的索要联系方式都是耍流氓。)\t\t \n  让悠哉送个妹子给你~~    \n     2014-07-24 18:20 |    \t\tzj1244 \t\t\t( 普通白帽子  |\t\t\t        Rank:273 漏洞数:33        | 小葵)\t\t \n  一个一个都被开除了！    \n     2014-07-24 18:48 |    \t\tPythonPig \t\t\t( 普通白帽子  |\t\t\t        Rank:491 漏洞数:71        | 只会简单工具的小小菜)\t\t \n  秒审核啊~确认也是神速    \n     2014-07-24 18:49 |    \t\tPythonPig \t\t\t( 普通白帽子  |\t\t\t        Rank:491 漏洞数:71        | 只会简单工具的小小菜)\t\t \n  @铁蛋火车侠 铁蛋哥你把所有厂商的越权漏洞都找完了    \n     2014-07-24 18:49 |    \t\tPythonPig \t\t\t( 普通白帽子  |\t\t\t        Rank:491 漏洞数:71        | 只会简单工具的小小菜)\t\t \n  @阿萨帝 @悠哉旅游网快送妹子    \n     2014-07-24 18:54 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  厂商还在...    \n     2014-07-24 19:20 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  妹子还会挖洞啊？    \n     2014-07-24 19:46 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  @PythonPig  我擦 承让     \n     2014-07-24 20:57 |    \t\tPythonPig \t\t\t( 普通白帽子  |\t\t\t        Rank:491 漏洞数:71        | 只会简单工具的小小菜)\t\t \n  @魇 你说@肉肉 姐会不会挖洞？    \n     2014-07-25 15:31 |    \t\t小西瓜 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:3        | 2014)\t\t \n  悠哉很忙....    \n     2014-07-28 17:10 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  @PythonPig /whitehat_detail.php?whitehat=%E8%82%89%E8%82%89    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}