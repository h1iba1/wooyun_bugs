{"id": 65085, "wybug_id": "wooyun-2013-019256", "wybug_title": "ROYCMS官网数据库信息泄漏", "wybug_corp": "roycms.cn", "wybug_author": "wefgod", "wybug_date": "2013-03-07 17:18", "wybug_open_date": "2013-06-14 10:45", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["应用敏感信息泄漏", "信息未屏蔽"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-05-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-14：\t细节向公众公开  简要描述： 官网：http://www.roycms.cn/index.aspx 详细说明：  由于在发布开源代码的时候，直接把官方的配置文件给放了进去，导致信息泄漏，可以直接用sa账户连接到官网的数据库去，数据库权限很高，想干什么就干什么！还是比较严重的svn地址：https://roycms.svn.codeplex.com/svn/   漏洞证明：  web.config内的连接字符串：\n<connectionStrings><add name=\"ConnectionString203.171.234.7@__ROYcms\" connectionString=\"1E7C6E42B4E6E122BFE1FFBBBBA22F382F6AEA49D877A92AE79F364641CEC19C6A798909BFF832424609DE492D768E0DF9E72DA370E5714EFE31FC6965855DF09C2CB0BE014801B1CFF4CEC96C78FFD925720BCDDB5E0B2484428E62B29C7EE65175DFE1B7CF57C8\"/><add name=\"ConnectionString\" connectionString=\"1E7C6E42B4E6E122FD0DA8C6173289F3222125A32AA27B5296E365D832BE6952488AD8AD7C3B90F70D0EDD7AFA219344697C4947822E1FC09B3081F60FF0BA9529519A2A7E44728DEAD48CA8E28C2A8513AD8EA3D053A614A4C7DE4A980D4F8567F1D94A0E7ED8B8\"/></connectionStrings>\n都是DES加密的，可以自己找对应的解密函数，DESEncrypt.cs内有，解密的字符串是ROYcms（区分大小写），解密后的字符串如下：\nData Source=203.171.23x.x;User ID=sa;Password=***（不放出了）;Initial Catalog=__ROYcms;Pooling=trueData Source=ROY-THINK\\SQLEXPRESS;Initial Catalog=__ROYcms;Integrated Security=True;Pooling=False\n\n\n\n\n   修复方案：  svn上的web.config修改下。   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-03-07 17:28 厂商回复： 感谢漏洞提交 最新状态： 2013-06-14：谢谢问题已经及时处理谢谢反馈者  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}