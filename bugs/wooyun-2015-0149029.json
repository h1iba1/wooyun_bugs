{"id": 66270, "wybug_id": "wooyun-2015-0149029", "wybug_title": "新网华通员工OA系统弱口令导致Getshell", "wybug_corp": "新网华通信息技术有限公司", "wybug_author": "大白胖纸", "wybug_date": "2015-10-24 09:03", "wybug_open_date": "2015-10-29 09:04", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 一切都是从弱口令开始的 详细说明：  1、弱密码：\nhttp://******.xinnet.com/account/login\n\n\n我扶了扶眼镜，没有看见验证码，用名字+弱口令爆破，得到lilan@xinnet.com;123456，登录成功。\n\n\n\nPS：这个婴儿的头衔我也是醉了……还有，这版聊的信息删不掉的啊！罪证就这样置顶了2、XSS：系统内超多XSS，然而并没有什么大用。举2个例子，剩下的自查吧，要不然天亮也写不完。（1）新建文件夹 ,文件夹名写XSS（完全不用绕过）\n\n（2）待办事项，事项名写XSS（也完全不用绕过）\n\n3、越权读取用户信息OA上有app下载，怀着好奇（捣乱）的心情，我把它下载到手机。玩着玩着就看到了这……\n\n这是要发啊。600多人的信息一览无余。但这不是越权，只是正常的业务流程，真正越权的在下面\n\n\"profile_view_password\":\"e10adc3949ba59abbe56e057f20f883e\"多么熟悉的md5，这就是123456啊！换一个member_id试试：\nPOST /api/member/getUserInfo HTTP/1.1Host: gouuse.xinnet.comProxy-Connection: closeContent-Type: application/x-www-form-urlencoded; charset=utf-8User-Agent: å¤ç¨ 1.8.7 rv:1.0 (iPhone; iPhone OS 9.0.2; zh_CN)Content-Length: 308Accept-Encoding: gzipConnection: closesource=2&appVersion=1.8.7&sn=bcd19046a95f72c2fffa9e0406a291c92dedfab0966f29088cd23390937093ca&member_id=249&n=50&command=member%2FgetUserInfo&token=e937784e1385a8dc0c0314f00112ec4b72567da68ba159abce8f31b464a1c12742fb815fff9218ee3d82bf913ee2c46a8f3bbd1e354e24e05196c56ac1a1e9849d665b10b286ed64feed02be1d12a72b\n\n\n\n\n至此又拿到一个账号：zbliurongjing@xinnet.com；1234564、getshell至此可以拿出标题的漏洞了。很多地方上传都过滤了，各种上传的姿势试了一个遍，终于在这个不起眼的地方找到了。通讯录，聊天页有个上传文件的功能\n\n\nhttp://gouuse.xinnet.com/tmp/upload/c/4/1/im/33/e7/1_587.php\n密码123\n\n上菜刀\nhttp://gouuse.xinnet.com/tmp/upload/c/4/1/im/c9/f0/1_794.php\n密码cmd\n\n   漏洞证明：  差不多就到这吧   修复方案：  你们比我更专业   版权声明：转载请注明来源 大白胖纸@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-29 09:04 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 2015-10-29：非常感谢大白胖纸@乌云，小新正在玩命确认及修复中  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}