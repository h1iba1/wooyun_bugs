{"id": 12501, "wybug_id": "wooyun-2015-0119942", "wybug_title": "春水堂情趣用品电商功能越权可泄露20W+用户信息(姓名/电话/地址)", "wybug_corp": "chunshuitang.com", "wybug_author": "小饼仔", "wybug_date": "2015-06-12 13:58", "wybug_open_date": "2015-07-27 14:04", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "设计不当", "越权"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-27：\t细节向公众公开  简要描述： 唉~泄露了用户的姓名、电话、地址。不要问我为什么会发现，我不是去买娃娃的！ 详细说明：  因为漏洞比较容易发现，为了避免泄露厂商信息，提交漏洞时，问题厂商填了 某情趣用品电商某深夜睡觉前看网易新闻，看到了一则关于情趣用品电商的新闻，然后就有了这个漏洞电商地址：\nhttp://www.chunshuitang.com/\n简介\n春水堂全名为北京春水堂商业连锁有限公司，创立于2003年1月，取义于南唐大词人冯延巳传诵千年的浪漫古词“风乍起，吹皱一池春水。闲引鸳鸯香径里，手挼红杏蕊……”        春水堂已经成为中国情趣文化的倡导者，其创始人蔺德刚的著作《成人之美》，被出版界誉为夫妻情趣生活的教科书。\n问题：主站和m站，查看、修改收货地址处存在越权，app端估计也有，厂商自己测一下吧修改地址ID即可查看其他用户收货地址一共有两处，一处需要登陆，一处不需要1. 不需要登陆访问 \nhttp://buy.chunshuitang.com/address/select/?addid=2222\n修改后面的addid即可查看\n\n\n\n\n\n2. 需要登陆登入后，直接访问以下地址： \nhttp://user.chunshuitang.com/address/edit/?addid=20000\n修改addid即可查看其它用户\n\n\n\n   漏洞证明：  标题里的20W+用户可能有点不准确，因为可能一个人对应多个收货地址。提交漏洞前新增了一个地址，addid=224675，因为ID是连续的，且大多数人都是对应一个收货地址，所以写了20W还有几个问题，这里再提一下1. 登陆处可以爆破，没有验证码，POST请求里面有个hashstr，以为是防止CSRF的，结果发现这个值为固定值。2. 添加、修改地址处存在CSRF，虽然请求里有个hashstr，但是和1一样，为固定值。其它功能厂商自己排查下。主站和m站都有这个问题，app端厂商自测下吧。   修复方案：  没有做任何破坏，只是证明问题~哈哈，送点优惠券和兑换码可好~~    版权声明：转载请注明来源 小饼仔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-06-12 14:03 厂商回复： 感谢小饼仔！漏洞已修复 最新状态： 2015-06-12：漏洞已经修复  ", "replys": "漏洞评价：\n评论\n     2015-06-12 10:58 |    \t\tSPRITEKING \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | x)\t\t \n  噗...  要    \n     2015-06-12 13:59 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  噗... 要    \n     2015-06-12 14:03 |    \t\t春水堂(乌云厂商)\t\t \n  感谢乌云白帽子的及时发现我们已经修复，春水堂一直以来十分重视用户隐私！感谢大家！！！    \n     2015-06-12 14:05 |    \t\temeditor \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 过来乌云学习 求大神别黑)\t\t \n  说吧 你为什么会发现    \n     2015-06-12 14:09 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:48        | 不告诉你)\t\t \n  @emeditor 我不是去买女朋友~    \n     2015-06-12 14:10 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:48        | 不告诉你)\t\t \n  @春水堂 厂商修复速度赞一个~    \n     2015-06-12 14:13 |    \t\t春水堂(乌云厂商)\t\t \n  @小饼仔 感谢小饼仔，送你个娃娃哈。    \n     2015-06-12 14:16 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  @春水堂 可联系@肉肉在乌云集市上架    \n     2015-06-12 14:25 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @春水堂 送点女朋友？    \n     2015-06-12 14:35 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:48        | 不告诉你)\t\t \n  @春水堂 良心厂商啊~~ 送点其他东西就好了，娃娃什么的还是````    \n     2015-06-12 14:37 |    \t\tJiuShao \t\t\t( 普通白帽子  |\t\t\t        Rank:405 漏洞数:94        | ╮(╯▽╰)╭锄禾日当午)\t\t \n  洞主我很好奇的是你怎么在会情趣用品商城发现越权？    \n     2015-06-12 14:40 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:48        | 不告诉你)\t\t \n  @春水堂 娃娃什么的还是````,可以接受的！哈哈哈    \n     2015-06-12 14:41 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:48        | 不告诉你)\t\t \n  @JiuShao 不要在意这些细节,关心漏洞...漏洞    \n     2015-06-12 14:46 |    \t\t春水堂(乌云厂商)\t\t \n  春水堂一直以来十分重视用户隐私！未造成任何用户隐私泄露。谢谢@小饼仔！！！    \n     2015-06-12 14:48 |    \t\t白开水 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:27        | 苍茫的天涯是我的爱~)\t\t \n  @春水堂   别老口头上感谢，先送个娃娃以示敬意！    \n     2015-06-12 15:01 |    \t\t小不点 \t\t\t( 普通白帽子  |\t\t\t        Rank:751 漏洞数:78        | 生命不息，刷洞不止.....)\t\t \n  你们干嘛要别人的娃娃，自己生个去不就行了.....>_<    \n     2015-06-12 15:14 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:48        | 不告诉你)\t\t \n  @春水堂 Hi,已接受~~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}