{"id": 7205, "wybug_id": "wooyun-2013-042542", "wybug_title": "敏感信息泄露系列#8 信息泄露导致IT168 1900万用户信息告急", "wybug_corp": "IT168.com", "wybug_author": "猪猪侠", "wybug_date": "2013-11-10 22:29", "wybug_open_date": "2013-12-25 22:29", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "错误信息未屏蔽"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-25：\t细节向公众公开  简要描述： 由于没有一个通用标准的防御规则保护好中间件配置信息、DNS信息、业务数据信息、用户信息、源码备份文件、版本管理工具信息、系统错误信息和敏感地址信息(后台或测试地址)的泄露，攻击者可能会通过收集这些保护不足的数据，利用这些信息对系统实施进一步的攻击。 详细说明：  #1 信息泄露原因由于IT168论坛管理员在更新服务器文件时，未注意到编辑器会默认创建各种.bak文件用来规避错误编辑时引发的数据丢失风险，从而造成了更严重的信息安全问题。#2 泄露内容网站http://a.it168.com泄露文件：http://a.it168.com/config/config_global.php.bakhttp://a.it168.com/config/config_ucenter.php.bak\n// -------------------------- CONFIG ADMINCP -------------------------- //// -------- Founders: $_config['admincp']['founder'] = '1,2,3'; --------- //$_config['admincp']['founder'] = '25266971,80******,1020******,170******9,17******91,262******98,2622****';$_config['admincp']['forcesecques'] = '0';$_config['admincp']['checkip'] = 1;$_config['admincp']['runquery'] = 1;$_config['admincp']['dbimport'] = 1;\n\n<?phpdefine('UC_CONNECT', '');define('UC_DBHOST', 'localhost');define('UC_DBUSER', 'appuc');define('UC_DBPW', 'LDNB********36M4Z');define('UC_DBNAME', 'app_ucenter');define('UC_DBCHARSET', 'gbk');define('UC_DBTABLEPRE', '`app_ucenter`.uc_');define('UC_DBCONNECT', '0');define('UC_KEY', '263dQhYNQ****************1glo+HIOKi5v7g');define('UC_API', 'http://mo********.it168.com');define('UC_CHARSET', 'gbk');define('UC_IP', '61.55.167.41');define('UC_APPID', '58');define('UC_PPP', '20');\n   漏洞证明：  #4 漏洞证明 (有UC_KEY，Discuz等于可以做任何事)详细利用方法参见： WooYun: 途牛网某服务配置失误 导致论坛敏感文件泄露(致使百万用户信息告急) #5 证明细节(对于有些人你若是不证明可以接触到数据，他们永远会觉得这不是安全问题！)例如盛大： WooYun: 盛大某分站敏感配置文件泄露#1 可导致内网渗透 #6 通过泄露的文件，我们得知uid=25266971的用户是 http://a.it168.com 论坛创始人###### 这里用户邮箱信息也泄露了（是个问题，记得顺道补丁）http://my.it168.com/index.php?r=Index/index&vid=25266971\n\n#7 通过获取到的UC_KEY，直接修改掉small_mark的密码(这家伙到处都是管理员)，然后登陆http://a.it168.com/admin.php 后台也毫无限制的可访问并登陆\n\n#8 最终证明\n\n\n\n   修复方案：  #1 网络边界需要认真对待。#2 杜绝为了方便而造成的不必要的信息泄露。#3 安全是一个整体，保证安全不在于强大的地方有多强大，而在于真正薄弱的地方在哪里。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-11-10 23:23 厂商回复： 确是配置错误，多谢提醒，马上处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-10 22:31 |    \t\tadm1n \t\t\t( 普通白帽子  |\t\t\t        Rank:216 漏洞数:66        | 只是一个渣渣而已。。。)\t\t \n  围观~    \n     2013-11-10 22:33 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  gelivable     \n     2013-11-10 22:59 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  神    \n     2013-11-11 00:57 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @IT168.com  WooYun: IT168论坛源高危敏感信息泄露  这个20RANK，我看不懂你们的给分方法了！你说都影响所有会员数据了，危害等级定为中合适吗？    \n     2013-11-11 09:53 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @猪猪侠 @IT168.com 确实给的太低了这个    \n     2013-12-07 19:47 |    \t\t花生^_^ \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 加强学习~~)\t\t \n  确实感觉太低了，厂商不重视。    \n     2013-12-23 19:50 |    \t\t拆包 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 我如同一个初学走路的孩子。)\t\t \n  discuz x3.1后台怎么拿shell啊？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}