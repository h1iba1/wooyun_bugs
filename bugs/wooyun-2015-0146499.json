{"id": 83871, "wybug_id": "wooyun-2015-0146499", "wybug_title": "中国公路客票网账号遍历及任意密码重置漏洞", "wybug_corp": "中国公路客票网", "wybug_author": "403", "wybug_date": "2015-10-13 17:56", "wybug_open_date": "2015-12-02 13:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "认证设计不合理", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向公众公开  简要描述： 看见有人在挖这个网站的洞，我也来凑凑热闹！ 详细说明：  1、账户遍历注册一个账户，通过http://**.**.**.**/user/getUserBySid/?username=xxxxx获取到自己账户的id，然后通过如下页面使用id遍历用户名http://**.**.**.**/verifycodeclient/xxxx(id号)/true\n\n2、使用遍历的账号重置密码，这里存在对手机号没有在服务器端验证的问题，因此无论是通过手机注册的账户还是通过邮箱注册的账户都可以通过修改数据包中的验证手机号来绕过。先看看邮箱注册账户重置绕过：\n\n这个是修改前的页面，邮箱认证账户默认没有添加手机号，通过修改页面源码，使手机验证重置也可选。\n\n点击手机验证重置，拦截数据包，在验证手机号处填写自己的手机号。\n\n收到验证码后提交，拦截数据包，同样添加自己的手机号，进入到重置密码页面，添加新密码，提交。\n\n使用新密码登录\n\n接下来看看手机注册用户重置绕过，由于手机注册账户默认验证手机为注册手机号，因此需要在刚开始的添加重置账户处拦截数据包，修改此用户的验证手机为自己的手机。\n\n后续步骤同上   漏洞证明：  如上   修复方案：  验证的手机号需要在服务器端进行验证   版权声明：转载请注明来源 403@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-10-18 13:50 厂商回复： CNVD确认所述情况,已由CNVD通过网站公开联系渠道向其邮件通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}