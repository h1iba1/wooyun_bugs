{"id": 88259, "wybug_id": "wooyun-2016-0208040", "wybug_title": "黑龙江农村信用社oa系统文件可绕过上传限制getshell                                      ", "wybug_corp": "黑龙江农村信用社", "wybug_author": "路人甲", "wybug_date": "2016-05-13 02:40", "wybug_open_date": "2016-07-01 09:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传漏洞", "补丁不及时"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-01：\t细节向公众公开  简要描述： 黑龙江农村信用社oa系统文件可绕过上传限制getshell 详细说明：  黑龙江农村信用社oa系统文件可绕过上传限制getshell /defaultroot/UploadServlet 绕过限制上传。 这个功能点本身是限制jsp类型上传的。通过 path参数 及 fileId参数构造可自定义文件及目录名,可以绕过这个限制 http://**.**.**.**/defaultroot/UploadServlet 正常情况过滤jsp/jspx等程序文件上传。 但可构造恶意输入烧过 上传文件保存存在缺陷可通过构造恶意输入上传jspx后门。 上传输入： path参数 及 fileId参数可自定义文件及目录名。 上传类型修改为jspx可执行，jsp格式也可上传但执行会进行权限验证。 上传post包，post数据包为自写简单后门 \n\n文件上传路径： http://**.**.**.**/defaultroot/upload/test/123458/123458.jspx?cmd=netstat执行结果： \n\n   漏洞证明：  执行结果： \n\n   修复方案：  禁止jspx执行；禁用path及fileId参数操纵上传文件命名。    版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-05-17 09:13 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向银行业信息化主管部门通报,并抄报黑龙江分中心协助处置,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}