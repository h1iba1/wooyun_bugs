{"id": 53770, "wybug_id": "wooyun-2014-066559", "wybug_title": "CuuMall商城后台Getshell", "wybug_corp": "cuumall.com", "wybug_author": "宇少", "wybug_date": "2014-07-03 12:55", "wybug_open_date": "2014-09-28 12:56", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "低", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["解析文件漏洞", "代码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-08：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-28：\t细节向公众公开  简要描述： CuuMall商城后台Getshell 最新版本v2.3 其他版本未测试 估计也通杀 ok思密达！！！ 详细说明：  CuuMall商城后台Getshell 有2种方法 第一种对表单里面的value参数没有过滤就直接显示了还有种方法是可以利用解析漏洞 备份获取shell下面是：          -------------淫荡De分割线-------------   漏洞证明：  #1漏洞文件存在 \\Runtime\\~app.php'db_type' => 'mysql', 'db_host' => 'localhost', 'db_name' => 'cuumall', 'db_user' => 'root', 'db_pwd' => '147258', 'db_port'直接是明文保存密码 访问后台 基本设置 Runtime\\Cache\\Admin 目录下生成MD5加密后台访问临时文件 并且这里的value参数里的值没有做任何处理就显示输出\n\n#2 利用 exp方法1：  直接后台基本设置里面，审查元素就获取表单参数值\n\n这样就可以拿到数据库账户和密码 权限大直接写shell方法2：程序的函数做了过滤处理 但是生产的临时文件没有过滤后台文章管理->插入一句话->然后备份\n\n备份这里iis 利用数据库名前缀：test.php;.or test.php:.apache 利用数据库名前缀：test.php.我这里是apache测试环境：\n\n\n\n生成路径：\n\nsuccess！\n\n   修复方案：  #1 YOU KNOW！附上一张美女图养眼 哈哈~~\n\n   版权声明：转载请注明来源 宇少@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-09-28 12:56 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-03 14:21 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  哇、膜拜哈........    \n     2014-07-04 16:06 |    \t\t07@jyhack.com \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:10        | 希望和大家多多交流，多多沟通、)\t\t \n  嫂子知道吗？    \n     2014-07-04 16:57 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  @07@jyhack.com 肯定不知道...知道了还的了    \n     2014-08-30 06:58 |    \t\t小邪 \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:47        | ielts过过过)\t\t \n  思路好赞~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}