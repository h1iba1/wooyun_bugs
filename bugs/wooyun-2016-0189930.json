{"id": 86238, "wybug_id": "wooyun-2016-0189930", "wybug_title": "华夏航空海量订单信息泄露实时查看最新订单", "wybug_corp": "华夏航空有限公司", "wybug_author": "黑骑士", "wybug_date": "2016-03-28 11:44", "wybug_open_date": "2016-05-12 14:28", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-12：\t细节向公众公开  简要描述： 华夏航空海量订单信息泄露，实时查看最新订单，指定日期查看历史订单 详细说明：  搜索site:www.chinaexpressair.com发现一堆订单链接\n\nhttp://www.chinaexpressair.com/forpay_2015112527750.htmlhttp://www.chinaexpressair.com/HXHK/forpay_2015112227458.htmlhttp://www.chinaexpressair.com/HXHK/forpay_2016010131724.htmlhttp://www.chinaexpressair.com/forpay_2016012836719.html点开以后如图\n\n点击我的订单，会发现订单信息一闪而过然后跳到登陆页面\n\n好办，重新来抓包，一点点地提交，将下图的数据包提交后订单信息出来了\n\n\n\n点击订单详情抓包，数据包后面有用\nPOST /order.do?reqCode=queryForOrderByXq HTTP/1.1Host: www.chinaexpressair.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://www.chinaexpressair.com/UserProfile1.htmlContent-Length: 21Cookie: _ga=GA1.2.852764830.1458880829; Hm_lvt_af8630feb2f38351fa1962020ce56d56=1458886106,1458886172,1458886671,1458888923; Hm_lpvt_af8630feb2f38351fa1962020ce56d56=1458888980; JSESSIONID=422BD1D8AD5E0811CB46B86C963BAEA9; _gat=1Connection: keep-aliveorderno=2015102025336\n还没完，注意到 http://www.chinaexpressair.com/forpay_2015112527750.html这里的末尾是年月日和递增序列，因此可以爆破所有的订单信息，而且可以查找指定日期的订单，通过遍历url并判断返回包长度可以爆破出指定日期的订单信息\n\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~第二种获取订单的方式最初的想法是想看看登陆后能否越权查看别人的订单，结果在点击我的订单后把一个数据包替换成上面抓到的那个后系统报错回滚结果把所有的订单信息全都吐出来了！登陆后点击我的订单，抓包逐个提交\n\n抓到下图的数据包后用之前准备的代码替换\n\n\n\n可以看到返回包报错了，继续逐个提交\n\n提交了下面的数据包后最新订单信息就爆出来了，可以通过修改pageno翻页\n\n最新订单信息全都爆出来了\n\n\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 黑骑士@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2016-03-28 14:28 厂商回复： 感谢白帽子的反馈，辛苦了。此漏洞我们的安全工程师已检测出来，正在修复测试中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-28 14:50 |    \t\t黑骑士 \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:18        | 黑色的骑士守护着光明)\t\t \n  呵呵    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}