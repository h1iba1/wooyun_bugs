{"id": 30958, "wybug_id": "wooyun-2015-0100472", "wybug_title": "惠尔顿上网行为管理系统任意文件下载+命令执行Getshell", "wybug_corp": "深圳市惠尔顿信息技术有限公司", "wybug_author": "pandas", "wybug_date": "2015-03-10 11:45", "wybug_open_date": "2015-06-11 18:34", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-16：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向公众公开  简要描述： 翻看前辈对该系统的挖掘案例：1.http://www.wooyun.org/bugs/wooyun-2010-0795752.http://www.wooyun.org/bugs/wooyun-2010-091953在此提交另外一处任意文件下载和命令执行Getshell 详细说明：  fofa最近DYM,谷歌搜了几个案例：1.https://test.bescar.com2.https://angelic.com.cn/3.http://222.223.56.1164.https://222.92.15.100一、任意文件下载：https://test.bescar.com/WebClient/down_file.php?filename=WebClient.exefilename未过滤，可以下载任意文件，例如shadow：https://test.bescar.com/WebClient/down_file.php?filename=/etc/shadow\n\n这个不是重点，一笔带过。   漏洞证明：  二、命令执行：这个命令执行和 WooYun: 惠尔顿上网行为管理系统任意命令执行getshell 的命令执行需要的条件一样都需要登录，所以略显鸡肋。等会发一个无需登录直接getshell的漏洞。不过该系统后台登陆框存在注射，可以直接以用户名admin'# 密码任意登录系统漏洞文件：base/sys/EmptyDisk.php\n<?php \t$thisfile = basename($_SERVER['PHP_SELF']);\t$RootDir = $_SERVER[\"DOCUMENT_ROOT\"].'/base/';\tinclude_once \"$RootDir/include/gblinclude.php\";// 登录权限校验\t$type = $_REQUEST['type'];\t$file = \"/opt/triton/\";\texec(\"rm -rf \".$file.$type.\" &\"); //此处对未过滤的type直接进入exec拼接造成命令执行\t$name = \"\";\tif($type == \"email\"){\t\t$name = \"邮件\";\t}else if($type == \"multipart\"){\t\t$name = \"文件\";\t}else if($type == \"client_screen\"){\t\t$name = \"截图\";\t}else if($type == \"ftp\"){\t\t$name = \"FTP\";\t}\twriteSysLog(\"硬件详细信息 清除\".$name.\"数据\");\techo 1;?>\nhttps://test.bescar.com/成功getshell。\n\n   修复方案：  重写最好   版权声明：转载请注明来源 pandas@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-03-13 18:32 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式（或以往建立的处置渠道）向网站管理单位（软件生产厂商）通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}