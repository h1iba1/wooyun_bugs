{"id": 66154, "wybug_id": "wooyun-2015-0138848", "wybug_title": "海尔社区XSS漏洞可直接登录别人账号（进而可能登录APP控制用户智能设备）", "wybug_corp": "海尔集团", "wybug_author": "纳米翡翠", "wybug_date": "2015-09-04 12:30", "wybug_open_date": "2015-10-21 17:56", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-21：\t细节向公众公开  简要描述： 海尔官网、海尔BBS，海尔APP使用的都是同一套账号和密码，所以理论上不管哪方面存在漏洞，即可拿到用户权限，进而控制用户智能设备 详细说明：  1.首先要注册两个账号，一个用于xss，一个用于被害者,分别用两个浏览器登录两个账号，模拟两个用户\n\n\n\n2.使得其中的一个账号给另一个账号发送私信，内容中插入xss\n\n\n\n\n\n3.登录另一个账号查看私信\n\nXSS已经执行\n\n邮件收到了XSS拿到的COOKIE\n\n4.使用拿到的cookie登录，登录成功\n\n5.登录进去之后可以修改邮箱或者手机号进一步修改用户密码，修改邮箱、手机信息只验证新的不验证原来的，可直接修改\n\n\n\n\n\n6.修改信息后即可通过忘记密码重设密码了之后就可以登录APP控制用户的设备啦（当然前提是用户绑定了设备）比较好的一个点子是去给版主发私信，然后在版主的贴子插入xss，这样只要进入论坛主页的用户，即可触发xss\n\n   漏洞证明：  不只是发私信有xss，所有使用该富文本插件的地方都可以插入xss，比如发贴处：\n\n很抱歉发了个贴子，撞到管理员的后台\n\n\n\n   修复方案：     版权声明：转载请注明来源 纳米翡翠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-09-06 17:54 厂商回复： 感谢乌云平台白帽子的测试与提醒，我方已安排人员进行处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}