{"id": 43994, "wybug_id": "wooyun-2014-080991", "wybug_title": "易想团购SQL注入", "wybug_corp": "易想团购", "wybug_author": "luwikes", "wybug_date": "2014-10-31 10:25", "wybug_open_date": "2015-01-29 10:26", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "源码审核", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-31：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-01-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 还没提交过代码审计的漏洞，工作需要就下载了这个系统看了下，翻了翻乌云，发现这个文件的漏洞点还没有人报过~~ 详细说明：  文件ajax.php的第179行到189行：\nif($_REQUEST['act']=='verify_ecv'){\t$ecvsn = trim($_REQUEST['ecvsn']);\t$ecvpassword = trim($_REQUEST['ecvpassword']);\t$user_id = intval($GLOBALS['user_info']['id']);\t$now = get_gmtime();\t$ecv_sql = \"select e.*,et.name from \".DB_PREFIX.\"ecv as e left join \".\t\t\t\tDB_PREFIX.\"ecv_type as et on e.ecv_type_id = et.id where e.sn = '\".\t\t\t\t$ecvsn.\"' and e.password = '\".\t\t\t\t$ecvpassword.\"' and ((e.begin_time <> 0 and e.begin_time < \".$now.\") or e.begin_time = 0) and \".\t\t\t\t\"((e.end_time <> 0 and e.end_time > \".$now.\") or e.end_time = 0) and ((e.use_limit <> 0 and e.use_limit > e.use_count) or (e.use_limit = 0)) \".\t\t\t\t\"and (e.user_id = \".$user_id.\" or e.user_id = 0)\";\n我再加个图：\n\n报错详情：\n\nsqlmap进一步验证下：\n\n   漏洞证明：  \n\n\n\n是要补充这个图吗？\n\n   修复方案：  过滤   版权声明：转载请注明来源 luwikes@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}