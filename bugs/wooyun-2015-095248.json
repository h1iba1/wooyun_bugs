{"id": 38885, "wybug_id": "wooyun-2015-095248", "wybug_title": "phpmps存储xss demo测试成功 (需点击)", "wybug_corp": "phpmps.com", "wybug_author": "hello", "wybug_date": "2015-02-10 19:14", "wybug_open_date": "2015-05-11 20:02", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-04-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-11：\t细节向公众公开  简要描述： demo站点测试成功 详细说明：  漏洞主要源码\ncase 'updateinfo':                $id       = intval($_POST['id']);                checkInfoUser($id, trim($_REQUEST['password']));                $title    = $_POST['title'] ? htmlspecialchars_deep(trim($_POST['title'])) : '';                $areaid   = $_POST['areaid'] ? intval($_POST['areaid']) : '';                $enddate  = !empty($_POST['enddate']) ? (intval($_POST['enddate']*3600*24)) + time() : '0';                $content  = $_POST['content'] ? htmlspecialchars_deep(trim($_POST['content'])) : '';                $linkman  = $_POST['linkman'] ? htmlspecialchars_deep(trim($_POST['linkman'])) : '';                $phone    = $_POST['phone'] ? trim($_POST['phone']) : ''; //没用html函数处理                $qq       = $_POST['qq'] ? intval($_POST['qq']) : '';                $email    = $_POST['email'] ? htmlspecialchars_deep(trim($_POST['email'])) : '';                $address  = $_POST['address'] ? trim($_POST['address']) : '';                $mappoint = $_POST['mappoint'] ? trim($_POST['mappoint']) : '';                if(empty($title))showmsg(\"标题不能为空\");                if(empty($phone) && empty($qq) && empty($email))showmsg(\"电话、qq、email，必须填写一项\");                check_words(array($title,$content));                $items = array(                        'areaid' => $areaid,                        'title' => $title,                        'content' => $content,                        'linkman' => $linkman,                        'email' => $email,                        'qq' => $qq,                        'phone' => $phone,                        'mappoint' => $mappoint,                        'address' => $address,                        'enddate' => $enddate                );                $res = editInfo($items, $_POST['cus_value'], $id);                $res ? $msg=\"恭喜您，修改成功！\" : $msg=\"抱歉修改失败，请与客服联系。\";                $link = \"view.php?id=$id\";                showmsg($msg, $link);        break;\n   漏洞证明：  漏洞证明随便注册一个用户然后登陆官网demo在个人中心处 点击 发布\n\n随便输入内容 后 然后点击我的信息\n\n点击编辑在移动电话处输入\n');alert('xss\n然后确定然后查看发布内容点击查看归属地按钮 就弹框了\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 hello@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-02-10 20:00 厂商回复： 感谢提供漏洞，我们会尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}