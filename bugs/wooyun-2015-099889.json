{"id": 37349, "wybug_id": "wooyun-2015-099889", "wybug_title": "山东省招生考试院邮箱系统，存在暴力破解和弱口令漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "小清新", "wybug_date": "2015-03-09 16:39", "wybug_open_date": "2015-04-23 16:40", "wybug_type": "后台弱口令", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-23：\t细节向公众公开  简要描述： 没有验证码，没有限制登陆次数 详细说明：  这个漏洞是我去年十一月份左右发现的，当时也是无聊。。。本想联系下本地的招办解决的= =#可是人家没鸟咱~~~好吧。只能提交了。通过查询mx记录，得到邮件服务器地址\n\n顺便扫了下端口，没找到登陆的地方【应该是做了反向代理吧，或过滤端口吧，- -#这个真不是太清楚，求大神指教下。】\n\n然后看了下C段，发现有几个ip是活的。然后打开了看下【其实这几个ip的端口号和web页面都是一样的，感觉应该是一台服务器做的多IP。也不是太确定，求大神指教。】随便打开了一个http://218.57.22.48/portal/local/index.html\n\n第一眼看上去发现没有验证码， 感觉应该可以爆破。        上burp抓下包看看\n\n  很普通的一个POST传参，而且密码字段那里没有做加密处理，很明显，可以暴力破解了。   嗯。不说那么多废话了-  -#省的大神打我 \n\n这里只用两个变量就可以了，前面的那个emailname 不用管。    然后结果\n\n发生了302跳转的是成功的。 不多说了 = =#   漏洞证明：  造成了部分内部文件的泄露.\n\n\n\n大概就是这样了。如果考试院的老师们能看到这里。那么下面是我想跟咱考试院的老师们吐槽的几句，如果怕耽误您时间，就不必再看了。    首先，我是今年咱山东的春季高考生，报的嘛，当然是信息技术专业，（ps：高三报的这个，原来是学美术的，实在感觉不适合学美术，画的东西，自己都看不下去0.0）   然后学校组织从普高转到了职高，进行技能突击培训。到了学校以后发现，学的东西实在是，怎么说那。ps。pr。flash。DW.组装与维修。常用工具软件。就算是唯一一个喜欢的网络技术课，竟然也是背概念，背大量的理论，真正技术性的很少。（因为要笔试啊）这实在是太狭隘了。到了后来，听说今年要考动态网站和网络搭建，本来是小小了高兴了一下下的，随之课程的安排，这心又凉了，因为是要突击,所以动态网站全是用DW来做，老师连ASP的基本语法都没教。直接就是拉DW里面的控件来做，我们班的学生，几乎连HTML的基本语言都不了解，asp的变量是什么都不知道，但是没关系，我们老师确实能用dw让这些学生突击做出来，不得不佩服，我们老师对考分还是很有一套的。但是我想问的就是咱们山东省作为咱国内的春季高考的试点，春季高考不就是为了弥补我国技能型人才太少么，那么我想问的是，这些只靠突击几个月技能的，他们能考出的分数会很不错，难道他们就是我国需要的技能型人才么？（去年的技能已经说明了这个问题，虽然今年要求加大难度，如果说是这样加大难度，我真的想说，意义不大）总体来说，别的学科我不了解，不敢妄下结论，但是信息技术这个专业，我真的只能说，选拔的太狭隘。不管是从哪儿方面来说，都太狭隘。不管怎样，我都是一名中国人，我想我的国家会变得更好，少年强则国强。我希望我们少年读书，是有目的的读书，是为了真正的研究知识而读书，而不是为了考分而读书，那样太狭隘。我知道，我的这些文字是起不来太大作用的，毕竟我只是一名普通的中学生，但是我还是要说出来，希望中国的教育能变得跟更好！！！！    修复方案：  增加验证码验证，限制同一个IP在一个时间内对网站的访问次数，限制账号的登陆错误失败次数，post传参时，要对该加密的地方，进行加密处理。        先改掉现在存在弱口令的用户，（如果感觉不知道哪些存在，我这里有一些扫出来的，您可以找我来要下，QQ：36048504（验证信息是zhangzimo）或者联系我邮箱36048504@qq.com）   版权声明：转载请注明来源 小清新@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-03-13 17:46 厂商回复： CNVD确认所述情况，已经转由CNCERT下发给山东分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}