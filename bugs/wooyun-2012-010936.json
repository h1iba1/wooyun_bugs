{"id": 17298, "wybug_id": "wooyun-2012-010936", "wybug_title": "phpcms sqlinject 漏洞", "wybug_corp": "phpcms", "wybug_author": "路人甲", "wybug_date": "2012-08-15 13:44", "wybug_open_date": "2012-09-29 13:45", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-10-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-10-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-29：\t细节向公众公开  简要描述： PHPCMS存在一个sql注射漏洞，这个漏洞导致的原因不高级。 详细说明：  在phpcms/api.php?op=add_favorite中使用了urldecode，导致了一个sqlinject漏洞。\n$title = urldecode($title);省略⋯⋯$data = array('title'=>$title, 'url'=>$url, 'adddate'=>SYS_TIME, 'userid'=>$userid);省略⋯⋯$favorite_db->insert($data);\n   漏洞证明：  \n\n   修复方案：  将\n$title = urldecode($title);\n修改成\n$title = addslashes(urldecode($title));\n   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-08-15 14:38 厂商回复： 这个之前文件之前是有一定的问题，但按照你使用的这个方法在最新版上测试，未报SQL错误。请核实。。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-15 14:14 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  ~.~.....公开。    \n     2012-08-15 14:30 |    \t\tRay \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:7        )\t\t \n  坐等公开。    \n     2012-08-15 14:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  有图么不是    \n     2012-08-15 14:52 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @phpcms 经wooyun官方确认，这个是存在的，$phpcms_auth = param::get_cookie('auth');，需要你先注册一个账户并且登陆后访问那个接口文件才会报错，看代码 ：）。    \n     2012-08-18 15:14 |    \t\t无敌最寂寞 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:4        | alert('这个家伙很懒，什么都没有留下'))\t\t \n  look!look!    \n     2012-08-18 18:01 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @无敌最寂寞 真无敌，还是假无敌啊？真无敌是少年时代的偶像啊，还是dahubaobao    \n     2012-09-04 15:53 |    \t\t巴克 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 禽兽)\t\t \n  求细节    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}