{"id": 63361, "wybug_id": "wooyun-2013-032075", "wybug_title": "爱丽网可以暴力破解他人账号造成用户敏感信息泄漏（有成功破解证明）", "wybug_corp": "aili.com", "wybug_author": "niliu", "wybug_date": "2013-07-24 11:34", "wybug_open_date": "2013-09-07 11:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "逻辑错误", "设计不当", "认证设计不合理", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-07：\t细节向公众公开  简要描述： 好久没收到厂商的礼物了，有点小骚动~ 详细说明：  我总感觉爱丽网的这种漏洞都修完了...无聊就检测一下...具体过程如下：登陆是随便填写一个用户名（test）吧，然后密码最好输入一个弱口令，这里我就填（******）吧...\n\n然后登陆时抓包，抓包如下：\n\n从抓包数据中可以看到，密码是md5加密后的，这里可以对弱口令******的用户进行用户名破解，也可以对某个特定账号进行md5密码破解（这个效率有点慢），也可以撞库...这里我对用户名进行破解，除了一个基本的用户名字典，又找一小部分某网站的用户名来进行测试，如图：\n\n根据包的大小来判断是否成功，破解成功的返回包比失败的大很多，如下失败：\nHTTP/1.1 200 OKDate: Wed, 24 Jul 2013 02:53:00 GMTServer: nginx/0.8.39Content-Type: text/html; charset=gbkX-Powered-By: PHP/5.2.10Set-Cookie: 4xkw_2132_sid=98Qqqh; expires=Thu, 25-Jul-2013 02:54:13 GMT; path=/Set-Cookie: 4xkw_2132_lastact=1374634453%09member.php%09logging; expires=Thu, 25-Jul-2013 02:54:13 GMT; path=/Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheX-Via: 1.1 hnly26:88 (Cdn Cache Server V2.0), 1.1 sddy32:6060 (Cdn Cache Server V2.0)Connection: closeContent-Length: 33jsonp1374633212385([{\"msg\":\"3\"}])\n成功：\nHTTP/1.1 200 OKDate: Wed, 24 Jul 2013 02:53:02 GMTServer: nginx/0.8.39Content-Type: text/html; charset=gbkX-Powered-By: PHP/5.2.10Set-Cookie: 4xkw_2132_sid=obJaj5; expires=Thu, 25-Jul-2013 02:54:13 GMT; path=/Set-Cookie: 4xkw_2132_lastact=1374634453%09member.php%09logging; expires=Thu, 25-Jul-2013 02:54:13 GMT; path=/Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheSet-Cookie: auth=ee28sKW0sdbZkVFkA9Y3tzgGbVjIAdxsFx8PCSuGAN23frIyYUduR7ZaWxrHlcMi6LzxxH6kiirpCpaCFtWm3BmO%2F0QoV%2B2mIKawjnE%2FMUsUtUYRCaNrFSlWQuj%2B5rlC; expires=Thu, 25-Jul-2013 02:54:15 GMT; path=/; domain=.aili.comSet-Cookie: username=%26%23122%3B%26%23104%3B%26%2397%3B%26%23111%3B; expires=Thu, 25-Jul-2013 02:54:15 GMT; path=/; domain=.aili.comSet-Cookie: asffd=zhao; expires=Thu, 25-Jul-2013 02:54:15 GMT; path=/; domain=.aili.comSet-Cookie: uid=15187; expires=Thu, 25-Jul-2013 02:54:15 GMT; path=/; domain=.aili.comSet-Cookie: lastvisit=1340650305; expires=Thu, 25-Jul-2013 02:54:15 GMT; path=/; domain=.aili.comSet-Cookie: avatar=http%3A%2F%2Fspace.aili.com%2Fuc_server%2Favatar.php%3Fuid%3D15187%26size%3Dmiddle%26r%3D73851; expires=Thu, 25-Jul-2013 02:54:15 GMT; path=/; domain=.aili.comSet-Cookie: integration=0; expires=Thu, 25-Jul-2013 02:54:15 GMT; path=/; domain=.aili.comSet-Cookie: reportnum=0; expires=Thu, 25-Jul-2013 02:54:15 GMT; path=/; domain=.aili.comSet-Cookie: report=0; expires=Thu, 25-Jul-2013 02:54:15 GMT; path=/; domain=.aili.comSet-Cookie: 15187email=zhao123%40163.com; expires=Thu, 25-Jul-2013 02:54:15 GMT; path=/; domain=.aili.comX-Via: 1.1 hnly26:88 (Cdn Cache Server V2.0), 1.1 sddy32:6060 (Cdn Cache Server V2.0)Connection: closeContent-Length: 828jsonp1374633212385([{\"uid\":\"15187\",\"username\":\"zhao\",\"email\":\"zhao123@163.com\",\"a_uid\":\"000015187\",\"avatar\":\"http:\\/\\/space.aili.com\\/uc_server\\/avatar.php?uid=15187&size=middle&r=73851\",\"realname\":\"\",\"birthyear\":\"0\",\"birthmonth\":\"0\",\"birthday\":\"0\",\"constellation\":\"\",\"zodiac\":\"\",\"telephone\":\"\",\"mobile\":\"\",\"idcardtype\":\"\",\"idcard\":\"\",\"address\":\"\",\"zipcode\":\"\",\"nationality\":\"\",\"birthprovince\":\"\",\"birthcity\":\"\",\"resideprovince\":\"\",\"residecity\":\"\",\"residedist\":\"\",\"residecommunity\":\"\",\"residesuite\":\"\",\"graduateschool\":\"\",\"company\":\"\",\"education\":\"\",\"occupation\":\"\",\"position\":\"\",\"revenue\":\"\",\"affectivestatus\":\"\",\"lookingfor\":\"\",\"bloodtype\":\"\",\"height\":\"\",\"weight\":\"\",\"alipay\":\"\",\"icq\":\"\",\"qq\":\"\",\"yahoo\":\"\",\"msn\":\"\",\"taobao\":\"\",\"site\":\"\",\"bio\":\"\",\"interest\":\"\",\"lastvisit\":\"1340650305\",\"integration\":0,\"reportnum\":0,\"num\":0}])\n因为这里面包含了用户的一些个人信息（用户名，邮箱等等...）再贴一些证明图：\n\n<img src=\"/upload/201307/241129151864aa2f98b3ecdfabbbfc7bfe7b6223.png\" alt=\"zhao.png\" \n\n\n\n   漏洞证明：  综上所述，就不一一列举了...   修复方案：  登陆验证码，错误次数限制等等.. ：D少年，礼物求给力！   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-07-24 14:51 厂商回复： @niliu   很久没看到你骚动了  多骚动几次. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-24 11:35 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  这标题给我改这老长，太霸道了。。。。    \n     2013-07-24 11:57 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  尽搞二流厂商    \n     2013-07-24 12:09 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @xsser 对，使'尽'搞二流厂商 :0    \n     2013-07-24 19:23 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @爱丽网 骚动起来~    \n     2013-09-07 13:09 |    \t\tmisssky \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:28        | 没什么)\t\t \n  厂商回复霸气    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}