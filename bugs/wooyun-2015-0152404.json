{"id": 81967, "wybug_id": "wooyun-2015-0152404", "wybug_title": "陕西师范大学出版总社因一张头像引发的血案", "wybug_corp": "陕西师范大学出版总社有限公司", "wybug_author": "修罗", "wybug_date": "2015-11-06 18:43", "wybug_open_date": "2015-12-21 18:44", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-12-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 本来准备继续渗下内网的，想想未获授权，还是算了。 详细说明：  1、进入陕西师范大学出版总社有限公司主站\n\nmask 区域\n*****nup*****\n\n，点击“网上商城”，进入：shop.snupg.com2、随便注册一个账号，登录进入\"个人中心\"，点击左侧”上传头像“\n\n3、打开FireBug可以看到客户端用js做了扩展名限制：\n\n4、下断点，刷新页面，把这处代码改成：file_types : \"*.*\",5、上传一个jsp 大马，成功绕过限制上传，由于网站有头像预览功能，上传后可在页面上找到上传文件的路径。   漏洞证明：  哇，ROOT，太客气了。\n\n这是网站所在目录\n\n查看网站配置，找到网站数据库和BBS数据库的配置信息：论坛配置：<db_driver>com.mysql.jdbc.Driver</db_driver>\t\t<db_url>jdbc:mysql://192.168.1.71:3307/discuz?useUnicode=true&amp;characterEncoding=utf-8</db_url><db_username>luntan</db_username>\t\t<db_password>luntan</db_password>本站mysql数据库配置：\n\nmask 区域\n*****.mysql.j**********nect=true&amp;useUnicode=**********me=pub**********rd=Fou*****\n\n通过大马连接数据库成功：\n\n   修复方案：  1、上传文件处加上服务端文件类型验证；2、删除我上传的jsp大马，位置在：/home/founder/platform/common/header_top20131115.jsp   版权声明：转载请注明来源 修罗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}