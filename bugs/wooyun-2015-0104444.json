{"id": 23512, "wybug_id": "wooyun-2015-0104444", "wybug_title": "网站安全狗免杀神技+IIS6.0解析WebShell访问限制Bypass", "wybug_corp": "安全狗", "wybug_author": "RedFree", "wybug_date": "2015-03-28 18:20", "wybug_open_date": "2015-06-29 15:14", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当", "客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向公众公开  简要描述：     你想让你的webshell不被安全狗查杀吗？你还在为上传了诸如test.asp;.jpg之类的文件访问时被安全狗拦截而发愁吗？如果是，请往下看，保证不后悔哦！ 详细说明：  上次通过使用中文符突破了安全狗对解析文件的拦截，安全狗更新后这个方法就失效了。测试如下：\nhttp://127.0.0.1/躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺躺.asp;.txt\n被拦截如图：\n\n那么这样就没有其它的方法来突破了吗？答案是否定的！由于安全狗对一些特殊字符没有免疫能力（具体哪些字符可以自行测试，这里只提供一个作为例子），所以依然可以构造特殊的文件名来绕过安全狗的栏截！    我使用：\n♣a.asp;.jpg\n来做文件名，内容呢则是普通的一句话：\n<%eval request(\"z\")%>\n。浏览器访问看一下效果：\n\n    同样的道理，可以用♣等特殊字符来作为Webshell的名称实现不被查杀的效果。\n\n\n\n    那么安全狗的全站扫描可不可以查杀的到呢？和正常的文件对比一下，上图，看效果：\n\n可见安全狗是不查杀带有♣这类字符作为文件名的文件的。   漏洞证明：  \n\n\n\n\n\n   修复方案：  新三年、旧三年、缝缝补补又三年，产品发布之前应该尽量做完整的测试！   版权声明：转载请注明来源 RedFree@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-03-31 15:12 厂商回复： 将在新版本中心修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-28 19:59 |    \t\tGnest \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 一地的白帽子)\t\t \n  发到Zone先睹为快呀！    \n     2015-03-28 20:49 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  这下狗哥有的忙了。。。@安全狗    \n     2015-03-28 22:11 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  @RedFree 你的菜刀啥时候放出来！    \n     2015-03-28 22:28 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  求详情    \n     2015-03-28 22:35 |    \t\t炊烟 \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:44        | 每一天都需要努力。)\t\t \n  求菜刀    \n     2015-03-28 22:47 |    \t\tAzui \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:10        | 用一只黑色铅笔画一出舞台默剧。)\t\t \n  这下狗哥有的忙了。。。@安全狗    \n     2015-03-29 02:06 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  安全狗好像还算比较好绕，上传2个文件，其中一个50m的文件就不拦了。    \n     2015-03-29 08:56 |    \t\tRedFree \t\t\t( 普通白帽子  |\t\t\t        Rank:180 漏洞数:40        | 每个系统都有它自身的弱点，无论是相对的还...)\t\t \n  @园长 昨晚也发了一个webshell上传绕过，和你说的原理上比较相似，不过还没有审核呢。    \n     2015-03-29 11:55 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  坐看风起云涌    \n     2015-03-31 15:38 |    \t\t小猫钓鱼 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:2        | 喵~)\t\t \n  绕过安全狗才5rank...    \n     2015-06-29 16:15 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:71        | I'm Me_Fortune)\t\t \n  相煎何太急。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}