{"id": 4898, "wybug_id": "wooyun-2014-055891", "wybug_title": "TOM在线一个小问题引起的连锁反应，影响好几个分站以及数据", "wybug_corp": "TOM在线", "wybug_author": "卡卡", "wybug_date": "2014-04-08 08:09", "wybug_open_date": "2014-04-13 08:10", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件上传", "渗透测试思路", "管理后台对外", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：   老大总是跟我说，小牙签也有大用处，今天这只小牙签确实有大用了   ps~~ （老子不是小牙签）！！！ 见过金箍棒么？ 恩？ 详细说明：    问题出的很不应该，在tom游戏这里\nhttp://joe.game.tom.com\n\n\n德州扑克??表示我只听过，怎么玩完全不懂~~好吧。。我农民了站点采用了dedecms，由于没及时打上补丁，导致一系列问题爆帐号密码\n\n直接爆出管理帐号密码，这个站我没找到后台登录界面，不过可悲的是管理员竟然用了管理帐号来做后台，这让我无言以对\n\n利用爆出的帐号密码成功登录后台文件管理处直接上传getshell\n\n权限很不错，可以各种跨，于是我又翻了翻，不小心就又翻到游戏论坛这里了\n\n找到数据库配置文件，连上去看了看\n<?phpdefine('UC_CONNECT', 'mysql');define('UC_DBHOST', '172.24.202.247');define('UC_DBUSER', 'gamebbs');define('UC_DBPW', 'gamebbsad213');define('UC_DBNAME', 'gamebbs');define('UC_DBCHARSET', 'gbk');define('UC_DBTABLEPRE', '`gamebbs`.bbs_ucenter_');define('UC_DBCONNECT', 0);define('UC_CHARSET', 'gbk');define('UC_KEY', 'icu3c8O7AdLa97P126h6O7C1K4Qaocd3q91eTcUcs571B91f84C2o137J9ubj6J7');define('UC_API', 'http://bbs.game.tom.com/uc_server');define('UC_APPID', '1');define('UC_IP', '');define('UC_PPP', 20);\n\n\n找到用户这个表，看了看，获取了下表行数\n\n这个数字代表什么不用我解释了把~~很多的表，我也没一一细看然后翻着翻着，又翻到tom围棋这个站，拿着数据库配置文件又连了上去，这个权限不错，可以跨库了\n\n这个服务器上所有的站，所有的数据，就都在这里了又翻出了root帐号密码\n\n这里又是个100多W，我也不知道是干嘛的\n\n而且可以执行命令，提权服务器\n\n我对linux也不是很熟悉，而且也只是检测，就到此为止！这个服务器上的几个站，都是采用dedecms的，而且漏洞都没修复，我也只是检测，并未脱裤，就到这里！高rank有木有？？   漏洞证明：  \n\n\n\n利用爆出的帐号密码成功登录后台文件管理处直接上传getshell\n\n\n\n\n<?phpdefine('UC_CONNECT', 'mysql');define('UC_DBHOST', '172.24.202.247');define('UC_DBUSER', 'gamebbs');define('UC_DBPW', 'gamebbsad213');define('UC_DBNAME', 'gamebbs');define('UC_DBCHARSET', 'gbk');define('UC_DBTABLEPRE', '`gamebbs`.bbs_ucenter_');define('UC_DBCONNECT', 0);define('UC_CHARSET', 'gbk');define('UC_KEY', 'icu3c8O7AdLa97P126h6O7C1K4Qaocd3q91eTcUcs571B91f84C2o137J9ubj6J7');define('UC_API', 'http://bbs.game.tom.com/uc_server');define('UC_APPID', '1');define('UC_IP', '');define('UC_PPP', 20);\n\n\n\n\n\n\n\n\n\n\n   修复方案：  对于国内一些cms，要及时打补丁、管理员的加强，不仅是技术上，更是一些行为习惯上，避免在用帐号做后台了由于太累，我也没找还有没有别人的shell，建议好好清理一下   版权声明：转载请注明来源 卡卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-04-13 08:10 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-08 09:15 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  咔！咔！已切！    \n     2014-04-13 09:08 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  咋忽略了    \n     2014-04-13 09:10 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  别说为什么没人确认，你们啊！真不会做人，把厂商说的这样，厂商肯定生气了！    \n     2014-04-13 17:38 |    \t\t卡卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:52        | <script>alert('安全团队长期招人')</scrip...)\t\t \n  好吧，每一次忽略背后，都是一颗破碎的心啊~~~    \n     2014-04-19 20:13 |    \t\t小夜 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:8        | 漫长的日子)\t\t \n  这不忽略 你自己的良心过的去吗？    \n     2014-04-19 20:13 |    \t\t小夜 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:8        | 漫长的日子)\t\t \n  你这是在调查户口本啊    \n     2014-05-01 23:51 |    \t\t小小鸟 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 小白一个)\t\t \n  这都忽略，得多伤作者的心啊    \n     2014-06-14 02:33 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  已阅    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}