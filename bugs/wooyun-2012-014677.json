{"id": 15485, "wybug_id": "wooyun-2012-014677", "wybug_title": "某银行网银身份认证小缺陷", "wybug_corp": "某银行", "wybug_author": "虚幻灵者", "wybug_date": "2012-11-12 16:11", "wybug_open_date": "2012-12-27 16:11", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "11", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-27：\t细节向公众公开  简要描述： 某银行网银系统身份认证机制上存在缺陷，导致攻击者可以绕过登陆页面进入网银系统。 详细说明：  中信银行的网银系统除了session认证身份外，还使用了随机分配的token令牌参数作为额外的身份认证机制。例如：……inforbar.do?EMP_SID=DFJAEXBMCFHBJFFKGMJDESIEDCJBBUUVCZHYGCGM正常来说使用多种身份认证机制时应该使用和而不是或的关系，而在该系统中，只要其中任意一种通过验证系统即认为你已经登陆成功。   漏洞证明：  清空firefox的所有缓存和cookie防止混淆页面效果。\n\n构造HTTP请求包，填写有效的token参数值，修改掉sessionid，令其失效。\n\n提交后可见，已经是登陆状态了。\n\n   修复方案：  这个大家都懂的。   版权声明：转载请注明来源 虚幻灵者@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2012-11-14 14:25 厂商回复： CNVD近日未复现所述情况（工作人员无中信银行账号，其官方网站上也禁止新用户注册），已联系中信银行信息化主管部门。根据14日下午反馈情况，所述关键参数在安全策略上采取与浏览器端源IP绑定认证的策略，故虚幻灵者在本机测试实现的情况在其他主机上将不会成功，同时变更该关键参数将直接导致会话失效。rank 7 最新状态： 2012-11-14：另补充，对于同一局域网主机，则存在嗅探攻击的可能，因为出口IP一致。  ", "replys": "漏洞评价：\n评论\n     2012-11-12 16:12 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  现在怎么都这么牛x ，无法想象了都    \n     2012-11-12 17:43 |    \t\t虚幻灵者 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:1        | s)\t\t \n  原来标题不是这个，乌云随便改我的标题有点不地道啊%>_<%    \n     2012-11-12 17:56 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @虚幻灵者 你要相信乌云改标题是有道理滴……    \n     2012-11-12 18:34 |    \t\t虚幻灵者 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:1        | s)\t\t \n  @zzR 改标题有道理，那么为什么漏洞没有提交中信银行而是提交到了第三方厂商cncert？呵呵，元芳你怎么看？    \n     2012-11-13 09:01 |    \t\tcode0day \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:4        | 一步一步来。)\t\t \n  银行你也敢动！！！！    \n     2012-11-13 13:13 |    \t\t虚幻灵者 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:1        | s)\t\t \n  @code0day 没动别人，只是动了我自己而已啊。    \n     2012-11-13 13:49 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @虚幻灵者 你每天看5个小时乌云你就知道为啥不提交到第三方厂商了-0-    \n     2012-11-14 09:52 |    \t\tsuper480 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:2        )\t\t \n  @虚幻灵者  银行不会直接过来领取的,一般流程是报给cncert,然后他们报给银监会,银监会报给银行.   因为是银监会报给银行,所以银行都是压力都是很大的.灰常不喜欢被人在乌云上报漏洞.    \n     2012-11-14 12:16 |    \t\txiya \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  mark     \n     2012-11-14 14:38 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  银行和一些国家信息系统部门的由于一些原因我们之前是不处理的，后来与CERT合作算是将乌云作为一个问题收集入口通过cert提交的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}