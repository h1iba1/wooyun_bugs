{"id": 85530, "wybug_id": "wooyun-2016-0172045", "wybug_title": "网站安全狗WebShell上传拦截Bypass再一发", "wybug_corp": "安全狗", "wybug_author": "RedFree", "wybug_date": "2016-01-22 22:43", "wybug_open_date": "2016-03-08 21:29", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "9", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "安全狗"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-08：\t细节向公众公开  简要描述： 网站安全狗再一发WebShell上传拦截绕过 详细说明：  测试环境：Windows2003+IIS6+ASP安全狗版本：\n\n上传一个ASP文件被拦截：\n\n请求内容（部分）如下：\n------WebKitFormBoundaryWyGa1hk6vT9BZGRrContent-Disposition: form-data; name=\"FileUploadName\"; filename=\"test.asp\"Content-Type: application/octet-stream<%response.write(\"bypass safedog test!\")%>------WebKitFormBoundaryWyGa1hk6vT9BZGRr--\n因为WebServer获取参数的灵活性，所以我尝试把安全狗拦截的filename=\"test.asp\"换个位置。经过一番测试，发现filename=\"test.asp\"位于Content-Type: application/octet-stream这一行或下一行时，安全狗的上传拦截便会失效。\n\n\n\n\n\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  考虑不正常请求的处理   版权声明：转载请注明来源 RedFree@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-01-25 09:59 厂商回复： 感谢感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-23 12:53 |    \t\tBay0 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 帅到抠脚~)\t\t \n  你猜下有多少人在你楼下了？    \n     2016-01-23 19:15 |    \t\t卡卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:56        | <script>alert('安全团队长期招人')</scrip...)\t\t \n  有多少人拜倒在红老师的牛仔裤下了？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}