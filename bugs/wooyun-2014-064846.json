{"id": 2586, "wybug_id": "wooyun-2014-064846", "wybug_title": "中国联通某站注入漏洞存在信息泄露风险", "wybug_corp": "中国联通", "wybug_author": "PythonPig", "wybug_date": "2014-06-14 11:07", "wybug_open_date": "2014-07-29 11:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["信息泄漏", "注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向公众公开  简要描述： 中国联通某站注入漏洞存在信息泄露风险 详细说明：  问题出在河南省校园通，从数据库初步来看，郑州市、开封市等地区老师信息、至少有18个学校的老师、学生、家长信息漏洞（包括姓名、电话、邮箱、用户名、密码等信息）0x01：注入点:http://www.ltxyt.com/xyt/dx/news/newsinfo.aspx?id=2178 本站还存在其他注入点，请自行检查\n\n0x02：数据库\n\n部分表的内容\n\n下面把数据库JXT中的表贴出来，还有不少汉字命名的表，呵呵\nweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005Database: JXT[283 tables]+----------------------------------------+| db_owner.ML_Chat                       || db_owner.ML_ChatHistory                || db_owner.ML_User                       || db_owner.ML_favorites                  || db_owner.View_1                        || dbo.A                                  || dbo.Academe                            || dbo.Accessory                          || dbo.Affiche                            || dbo.Answer                             || dbo.Area                               || dbo.BabyPhoto                          || dbo.BabyShow                           || dbo.City                               || dbo.ClassTime                          || dbo.Classes                            || dbo.Composition                        || dbo.Course                             || dbo.CustomGroup                        || dbo.Department                         || dbo.EmailReceiveBox                    || dbo.EmailSendBox                       || dbo.Exam                               || dbo.ExamResult                         || dbo.ExamResultStat                     || dbo.ExamType                           || dbo.FAQ                                || dbo.FriendLink                         || dbo.FriendLinkType                     || dbo.Grade                              || dbo.L_Rules                            || dbo.L_SMS                              || dbo.L_User                             || dbo.L_UserBind                         || dbo.LogAdminLogin                      || dbo.LogAdminOperation                  || dbo.LogUserLogin                       || dbo.MsgGroupA                          || dbo.MsgGroupB                          || dbo.PhoReceiveBox                      || dbo.PhoSendBox                         || dbo.PhoSendBox1                        || dbo.PhoSendHistroy                     || dbo.PhoneNumber                        || dbo.PhoneNumbers                       || dbo.PhoneNumbers1                      || dbo.Province                           || dbo.Question                           || dbo.QuestionTypeA                      || dbo.QuestionTypeB                      || dbo.RecordMsg                          || dbo.RecordMsgUser                      || dbo.ResComment                         || dbo.ResSms                             || dbo.ResSmsTypeA                        || dbo.ResSmsTypeB                        || dbo.ResText                            || dbo.ResTextTypeA                       || dbo.ResTextTypeB                       || dbo.ResVideo                           || dbo.Right                              || dbo.RightTypeA                         || dbo.RightTypeB                         || dbo.RightTypeC                         || dbo.Role                               || dbo.SMG_LOG                            || dbo.SMS                                || dbo.SP_ORIINFO                         || dbo.SP_ORIINFO_ERR                     || dbo.SP_ORIINFO_LOG                     || dbo.SP_SENDINFO                        || dbo.SchoolDept                         || dbo.SchoolType                         || dbo.ScoreType                          || dbo.Speciality                         || dbo.Subject                            || dbo.SysPar                             || dbo.SystemUser                         || dbo.SystemUsers                        || dbo.TB_Branch                          || dbo.TB_Employee                        || dbo.TB_Job                             || dbo.TB_Level                           || dbo.TB_Message                         || dbo.T_Counter                          || dbo.T_CounterStyle                     || dbo.T_IpLog                            || dbo.T_TodayIpLog                       || dbo.Teach                              || dbo.TemplateSystem                     || dbo.TemplateTeacher                    || dbo.TemplateType                       || dbo.TotalMsgClass                      || dbo.TotalMsgUser                       || dbo.UserAdministrator                  || dbo.UserEmployee                       || dbo.UserExInfo                         || dbo.UserParent                         || dbo.UserStudent                        || dbo.UserStudent_History                || dbo.UserTeacher                        || dbo.User_R_Dept                        || dbo.V_App_FAQ                          || dbo.V_Classes_School_Grade_UserTeacher || dbo.V_Classes_Subject_UserTeacher      || dbo.V_L_TemplateTeacher                || dbo.V_L_TemplateType                   || dbo.V_SchoolType_School_SchoolDetail   || dbo.V_UserStudent_UserParent           || dbo.V_UserTeacher_Course_Subject       || dbo.View_1                             || dbo.[Accessory-]                       || dbo.[V_A_某校重复记录_同一班级中_相同号码相同姓名的学生]                           || dbo.[V_A_漯河医专发送唯一数据_带班级]                            || dbo.[V_A_漯河医专发送唯一数据_带班级_仅班主任发送]                           || dbo.[V_A_漯河医专成功接收短信的学生]                             || dbo.[V_A_漯河医专有权限发送短信的教师]                             || dbo.[V_A_漯河医专正常接收短信的学生（终）]                           || dbo.[V_A_漯河医专用户资料_学生]                            || dbo.[V_A_漯河医专用户资料_教师]                            || dbo.[V_A_登封平台用户资料_家长]                            || dbo.[V_A_统计_临时A表中号码-学校-营业厅1]                        || dbo.[V_A_统计_临时A表中号码-学校-营业厅]                         || dbo.[V_A_统计_所有的号码及关联的学校]                            || dbo.[V_A_郑州地区学生资料]                             || dbo.[V_A_郑州地区家长资料]                             || dbo.[V_A_郑州地区教师资料]                             || dbo.[V_And_教师带UserName自定义分组]                   || dbo.[V_And_自定义学生分组]                           || dbo.[V_And_自定义家长分组]                           || dbo.[V_And_自定义教师分组]                           || dbo.[V_App_文章资源]                           || dbo.[V_B_成绩模板]                             || dbo.[V_C_可发短信班级阶梯类别--示例]                           || dbo.[V_C_可发短信的教师]                             || dbo.[V_C_各学校教师数]                             || dbo.[V_C_各学校部门数]                             || dbo.[V_C_带SCHOOLcSARDID的教师]                || dbo.[V_C_带学校ID的学生]                           || dbo.[V_C_带学校ID的家长]                           || dbo.[V_C_带年级的教师]                             || dbo.[V_C_带类型的学校]                             || dbo.[V_C_带部门ID的教师]                           || dbo.[V_C_带部门的教师]                             || dbo.[V_C_所有唯一用户号码]                             || dbo.[V_C_所有用户]                             || dbo.[V_C_所有用户号码]                             || dbo.[V_C_所有用户号码带学校类型]                             || dbo.[V_C_教师代课和管理班级]                             || dbo.[V_C_教师代课班级]                             || dbo.[V_C_教师相关的学生]                             || dbo.[V_C_教师相关的家长]                             || dbo.[V_C_教师管理班级]                             || dbo.[V_C_自定义分组]                             || dbo.[V_JL_发送手机短信_家长年级分组]                           || dbo.[V_JL_发送手机短信_教师年级分组]                           || dbo.[V_JL_发送手机短信_教师班级分组]                           || dbo.[V_JL_发送手机短信_班主任]                           || dbo.[V_JL_发送手机短信_自定义学生分组]                           || dbo.[V_JL_发送手机短信_自定义家长分组]                           || dbo.[V_JL_发送手机短信_自定义教师分组]                           || dbo.[V_JL_发送短信_班主任]                           || dbo.[V_JL_发送站内短信_自定义家长分组]                           || dbo.[V_KFJW_高级搜索]                          || dbo.[V_KK_获取教师用户版本号文本]                            || dbo.[V_KK_获取教师部门版本号文本]                            || dbo.[V_LS_荥阳学校]                            || dbo.[V_L_ADMIN_COMMON_角色设置]                || dbo.[V_L_ADMIN_SYS专区_权限列表]                   || dbo.[V_L_ADMIN_SYS专区_权限列表_NoHide]            || dbo.[V_L_ADMIN_SYS专区_角色管理_系统角色列表]                  || dbo.[V_L_ADMIN_学校管理_所有学校]                      || dbo.[V_L_ADMIN_学校管理_所有学校_学校人数]                     || dbo.[V_L_ADMIN_学校管理_所有学校_学校班级数]                     || dbo.[V_L_ADMIN_学校管理_所有学校_学校管理员]                     || dbo.[V_L_ADMIN_学校管理_所有学校_当前学年班级短信量]                     || dbo.[V_L_ADMIN_学生管理_档案管理]                      || dbo.[V_L_ADMIN_教务管理_成绩汇总]                      || dbo.[V_L_ADMIN_教务管理_成绩汇总_old]                  || dbo.[V_L_ADMIN_教务管理_成绩汇总_历次考试]                     || dbo.[V_L_ADMIN_教务管理_成绩汇总_历次考试_old]                 || dbo.[V_L_ADMIN_教务管理_成绩汇总_学生成绩]                     || dbo.[V_L_ADMIN_教务管理_成绩汇总_学生成绩_全部学生]                    || dbo.[V_L_ADMIN_教务管理_成绩汇总_考试班级]                     || dbo.[V_L_ADMIN_教务管理_班级设置]                      || dbo.[V_L_ADMIN_教务管理_考试类型]                      || dbo.[V_L_ADMIN_教务管理_考试设置]                      || dbo.[V_L_ADMIN_教师管理_档案管理]                      || dbo.[V_L_ADMIN_数据统计_新老用户_各县]                     || dbo.[V_L_ADMIN_数据统计_新老用户_各学校]                     || dbo.[V_L_ADMIN_数据统计_新老用户_各市]                     || dbo.[V_L_ADMIN_数据统计_新老用户_各班级]                     || dbo.[V_L_ADMIN_数据统计_用户统计_家长]                     || dbo.[V_L_ADMIN_数据统计_用户统计_家长test1]                || dbo.[V_L_ADMIN_数据统计_用户统计_教师]                     || dbo.[V_L_ADMIN_数据统计_用户统计_教师test1]                || dbo.[V_L_ADMIN_数据统计_用户统计_教师test2]                || dbo.[V_L_ADMIN_数据统计_短信统计]                      || dbo.[V_L_ADMIN_数据统计_短信统计_各县1]                    || dbo.[V_L_ADMIN_数据统计_短信统计_各县]                     || dbo.[V_L_ADMIN_数据统计_短信统计_各学校]                     || dbo.[V_L_ADMIN_数据统计_短信统计_各市1]                    || dbo.[V_L_ADMIN_数据统计_短信统计_各市]                     || dbo.[V_L_ADMIN_数据统计_短信统计_各年级]                     || dbo.[V_L_ADMIN_数据统计_短信统计_各班级]                     || dbo.[V_L_ADMIN_日志管理_普通用户登陆日志]                      || dbo.[V_L_ADMIN_日志管理_管理员操作日志]                      || dbo.[V_L_ADMIN_日志管理_管理员登陆日志]                      || dbo.[V_L_ADMIN_校务穐理_部门设置]                      || dbo.[V_L_ADMIN_校务管理_成纬汇总]                      || dbo.[V_L_ADMIN_用户管理_学生管理]                      || dbo.[V_L_ADMIN_用户管理_家长管理-早期]                     || dbo.[V_L_ADMIN_用户管理_家长管理]                      || dbo.[V_L_ADMIN_用户管理_教师管理]                      || dbo.[V_L_ADMIN_用户管理_职工管理]                      || dbo.[V_L_ADMIN_短信模板_原创模板]                      || dbo.[V_L_ADMIN_短信模板_系统模板]                      || dbo.[V_L_ADMIN_短信监审_待审核短信]                      || dbo.[V_L_ADMIN_短信监审_所发送短信]                      || dbo.[V_L_ADMIN_短信监审_所发送短信_历史记录]                     || dbo.[V_L_ADMIN_短信监审_所发送短信原始数据]                      || dbo.[V_L_ADMIN_短信监审_所接收短信]                      || dbo.[V_L_ADMIN_系统管理_角色管理_教师自定义角色]                     || dbo.[V_L_ADMIN_考试数量]                       || dbo.[V_L_PARENT_我的孩子_考试成绩_参加的考试]                    || dbo.[V_L_PARENT_我的孩子_考试成绩_参加的考试列表]                    || dbo.[V_L_PARENT_我的孩子_考试成绩_参加的考试成绩]                    || dbo.[V_L_Student_自定义分组_成员列表]                    || dbo.[V_L_Teacher_手机短信_自定义分组_成员列表]                   || dbo.[V_L_Teacher_短信统计_班级学生接收]                    || dbo.[V_L_Teacher_站内短信_收件箱]                    || dbo.[V_L_Teacher_站内短信_自定义分组_成员列表]                   || dbo.[V_L_参与考试班级数]                             || dbo.[V_L_学校最新学年]                             || dbo.[V_L_学生考试班级科目名次]                             || dbo.[V_L_班级考试科目数]                             || dbo.[V_L_省市区]                             || dbo.[V_L_考试班级列表]                             || dbo.[V_L_考试科目列表]                             || dbo.[V_NOUser_通过手机群发统计]                        || dbo.[V_S_发送成绩给学生]                             || dbo.[V_S_发送成绩给家长]                             || dbo.[V_T_漯河医专班级及具有发送权限大教师ID]                           || dbo.[V_X_带类别的问题]                             || dbo.[V_X_文本资源_大学]                            || dbo.[V_X_文本资源带类别]                             || dbo.[V_X_短信资源带类别]                             || dbo.[V_X_问吧类别]                             || dbo.[V_学校短信发送情况]                               || dbo.[db_owner.V_A_11月份有发送记录的用户及各自发送成功数]                  || dbo.[db_owner.V_A_18个学校]                  || dbo.[db_owner.V_A_18个学校_发送总量]                 || dbo.[db_owner.V_A_18个学校_学生数]                 || dbo.[db_owner.V_A_18个学校_成功发送数]                 || dbo.[db_owner.V_A_18个学校_教师数]                 || dbo.[db_owner.V_A_18个学校数据统计]                  || dbo.[db_owner.V_A_各学校学生注册数]                    || dbo.[db_owner.V_A_各学校家长注册数]                    || dbo.[db_owner.V_A_各学校教师注册数]                    || dbo.[db_owner.V_A_各学校管理员]                    || dbo.[db_owner.V_A_漯河医专六月份教师短信数据]                    || dbo.[db_owner.V_A_漯河地区各班级及班主任联系方式]                    || dbo.[db_owner.V_A_漯河职业技术学校用户资料_学生]                   || dbo.[db_owner.V_A_漯河职业技术学校用户资料_教师]                   || dbo.[db_owner.V_A_漯河职业技术学院发送唯一数据]                    || dbo.[db_owner.V_A_郑州地区1月份发送短信]                   || dbo.[db_owner.V_A_郑州市教师资料]                    || dbo.[db_owner.V_C_所有用户号码带学校类型2]                   || dbo.[db_owner.V_C_郑州地区各学校注册情况]                    || dbo.[db_owner.V_Q_今日数据统计]                    || dbo.[db_owner.V_Q_企信通用户]                    || dbo.[db_owner.V_Q_企信通部门_通讯录]                   || dbo.[发送记录（联通统计用）]                               || dbo.[教师_新用户_开封市区]                               || dbo.[教师_老用户_开封市区]                               || dbo.[用户营业厅归属（联通统计用）]                               || dbo.newold                             || dbo.school                             || dbo.schoolDetail                       || dbo.sendCount                          || dbo.smsUser                            || dbo.sysdiagrams                        || dbo.test1                              |+----------------------------------------+\n0x03：因为表和数据太多，这里只把部分老师信息数量和管理员的信息拿出来吧\n\n部分管理员信息\n\n   漏洞证明：  见详细说明   修复方案：  过滤   版权声明：转载请注明来源 PythonPig@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-06-18 20:21 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给河南分中心，由其后续地调当地基础电信企业处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-30 20:35 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  @PythonPig 中文的表名sqlmap里面怎么显示的？背景也看起来高大上啊    \n     2014-08-31 00:09 |    \t\tPythonPig \t\t\t( 普通白帽子  |\t\t\t        Rank:491 漏洞数:71        | 只会简单工具的小小菜)\t\t \n  @进击的zjx kali自带的sqlmap    \n     2014-08-31 11:38 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  @PythonPig 原来是kali。。学习了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}