{"id": 18144, "wybug_id": "wooyun-2012-011022", "wybug_title": "大连大学正方教务系统任意代码执行查询学生信息", "wybug_corp": "大连大学", "wybug_author": "路人甲", "wybug_date": "2012-08-18 13:45", "wybug_open_date": "2012-08-23 13:46", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 杭州正方教务管理系统是国内用的比较多一个教务管理系统,自高校采用以来,成为诸多黑客产业链的平台,在百度里搜索可以找到很多修改正方教务管理系统成绩的帖子,由于学校成绩与学生未来挂钩,如果被恶意篡改可能会影响终身,做为白帽子要深知影响力,及时反映该问题。 详细说明：  漏洞原理 正方教务管理系统是一套基于B/S和C/S全向兼容的管理系统。一般存在B/S架构的页面的IP开放了211端口,即可连接其C/S架构的管理系统,在C/S架构的查询过程中,对发起的TCP回话内容为固定值,可导致为经授权执行SQL查询语句等问题,在SQL查询过程中通过数据库语句可查询到关键账户,通过破解关键账户的密码,获得该教务管理系统的控制权限,随性发挥查询、改成绩什么的、都是浮云。另外求邀请码一个   漏洞证明：  1.在网上找到的一个教务系统,大连大学的,大连是个好地方啊。\n\n2.202.199.155.2:211 是开放的,证明对公网开放的C/S架构的管理方式。使用连接器测试之。\n\n提示连接成功,即可执行SQL\n\n3.该系统一般都会有一个默认账号,JWC01这个是教务处的账号,权限非常大,可以操作转学，退学什么的。相当的可怕,如果被恶意用户利用,影响也非常严重,对于该系统的密码也是可逆的。\n\n4.最终得到jwc01的账号。\n\n5.通过该账号可以查询到学生的详细信息,包括身份证号、手机号等。还有家人信息。如果该信息落入到电信诈骗人员手中,将造成很大的社会危害。\n\n   修复方案：  既然是白帽子要有安全建议：1.临时解决办法：建议211端口禁止对公网开放,限制在学校内网使用管理系统,禁止对公网开放连接。2.针对C/S架构的软件客户端执行操作语句时需要验证对端的身份。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-08-23 13:46 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-18 17:06 |    \t\tadwin \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:11        | 小菜请多指教。)\t\t \n  沙发关注。    \n     2012-08-18 21:07 |    \t\thqdvista \t\t\t( 普通白帽子  |\t\t\t        Rank:154 漏洞数:31        | N/A)\t\t \n  mark    \n     2012-08-19 10:09 |    \t\t梦想肥羊 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:18        | 博客：dnswalk.blog.163.com)\t\t \n  怎么我们学校不使用这个家伙··    \n     2012-08-23 13:58 |    \t\tadwin \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:11        | 小菜请多指教。)\t\t \n  洞主如此描述根本没有办法复现啊。    \n     2012-08-23 14:06 |    \t\tTea \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:37        | Can't We Be Young.)\t\t \n  这也无影响....    \n     2012-08-23 20:54 |    \t\t神刀 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | www.shellsec.com内射那么牛，虾米没妹子？)\t\t \n  mark    \n     2012-10-09 23:28 |    \t\tG8dSnow \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 一直在学习技术、分享知识的路上)\t\t \n  这个是啥连接软件?是自己写的么?说说原理啊    \n     2012-12-11 19:44 |    \t\tblack hook \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | 新人、)\t\t \n  这个SQL语句是什么？    \n     2013-01-22 00:09 |    \t\tl4mbda \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:3        | 嘘嘘)\t\t \n  @路人甲真恶心 sql语句也隐藏    \n     2013-02-24 23:49 |    \t\t剑走偏锋 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 剑走偏锋丨Zoupian Jian-feng)\t\t \n  @adwin @hqdvista @梦想肥羊 @adwin @Tea @神刀 @black hook @G8dSnow @l4mbda 我想知道这是什么连接器啊  来个群体召唤技能    \n     2013-05-08 18:14 |    \t\tayys \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 欢迎交流，熟悉正方教务系统漏洞。专业挖洞...)\t\t \n  求神器一个。。。楼主好人 ayys110@qq.com    \n     2015-01-12 20:21 |    \t\t05XS \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:5        | 总是拿着微不足道的成就来骗自己)\t\t \n  求神器一个 好人一生平安 249156334@qq.com    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}