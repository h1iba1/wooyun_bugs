{"id": 15985, "wybug_id": "wooyun-2012-015453", "wybug_title": "百度搜索引擎搜索结果被写入恶意JS（疑似挂马）", "wybug_corp": "百度", "wybug_author": "小P优优", "wybug_date": "2012-11-30 18:14", "wybug_open_date": "2012-12-03 10:46", "wybug_type": "恶意信息传播", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["挂马", "恶意信息传播", "挂马风险", "搜索引擎业务风险", "搜索引擎"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 搜索某些特定关键字时，搜索结果被加入script标签，引入一个浏览器控件（目前已经无法下载）。 详细说明：  关键字：\ntotal commander\n或者其他可以搜到TC的关键字，即可看到效果，浏览器提示安装Activex控件，研究了下发现某搜索结果莫名消失，而且被插入一段JS代码。\n<script >A.init(function() {var _this = this,T = A.baidu,img = _this.qq('softdown_icon'),qqbtn = _this.qq('op_newsoftdown_qqbtn'),bdbtn = _this.qq('op_newwoftdown_bdbtn'),qm = _this.qq('op_newsoftdown_qm'),browser = T.browser,i=0;var img1 = new Image();img1.onload = resize;img1.src = img.src;function hideBr() {var next = _this.container.nextSibling;if (next && next.nodeType == 1 && next.tagName == 'BR') {next.style.display = 'none';} else {if (i < 5) {setTimeout(hideBr, 50);} else {i++;}}} function resize() {var w = img1.width,h = img1.height;if (w > 64 || h > 64) {if (w < h) {w = 64 * w / h;h = 64;}else {h = 64 * h / w;w = 64;}}img.style.width = w + 'px';img.style.height = h + 'px';}var sid = '1018';;var SF = {softId: '',validPlugin: null,initObjectHtml:function(){var dv = document.createElement(\"div\"),ihtml='';if(browser.ie){ihtml = '<OBJECT ID=\"ieWebActivater\" CLASSID=\"CLSID:9149F99D-BC22-49c9-B952-845C94707595\" CODEBASE=\"http://test.zing.vn/ZingPlayWA.cab#version=1,0,0,8\" width=0 height=0 border=0></OBJECT>';}else if(browser.firefox || browser.isWebkit){ihtml = '<embed type=\"' + SF.getMimeType() + '\" id=\"npQMExtensionsXPCOM\" width=0 height=0 hidden=true></embed>';}dv.innerHTML = ihtml;document.body.appendChild(dv);},initPlugin:function(){if (!SF.validPlugin) {try{if (browser.ie) {SF.validPlugin = new ActiveXObject(\"npQMExtensionsIE.Basic\");} else if (browser.firefox || browser.isWebkit) {if (SF.checkMimePlugin()) {SF.validPlugin = T._g('npQMExtensionsXPCOM');} else {}}}catch(e){}}},initEvent:function(){},init: function() {SF.initObjectHtml(); SF.initPlugin();SF.initEvent();},getMimeType:function() {return \"application/qqpcmgr-extensions-mozilla\";},checkMimePlugin:function() {var type = window.navigator.mimeTypes && window.navigator.mimeTypes[SF.getMimeType()];var flag = type?true:false;if (flag) {var plugin = T._g('npQMExtensionsXPCOM');try {if (plugin.GetPluginVersion == undefined || plugin.GetPluginVersion() < 10000000) {flag = false;}} catch(e) {}}return flag;},checkWAPlugin: function() {try {if (!SF.validPlugin) {if (browser.ie) {SF.validPlugin = new ActiveXObject('npQMExtensionsIE.Basic');} else if (browser.firefox || browser.isWebkit) {if (SF.checkMimePlugin()) {SF.validPlugin = T._g('npQMExtensionsXPCOM');} else {}}}}catch (e) {}},isInstall: function() {var bInstall;SF.checkWAPlugin();if (SF.validPlugin) {try {bInstall = browser.ie ? SF.validPlugin.QMIsInstalled() : SF.validPlugin.QMIsInstall();bInstall = bInstall ? 1 : 0;} catch (e) {}}else {bInstall = 2;}return bInstall;},StartSoftMgr: function(sid) {SF.QMStatUp(5, '/page=taskmgr /softdetailid=' + sid + ' /action=download /parent=baidusearch');},QMStatUp: function(index, parms) {var strVersion;SF.checkWAPlugin(arguments[2]);if (SF.validPlugin) {try {SF.validPlugin.QMStartUp(index, parms);} catch (e) {}}},ieReady: function() {if ((browser.ie || browser.firefox || browser.isWebkit) && SF.isInstall() == 1) {return true;}else {return false;}}};T.dom.ready(function(){SF.init();if (qqbtn && sid != '' && (browser.ie || browser.firefox || browser.isWebkit)) {if (SF.ieReady()) {_this.qq('f').style.display = '';qqbtn.style.display = '';T.event.on(qqbtn, 'click', function() {SF.StartSoftMgr(sid);});c({'fm': 'inlo', rsv_qsd: 1});}else if (bdbtn) {qm.style.display = 'block';c({'fm': 'inlo', rsv_qsd: 2});}} else {if (!bdbtn) {setTimeout(hideBr, 50);}}});;});</script>\n   漏洞证明：  触发效果与分析结果，印象中此类问题已经出现很久了。\n\n   修复方案：  这到底是个咋回事？？？   版权声明：转载请注明来源 小P优优@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-12-03 10:46 厂商回复： 经过与产品线沟通，该问题不属于安全漏洞。为了不引起外界误解我们已做相应处理，感谢你的提交。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-30 22:20 |    \t\tEl4pse \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 世界上从来没有不可能这几个字，可不可能完...)\t\t \n  好吧我知道信封    \n     2012-11-30 23:38 |    \t\tHenry:bobo \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:22        | 本胖吊！~又高又肥2个奶奶像地雷)\t\t \n  @El4pse 你知道的太多了    \n     2012-12-01 09:36 |    \t\tEl4pse \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 世界上从来没有不可能这几个字，可不可能完...)\t\t \n  @Henry:bobo 你咋还没去当兵啊    \n     2012-12-02 19:30 |    \t\tlanz \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:5        | whatever)\t\t \n  非挂马，是与腾讯合作的一个东西。    \n     2012-12-03 14:25 |    \t\tLeadUrLife \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:14        | 好好学习 天天向上)\t\t \n   width=0 height=0 border=0 有类如上述字符的代码一般都见不得光    \n     2013-01-24 19:47 |    \t\tCzBiX \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | CzBiX)\t\t \n  cab文件下载地址：http://dl.play.zing.vn/minigamefile/ZingPlayWA.cab下载后发现是个类似于QQGame的游戏大厅    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}