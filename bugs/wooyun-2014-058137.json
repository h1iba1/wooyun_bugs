{"id": 56341, "wybug_id": "wooyun-2014-058137", "wybug_title": "美丽说存储型XSS漏洞", "wybug_corp": "美丽说", "wybug_author": "0x_Jin", "wybug_date": "2014-04-23 17:06", "wybug_open_date": "2014-06-07 17:07", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "类型应用", "利用技巧", "黑盒测试技巧", "腾讯微薄"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-07：\t细节向公众公开  简要描述： 同样还是去年的一个漏洞，本来想深挖来着 但是时间不够用了 就不深挖了 处于www域 www域下应用倒还挺多的  你们懂的！ 详细说明：  此次漏洞跟最开始 superhei 那个腾讯微薄的漏洞一样！(百度空间的文章中 带了经过编码的 xss payload  但是把文章链接发到腾讯微薄，腾讯微薄当时新出了预览功能 会先加载一次链接中的内容。但是在加载过程中 会把网页内容中的xss payload给解码)这次美丽说的漏洞也一样！在分享宝贝处 - 填入淘宝网商品链接(商品名改成xss payload) ->发布分享(造成XSS漏洞)这里可填入的商品链接不局限于淘宝，根据美丽说的说明 还可以有其他的购物站！目测是爬虫 爬行链接 然后把商品名 以及商品说明爬出来 然后返回给美丽说，美丽说插入到网页！不多说了 下面上图！   漏洞证明：  1.分享宝贝：\n\n2.修改淘宝宝贝名称(带上xss payload)\n\n3.分享宝贝处填入带有xss payload的商品链接：\n\n4.发布商品名中带xss payload的宝贝儿\n\n5.去看下刚发出出去的商品页面。\n\n可以看到打开页面时，发出了个请求到我的 js hook！6.看看网页源码中的内容：\n\n可以看到商品名后面带上了我们的xss payload7.再看看xss平台收到的内容:\n\n收到了cookie，并且美丽说 关键cookie值未做httponly。www 域下还是有蛮多应用的 好好修复下吧！去年腾讯围脖的xss出来 就应该修复的！   修复方案：  在爬虫去获得内容时，别html解码！然后在插入网页时再对值做一次检查！如果存在危险关键字 < > / \\ ' \"什么的 再做一次编码！求高分~   版权声明：转载请注明来源 0x_Jin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-04-24 15:06 厂商回复： 感谢提交。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}