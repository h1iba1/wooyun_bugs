{"id": 49440, "wybug_id": "wooyun-2014-078668", "wybug_title": "阿里云邮箱某处问题可导致用户邮件被读取", "wybug_corp": "阿里巴巴", "wybug_author": "mramydnei", "wybug_date": "2014-10-08 21:49", "wybug_open_date": "2014-11-22 21:50", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传内容未检查"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-22：\t细节向公众公开  简要描述： RT 详细说明：  被朋友叫去挖阿里云的XSS，正好无聊就去看了一看。登录后发现，一排的cookie全被加上了httponly flag。\n\n虽然httponly也不是万能的，但是和厂家打交道总有个别厂家会拿这个做挡箭牌。所以想了想，就放弃挖XSS了（不太想弄坏自己的心情）。所以正题是跨域数据劫持，到盗取csrf token，到读取任意邮件。和QQ邮箱的切入点一样，问题还是出在了附件上。我们给自己发送一个邮件，邮件里带上扩展名为png实际上是swf的附件发送给自己，收到邮件后通过预览获取附件的URL：\n\n\nhttps://mail.aliyun.com/attachpreview/aps_key_2722238350_714e89975fd1f472dc7d92e39d4860f2.jpg\n现在回到我们测试跨域数据劫持的页面：\nhttp://x55.me/csrf.htm\nflash地址填上刚才获取的图片（swf）的地址，想获取页面内容的地址就写：\nhttps://mail.aliyun.com/alimail/\n看看能不能偷盗什么有用的？\n\n从上图不难看出通过这种手段我们拿到了原本被保护的“死死的”csrf token。那有了这个token能干什么呢？\n\n我想自动转发应该是最快的途经了。   漏洞证明：  证明如上   修复方案：  暂无   版权声明：转载请注明来源 mramydnei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-10-09 15:13 厂商回复： 感谢您对我们的支持与关注，该问题我们正在修复~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-10 11:47 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  也需要配合其他漏洞吧    \n     2014-11-25 12:07 |    \t\t咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:20        )\t\t \n  学习了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}