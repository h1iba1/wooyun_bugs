{"id": 49299, "wybug_id": "wooyun-2014-074441", "wybug_title": "绿盟RSAS安全系统全版本通杀权限管理员绕过漏洞，包括最新 RSAS V5.0.13.2", "wybug_corp": "绿盟科技", "wybug_author": "路人甲", "wybug_date": "2014-08-30 15:25", "wybug_open_date": "2014-11-28 15:26", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "逻辑错误", "设计不当导致攻击界面扩大"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-28：\t细节向公众公开  简要描述： 绿盟RSAS安全系统全版本通杀权限绕过漏洞，包括最新 RSAS V5.0.13.2 详细说明：  RSAS默认的审计员账号是：reporter，auditor密码是：nsfocus普通账户登陆后查看版本，为最新V5.0.13.2 版本\n\n然后修改审计员密码，抓包，将referer处的auditor和post的数据里面的auditor一律修改为admin，也就是管理员账号，2处修改完后的数据包如下图：\n\n提交数据后，直接返回给我们超级管理员的密码修改页面，利用逻辑错误直接得到超级权限，如图：\n\n我们直接在这里修改admin的密码，然后提交即可：\n\n超级管理员登陆\n\n\n\n   漏洞证明：  见详细说明   修复方案：  自行修复。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-09-02 10:47 厂商回复： 非常感谢您提供的信息。此漏洞为已知漏洞，影响RSAS 5.0.8.13及以前版本，已在RSAS v 5.0.9.0版本中修复，2011-09-22升级包发布。目前通用版RSAS V5最新版本以及RSAS V6均不受此漏洞影响。但部分早期定制版本用户由于兼容性原因，导致无法自动升级相关安全补丁，仍然存在此安全问题，我们已经提供了针对定制版本用户的升级包并已开始联系客户进行紧急升级。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-30 15:32 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  不会是这个吧 http://loudong.360.cn/vul/info/id/15866/#gwt    \n     2014-08-30 15:34 |    \t\t大大灰狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:53        | Newbie)\t\t \n  干的漂亮    \n     2014-08-30 15:54 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  自身难保啊……    \n     2014-08-30 16:29 |    \t\tonlycjeg \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:5        | 我就看看,我不说话.)\t\t \n  前排；    \n     2014-08-30 16:32 |    \t\t残雪 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:7        | 屌丝一枚擅长扯淡)\t\t \n  shit 牛逼    \n     2014-08-30 16:33 |    \t\t10457793 \t\t\t( 普通白帽子  |\t\t\t        Rank:867 漏洞数:128        | 说好的借，为什么从来不还？O(∩_∩)O)\t\t \n  干的漂亮    \n     2014-08-30 16:51 |    \t\talong \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:7        | 关注信息安全，阿龙)\t\t \n  充分印证了那句话：没有100%的安全！    \n     2014-08-30 16:53 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  路过。。。。。。。    \n     2014-08-30 23:43 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  .....    \n     2014-08-31 01:00 |    \t\t0ps \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:10        | xo)\t\t \n  漏扫现在都V6了，5.0还是最新......    \n     2014-09-01 09:38 |    \t\t猪头子 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:35        | 自信的看着队友rm -rf/tar挂服务器)\t\t \n  http://loudong.360.cn/vul/info/id/15866/请不要做搬运工谢谢    \n     2014-09-01 10:56 |    \t\tleelei \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | helloword)\t\t \n  打脸了    \n     2014-09-01 10:58 |    \t\t24‘’ \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 无)\t\t \n  @leelei  。。。。    \n     2014-09-01 12:10 |    \t\tYuTian \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:4        | 兴趣决定一切)\t\t \n  好奇过程    \n     2014-09-01 12:50 |    \t\tbing  \t\t\t( 普通白帽子  |\t\t\t        Rank:332 漏洞数:34        | bingsec)\t\t \n  @10457793 漂亮小分队    \n     2014-09-02 13:58 |    \t\tKevin_Bai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | Kevin教育创始人)\t\t \n  作者是无耻的抄袭者啊！人家在3608月26号就发现了你8月30号才提交？绿盟才与抄袭了吧？为啥28号得到消息后就修复漏洞了还要在这里假装不知道，来确认漏洞。http://loudong.360.cn/vul/info/id/15866    \n     2014-09-02 14:01 |    \t\tKevin_Bai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | Kevin教育创始人)\t\t \n  作者是无耻的抄袭者啊！人家在360库带计划8月26号就发现了，你8月30号才提交？绿盟参与抄袭了吧？为啥28号得到消息后就修复漏洞了还要在这里假装不知道，来乌云确认漏洞而不是忽略漏洞呢？不符合常理啊。参考链接http://loudong.360.cn/vul/info/id/15866    \n     2014-09-02 14:05 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @Kevin_Bai 360库带的那个漏洞详情我看过了，如果是通过一个普通审计账号导致提升管理员权限，那必然是抄袭的    \n     2014-09-02 14:13 |    \t\tKevin_Bai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | Kevin教育创始人)\t\t \n  从库带计划和乌云两面绿盟对漏洞的评价可以看出这个抄袭是绿盟人故意所为，在确认乌云的漏洞后跑去说库带计划的漏洞提交者提交的是已知漏洞了。可是两个漏洞的提交时间那么明显的差了4天啊...大家谁不知道你们想干啥。。。绿盟的做法真的很无耻    \n     2014-09-02 14:26 |    \t\tKevin_Bai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | Kevin教育创始人)\t\t \n  还舔着脸说已知漏洞...RSAS 5.0.8.13就已知干嘛还让漏洞一直存在到5.13.02呢？8月28、29、30连续三天出修复补丁版本呢？2011-09-22就已经知道了为什么到2014年8月才修复呢？三年的时间呀你们就是这么为客户负责的？未知的话还能挽回点面子，已知只能让大家知道你们多么不对客户负责.国税总局怎么也是全国的大客户呀...你们就这样让人家带着漏洞跑了三年...这漏洞扫描器到底是扫别人漏洞呢还是让别人扫自己呢    \n     2014-09-02 14:40 |    \t\t進撃のDanny \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:7        )\t\t \n  @Kevin_Bai 你自己两处提交，这和厂商有什么关系，对你这样的人表示鄙视！！    \n     2014-09-02 21:06 |    \t\tKevin_Bai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | Kevin教育创始人)\t\t \n  @進撃のDanny 要是我自己提交两处就不会在这里骂抄袭的人了，这点已在库带计划得到了证明，乌云管理员也可以来证明    \n     2014-09-02 22:13 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  这个漏洞 还火了？ 是是非非 惹人闹    \n     2014-09-02 22:27 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Kevin_Bai 绿盟干嘛要自打嘴巴多提交一次啊？求解释    \n     2014-09-02 23:30 |    \t\tpolestar \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | Just A Hobby)\t\t \n  没明白在争论什么。我理解是说库带中提交的国税RSAS版本未定制版本，即使漏洞库比较新，但是没打安全补丁，所以这个漏洞为老漏洞。有什么不合适的地方呢？    \n     2014-09-03 09:17 |    \t\t猪头子 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:35        | 自信的看着队友rm -rf/tar挂服务器)\t\t \n  @Kevin_Bai 绿盟为什么要自打脸+1    \n     2014-09-03 09:33 |    \t\t大大灰狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:53        | Newbie)\t\t \n  @Kevin_Bai 绿盟为什么要自打脸+2    \n     2014-09-03 09:39 |    \t\ttang3 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 专业减肥，丰胸)\t\t \n  说的声泪俱下，结果因为没仔细读厂商回复，道德外衣果然是免费穿的    \n     2014-09-03 10:22 |    \t\t進撃のDanny \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:7        )\t\t \n  @Kevin_Bai 可以看这个漏洞的评论http://loudong.360.cn/vul/info/id/15866，不想多什么说了。你一会说白帽子无耻，一会说厂商无耻，到底是想表达什么呢？！    \n     2014-09-03 15:39 |    \t\tKevin_Bai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | Kevin教育创始人)\t\t \n  建议乌云管理员来看看这个抄袭的漏洞，这样的抄袭者还给分啊？丢乌云的脸    \n     2014-09-03 15:55 |    \t\tKevin_Bai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | Kevin教育创始人)\t\t \n  1.8月30日能看到这个楼顶详情的能有谁呢？无外乎360的人、绿盟、作者2.9月2日绿盟在已经看到库带计划提交此漏洞的情况下为什么还要给在乌云提交并抄袭的人“确认”并且评15Rank而不是忽略？综合两点想想不是绿盟的管理员自己提交给自己赚积分还能是谁？360的人或者作者本人来提交都会被绿盟的人直接把漏洞忽略的，忽略才是看到重复提交的漏洞的正常反应。    \n     2014-09-03 16:07 |    \t\t進撃のDanny \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:7        )\t\t \n  @Kevin_Bai 绿盟为什么要自打脸+3    \n     2014-09-03 16:25 |    \t\tKevin_Bai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | Kevin教育创始人)\t\t \n  不是绿盟自己的人做的为什么不忽略此漏洞？    \n     2014-09-04 10:56 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  别人确认和是不是绿盟自己人做的，有什么关系吗，不忽略只是对白帽子本身的尊重罢了，不扯了我就路过。大家继续    \n     2014-09-04 12:04 |    \t\tKevin_Bai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | Kevin教育创始人)\t\t \n  尊重抄袭者？哈哈说得好    \n     2014-11-28 17:17 |    \t\tDefa \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:13        | <img src=1 onerror=alert(1)>)\t\t \n  万能的路人甲    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}