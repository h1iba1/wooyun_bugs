{"id": 44975, "wybug_id": "wooyun-2015-090324", "wybug_title": "ESPCMS所有版本任意用户登陆", "wybug_corp": "易思ESPCMS企业网站管理系统", "wybug_author": "夕风号", "wybug_date": "2015-01-06 18:21", "wybug_open_date": "2015-04-06 18:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-06：\t细节向公众公开  简要描述： ESPCMS所有版本任意用户登陆 详细说明：  /interface/memebermain.php\n$rsMember['userid'] = $this->ec_member_username_id;$rsMember['rankname'] = $this->get_member_purview($rsMember['mcid'], 'rankname');$userid = intval($rsMember['userid']);\n跟进ec_member_username_id/public/class_connector.php\n$user_info = explode('|', $this->fun->eccode($this->fun->accept('ecisp_member_info', 'C'), 'DECODE', db_pscode));     //取自$_COOKIE['ecisp_member_info']                list($ec_member_username_id, $this->ec_member_alias, $ec_member_integral, $ec_member_mcid, $this->ec_member_email, $this->ec_member_lastip, $this->ec_member_ipadd, $this->ec_member_useragent, $this->ec_member_adminclassurl) = $user_info;                $this->ec_member_username_id = intval($ec_member_username_id);\n综上所述，$userid值完全可控，以http://demo.ecisp.cn为例，利用过程如下：1.注册，http://demo.ecisp.cn/index.php?ac=member&at=reg假设我们要登陆$userid=3的用户，则用户名为3test\n\n2.登陆后，查看cookie，得到\necisp_member_username=C50S%2BB7auih2gDPIqEsfCZAX5nybIUZ%2FgbPTQp%2F6gm0%3D\n3.将cookie中的ecisp_member_info值更改为上述ecisp_member_username值，得，\necisp_member_info=C50S%2BB7auih2gDPIqEsfCZAX5nybIUZ%2FgbPTQp%2F6gm0%3D\n此时，经过解密处理，可得$userid=$this->ec_member_username_id=intval('3test')=34.再次刷新，http://demo.ecisp.cn/index.php?ac=membermain&at=center\n\n   漏洞证明：  略   修复方案：  改用session   版权声明：转载请注明来源 夕风号@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-01-07 11:43 厂商回复： 感谢您的提交，我们会尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-06 18:31 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  不用看我就知道了。    \n     2015-01-06 18:47 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @roker  666    \n     2015-01-06 18:52 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  @′雨。 777    \n     2015-01-06 20:46 |    \t\tMxx \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 没有)\t\t \n  目测会火。    \n     2015-01-07 14:11 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  怎么没在通用那里？    \n     2015-01-10 21:43 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  啥情况    \n     2015-01-12 12:49 |    \t\tneal \t\t\t( 普通白帽子  |\t\t\t        Rank:219 漏洞数:23        )\t\t \n  提交这个 一般都是 匿名 因为大家都知道 他的算法有问题 一直没改    \n     2015-01-27 12:40 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @roker 这个不错哦。:)    \n     2015-01-27 12:55 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  @′雨。 啪啪啪    \n     2015-04-06 18:45 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  @neal 这个其实很吊，并不是算法问题。不知道谁交的。    \n     2015-04-08 16:38 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:11        | 我是一颗小小树)\t\t \n  @phith0n  算是逻辑漏洞吗，intval函数必须得小心使用啊    \n     2015-06-08 13:21 |    \t\tanswer \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:45        | 答案)\t\t \n  真的吊    \n     2015-07-18 18:44 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:64        )\t\t \n  又是intval的坑    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}