{"id": 63232, "wybug_id": "wooyun-2013-032574", "wybug_title": "上海好孩子网上商城支付漏洞", "wybug_corp": "mamabb.com", "wybug_author": "mango", "wybug_date": "2013-07-29 17:41", "wybug_open_date": "2013-09-12 17:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "支付行业敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-12：\t细节向公众公开  简要描述： 最近两年奶粉超贵的。。@钱途 不知道你家女儿断奶没有,断奶了我给你寄儿童玩具或者儿童床。。 详细说明：  开始吧,进入官方商城进行购买随便买几个东西吧,恩。。就找奶粉吧http://cat.mamabb.com/\n\n我擦最贵的486  还真是贵。。我们多选几个吧不然等会不好加减、买多一点送@钱途、、我们先买478点击加入购物车抓包改包如图改为负数\n\n\n\n - -因为刚刚奶粉被抵消了、、这样的金额太小了不好找比他小2倍商品 我们换一个金额大一些的,买个床送给@钱途吧\n\n1000多块。。。\n\n\n\n\n\n\n\n我想只要支付就能买吧。。。嘿嘿。。   漏洞证明：  \n\n我是来求礼物的   修复方案：   - -专业术语么。。1.像金额这样的信息不要放在页面上，确实有随时被篡改的风险，这些信息本来就在数据库中，可以定义一个字符型的字段代替金额的传输，或者直接由商品唯一标识来查询数据库得到金额；2.签名校验是最重要的了，将购买的商品、数量、金额（或替代字段）、订单的ID号生成一个校验字符串。在每次数据传输的过程中进行校验，当然这个校验的内容可以多次生成；3.银行或者第三方支付平台的支付接口都会检验商户的订单数据签名，这里当支付页面跳转到块钱的时候没有做签名校验，导致金额数据被篡改，请进一步确认接口问题；4.支付前需要做签名校验，支付之后同样需要再次做校验，按理说所有银行应该在支付完成之后返回一些信息（如支付金额等）给商户，这样可以通过回来的信息判断是否全额支付；5.还有什么比SSL更可靠的呢！    版权声明：转载请注明来源 mango@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-07-30 09:54 厂商回复： 感谢mango反馈，除了页面加强用户输入验证外，服务端也必须再进行验证。关键信息还是要存在服务端。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-29 19:00 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @M4sk  秒了    \n     2013-07-29 19:00 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  @mango 尼玛     \n     2013-07-29 19:01 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @M4sk 你怎么迷上QQ    \n     2013-07-29 19:02 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  @mango 下午有事 你懂得了~  尼玛 又是支付漏洞......刚刚上QQ  还没切换状态    \n     2013-07-30 09:56 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @上海好孩子儿童用品有限公司  求礼物    \n     2013-08-29 10:57 |    \t\t黄小昏 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:7        | alert（妹子）)\t\t \n  @mango 有震动床吗？    \n     2013-10-21 11:31 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @钱途    \n     2013-10-21 22:34 |    \t\t钱途 \t\t\t( 普通白帽子  |\t\t\t        Rank:273 漏洞数:44        )\t\t \n  @mango 你妹的，我才看到。回头买进口的！    \n     2013-10-21 22:55 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @钱途 叫你女儿和你一起感谢我    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}