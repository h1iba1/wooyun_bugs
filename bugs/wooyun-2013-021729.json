{"id": 12585, "wybug_id": "wooyun-2013-021729", "wybug_title": "新浪微博某功能控制不严可导致蠕虫", "wybug_corp": "新浪", "wybug_author": "se55i0n", "wybug_date": "2013-04-13 09:28", "wybug_open_date": "2013-05-28 09:29", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["应用配置错误", "利用技巧", "绕过", "类型应用", "漏洞利用", "敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-28：\t细节向公众公开  简要描述： 新浪微博某功能控制不严可导致蠕虫 详细说明：  1）存在问题的功能在：lady.weibo.com的评论处；\n\n2）点击发布并抓包，得到如下数据；\nPOST /cmnt/submit HTTP/1.1Host: comment5.news.sina.com.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:20.0) Gecko/20100101 Firefox/20.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://slide.eladies.sina.com.cn/fa/slide_3_41261_19668.htmlCookie: Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 292channel=shuo&newsid=slidenews-41261-277122&parent=B&content=very+nice&format=js&ispost=1&share_url=http%3A%2F%2Fslide.eladies.sina.com.cn%2Ffa%2Fslide_3_41261_19668.html%3Fimg%3D277122&video_url=&img_url=http%3A%2F%2Fwww.sinaimg.cn%2Fdy%2Fslidenews%2F3_img%2F2013_15%2F41261_277122_505214.jpg\n3）系统校验了referer，但是发现居然可以直接发送GET请求；\nhttp://comment5.news.sina.com.cn/cmnt/submit?channel=shuo&newsid=slidenews-41261-277122&parent=B&content=very+nice&format=js&ispost=1&share_url=http%3A%2F%2Fslide.eladies.sina.com.cn%2Ffa%2Fslide_3_41261_19668.html%3Fimg%3D277122&video_url=&img_url=http%3A%2F%2Fwww.sinaimg.cn%2Fdy%2Fslidenews%2F3_img%2F2013_15%2F41261_277122_505214.jpg\n4）提交效果见下图；\n\n5）在weibo发布上面的url请求，发现系统对GET请求也校验了referer；\n\n6）但是我们可以将url发布在如下场景；\n\n7）效果如下图，另外“share_url”和“image_url”参数貌似能够自己定义....\n\n   漏洞证明：  见详细说明   修复方案：     版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-04-13 12:24 厂商回复： 感谢关注新浪安全，已经安排人员进行修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-13 09:49 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。。霸气，恭喜你获得新浪大礼包一份    \n     2013-04-13 10:03 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-04-13 14:19 |    \t\tPwfee \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | iTeam团队)\t\t \n  新浪大礼包一份？    \n     2013-04-14 14:55 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:172        )\t\t \n  @px1624 大个毛线的礼包呀，你收到新浪的礼物了？    \n     2013-04-14 17:00 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @se55i0n ...我随便说说而已，你还真当真了，哈哈~~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}