{"id": 22074, "wybug_id": "wooyun-2011-03023", "wybug_title": "中国铁通江苏分公司xss及SQL注入,WebDAV的远程执行代码，后台暴露", "wybug_corp": "中国移动", "wybug_author": "zeracker", "wybug_date": "2011-10-17 23:35", "wybug_open_date": "2011-10-22 23:36", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射", "逻辑错误", "后台管理地址对外", "解析文件漏洞", "写权限漏洞利用", "配置", "后台地址被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-10-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-10-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 1.恶意用户可能会注入易受攻击的应用程序来欺骗用户，以收集数据，从他们的JavaScript，VBScript中的ActiveX，HTML或Flash。攻击者可以窃取会话cookie和接管帐户，模拟用户。它也可以修改的内容呈现给用户的页面。2.后台地址泄露，通过提交试探信息，返回错误提示。3.在此服务器上启用了WebDAV是和这个目录有写权限启用。 Acunetix WVS是能够创建一个测试文件，在此使用PUT方法的目录。 PUT方法是远程内容编辑WebDAV标准的一部分。一个配置不当的Web服务器可能会错误地提供远程访问PUT方法，无需任何形式的登录。更有什者，扫描仪，能够重命名此文件，以filename.asp; JPG，然后在Web服务器的情况下执行代码。此漏洞影响/admin恶意用户可以在这个系统上执行任意代码。可能危及系统的安全。攻击的详细信息ASP壳http://www.cttjs.com/admin/acu_test_5Itlt.asp; JPG。扫描器会尝试删除这个文件，但它可能没有足够的权限这样做。4.攻击者可能易受攻击的系统上执行任意SQL语句。这可能会危及完整的数据库和/或暴露敏感信息。根据所使用的后端数据库，SQL注入漏洞导致不同的数据/系统访问攻击者的水平。它可能不仅操纵现有的查询，但在任意数据的UNION，使用子查询，或追加额外的查询。在某些情况下，它可能会读取或写入到文件，或底层的操作系统上执行shell命令。某些SQL服务器，如微软SQL Server包含存储和扩展程序（数据库服务器功能）。如果攻击者能够获得访问这些程序可能会危及整个机器。 详细说明：  1.恶意用户可能会注入易受攻击的应用程序来欺骗用户，以收集数据，从他们的JavaScript，VBScript中的ActiveX，HTML或Flash。攻击者可以窃取会话cookie和接管帐户，模拟用户。它也可以修改的内容呈现给用户的页面。2.后台地址泄露，通过提交试探信息，返回错误提示。3.在此服务器上启用了WebDAV是和这个目录有写权限启用。 Acunetix WVS是能够创建一个测试文件，在此使用PUT方法的目录。 PUT方法是远程内容编辑WebDAV标准的一部分。一个配置不当的Web服务器可能会错误地提供远程访问PUT方法，无需任何形式的登录。更有什者，扫描仪，能够重命名此文件，以filename.asp; JPG，然后在Web服务器的情况下执行代码。此漏洞影响/admin恶意用户可以在这个系统上执行任意代码。可能危及系统的安全。攻击的详细信息ASP壳http://www.cttjs.com/admin/acu_test_5Itlt.asp; JPG。扫描器会尝试删除这个文件，但它可能没有足够的权限这样做。4.攻击者可能易受攻击的系统上执行任意SQL语句。这可能会危及完整的数据库和/或暴露敏感信息。根据所使用的后端数据库，SQL注入漏洞导致不同的数据/系统访问攻击者的水平。它可能不仅操纵现有的查询，但在任意数据的UNION，使用子查询，或追加额外的查询。在某些情况下，它可能会读取或写入到文件，或底层的操作系统上执行shell命令。某些SQL服务器，如微软SQL Server包含存储和扩展程序（数据库服务器功能）。如果攻击者能够获得访问这些程序可能会危及整个机器。   漏洞证明：  \n\n\n\n\n\n不一一列举了。。   修复方案：  1.从这个目录的写权限删除或禁用WebDAV如果它没有被使用。 2.你的脚本应该过滤用户输入的元字符。3.加入验证码机制，隐藏后台地址，修改提示信息。..............................你懂的   版权声明：转载请注明来源 zeracker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：7 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-10-18 10:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个简述好详细    \n     2011-10-23 09:52 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  写这么详细，等于碰到网络问题提交失败你就悲剧了    \n     2011-10-23 14:23 |    \t\t小鱼儿 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | Know It Then Hack It)\t\t \n  国企永远都是这么的NB。。。这么的不屑一顾啊。    \n     2011-10-23 14:24 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  希望和cert的合作能改变一些东西    \n     2011-10-23 14:49 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  该做的已经做了，不可能XXOO了，等着跨省吧？    \n     2011-10-23 14:51 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个事情上我顶你    \n     2012-02-08 13:26 |    \t\tsw0rder \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:5        | /*菜菜*/)\t\t \n  翻译出来的吧哈哈    \n     2012-02-23 16:28 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  最银剑的就是补了，以后忽略，BS！    \n     2012-02-25 13:52 |    \t\tpfdz \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:13        | Stay hungry. Stay foolish.)\t\t \n  @sw0rder 好像真的是翻译出来的。。    \n     2012-02-29 11:35 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  很明显是生成的报告，非手写。    \n     2012-03-10 21:00 |    \t\tXeyes \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 好好学习，天天休息。)\t\t \n  IBM APPSCAN 生成?    \n     2012-03-12 10:57 |    \t\tShady \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:8        | Test)\t\t \n  明显是wvs扫描的，（攻击的详细信息ASP壳http://www.cttjs.com/admin/acu_test_5Itlt.asp; JPG。扫描器会尝试删除这个文件，但它可能没有足够的权限这样做。）楼主搞错了吧，这个是wvs测试webdav的页面 这个目录可以写的 iiswrite工具put一个txt,直接更改格式就成功了，nc也可以的。别把扫描的报告gg翻译啊，蛋疼~~    \n     2012-03-12 11:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Shady ....... 学习了    \n     2012-04-19 02:39 |    \t\ttestcvc \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | test)\t\t \n  ASP壳……应该是在线翻译的 asp shell目测为WVS扫描生成结果    \n     2012-04-19 17:47 |    \t\tpfdz \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:13        | Stay hungry. Stay foolish.)\t\t \n  @testcvc 肯定是的了。。看“3.在此服务器上启用了WebDAV是和这个目录有写权限启用。 Acunetix WVS”    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 7, "Ranks": null}