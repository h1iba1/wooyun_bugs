{"id": 10679, "wybug_id": "wooyun-2013-034392", "wybug_title": "三国杀某分站后台弱口令+SQL注入漏洞", "wybug_corp": "边锋网络", "wybug_author": "猪猪侠", "wybug_date": "2013-08-14 23:46", "wybug_open_date": "2013-08-15 10:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-15：\t厂商提前公开漏洞，细节向公众公开  简要描述： 三国杀某分站后台地址可猜测，且管理员密码弱口令同时存在UPDATE类型SQL注入漏洞，而且GPC为off，可结合into outfile写文件获取WEBSHELL 详细说明：  # 管理入口http://cos.sanguosha.com/admin/index.php# admin 密码 123456\n\n# SQL 注入漏洞，虽然整站有WAF过滤规则，但只是简单的处理了GET请求的参数，POST数据并未处理\n\n   漏洞证明：  # update 类型注入，而且GPC为off，可以into out file 写文件拿shell\nupdate `v_system` set content='a:46:{s:2:\"xm\";s:6:\"名称\";s:4:\"xm_s\";s:1:\"1\";s:2:\"xb\";s:6:\"性别\";s:4:\"xb_s\";s:1:\"1\";s:2:\"nl\";s:6:\"年龄\";s:2:\"jg\";s:6:\"籍贯\";s:2:\"dw\";s:12:\"工作单位\";s:2:\"bm\";s:6:\"部门\";s:2:\"zw\";s:6:\"职位\";s:2:\"dh\";s:6:\"电话\";s:2:\"sg\";s:6:\"身高\";s:2:\"tz\";s:6:\"体重\";s:2:\"ah\";s:12:\"兴趣爱好\";s:4:\"ah_s\";s:1:\"1\";s:2:\"tc\";s:6:\"特长\";s:2:\"xy\";s:12:\"个性宣言\";s:4:\"xy_s\";s:1:\"1\";s:2:\"mc\";s:6:\"排名\";s:4:\"mc_s\";s:1:\"1\";s:2:\"rq\";s:6:\"人气\";s:4:\"rq_s\";s:1:\"1\";s:2:\"m1\";s:6:\"赛区\";s:4:\"m1_s\";s:1:\"1\";s:2:\"m2\";s:12:\"COS武将名\";s:4:\"m2_s\";s:1:\"1\";s:2:\"m3\";s:0:\"\";s:2:\"m4\";s:0:\"\";s:2:\"m5\";s:0:\"\";s:2:\"m6\";s:0:\"\";s:2:\"m7\";s:0:\"\";s:2:\"m8\";s:0:\"\";s:2:\"m9\";s:0:\"\";s:3:\"m10\";s:0:\"\";s:3:\"m12\";s:0:\"\";s:3:\"m13\";s:0:\"\";s:3:\"m14\";s:0:\"\";s:3:\"m15\";s:0:\"\";s:5:\"zszpy\";s:0:\"\";s:5:\"intro\";s:12:\"个人信息\";s:7:\"intro_s\";s:1:\"1\";s:3:\"hgd\";s:4:\"638'\";s:3:\"hwd\";s:3:\"427\";s:7:\"show_kd\";s:3:\"123\";s:7:\"show_hd\";s:3:\"185\";s:8:\"show_num\";s:2:\"10\";s:6:\"cgroup\";s:1:\"1\";}' where id=2You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'hwd\";s:3:\"427\";s:7:\"show_kd\";s:3:\"123\";s:7:\"show_hd\";s:3:\"185\";s:8:\"show_num\";s:' at line 1\n   修复方案：  # 管理入口更名或加IP限制# 登录接口加入验证码或重复次数暴力猜解限制# 来自客户端的POST类型数据顺便检测过滤   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-08-15 10:14 厂商回复： 感谢对三国杀及边锋集团的支持~此业务我们将做下线处理。 最新状态： 2013-08-15：洞主给我个联系方式吧~小礼物奉上~欢迎组队刷三国杀 浩方以及边锋集团业务  ", "replys": "漏洞评价：\n评论\n     2013-08-14 23:57 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  mark    \n     2013-08-15 09:13 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  吊~    \n     2013-08-15 09:49 |    \t\tj0ck \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:5        | hello~)\t\t \n  马    \n     2013-08-15 15:28 |    \t\tM0nster \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:17        | 允许我国的艺术家先富起来)\t\t \n  卧槽神速公开    \n     2013-08-15 17:51 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  组队刷有礼物么    \n     2013-08-16 11:29 |    \t\t边锋网络(乌云厂商)\t\t \n  @M0nster 本着对洞主的尊重和快速处理的态度！我们决定快速公开    \n     2013-08-16 20:04 |    \t\tM0nster \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:17        | 允许我国的艺术家先富起来)\t\t \n  @边锋网络 中国好厂商    \n     2013-11-12 16:20 |    \t\t未来还没来 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:5        | 每个人都期望成为主角，却不知道世界上从来...)\t\t \n  膜拜。偶像    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}