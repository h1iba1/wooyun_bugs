{"id": 5563, "wybug_id": "wooyun-2014-049577", "wybug_title": "重访百度旅游之存储型XSS漏洞", "wybug_corp": "百度", "wybug_author": "do9gy", "wybug_date": "2014-01-22 18:50", "wybug_open_date": "2014-03-08 18:51", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-08：\t细节向公众公开  简要描述： 之前百度旅游刚上线的时候发现过一个存储型xss,当时还因为这个把我帐号列为危险帐号不允许回帖了.不过最近又发现了一个 :) 详细说明：  这个xss位于个人中心,设置,更换背景.更换背景时抓了一下包发现提交了两个参数,第一个是pic,也就是图片的链接,第二个是token值应该是和防止csrf之类相关的吧.pic=http%3A%2F%2Fhiphotos.baidu.com%2Flvpics%2Fpic%2Fitem%2Fb7fd5266d0160924bc88527dd60735fae6cd3422.jpg&bdstoken=73c32f6354ca3fdf81297a3de51c07c9好奇心比较强,试了一下发现可以任意修改空间背景.只要将图片的url替换即可.但是还不满足,继续试探一下,发现图片链接在页面中的位置位于<section id=\"body\" class=\"user-background\" style=\"background-image: url([here])\">中括号内.这里一开始想直接提交)\"><script>alert(1)</script> <(\" 闭合一下即可,不过服务器对双引号和尖括号进行了转意.这里就比较鸡肋了.于是尝试提交:http://www.baidu.com/img/bdlogo.gif); xss:expression(alert(1)); a:(发现已经完全嵌入了,鸡肋的是这样就只有低版本的IE浏览器才能触发了.   漏洞证明：  \n\n   修复方案：  修改图片的时候只需要传递1-9几个数字,然后服务器端绑定数字对应的图片url即可.   版权声明：转载请注明来源 do9gy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2014-01-22 19:38 厂商回复： 感谢提交，低版本IE已经近于淘汰，影响范围较小。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-22 19:16 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  火钳留名    \n     2014-01-22 20:20 |    \t\tdo9gy \t\t\t( 实习白帽子  |\t\t\t        Rank:61 漏洞数:15        | Dog loves God。)\t\t \n  不得不佩服百度的响应速度.    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}