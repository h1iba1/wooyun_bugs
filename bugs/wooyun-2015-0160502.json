{"id": 78395, "wybug_id": "wooyun-2015-0160502", "wybug_title": "山西省某市人事考试中心网SQL注入数万公务员个人敏感信息泄露", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "山西开源聚合科技", "wybug_date": "2015-12-17 01:04", "wybug_open_date": "2016-02-01 18:25", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["基于时间的盲注"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向公众公开  简要描述： 一个注入引发的血案 详细说明：  首先，用nmap扫描端口，发现3306,3389端口开放扫描目录，发现后台登录地址。http://**.**.**.**/index.php?m=xdcms&c=login暴力破解没有破解，然后用burpsuite，发现sql注入。\nPOST /index.php?m=xdcms&c=login&f=check HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://**.**.**.**/index.php?m=xdcms&c=loginCookie: PHPSESSID=fqsns6dhfmvtln1sahoqeb2822Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 53username=admin&password=admin&verifycode=27f4&button=\nusername存在注入。\n\n虽说不是dba，但是可以获得os-shell权限。\n\n然后添加用户admin，密码：A123！@#。提权为administrator。然后通过3389端口，远程连接登录，登录成功\n\n发现数据库，没有用户名密码。\n\n有大量敏感信息的表\n\n打开其中一个表，并且计算其中的数据，发现有数万公务员信息。包括姓名，身份证号等\n\n\n\n   漏洞证明：  首先，用nmap扫描端口，发现3306,3389端口开放扫描目录，发现后台登录地址。http://**.**.**.**/index.php?m=xdcms&c=login暴力破解没有破解，然后用burpsuite，发现sql注入。\nPOST /index.php?m=xdcms&c=login&f=check HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://**.**.**.**/index.php?m=xdcms&c=loginCookie: PHPSESSID=fqsns6dhfmvtln1sahoqeb2822Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 53username=admin&password=admin&verifycode=27f4&button=\nusername存在注入。\n\n虽说不是dba，但是可以获得os-shell权限。\n\n然后添加用户admin，密码：A123！@#。提权为administrator。然后通过3389端口，远程连接登录，登录成功\n\n发现数据库，没有用户名密码。\n\n有大量敏感信息的表\n\n打开其中一个表，并且计算其中的数据，发现有数万公务员信息。包括姓名，身份证号等\n\n\n\n   修复方案：  你懂得   版权声明：转载请注明来源 山西开源聚合科技@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-12-21 16:02 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给山西分中心，由山西分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}