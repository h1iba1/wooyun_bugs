{"id": 66992, "wybug_id": "wooyun-2015-0144844", "wybug_title": "糖果网逻辑漏洞（泄露所有用户家庭地址等信息、冒充用户，盗取所有用户余额）", "wybug_corp": "糖果网", "wybug_author": "云袭2001", "wybug_date": "2015-10-05 09:30", "wybug_open_date": "2015-11-19 09:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-11-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 很严重，就看用户数量了 详细说明：  www.tangguow.cn漏洞1：泄露所有用户家庭地址等信息：进入购物车：\n\n在第一步,单击结算进入第二步时抓包：\n\n更改userid,爆出其他用户的信息:\n\n\n\nOk 那么拿burp跑一下：\n\n地址全出来了。随便一跑的结果：\n\n空地址的数据包长度为14484，上述数据包均包含用户信息漏洞2：冒充用户，盗取所有用户余额如果在这一系列二购买过程中替换userid，将在最后一页看到这个：\n\nOk 用户没有余额，那么要是有余额呢？进入财务中心：进行交易记录查询并且抓包\n\n然后同样替换userid,并且跑包：\n\n长度为11743的是没钱的，那么这些用户呢：\n\n11746代表1000元\n\nOk那么现在得到有余额用户的id了，那就让他们替我们付款吧：在提交订单出抓包：用户改为117\n\n这时会重定GET请求：两个包的id必须一样\n\n好了地址信息是我的，然而钱别人付：\n\n提示没有支付密码，还是同样的思路之后所有的包都使用userid=117设置好密码之后\n\n纠结到底最后会不会付款成功：还是干了\n\nOk了，我觉得可以到此为止了，剩下的漏洞你们自己发掘，问题很多   漏洞证明：  同上   修复方案：  能给个20rank吗 影响确实很严重   版权声明：转载请注明来源 云袭2001@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}