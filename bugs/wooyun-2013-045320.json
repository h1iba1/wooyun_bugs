{"id": 59989, "wybug_id": "wooyun-2013-045320", "wybug_title": "开心网某处oauth认证缺陷可劫持帐号token", "wybug_corp": "kaixin001.com", "wybug_author": "超威蓝猫", "wybug_date": "2013-12-09 11:14", "wybug_open_date": "2014-01-23 11:15", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-23：\t细节向公众公开  简要描述： 开心网某处oauth认证缺陷可劫持帐号token 详细说明：  这是开心网授权优酷登录的链接:\nhttp://www.kaixin001.com/login/connect_login.php?appkey=2811954408540d263d3e2d49c54c2a1f&url=http%3A%2F%2Fapi.kaixin001.com%2Foauth2%2Fauthorize%3Fclient_id%3D2811954408540d263d3e2d49c54c2a1f%26response_type%3Dcode%26scope%3Dbasic+create_repaste%26state%3D54285e9d47c41d294eb12615d2be1344%26redirect_uri%3Dhttp%253A%252F%252Fwww.youku.com%252Fpartner_kaixinLoginCallback_wintype_null_operateStfrom_null%26tmp%3D1\n其中，redirect_uri参数没有进行有效性校验，可以指向一个恶意构造的页面来劫持用户的token。   漏洞证明：  这里以跳转到乌云首页为例:\n\n登录后:\n\n点击连接:\n\n   修复方案：  检查redirect_uri参数的有效性。   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-09 14:36 厂商回复： 非常感谢，已经对redirect_uri增加验证 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}