{"id": 19371, "wybug_id": "wooyun-2012-07194", "wybug_title": "139邮箱存储型XSS漏洞(上次不小心触发之后，邮件删了，没能复现，终于复现了……)", "wybug_corp": "中国移动", "wybug_author": "一刀终情", "wybug_date": "2012-05-16 16:12", "wybug_open_date": "2012-06-30 16:13", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-06-30：\t细节向公众公开  简要描述： 139邮箱存储型XSS漏洞(上次不小心触发之后，邮件删了，没能复现，终于复现了……)http://www.wooyun.org/bugs/wooyun-2012-06155还是smtp协议可以伪造发件人姓名的问题，复现过程见详细内容~ 详细说明：  弄半天发现，要成功触发，必须要姓名、地址都插入xss代码，单独插任何一个都不能触发。。。伪造发信人姓名、地址，最简单的操作就是用邮件客户端，这里用的foxmail\n\nemail地址：aa@bb.com<iframe oNmouseenter=\"alert('address')\"><发信人姓名：aaa<iframe oNmouseenter=\"alert('name')\"><用的鼠标滑过的事件，发信后，弹出name;姓名处的xss被触发。P.S oNmouseenter事件，chrome好像不支持？IE可以执行。上次的测试邮件，确实同时触发了网易的邮箱，不过是内容中，不是本例中邮件列表界面，后来应该是修过了~   漏洞证明：  \n\n\n\n   修复方案：  原因不明，反正是没过滤   版权声明：转载请注明来源 一刀终情@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-05-21 09:22 厂商回复： CNVD确认漏洞并复现所述情况，转由CNCERT协调中国移动通信集团公司处置。对漏洞评分如下：CVSS：(AV:R/AC:L/Au:NR/C:P/A:N/I:P/B:N) score:6.42（最高10分，中危）即：远程攻击、攻击难度低、不需要用户认证，对机密性、完整性造成部分影响（可能涉及信息窃取、网页跳转、挂马侵害等，反射型跨站应用到邮件系统成为存储型跨站）。技术难度系数：1.0影响危害系数：1.3（较严重，涉及电信行业日常业务系统）CNVD综合评分：6.42*1.0*1.3=8.346possible同学也加入到监督安全生产的行列中了。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-16 17:11 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  呵呵，又见你，不过那块弄弄还是有重大发现的....只是触发有点快，基本点击收件箱就能跨，另外请教个问题，url自动跳转如何获取cookie？网上说的回旋镖方法貌似不行啊    \n     2012-05-16 17:16 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @wanglaojiu 触发快是好事啊~我是个菜鸟哇，URL跳转，你跳到目标地址，目标地址的程序获取cookie    \n     2012-05-16 17:21 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  @一刀终情 找了一些302跳转，可是获取不了cookie，只能用来自娱，纠结....你的那个漏洞点能使用的箱子种类还是有些的，关键点是看邮箱服务器过滤机制和代码风格，仔细模仿下就笑了。    \n     2012-05-21 10:14 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  \"possible同学也加入到监督安全生产的行列中了。\"这是被招安了么？    \n     2012-05-21 10:28 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @一刀终情 @cncert国家互联网应急中心 额 这个是厂商写错了吧 我还没有被招安的能力呀我没有加入到什么行列，纯属娱乐，碰到了就看看，也没有时间去找 呵呵 希望有一天出一个小程序，\"完全自动化办公\"，想找啥漏洞，点一个按钮就可以，希望和期待进一步目测，厂商偷懒 各种ctrl+c ctrl+v的结果...    \n     2012-05-21 10:38 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @possible 好像是厂商偷懒……    \n     2012-05-21 13:48 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  如何向google提交漏洞？    \n     2012-05-21 13:59 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @wanglaojiu 我擦，几千$~问@xsser看看    \n     2012-05-21 14:06 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  @一刀终情 只是随意问问。    \n     2012-05-21 22:54 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @wanglaojiu EMAIL    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}