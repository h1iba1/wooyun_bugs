{"id": 45291, "wybug_id": "wooyun-2015-096611", "wybug_title": "酷狗PC客户端远程JS代码注入漏洞(影响全国酷狗用户可挂马)", "wybug_corp": "酷狗", "wybug_author": "数据流", "wybug_date": "2015-02-10 12:47", "wybug_open_date": "2015-03-27 12:48", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-27：\t细节向公众公开  简要描述： @伏宸安全 详细说明：  主要是利用了三个漏洞完成的1 酷狗电台后台xss漏洞2 酷狗电台个人后台越权漏洞3 酷狗电台主页储存型xss漏洞一:http://www.kugou.com/fm2/app/musicshow/admin/njadmin/index.php酷狗电台个人后台,可用酷狗用户注册登陆,申请.\n\n插入xss代码,提交申请审核.第二天收到了后台的cookie\n\n在酷狗客户端有电台栏目,使用spy查看是调用了IE控件\n\n二:进入后台,找到自己申请的资料,然后通过审核\n\n这样就能成功得到一个酷狗电台\n\n自己创建一个插入xss的电台节目提交,然后通过xss得到的后台通过审核.然后通过burp得到源网页地址 在酷狗设置代理\n\n\n\n经过排查得到源网页为:http://www2.kugou.com/fm2/app/musicshow2/nj/index/njid=xxx发现在这网页上对输出有转义,一番测试,发现电台名称输出没有转义 在个人电台后台提交电台名称为\"<svg/onload=alert(1)> 闭合 提交后 在后台自己通过审核 \n\n\n\n源网页成功弹了,在客户端通过查找自己的电台也弹了\n\n现在要通过用户查找才能使客户端执行js而观察酷狗电台的首页\n\n利用个人后台的越权漏洞 \n\nzpid参数没有认证,在后台得到节目编号后可通过个人后台修改别人节目的资料,这里修改的是酷狗官方电台的资料 提交后也需要审核 直接到获得权限的后台通过即可. 这样用户一打开酷狗里面的电台就会中招.而酷狗是调用ie 也可使用ie的挂马漏洞进行攻击.\n\n也可插入获取cookie,直接用户的权限.这里就没去测试 危害太大   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 数据流@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-02-10 18:22 厂商回复： 谢谢提交! 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-10 12:49 |    \t\t白泽 \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:9        | @伏宸安全 树叶的一生只是为了归根)\t\t \n  你想想看，你听着歌儿，看着刚买来的电脑和家人对着酷狗选歌，旁边是你心爱的wifi，后面是你的children。突然屏幕上光标自己动起来了，你的电脑自动帮你选歌，你以为它要变成人工智能系统，其实是被挂马了，what the fuck。QQ就这样被盗了，失去了年轻的QQ。他们的程序员是……羊驼吗？    \n     2015-02-10 12:50 |    \t\t白泽 \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:9        | @伏宸安全 树叶的一生只是为了归根)\t\t \n  数据流顶你个肺    \n     2015-02-10 13:19 |    \t\t木马游民 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:8        | I love LSD!)\t\t \n  啊，买了个表，买了个表     \n     2015-02-10 14:02 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  你想想看，你听着歌儿，看着刚买来的电脑和家人对着酷狗选歌，旁边是你心爱的wifi，后面是你的children。突然屏幕上光标自己动起来了，你的电脑自动帮你选歌，你以为它要变成人工智能系统，其实是被挂马了，what the fuck。QQ就这样被盗了，失去了年轻的QQ。他们的程序员是……羊驼吗？    \n     2015-02-10 16:11 |    \t\tPSoul \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:5        )\t\t \n  牛逼    \n     2015-02-10 16:23 |    \t\tADO \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:8        | Script)\t\t \n  @白泽 你这文案能力好强，太逗了    \n     2015-02-10 16:29 |    \t\t安子 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 啪啪啪啪啪啪我是卖套的小行家)\t\t \n  你想想看，你听着歌儿，看着刚买来的电脑和家人对着酷狗选歌，旁边是你心爱的wifi，后面是你的children。突然屏幕上光标自己动起来了，你的电脑自动帮你选歌，你以为它要变成人工智能系统，其实是被挂马了，what the fuck。QQ就这样被盗了，失去了年轻的QQ。他们的程序员是……羊驼吗？    \n     2015-02-10 17:21 |    \t\t刘洪泽 \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:35        | 一个到处找密码的小号..........)\t\t \n  最近在忙什么呢？最近在帮酷狗公司报告那批有问题的嘛，他们家的客户端不过关就拿去发布了。卖条毛啊，最后还不是全部召回求我们，返修。唉哟我都没眼看了，那PC客户端的音乐开着开着，是会被种马的。对方公司委托我们诊断一下，就是坏了嘛还诊断条毛啊！Suspension system，术语就是底大杠，就像是的车子的后悬挂系统。它有个承轴，压力大嘛就顶不住了，Undingable。    \n     2015-02-10 18:13 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:583 漏洞数:75        | 非妹子勿扰···)\t\t \n  迅雷黑酷狗，这是什么姿势    \n     2015-02-21 10:56 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  这个其实危害很大    \n     2015-03-27 14:15 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  组合拳打的多棒    \n     2015-03-29 18:35 |    \t\tF0rm \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | )\t\t \n  你想想看，你听着歌儿，看着刚买来的电脑和家人对着酷狗选歌，旁边是你心爱的wifi，后面是你的children。突然屏幕上光标自己动起来了，你的电脑自动帮你选歌，你以为它要变成人工智能系统，其实是被挂马了，what the fuck。QQ就这样被盗了，失去了年轻的QQ。他们的程序员是……羊驼吗？     \n     2015-05-07 09:20 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:11        | 我是一颗小小树)\t\t \n  感觉这个漏洞很牛逼，真的，酷狗用户量那么大    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}