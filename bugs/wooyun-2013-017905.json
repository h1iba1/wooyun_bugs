{"id": 14063, "wybug_id": "wooyun-2013-017905", "wybug_title": "爱爱医修改任意用户数据+拒绝服务", "wybug_corp": "爱爱医", "wybug_author": "fox", "wybug_date": "2013-01-26 13:01", "wybug_open_date": "2013-03-12 13:01", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-12：\t细节向公众公开  简要描述： 爱爱医修改任意用户数据+拒绝服务 详细说明：  两个问题都是由未过滤的SQL注入引起的POST型注入点：\nhttp://love.iiyi.com/upExpert.php?expert=2\n把这个POST上去，所有人都无法登陆了\nhttp://love.iiyi.com/upExpert.php?expert=2';\n本来是用于update医生的擅长领域的\n\n加一个引号，爆出物理路径和user_id\nexpert=2' , `reply_num`='100' where `user_id` ='36375230' or `user_id` ='36376109' ;\n\n\n可以修改包括密码、积分等用户数据另外一个很好玩的地方，如果把expert改为\n2-\n这样的异常数据，用户在登陆http://love.iiyi.com/就会造成异常，目测是因为用此数据构造查询请求导致的\n\n这里触发有一个条件，用户登陆的浏览器上要没有cookie，否则专家擅长领域会从cookie里取值，就不会造成查询   漏洞证明：  两个问题都是由未过滤的SQL注入引起的POST型注入点：\nhttp://love.iiyi.com/upExpert.php?expert=2\n把这个POST上去，所有人都无法登陆了\nhttp://love.iiyi.com/upExpert.php?expert=2';\n本来是用于update医生的擅长领域的\n\n加一个引号，爆出物理路径和user_id\nexpert=2' , `reply_num`='100' where `user_id` ='36375230' or `user_id` ='36376109' ;\n\n\n可以修改包括密码、积分等用户数据另外一个很好玩的地方，如果把expert改为\n2-\n这样的异常数据，用户在登陆http://love.iiyi.com/就会造成异常，目测是因为用此数据构造查询请求导致的\n\n这里触发有一个条件，用户登陆的浏览器上要没有cookie，否则专家擅长领域会从cookie里取值，就不会造成查询   修复方案：  过滤求礼物   版权声明：转载请注明来源 fox@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-01-26 14:01 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-26 14:48 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  昨天大半夜发的， 一觉起来就确认了，期待 @爱爱医 礼物啊！    \n     2013-01-26 16:35 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @fox  表示爱爱医的站的洞第一个就是我找的，好有成就感~ 嘿嘿~ 爱爱医会发礼物的哦亲。    \n     2013-01-26 17:37 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  @Black Angel 哈哈，我就是看到爱爱医给你发礼物就跟过来了，这个厂商给力啊    \n     2013-01-26 17:50 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @fox 哈哈哈 必须给力 一进来就广发礼物~真心想知道发的是啥礼物。    \n     2013-01-28 10:18 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @fox 轮人千百遍， 今天被你轮了。    \n     2013-01-28 11:31 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  @小囧 膜拜你， 貌似你就在爱爱医？    \n     2013-01-28 12:13 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @fox   一个公司,但是不是这个项目，  恰巧你发现的这个是我做的，做的时候赶工期 没注意。。擦    血玲玲的教训呀~    \n     2013-01-28 13:27 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  @小囧 难怪你这么说。 一个项目难免有些洞，我只是恰巧撞到了：）    \n     2013-02-01 18:51 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @小囧 你们公司的tips有点意思~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}