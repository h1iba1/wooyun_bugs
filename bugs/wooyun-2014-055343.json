{"id": 57095, "wybug_id": "wooyun-2014-055343", "wybug_title": "畅想听吧之博客多处安全漏洞礼包", "wybug_corp": "cxt8.com", "wybug_author": "伟哥", "wybug_date": "2014-04-12 09:06", "wybug_open_date": "2014-05-27 09:07", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-27：\t细节向公众公开  简要描述： QAQ 昨天问了问 网站的客服 貌似网站的高管对XSS还是挺重视的 请审核大大手下留情   详细说明：  首先是储存型XSS\n\n单机查看源码 插入XSS代码 \n\n触发点 1主页置顶 直接触发  触发地址 http://blog.cxt8.com/123654/articles用户名+articles触发点 2 文章触发http://blog.cxt8.com/123654/Articles/Show/80000000000004D5.html\n\n忽然发现 可以在主页 评论 于是抄起神器开始截断 \n\n/123654/Comment/CommentAdd?parentid=0&pindex=1&content=%u54C7%uFF01%u597D%u8D5E%u597D%u8D5E%u54E6%uFF01%uFF01%uFF01%3CBR%3E&commenttype=101&is_desc=true&keyid=1&callback=jQuery1620412802761401835_1396429516079&_=1396429531578这个貌似 就是品论连接了  发现封包内并没有POT数据也没验证  所以 QAQ 貌似可以利用一下 刷下品论什么的 由于 没有 POT数据 就可以用图片触发了 先本地访问下 发现出了N多字符\n\n访问了下 - - 这么乱码是怎么回事 QAQ 但是也能评论 但是貌似 只能品论一次  于是不甘心的 尝试突破  最终尝试结果在 123654 也就是用户名前多加个/可以多评论一次http://blog.cxt8.com///123654/Comment/CommentAdd?parentid=0&pindex=1&content=%u54C7%uFF01%u597D%u8D5E%u597D%u8D5E%u54E6%uFF01%uFF01%uFF01%3CBR%3E&commenttype=101&is_desc=true&keyid=1&callback=jQuery1620412802761401835_1396429516079&_=1396429531578http://blog.cxt8.com/123654/Comment/CommentAdd?parentid=0&pindex=1&content=%u54C7%uFF01%u597D%u8D5E%u597D%u8D5E%u54E6%uFF01%uFF01%uFF01%3CBR%3E&commenttype=101&is_desc=true&keyid=1&callback=jQuery1620412802761401835_1396429516079&_=1396429531578于是开始构造\n\n\n\n\n\n成功 QAQ 我就不找用户测试了  估计效果是一样的  加强判断验证 好的那么我们来测试 平行权限  http://blog.cxt8.com/ 首先博客是对外公开的 这样我们查看任意人的博客日志就算不公开 也可以穷举  于是看到了 列于榜首的 华风 大大 QAQ 大大对不起我就先拿你开刀了 先截断编辑日志的 操作 得出结果 \n\n123654/Articles/Write/80000000000004D5.html这段就应该是 请求 编辑博客的连接了 80000000000004D5.html应该就是博客的文件吧  QAQ 满心欢喜的 构造了个连接 去华风大大的博客去做测试结果如下 QAQ \n\n他喵的 居然告诉我无权限  QAQ  怎么办 好纠结  于是不甘心的再次测试 这回记住华风大大的 文章 地址 然后修改我的文章地址 8000000000000024.html 这就是他的地址  \n\n如图  QAQ 卧槽 居然进去了  我真TM机智  \n\n删除也是同样原理 QAQ 就不掩饰了乌云从此 又多了一个厂商 此网站安全 也将无忧  我胸前雪白的红领巾 更加鲜艳了另厂商大大 求礼物啊 QAQ  小菜检测 勿喷  另请关注畅想听吧其他礼包。   漏洞证明：  \n\n   修复方案：  过滤 加强验证    版权声明：转载请注明来源 伟哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-04-12 09:52 厂商回复： 很可爱的作者 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-12 09:52 |    \t\t畅想听吧(乌云厂商)\t\t \n  感谢提交，鼓励一下    \n     2014-05-16 18:16 |    \t\t伟哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:29        | 不怕流氓有文化,就怕色狼有耐心,那么一只起...)\t\t \n  @疯狗 为毛还是小厂商流程  不是只看漏洞不看厂商的吗     \n     2014-05-19 14:13 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @伟哥 呃，厂商是已小厂商进行注册的，所以状态继承。除非影响或者有技术亮点还是可以在首页显示的。    \n     2014-05-20 14:52 |    \t\t伟哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:29        | 不怕流氓有文化,就怕色狼有耐心,那么一只起...)\t\t \n  @疯狗 表示又进行了一次检测 已经拿到服务器权限 求这次走大厂商流程     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}