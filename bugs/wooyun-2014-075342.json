{"id": 51209, "wybug_id": "wooyun-2014-075342", "wybug_title": "某通用CMS可越权查看用户敏感信息", "wybug_corp": "淮南市易迅信息科技有限公司", "wybug_author": "bey0nd", "wybug_date": "2014-09-09 17:45", "wybug_open_date": "2014-12-08 17:46", "wybug_type": "非授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-12-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 看到通用的洞洞规则变了，来凑个热闹吖，第一次提交通用，求通过呢..... 详细说明：  闲着没事，就在源码网站看看有没有有意思的源码，然后就看到了这个。http://down.admin5.com/php/105478.htmlhttp://www.duote.com/soft/109798.html直接来官网demo站测试了。。-------------------------------------------------------------------------微信公众平台的营销系统。最近挺火哈在官网注册了一个用户，随便添加一个公众号\n\n然后我们在来修改一下。如图\n\n抓个包，改个ID\n\n别人的信息全有了，对于微信号有了原始ID。。那就什么都可以干了，打个码~保存也是没问题的，不改别人的资料了，不好~-------------------------------------------------------------------看一下代码的具体实现使用ThinkPHP框架开发的，直接找到漏洞文件，在控制器里面viicms/Lib/Action/User/IndexAction.class.php中的edit()方法。\n\n\tpublic function edit(){\t\t$id=$this->_get('id','intval');\t\t$where['uid']=session('uid');\t\t$res=M('Wxuser')->where($where)->find($id);\t\t$this->assign('info',$res);\t\t$this->display();\t}直接获取GET中的id参数。然后连接数据库查询，并没有做验证，然后就输出到页面导致越权   漏洞证明：  闲着没事，就在源码网站看看有没有有意思的源码，然后就看到了这个。http://down.admin5.com/php/105478.htmlhttp://www.duote.com/soft/109798.html直接来官网demo站测试了。。-------------------------------------------------------------------------微信公众平台的营销系统。最近挺火哈在官网注册了一个用户，随便添加一个公众号\n\n然后我们在来修改一下。如图\n\n抓个包，改个ID\n\n别人的信息全有了，对于微信号有了原始ID。。那就什么都可以干了，打个码~保存也是没问题的，不改别人的资料了，不好~-------------------------------------------------------------------看一下代码的具体实现使用ThinkPHP框架开发的，直接找到漏洞文件，在控制器里面viicms/Lib/Action/User/IndexAction.class.php中的edit()方法。\n\n\tpublic function edit(){\t\t$id=$this->_get('id','intval');\t\t$where['uid']=session('uid');\t\t$res=M('Wxuser')->where($where)->find($id);\t\t$this->assign('info',$res);\t\t$this->display();\t}直接获取GET中的id参数。然后连接数据库查询，并没有做验证，然后就输出到页面导致越权   修复方案：  权限验证   版权声明：转载请注明来源 bey0nd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-09-09 18:27 |    \t\ts3xy \t\t\t( 核心白帽子 |\t\t\t        Rank:832 漏洞数:113        | 相濡以沫，不如相忘于江湖)\t\t \n  围观    \n     2014-09-10 14:45 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:142        | 相忘于江湖，不如相濡以沫)\t\t \n  @s3xy 收费    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}