{"id": 4708, "wybug_id": "wooyun-2014-052939", "wybug_title": "金蝶官网设计缺陷导致密码重置漏洞2", "wybug_corp": "金蝶", "wybug_author": "北京方便面", "wybug_date": "2014-03-06 11:40", "wybug_open_date": "2014-04-20 11:41", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-20：\t细节向公众公开  简要描述： http://www.wooyun.org/bugs/wooyun-2014-051429 最新状态：2014-02-21：经确认，我们的代码中返回值本来应该是\"false\"，但是手误写成了\"true\" ！在后来测试中也没有测试出来，故造成此漏洞。安全问题就是细节不注意造成的，我们需要汲取教训。 感谢小威同学为我们发现严重漏洞，请留下你的联系方式，我们为你送上小礼物以表谢意。看厂商的回复觉察到这里可能会有问题，于是测试之验证自己的想法 详细说明：  \n经确认，我们的代码中返回值本来应该是\"false\"，但是手误写成了\"true\" ！在后来测试中也没有测试出来，故造成此漏洞。安全问题就是细节不注意造成的，我们需要汲取教训。 感谢小威同学为我们发现严重漏洞，请留下你的联系方式，我们为你送上小礼物以表谢意。\n经测试发现这里存在低级的错误，1.靠服务器返回的状态信息进行本地验证2.验证凭证未参与密码修改验证过程看证明吧   漏洞证明：  \n\n进入2、获取验证码然后点击提交这里我们使用burp代理截包 截responses包\n\n\n\n很低级的错误，使用服务器返回信息做本地判断\n\n\n\n\n\n   修复方案：  唯一且不可测随机且一次性拥有较短寿命不信任用户自己的身份声明不要本地验证验证凭证要参与密码修改过程   版权声明：转载请注明来源 北京方便面@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-03-06 18:37 厂商回复： 谢谢 北京方便面 还继续测试，对 北京方便面 兄的专注、严谨与坚持的精神表示钦佩，学习！感谢！的确测试不周到，主要原因是逻辑复杂化了，以及输入校验不严格。现在修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-06 18:58 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  厂商脱胎换骨了    \n     2014-03-06 19:39 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  厂商是个好同志。    \n     2014-03-06 20:01 |    \t\t雅柏菲卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:1213 漏洞数:234        | 雙魚座聖鬥士雅柏菲卡)\t\t \n  @xsser 厂商羽化成蝶了    \n     2014-03-06 20:05 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  换人了    \n     2014-03-07 09:10 |    \t\t金蝶(乌云厂商)\t\t \n  厂商表示无语中呢，仍十分感谢各位关注，继续关注：）    \n     2014-03-27 14:38 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  他这个如果根据服务器返回信息做本地判断是不是会有个hidden的值，直接firebug修改html源码也行    \n     2014-03-27 16:44 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @HRay +1    \n     2014-04-20 21:43 |    \t\t暗影侠客 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:5        | xss,inject,ctrf)\t\t \n  金蝶有点侮辱中国程序员的感觉....    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}