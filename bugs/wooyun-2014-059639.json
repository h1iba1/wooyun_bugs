{"id": 3445, "wybug_id": "wooyun-2014-059639", "wybug_title": "腾讯OAuth平台redirect_uri过滤不严可能导致用户信息遭窃取（三）", "wybug_corp": "腾讯", "wybug_author": "p.z", "wybug_date": "2014-05-06 12:59", "wybug_open_date": "2014-06-20 13:00", "wybug_type": "应用配置错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-20：\t细节向公众公开  简要描述： 听说你们又修补啦？那我再补一发吧。 详细说明：  腾讯OAuth平台对redirect_uri校验时, 未考虑一些奇怪的浏览器特性, 导致redirect_uri检验被绕过.safari会对url中的full width字符自动转化为常见的字符, 比如下面这个url:http://ｗｗｗ．ｗｏｏｙｕｎ．ｏｒｇ会跳转到http://www.wooyun.org\n\n那么同样的, 把/#?这类path和authority分割的字符 转化为full width字符后, 虽然服务器认为这样的字符已经不能分割authority了,  但在浏览器处理时, 依然进行了分割.   漏洞证明：  http://openapi.qzone.qq.com/oauth/show?which=Login&display=pc&response_type=code&client_id=100263567&redirect_uri=http://www.aaaa.com／.security.tencent.com/2.php&scope=get_user_info,add_pic_t,add_t   修复方案：  过滤   版权声明：转载请注明来源 p.z@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-05-06 14:23 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-06 13:29 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  拆台    \n     2014-05-06 13:31 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  屌！    \n     2014-05-06 13:32 |    \t\t心伤的胖子 \t\t\t( 普通白帽子  |\t\t\t        Rank:308 漏洞数:29        | 因为心伤，所以胖子。)\t\t \n  屌爆！    \n     2014-05-06 13:32 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  屌爆了!    \n     2014-05-06 13:34 |    \t\t马燕羊蝎子 \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:10        | 亲，啥时候请吃马燕羊蝎子。)\t\t \n  屌爆了都！    \n     2014-05-06 13:36 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  屌爆了都要！    \n     2014-05-06 13:39 |    \t\t不良小狼 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:5        | 路人乙)\t\t \n  屌爆了咪咪咪！    \n     2014-05-06 13:46 |    \t\tz7y丶 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 我是z7y的表弟)\t\t \n  碉堡了还有续集没！    \n     2014-05-06 13:48 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  碉堡了肯定会有续集！    \n     2014-05-06 13:49 |    \t\t／々 1` 7 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:3        )\t\t \n  碉堡了肯定会有续集的！    \n     2014-05-06 13:50 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  碉堡了续集还有多少级啊！    \n     2014-05-06 13:53 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  碉堡了续集要多少集有多少集    \n     2014-05-06 14:04 |    \t\tl0u1s \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:3        | 崇尚自由、开放、共享、简约。)\t\t \n  碉堡了你绝对想不到续集有多少集    \n     2014-05-06 14:10 |    \t\tG3mIn1 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:5        | 我画兰江水悠悠，爱晚亭上枫叶稠。)\t\t \n  碉堡了不会是要放新闻联播了吧？    \n     2014-05-06 14:16 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  碉堡了你绝对想不到还要续多少集！    \n     2014-05-07 09:04 |    \t\tterrying \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:15        | 雅蠛蝶)\t\t \n  碉堡了你绝对想不到还要续多少集！    \n     2014-05-07 09:20 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  碉堡了你绝对想不到还要续多少集续集你怕不怕！    \n     2014-05-12 16:41 |    \t\til0vnn \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:12        | 这个人那个人)\t\t \n  碉堡了你绝对想不到多少集的续集都还会有续集！    \n     2014-06-20 13:06 |    \t\t小杰哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:155 漏洞数:25        | 逆水行舟，不进则退。)\t\t \n  碉堡了你绝对想不到第一季续集以后还会有第二季续集！    \n     2014-06-20 13:08 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  碉堡了你绝对想不到第一季续集以后还会有第二季续集希望别这么快大结局！    \n     2014-06-20 13:17 |    \t\t假马 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:18        | 我存在,你婶婶的脑海里.)\t\t \n  碉堡了你绝对想不到第一季续集以后还会有第二季续集甚至第三季第四季第五季第六季！    \n     2014-06-20 13:24 |    \t\t厦门佬 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:8        )\t\t \n  碉堡了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}