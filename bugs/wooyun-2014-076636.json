{"id": 50835, "wybug_id": "wooyun-2014-076636", "wybug_title": "某通用型校园建站系统存在六处QL注射漏洞", "wybug_corp": "国家互联网应急中心", "wybug_author": "U神", "wybug_date": "2014-09-21 23:16", "wybug_open_date": "2014-12-20 23:18", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-20：\t细节向公众公开  简要描述： 影响比较大 详细说明：  前人经验 WooYun: 某通用型数字校园系统SQL注射漏洞（涉及大量学校） ，看到走的是首页，不得不把这个系统的注入点提交完，六个打包我就不一一单刷了。厂商：http://www.wxxzbjy.com/  无锡新座标教育技术有限公司google模糊搜索量：\n\n按照参数来区分不同的注入点：第一处：“tid”参数注入\n\n\nmask 区域\n\n1.http://**.**.**\n\n\n\n/dpma/FWeb/WorkRoomWeb/Web/TeacherSourceDetail.aspx?SFID=2825&tid=3210010059 \n\n\n\nmask 区域\n\n1.http://**.**.**/\n\n\n\ndpma/FWeb/WorkRoomWeb/Web/TeacherCourse.aspx?tid=3180010017\n\n\n\nmask 区域\n\n1.http://**.**.**/\n\n\n\ndpma/FWeb/WorkRoomWeb/Web/Index.aspx?TID=3180010017 \n\n\n\nmask 区域\n\n1.http://**.**.**/\n\n\n\ndpma/FWeb/WorkRoomWeb/Web/TeacherAlbums_New.aspx?tid=3180010017\n\n\n\nmask 区域\n\n1.http://**.**.**/\n\n\n\ndpma/FWeb/WorkRoomWeb/Web/TeacherBlog.aspx?tid=3180010017\n\n\n\nmask 区域\n\n1.http://**.**.**/\n\n\n\ndpma/FWeb/WorkRoomWeb/Web/TeacherBlogDetail.aspx?tid=\n\n\n\nmask 区域\n\n1.http://**.**.**/\n\n\n\ndpma/FWeb/WorkRoomWeb/Web/TeacherPhotosDetail.aspx?tid=3180010017&Album_ID=1051\n\n\n\nmask 区域\n\n1.http://**.**.**/\n\n\n\ndpma/FWeb/WorkRoomWeb/Web/TeacherSourceDetail.aspx?SFID=1882&tid=3180010017h\n\n\n\nmask 区域\n\n1.ttp://**.**.**/dpm\n\n\n\na/FWeb/WorkRoomWeb/Web/Index.aspx?TID=3240010089http://\n\n\n\nmask 区域\n\n*****hed*****\n\n\n\n/dpma/FWeb/WorkRoomWeb/Web/Index.aspx?tid=1050180233http://\n\n\n\nmask 区域\n\n*****hed*****\n\n\n\n/dpma/FWeb/WorkRoomWeb/Web/TeacherBlogDetail.aspx?tid=1050270067&diaryId=271107\n第二处“KindSetID”参数注入：\nh\n\nmask 区域\n\n1.ttp://**.**.**\n\n\n\n/DPMA/FWeb/SPEWeb/Web/SPENews.aspx?KindSetID=10003&sid=318001http://\n\n\n\nmask 区域\n\n*****zyx.*****\n\n\n\n/DPMA/FWeb/SPEWeb/Web/SPENewsList.aspx?KindSetID=1000310&sid=318001 http://\n\n\n\nmask 区域\n\n*****zyx.*****\n\n\n\n/DPMA/FWeb/SPEWeb/Web/SPEVideoVideos.aspx?KindSetID=30002&sid=318001http://\n\n\n\nmask 区域\n\n*****zyx.*****\n\n\n\n/DPMA/FWeb/SPEWeb/Web/SPERecommandNews.aspx?KindSetID=10003&sid=318001 http:/\n\n\n\nmask 区域\n\n*****wzyx*****\n\n\n\n/DPMA/FWeb/SPEWeb/Web/SPEPhoto_Page.aspx?KindSetID=0&sid=318001http://\n\n\n\nmask 区域\n\n*****2.1*****\n\n\n\n/dpma/FWeb/SPEWeb/Web/SPENews.aspx?KindSetID=10000&sid=324001http:/\n\n\n\nmask 区域\n\n*****.102*****\n\n\n\n/dpma/FWeb/SPEWeb/Web/SPEVideoPage.aspx?KindSetID=30001&VideoID=1020&sid=324001 http://\n\n\n\nmask 区域\n\n*****102.*****\n\n\n\ndpma/FWeb/SPEWeb/Web/SPEVideoVideos.aspx?KindSetID=30001&sid=324001 KindSetID=30001 http://\n\n\n\nmask 区域\n\n*****2.1*****\n\n\n\n/dpma/FWeb/SPEWeb/Web/SPERecommandNews.aspx?KindSetID=10000&sid=324001 http://iqxxx.net/dpma/FWeb/SPEWeb/Web/SPENewsList.aspx?KindSetID=1000314&sid=315001\n第三处：“KindID”参数注入\nhttp:/\n\nmask 区域\n\n*****h19*****\n\n\n\nt/dpma/FWeb/SchoolWeb/Web/TeacherArticle.aspx?KindID=1007_1001_1010&sid=321001 http://\n\n\n\nmask 区域\n\n*****zyx.*****\n\n\n\nDPMA/FWeb/SchoolWeb/Web/TeacherArticle.aspx?KindID=1007_1001_1000&sid=318001 http://\n\n\n\nmask 区域\n\n*****190*****\n\n\n\n/dpma/FWeb/SchoolWeb/Web/TeacherSource.aspx?KindID=1003_1001_1017&sid=321001 http://\n\n\n\nmask 区域\n\n*****06.n*****\n\n\n\ndpma/FWeb/SchoolWeb/Web/TeacherSource.aspx?KindID=1003_1001_1017&sid=321001  http://\n\n\n\nmask 区域\n\n*****zyx.*****\n\n\n\n/DPMA/FWeb/SchoolWeb/Web/TeacherSource.aspx?KindID=1003_1001_1009&User_Type=1&sid=318001 KindID=1003_1001_1009 http:/\n\n\n\nmask 区域\n\n*****wzyx*****\n\n\n\n/DPMA/FWeb/SPEWeb/Web/SPEVideoPage.aspx?KindSetID=30001&VideoID=1032&sid=318001 http://\n\n\n\nmask 区域\n\n*****zyx.*****\n\n\n\nDPMA/FWeb/SchoolWeb/Web/TeacherSource.aspx?KindID=1008_1001_1009&sid=318001 http://\n\n\n\nmask 区域\n\n*****du.c*****\n\n\n\nma/FWeb/SchoolWeb/Web/TeacherArticle.aspx?KindID=1004_1001_1420&sid=105027http://\n\n\n\nmask 区域\n\n*****du.c*****\n\n\n\nma/FWeb/SchoolWeb/Web/TeacherSource.aspx?KindID=1008_1001_1416&sid=105027  http:/\n\n\n\nmask 区域\n\n*****.kse*****\n\n\n\n/dpma/FWeb/SchoolWeb/Web/TeacherArticle.aspx?KindID=1003_1001_1170&sid=101003http://\n\n\n\nmask 区域\n\n*****.ne*****\n\n\n\ndpma/FWeb/SPEWeb/Web/SPENews.aspx?KindSetID=10000&sid=315001http://\n\n\n\nmask 区域\n\n*****.ne*****\n\n\n\nma/FWeb/SchoolWeb/Web/TeacherSource.aspx?KindID=1008_1001_1007&sid=315001\n第四处：“ALBUMID”参数注入\n\n\nmask 区域\n\n1.http://**.**.**\n\n\n\nt/DPMA/FWeb/SPEWeb/Web/SPEPhoto_Photos.aspx?KindSetID=2000013&ALBUMID=1023&sid=318001http://\n\n\n\nmask 区域\n\n*****zyx.*****\n\n\n\nMA/FWeb/SPEWeb/Web/SPEPhoto_Photos.aspx?KindSetID=0&ALBUMID=1023http://\n\n\n\nmask 区域\n\n*****pdedu*****\n\n\n\ndpma/FWeb/SPEWeb/web3/SPEPhoto_Photos.aspx?KindSetID=20000&ALBUMID=1013&sid=330001http://\n\n\n\nmask 区域\n\n*****zyx.*****\n\n\n\n/dpma/FWeb/SPEWeb/Web/SPEPhoto_Photos.aspx?KindSetID=&ALBUMID=1018&sid=318001http://\n\n\n\nmask 区域\n\n*****xqx*****\n\n\n\nDPMA/FWeb/SPEWeb/Web/SPEPhoto_Photos.aspx?KindSetID=20003&ALBUMID=1171&sid=315001\n第五处：“VideoID”参数注入：\nhttp://\n\nmask 区域\n\n*****zyx.*****\n\n\n\nDPMA/FWeb/SPEWeb/Web/SPEVideoPage.aspx?KindSetID=30001&VideoID=1032&sid=318001http://\n\n\n\nmask 区域\n\n*****2.1*****\n\n\n\n/dpma/FWeb/SPEWeb/Web/SPEVideoPage.aspx?KindSetID=30001&VideoID=1020&sid=324001http://\n\n\n\nmask 区域\n\n*****hwz*****\n\n\n\nt/dpma/FWeb/SPEWeb/Web/SPEVideoPage.aspx?KindSetID=30003&VideoID=1031&sid=318001http://\n\n\n\nmask 区域\n\n*****qxx*****\n\n\n\n/DPMA/FWeb/SPEWeb/Web/SPEVideoPage.aspx?KindSetID=30003&VideoID=1015&sid=315001http:/\n\n\n\nmask 区域\n\n*****.102*****\n\n\n\n/dpma/FWeb/SPEWeb/Web/SPEVideoPage.aspx?KindSetID=30001&VideoID=1003&sid=324001\n第六处：“sid”参数注入：\n\n\nmask 区域\n\n1.http://**.**.**\n\n\n\n/DPMA/FWeb/SchoolWeb/Web/AnnounAndNews.aspx?Type_Anews=2&sid=318001http:\n\n\n\nmask 区域\n\n*****hwzy*****\n\n\n\n/DPMA/FWeb/SchoolWeb/Web/AnnounAndNewsDetail.aspx?Type_Anews=2&TaID=1002&sid=318001 http://\n\n\n\nmask 区域\n\n*****2.1*****\n\n\n\n/dpma/FWeb/SchoolWeb/Web/AnnounAndNews.aspx?Type_Anews=2&sid=324001http://\n\n\n\nmask 区域\n\n*****hed*****\n\n\n\n/dpma/FWeb/SchoolWeb/Web/AnnounAndNews.aspx?Type_Anews=2&sid=105027http://\n\n\n\nmask 区域\n\n*****ksed*****\n\n\n\ndpma/FWeb/SchoolWeb/Web/AnnounAndNews.aspx?Type_Anews=2&sid=101003\n   漏洞证明：  我就随便挑几个测试一下了：\nSQL1：tid参数注入证明:\n\n\n\nSQL2：KindSetID参数注入证明：\n\n\n\nSQL3：KindID参数注入证明：\n\n\n\nSQL4：ALBUMID参数注入证明：\n\n\n\nSQL5：VideoID参数注入证明：\n\n\n\nSQL6：sid参数注入证明：\n\n\n   修复方案：     版权声明：转载请注明来源 U神@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-09-26 10:09 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-20 09:41 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  看了下你的wooyun漏洞和360漏洞列表，我可以说你为什么要2边都提交拿钱呢，我并不是单指这一个漏洞。    \n     2014-12-20 10:41 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @黑暗游侠 呵呵，我只是笑笑，如果一个系统有10个漏洞，我会把其中一个分到乌云，其它9个分到库带，请问是一样的吗？你看到厂商一样就认为漏洞一样？注入点一样？你可以扪心问问库带的人，它会审查我乌云这边的洞是不是重复再说把    \n     2014-12-20 10:46 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @U神 比如说：http://wooyun.org/bugs/wooyun-2014-061725、http://loudong.360.cn/vul/info/qid/QTVA-2014-21296  你会认为这尼玛不是同一个厂商，漏洞肯定一样，但是你错了，一个是post注入，而库带这边是get注入，一个注入参数是gm_name,另一个是username 你还有什么话好说的吗？    \n     2014-12-20 10:49 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @黑暗游侠 还不出来认错么？这个校园系统有两处非常隐蔽，除非知道源代码的人才找的到的注入我提交到库带了，但是这六处显而易见，前台直接能找到的注入我提交到乌云，有什么不对的吗？心虚了吗？    \n     2014-12-20 13:20 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @U神 非就事论事，难道那么多厂商都是分的么，大哥别激动，真没别的意思，就是好奇问个问题而已，我以前也有一洞多交的。    \n     2015-02-08 11:41 |    \t\t小牛牛 \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:7        | 求带)\t\t \n  一洞多交不会封你号？    \n     2015-02-08 16:09 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @小牛牛 没有一洞多交啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}