{"id": 55157, "wybug_id": "wooyun-2014-062047", "wybug_title": "PHPSHE B2C 重装。", "wybug_corp": "phpshe.com", "wybug_author": "′雨。", "wybug_date": "2014-05-25 12:24", "wybug_open_date": "2014-08-23 12:26", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-23：\t细节向公众公开  简要描述： PHPSHE B2C商城系统 v1.2(build 20140519 UTF8)看到更新了 下一个下来看看。我擦 敢判断一下lock吗? 详细说明：  在install/index.php\nerror_reporting(E_ALL ^ E_NOTICE);date_default_timezone_set('PRC');header('Content-Type: text/html; charset=utf-8');//改写不安全的register_global和防sql注入处理if (@ini_get('register_globals')) {\tforeach($_REQUEST as $name => $value){unset($$name);}}$pe['host_root'] = 'http://'.str_ireplace(rtrim(str_replace('\\\\','/',$_SERVER['DOCUMENT_ROOT']), '/'), $_SERVER['HTTP_HOST'], str_replace('\\\\', '/', dirname(__FILE__))).'/../';$pe['path_root'] = str_replace('\\\\','/',dirname(__FILE__)).'/../';include(\"{$pe['path_root']}/include/class/cache.class.php\");include(\"{$pe['path_root']}/include/function/global.func.php\");if (get_magic_quotes_gpc()) {\t!empty($_GET) && extract(pe_trim(pe_stripslashes($_GET)), EXTR_PREFIX_ALL, '_g');\t!empty($_POST) && extract(pe_trim(pe_stripslashes($_POST)), EXTR_PREFIX_ALL, '_p');}else {\t!empty($_GET) && extract(pe_trim($_GET),EXTR_PREFIX_ALL,'_g');\t!empty($_POST) && extract(pe_trim($_POST),EXTR_PREFIX_ALL,'_p');}switch ($_g_step) {\t//#####################@ 配置信息 @#####################//\tcase 'setting':\t\tif (isset($_p_pesubmit)) {\n没有判断lock  。。可以直接重装。轻松Getshell。   漏洞证明：  \n\n   修复方案：  在安装完成后 生成一个lock然后在安装的时候判断是否已经有Lock 。如果有lock 就退出。或者安装完成后直接删掉这文件把。。这。。。。  不知道怎么说了。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-05-25 13:54 厂商回复： 感谢@′雨。 提供代码审计，安装文档及安装完成有提示删除install目录，新版会再强制rename下文件。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-23 21:48 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  强制rename下文件－－    \n     2015-03-21 17:37 |    \t\txussec \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Python的裤衩谁有？)\t\t \n  强制rename下文件－－    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}