{"id": 29158, "wybug_id": "wooyun-2015-0120412", "wybug_title": "中国移动网上营业厅安卓平台应用存在硬编码固定密钥和IV的漏洞可嗅探攻击", "wybug_corp": "中国移动", "wybug_author": "drama_Queen", "wybug_date": "2015-06-14 14:43", "wybug_open_date": "2015-09-17 12:10", "wybug_type": "用户敏感数据泄漏", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "安全", "敏感数据未加密"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向公众公开  简要描述： 安卓平台中国电信掌上营业厅apk硬编码入对用户登录密码加密的固定密钥和IV，获得密文后可以直接反解出密码原文。同时记住密码功能中也存在问题 详细说明：  在用户登录过程中：首先随机产生一个10000内的整数作为密钥，将该密钥和内置的一个私钥“[B@1f80ce47”在自定义的一个加密函数中加密。将密码和密钥同样在该加密函数中加密。然后将加密的两个结果和其他的一些信息同时做desede/CBC/PKCS5Padding。取“richeninfo.3322.org@nqz#211”前24个字节作为 DES-EDE 密钥的密钥内容。IV为“01234567”，将结果base64编码。同时内置有解密函数。均可反解。而在记住密码的过程中：当第一次登录成功后，会把第一次收集到的密码明文的方式直接存储到content中。   漏洞证明：  经过第一步DES解密以后获得以下内容\n\n然后由于apk中已经内置一个自定义的解密函数(在登陆过程中没有调用)，可以直接复制反编译后的源码解密。   修复方案：  不要硬编码DES的固定密钥和IV。同时，既然存在自定义的加密函数，如果没有用到解密过程，请不要直接写入解密函数。   版权声明：转载请注明来源 drama_Queen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-06-19 12:09 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发通报,由其后续协网站调管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}