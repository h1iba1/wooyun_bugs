{"id": 86721, "wybug_id": "wooyun-2016-0189562", "wybug_title": "中国联通某核心业务系统缺陷/全国32省用户资料泄漏/可查全国公民身份证信息（可办理及查询全国各省用户业务）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Aasron", "wybug_date": "2016-03-27 10:10", "wybug_open_date": "2016-05-15 11:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "大量用户信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-15：\t细节向公众公开  简要描述： 中国联通某核心业务系统缺陷/全国32省用户资料泄漏/可查全国公民身份证信息（可办理及查询全国各省用户业务）根据我的观察，基本全国32个省中的各个市级以及区级或者办公区域，帐号都有，并且都可以登录并办理业务或查询用户信息资料 详细说明：  发现这个漏洞的时候我都吓了一跳，而且搜了一下，联通这套系统问题还真不少\n\n但是如此低级的一个问题  实属不应该发生中国联通cBSS支撑系统\nhttp://123.***.***.***:47088/essframe\n我看了看以前的案例，一般以一个帐号的弱口令或以命令执行为主这次是系统的一个设计缺陷，导致全国员工帐号可爆破没有验证码确实是个硬伤！\nPOST /essframe HTTP/1.1Host: 123.***.***.***:47088User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: **.**.**.**:47088/essframeCookie: BSS_JSESSIONID=WRiz3EKF-TmLtoK1OlPizCr3PyUPX88R38J6HRa7N-vk6Ux774Gb!2147461409!NONE; LOGIN_STAFF_IDBSS=admin; LOGIN_PROVINCE_IDBSS=11Connection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 659service=direct%2F1%2FHome%2F%24Form&sp=S0&Form0=LOGIN_AUTH_TYPE%2CSTAFF_ID%2C%24FormConditional%2C%24FormConditional%240%2CLOGIN_PROVINCE_CODE%2C%24FormConditional%241%2C%24FormConditional%242%2C%24FormConditional%243%2C%24FormConditional%244%2C%24FormConditional%245%2C%24FormConditional%246%2CbLoginSubmit%2C%24FormConditional%247&%24FormConditional=F&%24FormConditional%240=T&%24FormConditional%241=F&%24FormConditional%242=F&%24FormConditional%243=F&%24FormConditional%244=F&%24FormConditional%245=F&%24FormConditional%246=T&%24FormConditional%247=F&LOGIN_AUTH_TYPE=0&STAFF_ID=admin&LOGIN_PASSWORD=123456&LOGIN_PROVINCE_CODE=11&LOGIN_FLAG=1&bLoginSubmit=+\n在这里用户名及密码并未进行加密传输，并且还不设置登录限制，那就爆破咯！首先我们爆破北京的帐号\n\n测试北京我一共爆破出来10个有效切可登录的帐号\n\n\n****i\t ***wei\t***gyu\t***lei\t\tli******we*wan***\tya******ng\tliu***n\tch****g\n密码均为弱口令，我们登录进去看看\n\n这个感觉权限比较小啊，于是多换了几个帐号看了看这个权限貌似挺大\n\n担保公司信息\n\n用户资料\n\n接下来我们尝试登录全国各省的业务系统   漏洞证明：  中国联通河北CBSS支撑系统\n\n黑名单用户及身份证信息\n\n山东区域：这人名字叼扎天，马超！！\n\n\n\n黑龙江区域：\n\n\n\n上海区域：\n\n原本我以为总部的安全性比较高，但经过我测试，可登录的帐号多达20多枚这里由于省份太多，我仅说明问题，所以不全国各个省市截图了中国联通总部区域:\n\n\n\n\n\n这个厉害了\n\n找了几个权限比较大的帐号网上搜索证件号码，找到一个用户身份证具体步骤：搜索身份证及证件号码--营业受理--资料维护--客户资料变更然后点击认证就能看到身份证信息了，大概资料如下图\n\n\n\n   修复方案：  1.验证机制2.改改改   版权声明：转载请注明来源 Aasron@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2016-03-31 10:54 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国联合网络通信集团有限公司通报,由其后续协调网站管理部门处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-27 10:11 |    \t\tPzacker \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:32        )\t\t \n  6666666666    \n     2016-03-27 10:27 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:154 漏洞数:65        | 我要是再正常一点就好了)\t\t \n  前排    \n     2016-03-27 11:01 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:743 漏洞数:149        )\t\t \n  6666666666    \n     2016-03-27 11:06 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:765 漏洞数:81        | root@qisec.com)\t\t \n  打雷了    \n     2016-03-27 11:45 |    \t\t不会游泳的鱼 \t\t\t( 普通白帽子  |\t\t\t        Rank:188 漏洞数:56        | 非著名白帽子)\t\t \n  666    \n     2016-03-27 12:27 |    \t\t玄道 \t\t\t( 普通白帽子  |\t\t\t        Rank:140 漏洞数:41        | 就是注入 就是注入 注入)\t\t \n  666666666666666    \n     2016-03-27 13:02 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:787 漏洞数:150        | raw_input(\"你知道我要输入什么？\"))\t\t \n  节奏。。    \n     2016-03-27 16:18 |    \t\tFormat_smile \t\t\t( 普通白帽子  |\t\t\t        Rank:496 漏洞数:172        | ···孰能无过，谁是谁非！)\t\t \n  然而没有打雷    \n     2016-03-27 16:32 |    \t\t’‘Nome \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:31        | 有事请发邮件，2859857@gmail.com，垃圾邮...)\t\t \n  居然不打雷    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}