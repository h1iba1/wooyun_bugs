{"id": 43575, "wybug_id": "wooyun-2014-082335", "wybug_title": "某市医保网上申报系统漏洞集合", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2014-11-07 15:56", "wybug_open_date": "2014-12-22 15:58", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-22：\t细节向公众公开  简要描述： 该系统中存有该市的社区医保和学校医保数据，不含有公司医保数据。 详细说明：  估计乌云公开之前都不会修复，所以我尽量使用mask标签，望见谅！目标地址：\n\nmask 区域\n1.http://**.**.**/login.jsp\n\n\n\nmask 区域\n*****be3798e1ca012019e5c1.png&qu*****\n\n问题1：大量弱口令和默认口令；问题2：使用A账户越权操作B账户，平行权限控制问题，该处可以遍历所有人员信息；问题3：使用任意账户修改任意账户密码，且包含超级管理员。   漏洞证明：  问题1：首先通过\n\nmask 区域\n1.http://**.**.**/helpdw.doc\n\n和\n\nmask 区域\n1.http://**.**.**/helpsq.doc\n\n获取帮助手册，可以获取医保维护人员账户为六位数字，密码为123456。使用burpsuite intruder进行遍历可登陆大量账户，如：\n\nmask 区域\n*****08为^*****\n\n没有遍历所有，尝试到可登陆账户即刻停止！登录某账户，查看学生班级信息\n\nmask 区域\n*****7722b1853ef4a7ec2e.png\"*****\n\n登录某账户，查看社区人员信息，并可分析出家庭成员信息\n\nmask 区域\n*****5c2e8bcfa32b21fa2f.png\"*****\n\n\n\n问题2：区分社区用户和学校用户，以社区用户演示遍历家庭信息\n\nmask 区域\n1.http://**.**.**/usr/SqCb/familyDetail.jspfamilyId=35301976\n\n变换familyId=35301976遍历个人信息\n\nmask 区域\n1.http://**.**.**/usr/SqCb/pshowDetail.jspgrbh=16693875\n\n变换grbh=16693875遍历普通管理员\n\nmask 区域\n1.http://**.**.**/usr/User/edit.jspuserid=1\n\n此处获取系统管理员ID为1问题3：演示修改管理员密码利用burpsuite拦截社区管理员重置密码过程点击-系统管理-用户管理\n\nmask 区域\n*****79e02ef162534d0752.png\"*****\n\n点击任意用户后面的重置密码，burpsuite拦截，并修改c0-param0=1,即可重置administrator密码为123456，出于安全考虑已经修改为\n\nmask 区域\n*****sor*****\n\n登录\n\nmask 区域\n*****23624bc0b22a07461e.png\"*****\n\n可管理该市下所有社区和学校数据点击红色框内切换身份\n\nmask 区域\n*****0c8358528366487adb.png\"*****\n\n虽然我的证明没有遍历所有数据，但是按照一个市含有的社区人员和学生数量即可判断属于大量个人信息泄露。   修复方案：  问题1：随机登录密码，首次登录强制修改密码问题2 and 3：i don't konw!   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-11-11 14:21 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}