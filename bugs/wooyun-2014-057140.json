{"id": 2896, "wybug_id": "wooyun-2014-057140", "wybug_title": "秘密APP逻辑缺陷导致可猜测秘密具体发布者是哪个好友", "wybug_corp": "秘密", "wybug_author": "Lucien", "wybug_date": "2014-04-16 10:38", "wybug_open_date": "2014-07-15 10:39", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "手机应用", "秘密"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-06-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向公众公开  简要描述： 由无觅网出品的秘密AAP可以匿名发布信息，其最重要的卖点就是隐私保护，但是由于其存在着致命的逻辑设计缺陷，可猜测出秘密的发布者是自己的哪位联系人。隐私保护形同虚设，命中率百分百。这是一个逻辑挑战。 详细说明：  秘密APP存在三个问题第一，注册账号时无需验证手机号就可注册成功。第二，通过找回密码穷举联系人可以获得注册秘密APP的好友列表。第三，请求找回密码重新获取时间可以通过登录账号再退出绕过将以上三个漏洞加以利用即可猜测出秘密发布者。猜测步骤：1.利用APP只能注册三个账号的特点，注册满三个账号（手机号任意输，不是自己的手机号也能注册）。2.通过忘记密码穷举联系人列表，未注册的会提示手机号码还未注册，已注册的会提示一部手机最多注册三个账号。 PS：为什么第一步要把三个账号注册满，因为你不注册满，一旦该手机号码注册过秘密，就会发验证码过去，岂不是打草惊蛇了。而且会触发验证码120秒的等待时间（不过也有办法不等待，登陆自己的号码再退出等待时间就清零了。3.在另外一台通讯录为0的设备上注册一个新的账号。把联系人账号一个个输进去，前三个输入自几注册过的手机号，后面每增加一名用户，就能看到这名用户发的所有秘密。（这里也体现出刚开始注册总结。。以方法虽然笨了点，时间也花的久点，但是确实有效，100%命中！以上第二步可以写个软件跑一下，两分钟就能出结果，第三步还需要自己去慢慢比对。。联系人注册多的就杯具了。其实也有更笨的办法，跳过第二步不用猜测谁注册了秘密，直接把通讯录联系人一个一个添加到新的设备和账号里，就可以了！   漏洞证明：  1.提前注册好一个账号。13737373737，并发布text秘密2.通过重置密码发现13737373737已注册\n\n（未注册显示为手机号码还未注册，可将该人排除）\n\n3.将13737373737加入通讯录\n\n4.发现朋友的消息多出了一条，即可猜测是来自13737373737的匿名消息。\n\n   修复方案：  增加注册时短信验证，忘记密码更换提示语，增加请求次数限制，修改请求时长限制   版权声明：转载请注明来源 Lucien@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-04-16 21:44 厂商回复： 感谢@Lucien对秘密的关注及提出的建议。我们重新深入了解及测试了整个流程，按照用户提供的测试流程并无法确切猜出发表秘密的用户。但用户对于产品提示及注册流程的建议非常棒，已被采纳，将于下一版提供给用户。有其他方面的建议及反馈可发邮件至mimifb#。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-15 18:23 |    \t\toouaoo \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 转型中。)\t\t \n  逻辑设计问题。。那这业务都不能玩了。    \n     2014-04-15 18:23 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  颤抖了    \n     2014-04-15 19:16 |    \t\tLucien \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 一个普通用户)\t\t \n  你们的秘密我都一清二楚！！    \n     2014-04-15 23:55 |    \t\tblast \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:57        | 五仁委员会)\t\t \n  漂亮 = =！    \n     2014-04-16 00:36 |    \t\t只发通用型 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:14        | 刷通用型奖金小号)\t\t \n  都说了裤子早晚要被脱    \n     2014-04-16 10:41 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  wumii 他们的域名是 无秘密    \n     2014-04-16 11:07 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  据说有女的在里面发过什么什么的。看过截图尼玛给力    \n     2014-04-16 13:13 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  呵呵……    \n     2014-04-16 19:14 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2014-04-16 19:15 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @秘密 记得5天内确认漏洞撒~    \n     2014-04-16 20:37 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @wefgod 到底是有多叼    \n     2014-04-16 22:47 |    \t\tNicky \t\t\t( 普通白帽子  |\t\t\t        Rank:477 漏洞数:69        | http://www.droidsec.cn 安卓安全中文站)\t\t \n  二分法？    \n     2014-04-16 23:46 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  这个秘密是冒牌的那个吧    \n     2014-05-14 21:36 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  @wefgod 感兴趣的是它的裤子    \n     2014-06-10 08:01 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  我靠，你也来乌云了，辛龙，嘿嘿    \n     2014-07-15 10:52 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  膜拜、    \n     2014-07-15 11:14 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  ( ⊙ o ⊙ )啊！    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}