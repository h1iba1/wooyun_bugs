{"id": 86292, "wybug_id": "wooyun-2016-0188746", "wybug_title": "理财屋网站存在漏洞 可以任意重置用户密码", "wybug_corp": "理财屋", "wybug_author": "立志成为厨神的男人", "wybug_date": "2016-03-25 10:13", "wybug_open_date": "2016-05-09 10:13", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "安全意识不足", "未授权访问", "用户敏感信息泄露", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-05-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  可以绕过短信验证直接修改用户密码 注册不存在的手机号 实名不存在的身份证有巨大安全隐患   漏洞证明：  注册部分：填写任意手机号\n\n点击下一步\n\n请求是酱紫的然后拦截响应如下：\n\n此时提示我验证码错误，但是我发现可以修改响应代码为200，结果为true（正常注册时候就是响应这个）修改如下：\n\n然后继续\n\n发现成功绕过了，可以正常注册了。期间有个图没截，在我修改响应之后，系统会再修正一次响应，修正后的是正常的验证码正确时候才会给的响应。下面密码找回部分的时候我截了\n\n填密码\n\n注册成功了\n\n成功登录了！ 找回密码：还用改改的手机号点找回密码\n\n继续\n\n输入任意验证码，然后下一步\n\n拦截响应如下\n\n此时还是提示验证码错误，没错，和刚刚一模一样！修改下\n\n修改后点击BURP的forward，可以看到服务器返回了一个完全正常的响应，如下图\n\n然后继续\n\n好了 到这里就可以正常重置密码了\n\n\n\n另外，网站还有个实名认证也是一个套路，通过手机验证码校验的，形同虚设此外，网站登录页面会如果输入不存在的用户名，会提示用户名不存在；输入错误密码会单独提示密码错误；而且登录没有验证码可以暴力猜测用户名，然后用上述方法修改密码   修复方案：  改变认证机制，修改响应机制。恩。。。你们自己琢磨，截图好累   版权声明：转载请注明来源 立志成为厨神的男人@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评价\n     2016-03-25 15:10 |    \t\t立志成为厨神的男人 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | 我饿了)\t\t \n  第一个漏洞 处女洞 激动    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}