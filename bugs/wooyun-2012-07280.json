{"id": 20228, "wybug_id": "wooyun-2012-07280", "wybug_title": "WordPress反射型XSS", "wybug_corp": "Wordpress", "wybug_author": "路人甲", "wybug_date": "2012-05-18 15:28", "wybug_open_date": "2012-05-18 15:28", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-05-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： WordPress是一种使用PHP语言开发的博客平台，用户可以在支持PHP和MySQL 数据库的服务器上架设自己的网志。也可以把 WordPress 当作一个内容管理系统（CMS）来使用。近日，国外安全研究人员公布，WordPress在部分功能实现上采用了不安全的第三方组件，导致XSS漏洞，当攻击者诱骗管理员点击，攻击成功可以直接GETSHELL。 详细说明：  原文：https://nealpoole.com/blog/2012/05/xss-and-csrf-via-swf-applets-swfupload-plupload/对wp-includes/js/swfupload/swfupload.swf进行反编译分析，尽管swfupload.swf其对传入ExternalInterface.call的第二个参数进行了安全编码，但对于函数名，即ExternalInterface.call的第一个参数没有进行安全编码。而函数名中的部分字符可控，造成xss漏洞。\nthis.movieName = root.loaderInfo.parameters.movieName;...this.flashReady_Callback = \"SWFUpload.instances[\\\"\" + this.movieName + \"\\\"].flashReady\";...if (ExternalCall.Bool(this.testExternalInterface_Callback)){    ExternalCall.Simple(this.flashReady_Callback);    this.hasCalledFlashReady = true;}=================class ExternalCall extends Object{...        public static function Simple(param1:String) : void        {            ExternalInterface.call(param1);            return;        }\n   漏洞证明：  http://www.80sec.com/wp-includes/js/swfupload/swfupload.swf?movieName=\"])}catch(e){if(!window.x){window.x=1;alert(/xss/)}}//   修复方案：  暂时删除swfupload.swf，等待官方更新。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-05-18 16:27 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  flash火爆了    \n     2012-05-18 16:53 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  缺陷关联： WooYun: JWPlayer Xss 0day [Flash编程安全问题] （Flash编程安全）    \n     2012-05-18 16:54 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  @蟋蟀哥哥 @horseluke              replacePattern = new RegExp(\"[^a-zA-Z0-9_]\", \"g\");            this.movieName = replace(replacePattern, \"\");            this.flashReady_Callback = \"SWFUpload.instances[\\\"\" + this.movieName + \"\\\"].flashReady\";    \n     2012-05-18 21:10 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  昨天刚准备下载这个，看来免了。。。    \n     2012-05-19 12:29 |    \t\tQcbf \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | hello computer)\t\t \n  新版本的wordpress修复了这个漏洞..www.32199.net/wp-includes/js/swfupload/swfupload.swf?movieName=\"])}catch(e){if(!window.x){window.x=1;alert(/xss/)}}//我用的最新的wordpress..    \n     2012-05-19 12:43 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @rayh4c 修补方法？    \n     2012-05-19 12:44 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @horseluke 升级    \n     2012-05-19 12:55 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @蟋蟀哥哥 额，我问的是，他所说的是不是一种修复方法？    \n     2012-05-19 13:13 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @horseluke 他说的是利用和测试,证明他的blog已经没有这个漏洞了    \n     2012-05-21 11:23 |    \t\tnidao \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:3        | 还是木有。)\t\t \n  怎么直接GETSHELL？？？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}