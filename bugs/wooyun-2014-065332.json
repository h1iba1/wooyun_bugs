{"id": 1430, "wybug_id": "wooyun-2014-065332", "wybug_title": "DedeCMS-V5.7-UTF8-SP1 变反射为持久xss 拿shell", "wybug_corp": "Dedecms", "wybug_author": "menmen519", "wybug_date": "2014-06-18 09:41", "wybug_open_date": "2014-09-13 09:42", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "持久型", "第三方不可信程序", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-23：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-13：\t细节向公众公开  简要描述： DedeCMS-V5.7-UTF8-SP1 变反射为持久xss 拿shell 上次提交了一个个人圈子的反射型xss，但是乌云没有理会我，一直到现在还没有审核，这次我重新在找一个，那么就利用这个，把反射型变成一个持久类型，然后拿后台shell 详细说明：  首先我们登陆用户，然后创建圈子，如图所示：\n\n发送给管理员的短消息如下：\n\n然后我们登陆管理员，在管理员的短消息里面查看：\n\n到此为止所有的操作已经执行完毕，那么我们来看看，此处的csrf究竟发生在那一块,看到管理后台有一个执行sql语句的地方,如图:\n\n然后我们找到一个可写目录：D:\\wamp\\www\\DedeCMS-V5.7-UTF8-SP1\\uploads\\uploads\\userup，当然了如果是linux，大家也能够对应起来接下来 我们肯定就是利用mysql的into outfile 语句进行写shell，那么有人就要问我了，这个语句需要高权限，不要紧在这之前我也做过一个后台xss+csrf拿shell的，只不过这里我只是举一个例子最终我们证明我们的过程，如图所示：\n\n致辞已经全部完成，其实我一直不明白wuyun为什么不接受反射型xss，这种和csrf利用起来还是非常危险的，ok！！！！！   漏洞证明：     修复方案：     版权声明：转载请注明来源 menmen519@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-09-13 09:42 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-18 10:17 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  专注dedecms三十载    \n     2014-06-18 11:08 |    \t\t博丽灵梦 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:7        | = =cf)\t\t \n  多么玄幻的一个标题  mark一个    \n     2014-06-18 11:16 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  只是希望乌云对反射型xss多重视一些，不要老忽略    \n     2014-06-18 11:20 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  $    \n     2014-06-18 15:41 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  @menmen519 利用漏洞是一种艺术，顶LZ    \n     2014-06-18 16:19 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  @luwikes 呵呵 就是给一个提醒，反射xss也是很恐怖的    \n     2014-06-18 17:43 |    \t\tj2ck3r \t\t\t( 普通白帽子  |\t\t\t        Rank:406 漏洞数:92        | 别关注我，跟你不熟。)\t\t \n  xss还能拿webshell？？    \n     2014-08-19 16:58 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  忍不住又来赞美了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}