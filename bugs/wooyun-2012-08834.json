{"id": 18440, "wybug_id": "wooyun-2012-08834", "wybug_title": "a.sop电子政务公共服务支撑与管理平台-在线直播系统任意文件上传漏洞", "wybug_corp": "航天四创", "wybug_author": "刺刺", "wybug_date": "2012-06-27 01:07", "wybug_open_date": "2012-08-11 01:08", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-11：\t细节向公众公开  简要描述： 航天四创a.sop电子政务公共服务支撑与管理平台-在线访谈直播系统，存在任意文件文件上传的问题，比如上传jsp脚本，即可取得对应的控制权限。使用该套系统的单位有某国公安部、工信部、科协、民政部、国务院国有资产监督管理委员会等部委机关。如果发生厂商忽略，麻烦cert通知涉及单位，有的已经被XX过了。 详细说明：  1. 首先是在线直播的后台；比如：工信部的http://zhibo.miit.gov.cn:8080/direct/displayLogin.do\n\n这里存在默认口令，admin admin，有的版本没有改；不过要是改了也没有关系；你可以使用经典的  1'or'1'='1 ,用户名和密码都是这就可以登入。进入以后，选择直播管理—\n\n点击第一个直播主题“信息化与工业化融合成果展览会”选择“直播管理者”，记录管理者的帐号和密码；\n\n先退出。然后以刚才的帐号和密码，选择对应的主题，登录\n\n登录进入，选择导播\n\n选择“增加图片”，在新窗口中，右键属性，查看添加图片的具体link\n\n比如此处的是：http://zhibo.miit.gov.cn:8080/direct/manager/addpicture.jsp?menuid=45在新窗口打开以上连接；另存为本地html文件；打开编辑\nvar str= document.all.picture.value.substr(document.all.picture.value.lastIndexOf(\".\")+1);   \t   \t\tvar s_str = str.toLowerCase();   \t   \tif(s_str!=\"jpg\" && s_str!=\"bmp\" && s_str!=\"gif\" && s_str!=\"png\" && s_str!=\"tif\"    \t\t\t&& s_str!=\"wmf\" && s_str!=\"jpeg\" && s_str!=\"psd\" && s_str!=\"pcx\"    \t \t\t&& s_str!=\"exif\" && s_str!=\"tiff\" && s_str!=\"svg\" && s_str!=\"dxf\"    \t \t\t&& s_str!=\"ufo\" && s_str!=\"eps\"){\n随便改一个为jsp,将POST的action改为全地址；\n<form name=\"rForm\" method=\"POST\" action=\"http://zhibo.miit.gov.cn:8080/direct/savepicture.do?menuid=45\"\n修改完成，本地浏览器打开，可能有乱码，右键编码选择UTF-8编码；浏览，选择jsp脚本，保存即可上传；\n\n   漏洞证明：  \n\njsp脚本木马已经上传成功；比如公安部的\n\n其他的几个我就不测试了。比如：http://fangtan.sasac.gov.cn/direct/manager/addpicture.jsp?menuid=1   修复方案：  通过google搜索出来的在线直播的版本是2.0——4.0，只要可以打开的，几乎无一幸免。从代码的角度讲，修补工作太多，我很怀疑航天四创的能力。从用户的角度来说，大家又不是没有钱的单位，这套系统该停就停了吧。（还是录制一个视频好，这个插图太麻烦了。）   版权声明：转载请注明来源 刺刺@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：19  确认时间：2012-06-27 02:00 厂商回复： CNVD确认漏洞并复现所述情况，转由CNCERT国家中心上报国务院某信息安全协调机构处置。对漏洞评分如下：CVSS：(AV:R/AC:L/Au:NR/C:C/A:P/I:C/B:N) score:9.67（最高10分，高危）即：远程攻击、攻击难度低、不需要用户认证，对机密性、完整性构成完全影响，对可用性构成部分影响。技术难度系数：1.1 （多个漏洞)影响危害系数：1.8（严重，涉及多个部委子站，构成业务运行安全风险）CNVD综合评分：7.79*1.1*1.2=19.146 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-27 09:10 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  @cncert国家互联网应急中心  rank算数没算好吧 7.79*1.1*1.2=19.146  怎么来的？    \n     2012-07-17 10:54 |    \t\tValo洛洛 \t\t\t( 普通白帽子  |\t\t\t        Rank:458 漏洞数:52        | 。)\t\t \n  @cncert国家互联网应急中心 表示公开了也没补    \n     2012-07-29 22:32 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  国务院某信息安全协调机构和CNCERT的各省分中心一个德行，事不关己，高高挂起。    \n     2012-08-11 01:17 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  表示真的没补~~~要被轮了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 19, "Ranks": null}